var eH=Object.defineProperty;var W2=e=>{throw TypeError(e)};var tH=(e,t,r)=>t in e?eH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var oe=(e,t,r)=>tH(e,typeof t!="symbol"?t+"":t,r),Qv=(e,t,r)=>t.has(e)||W2("Cannot "+r);var Le=(e,t,r)=>(Qv(e,t,"read from private field"),r?r.call(e):t.get(e)),yr=(e,t,r)=>t.has(e)?W2("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Kt=(e,t,r,n)=>(Qv(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Yn=(e,t,r)=>(Qv(e,t,"access private method"),r);var fm=(e,t,r,n)=>({set _(s){Kt(e,t,s,r)},get _(){return Le(e,t,n)}});function rH(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function OR(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function jR(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var DR={exports:{}},U_={},NR={exports:{}},Jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sp=Symbol.for("react.element"),nH=Symbol.for("react.portal"),sH=Symbol.for("react.fragment"),iH=Symbol.for("react.strict_mode"),oH=Symbol.for("react.profiler"),aH=Symbol.for("react.provider"),lH=Symbol.for("react.context"),cH=Symbol.for("react.forward_ref"),uH=Symbol.for("react.suspense"),dH=Symbol.for("react.memo"),hH=Symbol.for("react.lazy"),G2=Symbol.iterator;function fH(e){return e===null||typeof e!="object"?null:(e=G2&&e[G2]||e["@@iterator"],typeof e=="function"?e:null)}var RR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},FR=Object.assign,LR={};function Md(e,t,r){this.props=e,this.context=t,this.refs=LR,this.updater=r||RR}Md.prototype.isReactComponent={};Md.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Md.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function BR(){}BR.prototype=Md.prototype;function N1(e,t,r){this.props=e,this.context=t,this.refs=LR,this.updater=r||RR}var R1=N1.prototype=new BR;R1.constructor=N1;FR(R1,Md.prototype);R1.isPureReactComponent=!0;var H2=Array.isArray,zR=Object.prototype.hasOwnProperty,F1={current:null},VR={key:!0,ref:!0,__self:!0,__source:!0};function UR(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)zR.call(t,n)&&!VR.hasOwnProperty(n)&&(s[n]=t[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:sp,type:e,key:i,ref:o,props:s,_owner:F1.current}}function pH(e,t){return{$$typeof:sp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function L1(e){return typeof e=="object"&&e!==null&&e.$$typeof===sp}function mH(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var K2=/\/+/g;function Yv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mH(""+e.key):t.toString(36)}function fg(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case sp:case nH:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+Yv(o,0):n,H2(s)?(r="",e!=null&&(r=e.replace(K2,"$&/")+"/"),fg(s,t,r,"",function(c){return c})):s!=null&&(L1(s)&&(s=pH(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(K2,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",H2(e))for(var a=0;a<e.length;a++){i=e[a];var l=n+Yv(i,a);o+=fg(i,t,r,l,s)}else if(l=fH(e),typeof l=="function")for(e=l.call(e),a=0;!(i=e.next()).done;)i=i.value,l=n+Yv(i,a++),o+=fg(i,t,r,l,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function pm(e,t,r){if(e==null)return e;var n=[],s=0;return fg(e,n,"","",function(i){return t.call(r,i,s++)}),n}function gH(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var gs={current:null},pg={transition:null},_H={ReactCurrentDispatcher:gs,ReactCurrentBatchConfig:pg,ReactCurrentOwner:F1};function WR(){throw Error("act(...) is not supported in production builds of React.")}Jt.Children={map:pm,forEach:function(e,t,r){pm(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return pm(e,function(){t++}),t},toArray:function(e){return pm(e,function(t){return t})||[]},only:function(e){if(!L1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Jt.Component=Md;Jt.Fragment=sH;Jt.Profiler=oH;Jt.PureComponent=N1;Jt.StrictMode=iH;Jt.Suspense=uH;Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_H;Jt.act=WR;Jt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=FR({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=F1.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)zR.call(t,l)&&!VR.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:sp,type:e.type,key:s,ref:i,props:n,_owner:o}};Jt.createContext=function(e){return e={$$typeof:lH,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:aH,_context:e},e.Consumer=e};Jt.createElement=UR;Jt.createFactory=function(e){var t=UR.bind(null,e);return t.type=e,t};Jt.createRef=function(){return{current:null}};Jt.forwardRef=function(e){return{$$typeof:cH,render:e}};Jt.isValidElement=L1;Jt.lazy=function(e){return{$$typeof:hH,_payload:{_status:-1,_result:e},_init:gH}};Jt.memo=function(e,t){return{$$typeof:dH,type:e,compare:t===void 0?null:t}};Jt.startTransition=function(e){var t=pg.transition;pg.transition={};try{e()}finally{pg.transition=t}};Jt.unstable_act=WR;Jt.useCallback=function(e,t){return gs.current.useCallback(e,t)};Jt.useContext=function(e){return gs.current.useContext(e)};Jt.useDebugValue=function(){};Jt.useDeferredValue=function(e){return gs.current.useDeferredValue(e)};Jt.useEffect=function(e,t){return gs.current.useEffect(e,t)};Jt.useId=function(){return gs.current.useId()};Jt.useImperativeHandle=function(e,t,r){return gs.current.useImperativeHandle(e,t,r)};Jt.useInsertionEffect=function(e,t){return gs.current.useInsertionEffect(e,t)};Jt.useLayoutEffect=function(e,t){return gs.current.useLayoutEffect(e,t)};Jt.useMemo=function(e,t){return gs.current.useMemo(e,t)};Jt.useReducer=function(e,t,r){return gs.current.useReducer(e,t,r)};Jt.useRef=function(e){return gs.current.useRef(e)};Jt.useState=function(e){return gs.current.useState(e)};Jt.useSyncExternalStore=function(e,t,r){return gs.current.useSyncExternalStore(e,t,r)};Jt.useTransition=function(){return gs.current.useTransition()};Jt.version="18.3.1";NR.exports=Jt;var C=NR.exports;const et=OR(C),GR=rH({__proto__:null,default:et},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yH=C,vH=Symbol.for("react.element"),wH=Symbol.for("react.fragment"),bH=Object.prototype.hasOwnProperty,xH=yH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,MH={key:!0,ref:!0,__self:!0,__source:!0};function HR(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)bH.call(t,n)&&!MH.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:vH,type:e,key:i,ref:o,props:s,_owner:xH.current}}U_.Fragment=wH;U_.jsx=HR;U_.jsxs=HR;DR.exports=U_;var m=DR.exports,KR={exports:{}},qs={},qR={exports:{}},QR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,te){var re=R.length;R.push(te);e:for(;0<re;){var L=re-1>>>1,j=R[L];if(0<s(j,te))R[L]=te,R[re]=j,re=L;else break e}}function r(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var te=R[0],re=R.pop();if(re!==te){R[0]=re;e:for(var L=0,j=R.length,q=j>>>1;L<q;){var ne=2*(L+1)-1,me=R[ne],ae=ne+1,fe=R[ae];if(0>s(me,re))ae<j&&0>s(fe,me)?(R[L]=fe,R[ae]=re,L=ae):(R[L]=me,R[ne]=re,L=ne);else if(ae<j&&0>s(fe,re))R[L]=fe,R[ae]=re,L=ae;else break e}}return te}function s(R,te){var re=R.sortIndex-te.sortIndex;return re!==0?re:R.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(R){for(var te=r(c);te!==null;){if(te.callback===null)n(c);else if(te.startTime<=R)n(c),te.sortIndex=te.expirationTime,t(l,te);else break;te=r(c)}}function b(R){if(_=!1,v(R),!p)if(r(l)!==null)p=!0,X(x);else{var te=r(c);te!==null&&G(b,te.startTime-R)}}function x(R,te){p=!1,_&&(_=!1,y(P),P=-1),f=!0;var re=h;try{for(v(te),d=r(l);d!==null&&(!(d.expirationTime>te)||R&&!V());){var L=d.callback;if(typeof L=="function"){d.callback=null,h=d.priorityLevel;var j=L(d.expirationTime<=te);te=e.unstable_now(),typeof j=="function"?d.callback=j:d===r(l)&&n(l),v(te)}else n(l);d=r(l)}if(d!==null)var q=!0;else{var ne=r(c);ne!==null&&G(b,ne.startTime-te),q=!1}return q}finally{d=null,h=re,f=!1}}var M=!1,E=null,P=-1,I=5,O=-1;function V(){return!(e.unstable_now()-O<I)}function U(){if(E!==null){var R=e.unstable_now();O=R;var te=!0;try{te=E(!0,R)}finally{te?B():(M=!1,E=null)}}else M=!1}var B;if(typeof g=="function")B=function(){g(U)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,K=Y.port2;Y.port1.onmessage=U,B=function(){K.postMessage(null)}}else B=function(){w(U,0)};function X(R){E=R,M||(M=!0,B())}function G(R,te){P=w(function(){R(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,X(x))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(R){switch(h){case 1:case 2:case 3:var te=3;break;default:te=h}var re=h;h=te;try{return R()}finally{h=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,te){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var re=h;h=R;try{return te()}finally{h=re}},e.unstable_scheduleCallback=function(R,te,re){var L=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?L+re:L):re=L,R){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=re+j,R={id:u++,callback:te,priorityLevel:R,startTime:re,expirationTime:j,sortIndex:-1},re>L?(R.sortIndex=re,t(c,R),r(l)===null&&R===r(c)&&(_?(y(P),P=-1):_=!0,G(b,re-L))):(R.sortIndex=j,t(l,R),p||f||(p=!0,X(x))),R},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(R){var te=h;return function(){var re=h;h=te;try{return R.apply(this,arguments)}finally{h=re}}}})(QR);qR.exports=QR;var TH=qR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EH=C,Hs=TH;function Ye(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YR=new Set,wf={};function Ic(e,t){id(e,t),id(e+"Capture",t)}function id(e,t){for(wf[e]=t,e=0;e<t.length;e++)YR.add(t[e])}var Qo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mb=Object.prototype.hasOwnProperty,SH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,q2={},Q2={};function PH(e){return mb.call(Q2,e)?!0:mb.call(q2,e)?!1:SH.test(e)?Q2[e]=!0:(q2[e]=!0,!1)}function CH(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kH(e,t,r,n){if(t===null||typeof t>"u"||CH(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _s(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Hn[e]=new _s(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Hn[t]=new _s(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Hn[e]=new _s(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Hn[e]=new _s(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Hn[e]=new _s(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Hn[e]=new _s(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Hn[e]=new _s(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Hn[e]=new _s(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Hn[e]=new _s(e,5,!1,e.toLowerCase(),null,!1,!1)});var B1=/[\-:]([a-z])/g;function z1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(B1,z1);Hn[t]=new _s(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(B1,z1);Hn[t]=new _s(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(B1,z1);Hn[t]=new _s(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Hn[e]=new _s(e,1,!1,e.toLowerCase(),null,!1,!1)});Hn.xlinkHref=new _s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Hn[e]=new _s(e,1,!1,e.toLowerCase(),null,!0,!0)});function V1(e,t,r,n){var s=Hn.hasOwnProperty(t)?Hn[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kH(t,r,s,n)&&(r=null),n||s===null?PH(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var na=EH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mm=Symbol.for("react.element"),vu=Symbol.for("react.portal"),wu=Symbol.for("react.fragment"),U1=Symbol.for("react.strict_mode"),gb=Symbol.for("react.profiler"),XR=Symbol.for("react.provider"),JR=Symbol.for("react.context"),W1=Symbol.for("react.forward_ref"),_b=Symbol.for("react.suspense"),yb=Symbol.for("react.suspense_list"),G1=Symbol.for("react.memo"),Ta=Symbol.for("react.lazy"),ZR=Symbol.for("react.offscreen"),Y2=Symbol.iterator;function vh(e){return e===null||typeof e!="object"?null:(e=Y2&&e[Y2]||e["@@iterator"],typeof e=="function"?e:null)}var Xr=Object.assign,Xv;function Uh(e){if(Xv===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Xv=t&&t[1]||""}return`
`+Xv+e}var Jv=!1;function Zv(e,t){if(!e||Jv)return"";Jv=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{Jv=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Uh(e):""}function AH(e){switch(e.tag){case 5:return Uh(e.type);case 16:return Uh("Lazy");case 13:return Uh("Suspense");case 19:return Uh("SuspenseList");case 0:case 2:case 15:return e=Zv(e.type,!1),e;case 11:return e=Zv(e.type.render,!1),e;case 1:return e=Zv(e.type,!0),e;default:return""}}function vb(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case wu:return"Fragment";case vu:return"Portal";case gb:return"Profiler";case U1:return"StrictMode";case _b:return"Suspense";case yb:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case JR:return(e.displayName||"Context")+".Consumer";case XR:return(e._context.displayName||"Context")+".Provider";case W1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case G1:return t=e.displayName||null,t!==null?t:vb(e.type)||"Memo";case Ta:t=e._payload,e=e._init;try{return vb(e(t))}catch{}}return null}function $H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vb(t);case 8:return t===U1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function qa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function eF(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function IH(e){var t=eF(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function gm(e){e._valueTracker||(e._valueTracker=IH(e))}function tF(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=eF(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Vg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function wb(e,t){var r=t.checked;return Xr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function X2(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=qa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function rF(e,t){t=t.checked,t!=null&&V1(e,"checked",t,!1)}function bb(e,t){rF(e,t);var r=qa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xb(e,t.type,r):t.hasOwnProperty("defaultValue")&&xb(e,t.type,qa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function J2(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function xb(e,t,r){(t!=="number"||Vg(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Wh=Array.isArray;function Lu(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+qa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Mb(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ye(91));return Xr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Z2(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ye(92));if(Wh(r)){if(1<r.length)throw Error(Ye(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:qa(r)}}function nF(e,t){var r=qa(t.value),n=qa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function eA(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sF(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tb(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sF(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _m,iF=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_m=_m||document.createElement("div"),_m.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_m.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function bf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ef={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OH=["Webkit","ms","Moz","O"];Object.keys(ef).forEach(function(e){OH.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ef[t]=ef[e]})});function oF(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ef.hasOwnProperty(e)&&ef[e]?(""+t).trim():t+"px"}function aF(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=oF(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var jH=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Eb(e,t){if(t){if(jH[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ye(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ye(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ye(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ye(62))}}function Sb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pb=null;function H1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cb=null,Bu=null,zu=null;function tA(e){if(e=ap(e)){if(typeof Cb!="function")throw Error(Ye(280));var t=e.stateNode;t&&(t=q_(t),Cb(e.stateNode,e.type,t))}}function lF(e){Bu?zu?zu.push(e):zu=[e]:Bu=e}function cF(){if(Bu){var e=Bu,t=zu;if(zu=Bu=null,tA(e),t)for(e=0;e<t.length;e++)tA(t[e])}}function uF(e,t){return e(t)}function dF(){}var e0=!1;function hF(e,t,r){if(e0)return e(t,r);e0=!0;try{return uF(e,t,r)}finally{e0=!1,(Bu!==null||zu!==null)&&(dF(),cF())}}function xf(e,t){var r=e.stateNode;if(r===null)return null;var n=q_(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ye(231,t,typeof r));return r}var kb=!1;if(Qo)try{var wh={};Object.defineProperty(wh,"passive",{get:function(){kb=!0}}),window.addEventListener("test",wh,wh),window.removeEventListener("test",wh,wh)}catch{kb=!1}function DH(e,t,r,n,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var tf=!1,Ug=null,Wg=!1,Ab=null,NH={onError:function(e){tf=!0,Ug=e}};function RH(e,t,r,n,s,i,o,a,l){tf=!1,Ug=null,DH.apply(NH,arguments)}function FH(e,t,r,n,s,i,o,a,l){if(RH.apply(this,arguments),tf){if(tf){var c=Ug;tf=!1,Ug=null}else throw Error(Ye(198));Wg||(Wg=!0,Ab=c)}}function Oc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function rA(e){if(Oc(e)!==e)throw Error(Ye(188))}function LH(e){var t=e.alternate;if(!t){if(t=Oc(e),t===null)throw Error(Ye(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return rA(s),e;if(i===n)return rA(s),t;i=i.sibling}throw Error(Ye(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o)throw Error(Ye(189))}}if(r.alternate!==n)throw Error(Ye(190))}if(r.tag!==3)throw Error(Ye(188));return r.stateNode.current===r?e:t}function pF(e){return e=LH(e),e!==null?mF(e):null}function mF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mF(e);if(t!==null)return t;e=e.sibling}return null}var gF=Hs.unstable_scheduleCallback,nA=Hs.unstable_cancelCallback,BH=Hs.unstable_shouldYield,zH=Hs.unstable_requestPaint,hn=Hs.unstable_now,VH=Hs.unstable_getCurrentPriorityLevel,K1=Hs.unstable_ImmediatePriority,_F=Hs.unstable_UserBlockingPriority,Gg=Hs.unstable_NormalPriority,UH=Hs.unstable_LowPriority,yF=Hs.unstable_IdlePriority,W_=null,To=null;function WH(e){if(To&&typeof To.onCommitFiberRoot=="function")try{To.onCommitFiberRoot(W_,e,void 0,(e.current.flags&128)===128)}catch{}}var qi=Math.clz32?Math.clz32:KH,GH=Math.log,HH=Math.LN2;function KH(e){return e>>>=0,e===0?32:31-(GH(e)/HH|0)|0}var ym=64,vm=4194304;function Gh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Hg(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var a=o&~s;a!==0?n=Gh(a):(i&=o,i!==0&&(n=Gh(i)))}else o=r&~s,o!==0?n=Gh(o):i!==0&&(n=Gh(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-qi(t),s=1<<r,n|=e[r],t&=~s;return n}function qH(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QH(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-qi(i),a=1<<o,l=s[o];l===-1?(!(a&r)||a&n)&&(s[o]=qH(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}}function $b(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function vF(){var e=ym;return ym<<=1,!(ym&4194240)&&(ym=64),e}function t0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ip(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qi(t),e[t]=r}function YH(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-qi(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function q1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-qi(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Mr=0;function wF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bF,Q1,xF,MF,TF,Ib=!1,wm=[],Ra=null,Fa=null,La=null,Mf=new Map,Tf=new Map,Sa=[],XH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sA(e,t){switch(e){case"focusin":case"focusout":Ra=null;break;case"dragenter":case"dragleave":Fa=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":Mf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tf.delete(t.pointerId)}}function bh(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=ap(t),t!==null&&Q1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function JH(e,t,r,n,s){switch(t){case"focusin":return Ra=bh(Ra,e,t,r,n,s),!0;case"dragenter":return Fa=bh(Fa,e,t,r,n,s),!0;case"mouseover":return La=bh(La,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Mf.set(i,bh(Mf.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Tf.set(i,bh(Tf.get(i)||null,e,t,r,n,s)),!0}return!1}function EF(e){var t=ec(e.target);if(t!==null){var r=Oc(t);if(r!==null){if(t=r.tag,t===13){if(t=fF(r),t!==null){e.blockedOn=t,TF(e.priority,function(){xF(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function mg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ob(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Pb=n,r.target.dispatchEvent(n),Pb=null}else return t=ap(r),t!==null&&Q1(t),e.blockedOn=r,!1;t.shift()}return!0}function iA(e,t,r){mg(e)&&r.delete(t)}function ZH(){Ib=!1,Ra!==null&&mg(Ra)&&(Ra=null),Fa!==null&&mg(Fa)&&(Fa=null),La!==null&&mg(La)&&(La=null),Mf.forEach(iA),Tf.forEach(iA)}function xh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ib||(Ib=!0,Hs.unstable_scheduleCallback(Hs.unstable_NormalPriority,ZH)))}function Ef(e){function t(s){return xh(s,e)}if(0<wm.length){xh(wm[0],e);for(var r=1;r<wm.length;r++){var n=wm[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ra!==null&&xh(Ra,e),Fa!==null&&xh(Fa,e),La!==null&&xh(La,e),Mf.forEach(t),Tf.forEach(t),r=0;r<Sa.length;r++)n=Sa[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Sa.length&&(r=Sa[0],r.blockedOn===null);)EF(r),r.blockedOn===null&&Sa.shift()}var Vu=na.ReactCurrentBatchConfig,Kg=!0;function eK(e,t,r,n){var s=Mr,i=Vu.transition;Vu.transition=null;try{Mr=1,Y1(e,t,r,n)}finally{Mr=s,Vu.transition=i}}function tK(e,t,r,n){var s=Mr,i=Vu.transition;Vu.transition=null;try{Mr=4,Y1(e,t,r,n)}finally{Mr=s,Vu.transition=i}}function Y1(e,t,r,n){if(Kg){var s=Ob(e,t,r,n);if(s===null)d0(e,t,n,qg,r),sA(e,n);else if(JH(s,e,t,r,n))n.stopPropagation();else if(sA(e,n),t&4&&-1<XH.indexOf(e)){for(;s!==null;){var i=ap(s);if(i!==null&&bF(i),i=Ob(e,t,r,n),i===null&&d0(e,t,n,qg,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else d0(e,t,n,null,r)}}var qg=null;function Ob(e,t,r,n){if(qg=null,e=H1(n),e=ec(e),e!==null)if(t=Oc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fF(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qg=e,null}function SF(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VH()){case K1:return 1;case _F:return 4;case Gg:case UH:return 16;case yF:return 536870912;default:return 16}default:return 16}}var ja=null,X1=null,gg=null;function PF(){if(gg)return gg;var e,t=X1,r=t.length,n,s="value"in ja?ja.value:ja.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return gg=s.slice(e,1<n?1-n:void 0)}function _g(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bm(){return!0}function oA(){return!1}function Qs(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?bm:oA,this.isPropagationStopped=oA,this}return Xr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=bm)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=bm)},persist:function(){},isPersistent:bm}),t}var Td={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},J1=Qs(Td),op=Xr({},Td,{view:0,detail:0}),rK=Qs(op),r0,n0,Mh,G_=Xr({},op,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Z1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mh&&(Mh&&e.type==="mousemove"?(r0=e.screenX-Mh.screenX,n0=e.screenY-Mh.screenY):n0=r0=0,Mh=e),r0)},movementY:function(e){return"movementY"in e?e.movementY:n0}}),aA=Qs(G_),nK=Xr({},G_,{dataTransfer:0}),sK=Qs(nK),iK=Xr({},op,{relatedTarget:0}),s0=Qs(iK),oK=Xr({},Td,{animationName:0,elapsedTime:0,pseudoElement:0}),aK=Qs(oK),lK=Xr({},Td,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cK=Qs(lK),uK=Xr({},Td,{data:0}),lA=Qs(uK),dK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pK(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fK[e])?!!t[e]:!1}function Z1(){return pK}var mK=Xr({},op,{key:function(e){if(e.key){var t=dK[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=_g(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?hK[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Z1,charCode:function(e){return e.type==="keypress"?_g(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_g(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gK=Qs(mK),_K=Xr({},G_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cA=Qs(_K),yK=Xr({},op,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Z1}),vK=Qs(yK),wK=Xr({},Td,{propertyName:0,elapsedTime:0,pseudoElement:0}),bK=Qs(wK),xK=Xr({},G_,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),MK=Qs(xK),TK=[9,13,27,32],eM=Qo&&"CompositionEvent"in window,rf=null;Qo&&"documentMode"in document&&(rf=document.documentMode);var EK=Qo&&"TextEvent"in window&&!rf,CF=Qo&&(!eM||rf&&8<rf&&11>=rf),uA=" ",dA=!1;function kF(e,t){switch(e){case"keyup":return TK.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function AF(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bu=!1;function SK(e,t){switch(e){case"compositionend":return AF(t);case"keypress":return t.which!==32?null:(dA=!0,uA);case"textInput":return e=t.data,e===uA&&dA?null:e;default:return null}}function PK(e,t){if(bu)return e==="compositionend"||!eM&&kF(e,t)?(e=PF(),gg=X1=ja=null,bu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return CF&&t.locale!=="ko"?null:t.data;default:return null}}var CK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hA(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!CK[e.type]:t==="textarea"}function $F(e,t,r,n){lF(n),t=Qg(t,"onChange"),0<t.length&&(r=new J1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var nf=null,Sf=null;function kK(e){VF(e,0)}function H_(e){var t=Tu(e);if(tF(t))return e}function AK(e,t){if(e==="change")return t}var IF=!1;if(Qo){var i0;if(Qo){var o0="oninput"in document;if(!o0){var fA=document.createElement("div");fA.setAttribute("oninput","return;"),o0=typeof fA.oninput=="function"}i0=o0}else i0=!1;IF=i0&&(!document.documentMode||9<document.documentMode)}function pA(){nf&&(nf.detachEvent("onpropertychange",OF),Sf=nf=null)}function OF(e){if(e.propertyName==="value"&&H_(Sf)){var t=[];$F(t,Sf,e,H1(e)),hF(kK,t)}}function $K(e,t,r){e==="focusin"?(pA(),nf=t,Sf=r,nf.attachEvent("onpropertychange",OF)):e==="focusout"&&pA()}function IK(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return H_(Sf)}function OK(e,t){if(e==="click")return H_(t)}function jK(e,t){if(e==="input"||e==="change")return H_(t)}function DK(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xi=typeof Object.is=="function"?Object.is:DK;function Pf(e,t){if(Xi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!mb.call(t,s)||!Xi(e[s],t[s]))return!1}return!0}function mA(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gA(e,t){var r=mA(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=mA(r)}}function jF(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?jF(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function DF(){for(var e=window,t=Vg();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vg(e.document)}return t}function tM(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function NK(e){var t=DF(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&jF(r.ownerDocument.documentElement,r)){if(n!==null&&tM(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=gA(r,i);var o=gA(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var RK=Qo&&"documentMode"in document&&11>=document.documentMode,xu=null,jb=null,sf=null,Db=!1;function _A(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Db||xu==null||xu!==Vg(n)||(n=xu,"selectionStart"in n&&tM(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),sf&&Pf(sf,n)||(sf=n,n=Qg(jb,"onSelect"),0<n.length&&(t=new J1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=xu)))}function xm(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Mu={animationend:xm("Animation","AnimationEnd"),animationiteration:xm("Animation","AnimationIteration"),animationstart:xm("Animation","AnimationStart"),transitionend:xm("Transition","TransitionEnd")},a0={},NF={};Qo&&(NF=document.createElement("div").style,"AnimationEvent"in window||(delete Mu.animationend.animation,delete Mu.animationiteration.animation,delete Mu.animationstart.animation),"TransitionEvent"in window||delete Mu.transitionend.transition);function K_(e){if(a0[e])return a0[e];if(!Mu[e])return e;var t=Mu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in NF)return a0[e]=t[r];return e}var RF=K_("animationend"),FF=K_("animationiteration"),LF=K_("animationstart"),BF=K_("transitionend"),zF=new Map,yA="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sl(e,t){zF.set(e,t),Ic(t,[e])}for(var l0=0;l0<yA.length;l0++){var c0=yA[l0],FK=c0.toLowerCase(),LK=c0[0].toUpperCase()+c0.slice(1);sl(FK,"on"+LK)}sl(RF,"onAnimationEnd");sl(FF,"onAnimationIteration");sl(LF,"onAnimationStart");sl("dblclick","onDoubleClick");sl("focusin","onFocus");sl("focusout","onBlur");sl(BF,"onTransitionEnd");id("onMouseEnter",["mouseout","mouseover"]);id("onMouseLeave",["mouseout","mouseover"]);id("onPointerEnter",["pointerout","pointerover"]);id("onPointerLeave",["pointerout","pointerover"]);Ic("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ic("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ic("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ic("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ic("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ic("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BK=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hh));function vA(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,FH(n,t,void 0,e),e.currentTarget=null}function VF(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;vA(s,a,c),i=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;vA(s,a,c),i=l}}}if(Wg)throw e=Ab,Wg=!1,Ab=null,e}function Fr(e,t){var r=t[Bb];r===void 0&&(r=t[Bb]=new Set);var n=e+"__bubble";r.has(n)||(UF(t,e,2,!1),r.add(n))}function u0(e,t,r){var n=0;t&&(n|=4),UF(r,e,n,t)}var Mm="_reactListening"+Math.random().toString(36).slice(2);function Cf(e){if(!e[Mm]){e[Mm]=!0,YR.forEach(function(r){r!=="selectionchange"&&(BK.has(r)||u0(r,!1,e),u0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Mm]||(t[Mm]=!0,u0("selectionchange",!1,t))}}function UF(e,t,r,n){switch(SF(t)){case 1:var s=eK;break;case 4:s=tK;break;default:s=Y1}r=s.bind(null,t,r,e),s=void 0,!kb||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function d0(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ec(a),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}a=a.parentNode}}n=n.return}hF(function(){var c=i,u=H1(r),d=[];e:{var h=zF.get(e);if(h!==void 0){var f=J1,p=e;switch(e){case"keypress":if(_g(r)===0)break e;case"keydown":case"keyup":f=gK;break;case"focusin":p="focus",f=s0;break;case"focusout":p="blur",f=s0;break;case"beforeblur":case"afterblur":f=s0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=aA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=sK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=vK;break;case RF:case FF:case LF:f=aK;break;case BF:f=bK;break;case"scroll":f=rK;break;case"wheel":f=MK;break;case"copy":case"cut":case"paste":f=cK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=cA}var _=(t&4)!==0,w=!_&&e==="scroll",y=_?h!==null?h+"Capture":null:h;_=[];for(var g=c,v;g!==null;){v=g;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,y!==null&&(b=xf(g,y),b!=null&&_.push(kf(g,b,v)))),w)break;g=g.return}0<_.length&&(h=new f(h,p,null,r,u),d.push({event:h,listeners:_}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&r!==Pb&&(p=r.relatedTarget||r.fromElement)&&(ec(p)||p[Yo]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=c,p=p?ec(p):null,p!==null&&(w=Oc(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(_=aA,b="onMouseLeave",y="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(_=cA,b="onPointerLeave",y="onPointerEnter",g="pointer"),w=f==null?h:Tu(f),v=p==null?h:Tu(p),h=new _(b,g+"leave",f,r,u),h.target=w,h.relatedTarget=v,b=null,ec(u)===c&&(_=new _(y,g+"enter",p,r,u),_.target=v,_.relatedTarget=w,b=_),w=b,f&&p)t:{for(_=f,y=p,g=0,v=_;v;v=nu(v))g++;for(v=0,b=y;b;b=nu(b))v++;for(;0<g-v;)_=nu(_),g--;for(;0<v-g;)y=nu(y),v--;for(;g--;){if(_===y||y!==null&&_===y.alternate)break t;_=nu(_),y=nu(y)}_=null}else _=null;f!==null&&wA(d,h,f,_,!1),p!==null&&w!==null&&wA(d,w,p,_,!0)}}e:{if(h=c?Tu(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var x=AK;else if(hA(h))if(IF)x=jK;else{x=IK;var M=$K}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(x=OK);if(x&&(x=x(e,c))){$F(d,x,r,u);break e}M&&M(e,h,c),e==="focusout"&&(M=h._wrapperState)&&M.controlled&&h.type==="number"&&xb(h,"number",h.value)}switch(M=c?Tu(c):window,e){case"focusin":(hA(M)||M.contentEditable==="true")&&(xu=M,jb=c,sf=null);break;case"focusout":sf=jb=xu=null;break;case"mousedown":Db=!0;break;case"contextmenu":case"mouseup":case"dragend":Db=!1,_A(d,r,u);break;case"selectionchange":if(RK)break;case"keydown":case"keyup":_A(d,r,u)}var E;if(eM)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else bu?kF(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(CF&&r.locale!=="ko"&&(bu||P!=="onCompositionStart"?P==="onCompositionEnd"&&bu&&(E=PF()):(ja=u,X1="value"in ja?ja.value:ja.textContent,bu=!0)),M=Qg(c,P),0<M.length&&(P=new lA(P,e,null,r,u),d.push({event:P,listeners:M}),E?P.data=E:(E=AF(r),E!==null&&(P.data=E)))),(E=EK?SK(e,r):PK(e,r))&&(c=Qg(c,"onBeforeInput"),0<c.length&&(u=new lA("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=E))}VF(d,t)})}function kf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Qg(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=xf(e,r),i!=null&&n.unshift(kf(e,i,s)),i=xf(e,t),i!=null&&n.push(kf(e,i,s))),e=e.return}return n}function nu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wA(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,s?(l=xf(r,i),l!=null&&o.unshift(kf(r,l,a))):s||(l=xf(r,i),l!=null&&o.push(kf(r,l,a)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var zK=/\r\n?/g,VK=/\u0000|\uFFFD/g;function bA(e){return(typeof e=="string"?e:""+e).replace(zK,`
`).replace(VK,"")}function Tm(e,t,r){if(t=bA(t),bA(e)!==t&&r)throw Error(Ye(425))}function Yg(){}var Nb=null,Rb=null;function Fb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lb=typeof setTimeout=="function"?setTimeout:void 0,UK=typeof clearTimeout=="function"?clearTimeout:void 0,xA=typeof Promise=="function"?Promise:void 0,WK=typeof queueMicrotask=="function"?queueMicrotask:typeof xA<"u"?function(e){return xA.resolve(null).then(e).catch(GK)}:Lb;function GK(e){setTimeout(function(){throw e})}function h0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Ef(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ef(t)}function Ba(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function MA(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ed=Math.random().toString(36).slice(2),wo="__reactFiber$"+Ed,Af="__reactProps$"+Ed,Yo="__reactContainer$"+Ed,Bb="__reactEvents$"+Ed,HK="__reactListeners$"+Ed,KK="__reactHandles$"+Ed;function ec(e){var t=e[wo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Yo]||r[wo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=MA(e);e!==null;){if(r=e[wo])return r;e=MA(e)}return t}e=r,r=e.parentNode}return null}function ap(e){return e=e[wo]||e[Yo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ye(33))}function q_(e){return e[Af]||null}var zb=[],Eu=-1;function il(e){return{current:e}}function Lr(e){0>Eu||(e.current=zb[Eu],zb[Eu]=null,Eu--)}function Dr(e,t){Eu++,zb[Eu]=e.current,e.current=t}var Qa={},ns=il(Qa),Es=il(!1),yc=Qa;function od(e,t){var r=e.type.contextTypes;if(!r)return Qa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ss(e){return e=e.childContextTypes,e!=null}function Xg(){Lr(Es),Lr(ns)}function TA(e,t,r){if(ns.current!==Qa)throw Error(Ye(168));Dr(ns,t),Dr(Es,r)}function WF(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Ye(108,$H(e)||"Unknown",s));return Xr({},r,n)}function Jg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qa,yc=ns.current,Dr(ns,e),Dr(Es,Es.current),!0}function EA(e,t,r){var n=e.stateNode;if(!n)throw Error(Ye(169));r?(e=WF(e,t,yc),n.__reactInternalMemoizedMergedChildContext=e,Lr(Es),Lr(ns),Dr(ns,e)):Lr(Es),Dr(Es,r)}var Wo=null,Q_=!1,f0=!1;function GF(e){Wo===null?Wo=[e]:Wo.push(e)}function qK(e){Q_=!0,GF(e)}function ol(){if(!f0&&Wo!==null){f0=!0;var e=0,t=Mr;try{var r=Wo;for(Mr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Wo=null,Q_=!1}catch(s){throw Wo!==null&&(Wo=Wo.slice(e+1)),gF(K1,ol),s}finally{Mr=t,f0=!1}}return null}var Su=[],Pu=0,Zg=null,e_=0,ci=[],ui=0,vc=null,Ho=1,Ko="";function Wl(e,t){Su[Pu++]=e_,Su[Pu++]=Zg,Zg=e,e_=t}function HF(e,t,r){ci[ui++]=Ho,ci[ui++]=Ko,ci[ui++]=vc,vc=e;var n=Ho;e=Ko;var s=32-qi(n)-1;n&=~(1<<s),r+=1;var i=32-qi(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ho=1<<32-qi(t)+s|r<<s|n,Ko=i+e}else Ho=1<<i|r<<s|n,Ko=e}function rM(e){e.return!==null&&(Wl(e,1),HF(e,1,0))}function nM(e){for(;e===Zg;)Zg=Su[--Pu],Su[Pu]=null,e_=Su[--Pu],Su[Pu]=null;for(;e===vc;)vc=ci[--ui],ci[ui]=null,Ko=ci[--ui],ci[ui]=null,Ho=ci[--ui],ci[ui]=null}var Us=null,Vs=null,zr=!1,zi=null;function KF(e,t){var r=fi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function SA(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Us=e,Vs=Ba(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Us=e,Vs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=vc!==null?{id:Ho,overflow:Ko}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=fi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Us=e,Vs=null,!0):!1;default:return!1}}function Vb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ub(e){if(zr){var t=Vs;if(t){var r=t;if(!SA(e,t)){if(Vb(e))throw Error(Ye(418));t=Ba(r.nextSibling);var n=Us;t&&SA(e,t)?KF(n,r):(e.flags=e.flags&-4097|2,zr=!1,Us=e)}}else{if(Vb(e))throw Error(Ye(418));e.flags=e.flags&-4097|2,zr=!1,Us=e}}}function PA(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Us=e}function Em(e){if(e!==Us)return!1;if(!zr)return PA(e),zr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Fb(e.type,e.memoizedProps)),t&&(t=Vs)){if(Vb(e))throw qF(),Error(Ye(418));for(;t;)KF(e,t),t=Ba(t.nextSibling)}if(PA(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ye(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Vs=Ba(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Vs=null}}else Vs=Us?Ba(e.stateNode.nextSibling):null;return!0}function qF(){for(var e=Vs;e;)e=Ba(e.nextSibling)}function ad(){Vs=Us=null,zr=!1}function sM(e){zi===null?zi=[e]:zi.push(e)}var QK=na.ReactCurrentBatchConfig;function Th(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ye(309));var n=r.stateNode}if(!n)throw Error(Ye(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ye(284));if(!r._owner)throw Error(Ye(290,e))}return e}function Sm(e,t){throw e=Object.prototype.toString.call(t),Error(Ye(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function CA(e){var t=e._init;return t(e._payload)}function QF(e){function t(y,g){if(e){var v=y.deletions;v===null?(y.deletions=[g],y.flags|=16):v.push(g)}}function r(y,g){if(!e)return null;for(;g!==null;)t(y,g),g=g.sibling;return null}function n(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function s(y,g){return y=Wa(y,g),y.index=0,y.sibling=null,y}function i(y,g,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<g?(y.flags|=2,g):v):(y.flags|=2,g)):(y.flags|=1048576,g)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function a(y,g,v,b){return g===null||g.tag!==6?(g=w0(v,y.mode,b),g.return=y,g):(g=s(g,v),g.return=y,g)}function l(y,g,v,b){var x=v.type;return x===wu?u(y,g,v.props.children,b,v.key):g!==null&&(g.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ta&&CA(x)===g.type)?(b=s(g,v.props),b.ref=Th(y,g,v),b.return=y,b):(b=Tg(v.type,v.key,v.props,null,y.mode,b),b.ref=Th(y,g,v),b.return=y,b)}function c(y,g,v,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==v.containerInfo||g.stateNode.implementation!==v.implementation?(g=b0(v,y.mode,b),g.return=y,g):(g=s(g,v.children||[]),g.return=y,g)}function u(y,g,v,b,x){return g===null||g.tag!==7?(g=hc(v,y.mode,b,x),g.return=y,g):(g=s(g,v),g.return=y,g)}function d(y,g,v){if(typeof g=="string"&&g!==""||typeof g=="number")return g=w0(""+g,y.mode,v),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case mm:return v=Tg(g.type,g.key,g.props,null,y.mode,v),v.ref=Th(y,null,g),v.return=y,v;case vu:return g=b0(g,y.mode,v),g.return=y,g;case Ta:var b=g._init;return d(y,b(g._payload),v)}if(Wh(g)||vh(g))return g=hc(g,y.mode,v,null),g.return=y,g;Sm(y,g)}return null}function h(y,g,v,b){var x=g!==null?g.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return x!==null?null:a(y,g,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case mm:return v.key===x?l(y,g,v,b):null;case vu:return v.key===x?c(y,g,v,b):null;case Ta:return x=v._init,h(y,g,x(v._payload),b)}if(Wh(v)||vh(v))return x!==null?null:u(y,g,v,b,null);Sm(y,v)}return null}function f(y,g,v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(v)||null,a(g,y,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case mm:return y=y.get(b.key===null?v:b.key)||null,l(g,y,b,x);case vu:return y=y.get(b.key===null?v:b.key)||null,c(g,y,b,x);case Ta:var M=b._init;return f(y,g,v,M(b._payload),x)}if(Wh(b)||vh(b))return y=y.get(v)||null,u(g,y,b,x,null);Sm(g,b)}return null}function p(y,g,v,b){for(var x=null,M=null,E=g,P=g=0,I=null;E!==null&&P<v.length;P++){E.index>P?(I=E,E=null):I=E.sibling;var O=h(y,E,v[P],b);if(O===null){E===null&&(E=I);break}e&&E&&O.alternate===null&&t(y,E),g=i(O,g,P),M===null?x=O:M.sibling=O,M=O,E=I}if(P===v.length)return r(y,E),zr&&Wl(y,P),x;if(E===null){for(;P<v.length;P++)E=d(y,v[P],b),E!==null&&(g=i(E,g,P),M===null?x=E:M.sibling=E,M=E);return zr&&Wl(y,P),x}for(E=n(y,E);P<v.length;P++)I=f(E,y,P,v[P],b),I!==null&&(e&&I.alternate!==null&&E.delete(I.key===null?P:I.key),g=i(I,g,P),M===null?x=I:M.sibling=I,M=I);return e&&E.forEach(function(V){return t(y,V)}),zr&&Wl(y,P),x}function _(y,g,v,b){var x=vh(v);if(typeof x!="function")throw Error(Ye(150));if(v=x.call(v),v==null)throw Error(Ye(151));for(var M=x=null,E=g,P=g=0,I=null,O=v.next();E!==null&&!O.done;P++,O=v.next()){E.index>P?(I=E,E=null):I=E.sibling;var V=h(y,E,O.value,b);if(V===null){E===null&&(E=I);break}e&&E&&V.alternate===null&&t(y,E),g=i(V,g,P),M===null?x=V:M.sibling=V,M=V,E=I}if(O.done)return r(y,E),zr&&Wl(y,P),x;if(E===null){for(;!O.done;P++,O=v.next())O=d(y,O.value,b),O!==null&&(g=i(O,g,P),M===null?x=O:M.sibling=O,M=O);return zr&&Wl(y,P),x}for(E=n(y,E);!O.done;P++,O=v.next())O=f(E,y,P,O.value,b),O!==null&&(e&&O.alternate!==null&&E.delete(O.key===null?P:O.key),g=i(O,g,P),M===null?x=O:M.sibling=O,M=O);return e&&E.forEach(function(U){return t(y,U)}),zr&&Wl(y,P),x}function w(y,g,v,b){if(typeof v=="object"&&v!==null&&v.type===wu&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case mm:e:{for(var x=v.key,M=g;M!==null;){if(M.key===x){if(x=v.type,x===wu){if(M.tag===7){r(y,M.sibling),g=s(M,v.props.children),g.return=y,y=g;break e}}else if(M.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ta&&CA(x)===M.type){r(y,M.sibling),g=s(M,v.props),g.ref=Th(y,M,v),g.return=y,y=g;break e}r(y,M);break}else t(y,M);M=M.sibling}v.type===wu?(g=hc(v.props.children,y.mode,b,v.key),g.return=y,y=g):(b=Tg(v.type,v.key,v.props,null,y.mode,b),b.ref=Th(y,g,v),b.return=y,y=b)}return o(y);case vu:e:{for(M=v.key;g!==null;){if(g.key===M)if(g.tag===4&&g.stateNode.containerInfo===v.containerInfo&&g.stateNode.implementation===v.implementation){r(y,g.sibling),g=s(g,v.children||[]),g.return=y,y=g;break e}else{r(y,g);break}else t(y,g);g=g.sibling}g=b0(v,y.mode,b),g.return=y,y=g}return o(y);case Ta:return M=v._init,w(y,g,M(v._payload),b)}if(Wh(v))return p(y,g,v,b);if(vh(v))return _(y,g,v,b);Sm(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,g!==null&&g.tag===6?(r(y,g.sibling),g=s(g,v),g.return=y,y=g):(r(y,g),g=w0(v,y.mode,b),g.return=y,y=g),o(y)):r(y,g)}return w}var ld=QF(!0),YF=QF(!1),t_=il(null),r_=null,Cu=null,iM=null;function oM(){iM=Cu=r_=null}function aM(e){var t=t_.current;Lr(t_),e._currentValue=t}function Wb(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Uu(e,t){r_=e,iM=Cu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xs=!0),e.firstContext=null)}function _i(e){var t=e._currentValue;if(iM!==e)if(e={context:e,memoizedValue:t,next:null},Cu===null){if(r_===null)throw Error(Ye(308));Cu=e,r_.dependencies={lanes:0,firstContext:e}}else Cu=Cu.next=e;return t}var tc=null;function lM(e){tc===null?tc=[e]:tc.push(e)}function XF(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,lM(t)):(r.next=s.next,s.next=r),t.interleaved=r,Xo(e,n)}function Xo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ea=!1;function cM(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JF(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function za(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ar&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Xo(e,r)}return s=n.interleaved,s===null?(t.next=t,lM(n)):(t.next=s.next,s.next=t),n.interleaved=t,Xo(e,r)}function yg(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,q1(e,r)}}function kA(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function n_(e,t,r,n){var s=e.updateQueue;Ea=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,_=a;switch(h=t,f=r,_.tag){case 1:if(p=_.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=_.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Xr({},d,h);break e;case 2:Ea=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);bc|=o,e.lanes=o,e.memoizedState=d}}function AA(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ye(191,s));s.call(n)}}}var lp={},Eo=il(lp),$f=il(lp),If=il(lp);function rc(e){if(e===lp)throw Error(Ye(174));return e}function uM(e,t){switch(Dr(If,t),Dr($f,e),Dr(Eo,lp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Tb(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Tb(t,e)}Lr(Eo),Dr(Eo,t)}function cd(){Lr(Eo),Lr($f),Lr(If)}function ZF(e){rc(If.current);var t=rc(Eo.current),r=Tb(t,e.type);t!==r&&(Dr($f,e),Dr(Eo,r))}function dM(e){$f.current===e&&(Lr(Eo),Lr($f))}var Kr=il(0);function s_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var p0=[];function hM(){for(var e=0;e<p0.length;e++)p0[e]._workInProgressVersionPrimary=null;p0.length=0}var vg=na.ReactCurrentDispatcher,m0=na.ReactCurrentBatchConfig,wc=0,Qr=null,kn=null,Nn=null,i_=!1,of=!1,Of=0,YK=0;function Xn(){throw Error(Ye(321))}function fM(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xi(e[r],t[r]))return!1;return!0}function pM(e,t,r,n,s,i){if(wc=i,Qr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,vg.current=e===null||e.memoizedState===null?e9:t9,e=r(n,s),of){i=0;do{if(of=!1,Of=0,25<=i)throw Error(Ye(301));i+=1,Nn=kn=null,t.updateQueue=null,vg.current=r9,e=r(n,s)}while(of)}if(vg.current=o_,t=kn!==null&&kn.next!==null,wc=0,Nn=kn=Qr=null,i_=!1,t)throw Error(Ye(300));return e}function mM(){var e=Of!==0;return Of=0,e}function go(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?Qr.memoizedState=Nn=e:Nn=Nn.next=e,Nn}function yi(){if(kn===null){var e=Qr.alternate;e=e!==null?e.memoizedState:null}else e=kn.next;var t=Nn===null?Qr.memoizedState:Nn.next;if(t!==null)Nn=t,kn=e;else{if(e===null)throw Error(Ye(310));kn=e,e={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Nn===null?Qr.memoizedState=Nn=e:Nn=Nn.next=e}return Nn}function jf(e,t){return typeof t=="function"?t(e):t}function g0(e){var t=yi(),r=t.queue;if(r===null)throw Error(Ye(311));r.lastRenderedReducer=e;var n=kn,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((wc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=n):l=l.next=d,Qr.lanes|=u,bc|=u}c=c.next}while(c!==null&&c!==i);l===null?o=n:l.next=a,Xi(n,t.memoizedState)||(xs=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Qr.lanes|=i,bc|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function _0(e){var t=yi(),r=t.queue;if(r===null)throw Error(Ye(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Xi(i,t.memoizedState)||(xs=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function eL(){}function tL(e,t){var r=Qr,n=yi(),s=t(),i=!Xi(n.memoizedState,s);if(i&&(n.memoizedState=s,xs=!0),n=n.queue,gM(sL.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Nn!==null&&Nn.memoizedState.tag&1){if(r.flags|=2048,Df(9,nL.bind(null,r,n,s,t),void 0,null),Rn===null)throw Error(Ye(349));wc&30||rL(r,t,s)}return s}function rL(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Qr.updateQueue,t===null?(t={lastEffect:null,stores:null},Qr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function nL(e,t,r,n){t.value=r,t.getSnapshot=n,iL(t)&&oL(e)}function sL(e,t,r){return r(function(){iL(t)&&oL(e)})}function iL(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xi(e,r)}catch{return!0}}function oL(e){var t=Xo(e,1);t!==null&&Qi(t,e,1,-1)}function $A(e){var t=go();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jf,lastRenderedState:e},t.queue=e,e=e.dispatch=ZK.bind(null,Qr,e),[t.memoizedState,e]}function Df(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Qr.updateQueue,t===null?(t={lastEffect:null,stores:null},Qr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function aL(){return yi().memoizedState}function wg(e,t,r,n){var s=go();Qr.flags|=e,s.memoizedState=Df(1|t,r,void 0,n===void 0?null:n)}function Y_(e,t,r,n){var s=yi();n=n===void 0?null:n;var i=void 0;if(kn!==null){var o=kn.memoizedState;if(i=o.destroy,n!==null&&fM(n,o.deps)){s.memoizedState=Df(t,r,i,n);return}}Qr.flags|=e,s.memoizedState=Df(1|t,r,i,n)}function IA(e,t){return wg(8390656,8,e,t)}function gM(e,t){return Y_(2048,8,e,t)}function lL(e,t){return Y_(4,2,e,t)}function cL(e,t){return Y_(4,4,e,t)}function uL(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dL(e,t,r){return r=r!=null?r.concat([e]):null,Y_(4,4,uL.bind(null,t,e),r)}function _M(){}function hL(e,t){var r=yi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&fM(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function fL(e,t){var r=yi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&fM(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function pL(e,t,r){return wc&21?(Xi(r,t)||(r=vF(),Qr.lanes|=r,bc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=r)}function XK(e,t){var r=Mr;Mr=r!==0&&4>r?r:4,e(!0);var n=m0.transition;m0.transition={};try{e(!1),t()}finally{Mr=r,m0.transition=n}}function mL(){return yi().memoizedState}function JK(e,t,r){var n=Ua(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},gL(e))_L(t,r);else if(r=XF(e,t,r,n),r!==null){var s=ps();Qi(r,e,n,s),yL(r,t,n)}}function ZK(e,t,r){var n=Ua(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(gL(e))_L(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,a=i(o,r);if(s.hasEagerState=!0,s.eagerState=a,Xi(a,o)){var l=t.interleaved;l===null?(s.next=s,lM(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=XF(e,t,s,n),r!==null&&(s=ps(),Qi(r,e,n,s),yL(r,t,n))}}function gL(e){var t=e.alternate;return e===Qr||t!==null&&t===Qr}function _L(e,t){of=i_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function yL(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,q1(e,r)}}var o_={readContext:_i,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},e9={readContext:_i,useCallback:function(e,t){return go().memoizedState=[e,t===void 0?null:t],e},useContext:_i,useEffect:IA,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,wg(4194308,4,uL.bind(null,t,e),r)},useLayoutEffect:function(e,t){return wg(4194308,4,e,t)},useInsertionEffect:function(e,t){return wg(4,2,e,t)},useMemo:function(e,t){var r=go();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=go();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=JK.bind(null,Qr,e),[n.memoizedState,e]},useRef:function(e){var t=go();return e={current:e},t.memoizedState=e},useState:$A,useDebugValue:_M,useDeferredValue:function(e){return go().memoizedState=e},useTransition:function(){var e=$A(!1),t=e[0];return e=XK.bind(null,e[1]),go().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Qr,s=go();if(zr){if(r===void 0)throw Error(Ye(407));r=r()}else{if(r=t(),Rn===null)throw Error(Ye(349));wc&30||rL(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,IA(sL.bind(null,n,i,e),[e]),n.flags|=2048,Df(9,nL.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=go(),t=Rn.identifierPrefix;if(zr){var r=Ko,n=Ho;r=(n&~(1<<32-qi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Of++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=YK++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},t9={readContext:_i,useCallback:hL,useContext:_i,useEffect:gM,useImperativeHandle:dL,useInsertionEffect:lL,useLayoutEffect:cL,useMemo:fL,useReducer:g0,useRef:aL,useState:function(){return g0(jf)},useDebugValue:_M,useDeferredValue:function(e){var t=yi();return pL(t,kn.memoizedState,e)},useTransition:function(){var e=g0(jf)[0],t=yi().memoizedState;return[e,t]},useMutableSource:eL,useSyncExternalStore:tL,useId:mL,unstable_isNewReconciler:!1},r9={readContext:_i,useCallback:hL,useContext:_i,useEffect:gM,useImperativeHandle:dL,useInsertionEffect:lL,useLayoutEffect:cL,useMemo:fL,useReducer:_0,useRef:aL,useState:function(){return _0(jf)},useDebugValue:_M,useDeferredValue:function(e){var t=yi();return kn===null?t.memoizedState=e:pL(t,kn.memoizedState,e)},useTransition:function(){var e=_0(jf)[0],t=yi().memoizedState;return[e,t]},useMutableSource:eL,useSyncExternalStore:tL,useId:mL,unstable_isNewReconciler:!1};function Di(e,t){if(e&&e.defaultProps){t=Xr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Gb(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Xr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var X_={isMounted:function(e){return(e=e._reactInternals)?Oc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ps(),s=Ua(e),i=qo(n,s);i.payload=t,r!=null&&(i.callback=r),t=za(e,i,s),t!==null&&(Qi(t,e,s,n),yg(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ps(),s=Ua(e),i=qo(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=za(e,i,s),t!==null&&(Qi(t,e,s,n),yg(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ps(),n=Ua(e),s=qo(r,n);s.tag=2,t!=null&&(s.callback=t),t=za(e,s,n),t!==null&&(Qi(t,e,n,r),yg(t,e,n))}};function OA(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Pf(r,n)||!Pf(s,i):!0}function vL(e,t,r){var n=!1,s=Qa,i=t.contextType;return typeof i=="object"&&i!==null?i=_i(i):(s=Ss(t)?yc:ns.current,n=t.contextTypes,i=(n=n!=null)?od(e,s):Qa),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=X_,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function jA(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&X_.enqueueReplaceState(t,t.state,null)}function Hb(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},cM(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=_i(i):(i=Ss(t)?yc:ns.current,s.context=od(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Gb(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&X_.enqueueReplaceState(s,s.state,null),n_(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ud(e,t){try{var r="",n=t;do r+=AH(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function y0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Kb(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var n9=typeof WeakMap=="function"?WeakMap:Map;function wL(e,t,r){r=qo(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){l_||(l_=!0,nx=n),Kb(e,t)},r}function bL(e,t,r){r=qo(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Kb(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Kb(e,t),typeof n!="function"&&(Va===null?Va=new Set([this]):Va.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function DA(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new n9;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=_9.bind(null,e,t,r),t.then(e,e))}function NA(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function RA(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qo(-1,1),t.tag=2,za(r,t,1))),r.lanes|=1),e)}var s9=na.ReactCurrentOwner,xs=!1;function cs(e,t,r,n){t.child=e===null?YF(t,null,r,n):ld(t,e.child,r,n)}function FA(e,t,r,n,s){r=r.render;var i=t.ref;return Uu(t,s),n=pM(e,t,r,n,i,s),r=mM(),e!==null&&!xs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Jo(e,t,s)):(zr&&r&&rM(t),t.flags|=1,cs(e,t,n,s),t.child)}function LA(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!EM(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,xL(e,t,i,n,s)):(e=Tg(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Pf,r(o,n)&&e.ref===t.ref)return Jo(e,t,s)}return t.flags|=1,e=Wa(i,n),e.ref=t.ref,e.return=t,t.child=e}function xL(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Pf(i,n)&&e.ref===t.ref)if(xs=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(xs=!0);else return t.lanes=e.lanes,Jo(e,t,s)}return qb(e,t,r,n,s)}function ML(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(Au,Rs),Rs|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dr(Au,Rs),Rs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Dr(Au,Rs),Rs|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Dr(Au,Rs),Rs|=n;return cs(e,t,s,r),t.child}function TL(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function qb(e,t,r,n,s){var i=Ss(r)?yc:ns.current;return i=od(t,i),Uu(t,s),r=pM(e,t,r,n,i,s),n=mM(),e!==null&&!xs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Jo(e,t,s)):(zr&&n&&rM(t),t.flags|=1,cs(e,t,r,s),t.child)}function BA(e,t,r,n,s){if(Ss(r)){var i=!0;Jg(t)}else i=!1;if(Uu(t,s),t.stateNode===null)bg(e,t),vL(t,r,n),Hb(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=_i(c):(c=Ss(r)?yc:ns.current,c=od(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&jA(t,o,n,c),Ea=!1;var h=t.memoizedState;o.state=h,n_(t,n,o,s),l=t.memoizedState,a!==n||h!==l||Es.current||Ea?(typeof u=="function"&&(Gb(t,r,u,n),l=t.memoizedState),(a=Ea||OA(t,r,a,n,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,JF(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Di(t.type,a),o.props=c,d=t.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=_i(l):(l=Ss(r)?yc:ns.current,l=od(t,l));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&jA(t,o,n,l),Ea=!1,h=t.memoizedState,o.state=h,n_(t,n,o,s);var p=t.memoizedState;a!==d||h!==p||Es.current||Ea?(typeof f=="function"&&(Gb(t,r,f,n),p=t.memoizedState),(c=Ea||OA(t,r,c,n,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Qb(e,t,r,n,i,s)}function Qb(e,t,r,n,s,i){TL(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&EA(t,r,!1),Jo(e,t,i);n=t.stateNode,s9.current=t;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=ld(t,e.child,null,i),t.child=ld(t,null,a,i)):cs(e,t,a,i),t.memoizedState=n.state,s&&EA(t,r,!0),t.child}function EL(e){var t=e.stateNode;t.pendingContext?TA(e,t.pendingContext,t.pendingContext!==t.context):t.context&&TA(e,t.context,!1),uM(e,t.containerInfo)}function zA(e,t,r,n,s){return ad(),sM(s),t.flags|=256,cs(e,t,r,n),t.child}var Yb={dehydrated:null,treeContext:null,retryLane:0};function Xb(e){return{baseLanes:e,cachePool:null,transitions:null}}function SL(e,t,r){var n=t.pendingProps,s=Kr.current,i=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Dr(Kr,s&1),e===null)return Ub(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ey(o,n,0,null),e=hc(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Xb(r),t.memoizedState=Yb,e):yM(t,o));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return i9(e,t,o,n,a,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,a=s.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Wa(s,l),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Wa(a,i):(i=hc(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Xb(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Yb,n}return i=e.child,e=i.sibling,n=Wa(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function yM(e,t){return t=ey({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pm(e,t,r,n){return n!==null&&sM(n),ld(t,e.child,null,r),e=yM(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function i9(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=y0(Error(Ye(422))),Pm(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=ey({mode:"visible",children:n.children},s,0,null),i=hc(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ld(t,e.child,null,o),t.child.memoizedState=Xb(o),t.memoizedState=Yb,i);if(!(t.mode&1))return Pm(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,i=Error(Ye(419)),n=y0(i,n,void 0),Pm(e,t,o,n)}if(a=(o&e.childLanes)!==0,xs||a){if(n=Rn,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Xo(e,s),Qi(n,e,s,-1))}return TM(),n=y0(Error(Ye(421))),Pm(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=y9.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Vs=Ba(s.nextSibling),Us=t,zr=!0,zi=null,e!==null&&(ci[ui++]=Ho,ci[ui++]=Ko,ci[ui++]=vc,Ho=e.id,Ko=e.overflow,vc=t),t=yM(t,n.children),t.flags|=4096,t)}function VA(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Wb(e.return,t,r)}function v0(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function PL(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(cs(e,t,n.children,r),n=Kr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&VA(e,r,t);else if(e.tag===19)VA(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Dr(Kr,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&s_(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),v0(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&s_(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}v0(t,!0,r,null,i);break;case"together":v0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Jo(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),bc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ye(153));if(t.child!==null){for(e=t.child,r=Wa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Wa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function o9(e,t,r){switch(t.tag){case 3:EL(t),ad();break;case 5:ZF(t);break;case 1:Ss(t.type)&&Jg(t);break;case 4:uM(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Dr(t_,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Dr(Kr,Kr.current&1),t.flags|=128,null):r&t.child.childLanes?SL(e,t,r):(Dr(Kr,Kr.current&1),e=Jo(e,t,r),e!==null?e.sibling:null);Dr(Kr,Kr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return PL(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Dr(Kr,Kr.current),n)break;return null;case 22:case 23:return t.lanes=0,ML(e,t,r)}return Jo(e,t,r)}var CL,Jb,kL,AL;CL=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Jb=function(){};kL=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,rc(Eo.current);var i=null;switch(r){case"input":s=wb(e,s),n=wb(e,n),i=[];break;case"select":s=Xr({},s,{value:void 0}),n=Xr({},n,{value:void 0}),i=[];break;case"textarea":s=Mb(e,s),n=Mb(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Yg)}Eb(r,n);var o;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(wf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(a=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(wf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Fr("scroll",e),i||a===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};AL=function(e,t,r,n){r!==n&&(t.flags|=4)};function Eh(e,t){if(!zr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Jn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function a9(e,t,r){var n=t.pendingProps;switch(nM(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jn(t),null;case 1:return Ss(t.type)&&Xg(),Jn(t),null;case 3:return n=t.stateNode,cd(),Lr(Es),Lr(ns),hM(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Em(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zi!==null&&(ox(zi),zi=null))),Jb(e,t),Jn(t),null;case 5:dM(t);var s=rc(If.current);if(r=t.type,e!==null&&t.stateNode!=null)kL(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ye(166));return Jn(t),null}if(e=rc(Eo.current),Em(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[wo]=t,n[Af]=i,e=(t.mode&1)!==0,r){case"dialog":Fr("cancel",n),Fr("close",n);break;case"iframe":case"object":case"embed":Fr("load",n);break;case"video":case"audio":for(s=0;s<Hh.length;s++)Fr(Hh[s],n);break;case"source":Fr("error",n);break;case"img":case"image":case"link":Fr("error",n),Fr("load",n);break;case"details":Fr("toggle",n);break;case"input":X2(n,i),Fr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Fr("invalid",n);break;case"textarea":Z2(n,i),Fr("invalid",n)}Eb(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?n.textContent!==a&&(i.suppressHydrationWarning!==!0&&Tm(n.textContent,a,e),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Tm(n.textContent,a,e),s=["children",""+a]):wf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Fr("scroll",n)}switch(r){case"input":gm(n),J2(n,i,!0);break;case"textarea":gm(n),eA(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Yg)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sF(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[wo]=t,e[Af]=n,CL(e,t,!1,!1),t.stateNode=e;e:{switch(o=Sb(r,n),r){case"dialog":Fr("cancel",e),Fr("close",e),s=n;break;case"iframe":case"object":case"embed":Fr("load",e),s=n;break;case"video":case"audio":for(s=0;s<Hh.length;s++)Fr(Hh[s],e);s=n;break;case"source":Fr("error",e),s=n;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),s=n;break;case"details":Fr("toggle",e),s=n;break;case"input":X2(e,n),s=wb(e,n),Fr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Xr({},n,{value:void 0}),Fr("invalid",e);break;case"textarea":Z2(e,n),s=Mb(e,n),Fr("invalid",e);break;default:s=n}Eb(r,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?aF(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&iF(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&bf(e,l):typeof l=="number"&&bf(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(wf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Fr("scroll",e):l!=null&&V1(e,i,l,o))}switch(r){case"input":gm(e),J2(e,n,!1);break;case"textarea":gm(e),eA(e);break;case"option":n.value!=null&&e.setAttribute("value",""+qa(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Lu(e,!!n.multiple,i,!1):n.defaultValue!=null&&Lu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Yg)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jn(t),null;case 6:if(e&&t.stateNode!=null)AL(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ye(166));if(r=rc(If.current),rc(Eo.current),Em(t)){if(n=t.stateNode,r=t.memoizedProps,n[wo]=t,(i=n.nodeValue!==r)&&(e=Us,e!==null))switch(e.tag){case 3:Tm(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tm(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[wo]=t,t.stateNode=n}return Jn(t),null;case 13:if(Lr(Kr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(zr&&Vs!==null&&t.mode&1&&!(t.flags&128))qF(),ad(),t.flags|=98560,i=!1;else if(i=Em(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ye(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ye(317));i[wo]=t}else ad(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Jn(t),i=!1}else zi!==null&&(ox(zi),zi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Kr.current&1?An===0&&(An=3):TM())),t.updateQueue!==null&&(t.flags|=4),Jn(t),null);case 4:return cd(),Jb(e,t),e===null&&Cf(t.stateNode.containerInfo),Jn(t),null;case 10:return aM(t.type._context),Jn(t),null;case 17:return Ss(t.type)&&Xg(),Jn(t),null;case 19:if(Lr(Kr),i=t.memoizedState,i===null)return Jn(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Eh(i,!1);else{if(An!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=s_(e),o!==null){for(t.flags|=128,Eh(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Dr(Kr,Kr.current&1|2),t.child}e=e.sibling}i.tail!==null&&hn()>dd&&(t.flags|=128,n=!0,Eh(i,!1),t.lanes=4194304)}else{if(!n)if(e=s_(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Eh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!zr)return Jn(t),null}else 2*hn()-i.renderingStartTime>dd&&r!==1073741824&&(t.flags|=128,n=!0,Eh(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=hn(),t.sibling=null,r=Kr.current,Dr(Kr,n?r&1|2:r&1),t):(Jn(t),null);case 22:case 23:return MM(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Rs&1073741824&&(Jn(t),t.subtreeFlags&6&&(t.flags|=8192)):Jn(t),null;case 24:return null;case 25:return null}throw Error(Ye(156,t.tag))}function l9(e,t){switch(nM(t),t.tag){case 1:return Ss(t.type)&&Xg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cd(),Lr(Es),Lr(ns),hM(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return dM(t),null;case 13:if(Lr(Kr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ye(340));ad()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Lr(Kr),null;case 4:return cd(),null;case 10:return aM(t.type._context),null;case 22:case 23:return MM(),null;case 24:return null;default:return null}}var Cm=!1,ts=!1,c9=typeof WeakSet=="function"?WeakSet:Set,dt=null;function ku(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){on(e,t,n)}else r.current=null}function Zb(e,t,r){try{r()}catch(n){on(e,t,n)}}var UA=!1;function u9(e,t){if(Nb=Kg,e=DF(),tM(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var f;d!==r||s!==0&&d.nodeType!==3||(a=o+s),d!==i||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===e)break t;if(h===r&&++c===s&&(a=o),h===i&&++u===n&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Rb={focusedElem:e,selectionRange:r},Kg=!1,dt=t;dt!==null;)if(t=dt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,dt=e;else for(;dt!==null;){t=dt;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var _=p.memoizedProps,w=p.memoizedState,y=t.stateNode,g=y.getSnapshotBeforeUpdate(t.elementType===t.type?_:Di(t.type,_),w);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ye(163))}}catch(b){on(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,dt=e;break}dt=t.return}return p=UA,UA=!1,p}function af(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Zb(t,r,i)}s=s.next}while(s!==n)}}function J_(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ex(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function $L(e){var t=e.alternate;t!==null&&(e.alternate=null,$L(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[wo],delete t[Af],delete t[Bb],delete t[HK],delete t[KK])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function IL(e){return e.tag===5||e.tag===3||e.tag===4}function WA(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||IL(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function tx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Yg));else if(n!==4&&(e=e.child,e!==null))for(tx(e,t,r),e=e.sibling;e!==null;)tx(e,t,r),e=e.sibling}function rx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(rx(e,t,r),e=e.sibling;e!==null;)rx(e,t,r),e=e.sibling}var Vn=null,Li=!1;function ha(e,t,r){for(r=r.child;r!==null;)OL(e,t,r),r=r.sibling}function OL(e,t,r){if(To&&typeof To.onCommitFiberUnmount=="function")try{To.onCommitFiberUnmount(W_,r)}catch{}switch(r.tag){case 5:ts||ku(r,t);case 6:var n=Vn,s=Li;Vn=null,ha(e,t,r),Vn=n,Li=s,Vn!==null&&(Li?(e=Vn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Vn.removeChild(r.stateNode));break;case 18:Vn!==null&&(Li?(e=Vn,r=r.stateNode,e.nodeType===8?h0(e.parentNode,r):e.nodeType===1&&h0(e,r),Ef(e)):h0(Vn,r.stateNode));break;case 4:n=Vn,s=Li,Vn=r.stateNode.containerInfo,Li=!0,ha(e,t,r),Vn=n,Li=s;break;case 0:case 11:case 14:case 15:if(!ts&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Zb(r,t,o),s=s.next}while(s!==n)}ha(e,t,r);break;case 1:if(!ts&&(ku(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){on(r,t,a)}ha(e,t,r);break;case 21:ha(e,t,r);break;case 22:r.mode&1?(ts=(n=ts)||r.memoizedState!==null,ha(e,t,r),ts=n):ha(e,t,r);break;default:ha(e,t,r)}}function GA(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new c9),t.forEach(function(n){var s=v9.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Si(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Vn=a.stateNode,Li=!1;break e;case 3:Vn=a.stateNode.containerInfo,Li=!0;break e;case 4:Vn=a.stateNode.containerInfo,Li=!0;break e}a=a.return}if(Vn===null)throw Error(Ye(160));OL(i,o,s),Vn=null,Li=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){on(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)jL(t,e),t=t.sibling}function jL(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Si(t,e),po(e),n&4){try{af(3,e,e.return),J_(3,e)}catch(_){on(e,e.return,_)}try{af(5,e,e.return)}catch(_){on(e,e.return,_)}}break;case 1:Si(t,e),po(e),n&512&&r!==null&&ku(r,r.return);break;case 5:if(Si(t,e),po(e),n&512&&r!==null&&ku(r,r.return),e.flags&32){var s=e.stateNode;try{bf(s,"")}catch(_){on(e,e.return,_)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&rF(s,i),Sb(a,o);var c=Sb(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?aF(s,d):u==="dangerouslySetInnerHTML"?iF(s,d):u==="children"?bf(s,d):V1(s,u,d,c)}switch(a){case"input":bb(s,i);break;case"textarea":nF(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Lu(s,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Lu(s,!!i.multiple,i.defaultValue,!0):Lu(s,!!i.multiple,i.multiple?[]:"",!1))}s[Af]=i}catch(_){on(e,e.return,_)}}break;case 6:if(Si(t,e),po(e),n&4){if(e.stateNode===null)throw Error(Ye(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(_){on(e,e.return,_)}}break;case 3:if(Si(t,e),po(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ef(t.containerInfo)}catch(_){on(e,e.return,_)}break;case 4:Si(t,e),po(e);break;case 13:Si(t,e),po(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(bM=hn())),n&4&&GA(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(ts=(c=ts)||u,Si(t,e),ts=c):Si(t,e),po(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(dt=e,u=e.child;u!==null;){for(d=dt=u;dt!==null;){switch(h=dt,f=h.child,h.tag){case 0:case 11:case 14:case 15:af(4,h,h.return);break;case 1:ku(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(_){on(n,r,_)}}break;case 5:ku(h,h.return);break;case 22:if(h.memoizedState!==null){KA(d);continue}}f!==null?(f.return=h,dt=f):KA(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=oF("display",o))}catch(_){on(e,e.return,_)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(_){on(e,e.return,_)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Si(t,e),po(e),n&4&&GA(e);break;case 21:break;default:Si(t,e),po(e)}}function po(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(IL(r)){var n=r;break e}r=r.return}throw Error(Ye(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(bf(s,""),n.flags&=-33);var i=WA(e);rx(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,a=WA(e);tx(e,a,o);break;default:throw Error(Ye(161))}}catch(l){on(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function d9(e,t,r){dt=e,DL(e)}function DL(e,t,r){for(var n=(e.mode&1)!==0;dt!==null;){var s=dt,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Cm;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||ts;a=Cm;var c=ts;if(Cm=o,(ts=l)&&!c)for(dt=s;dt!==null;)o=dt,l=o.child,o.tag===22&&o.memoizedState!==null?qA(s):l!==null?(l.return=o,dt=l):qA(s);for(;i!==null;)dt=i,DL(i),i=i.sibling;dt=s,Cm=a,ts=c}HA(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,dt=i):HA(e)}}function HA(e){for(;dt!==null;){var t=dt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ts||J_(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ts)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Di(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&AA(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}AA(t,o,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ef(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ye(163))}ts||t.flags&512&&ex(t)}catch(h){on(t,t.return,h)}}if(t===e){dt=null;break}if(r=t.sibling,r!==null){r.return=t.return,dt=r;break}dt=t.return}}function KA(e){for(;dt!==null;){var t=dt;if(t===e){dt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,dt=r;break}dt=t.return}}function qA(e){for(;dt!==null;){var t=dt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{J_(4,t)}catch(l){on(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){on(t,s,l)}}var i=t.return;try{ex(t)}catch(l){on(t,i,l)}break;case 5:var o=t.return;try{ex(t)}catch(l){on(t,o,l)}}}catch(l){on(t,t.return,l)}if(t===e){dt=null;break}var a=t.sibling;if(a!==null){a.return=t.return,dt=a;break}dt=t.return}}var h9=Math.ceil,a_=na.ReactCurrentDispatcher,vM=na.ReactCurrentOwner,pi=na.ReactCurrentBatchConfig,ar=0,Rn=null,bn=null,Gn=0,Rs=0,Au=il(0),An=0,Nf=null,bc=0,Z_=0,wM=0,lf=null,ws=null,bM=0,dd=1/0,Vo=null,l_=!1,nx=null,Va=null,km=!1,Da=null,c_=0,cf=0,sx=null,xg=-1,Mg=0;function ps(){return ar&6?hn():xg!==-1?xg:xg=hn()}function Ua(e){return e.mode&1?ar&2&&Gn!==0?Gn&-Gn:QK.transition!==null?(Mg===0&&(Mg=vF()),Mg):(e=Mr,e!==0||(e=window.event,e=e===void 0?16:SF(e.type)),e):1}function Qi(e,t,r,n){if(50<cf)throw cf=0,sx=null,Error(Ye(185));ip(e,r,n),(!(ar&2)||e!==Rn)&&(e===Rn&&(!(ar&2)&&(Z_|=r),An===4&&Pa(e,Gn)),Ps(e,n),r===1&&ar===0&&!(t.mode&1)&&(dd=hn()+500,Q_&&ol()))}function Ps(e,t){var r=e.callbackNode;QH(e,t);var n=Hg(e,e===Rn?Gn:0);if(n===0)r!==null&&nA(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&nA(r),t===1)e.tag===0?qK(QA.bind(null,e)):GF(QA.bind(null,e)),WK(function(){!(ar&6)&&ol()}),r=null;else{switch(wF(n)){case 1:r=K1;break;case 4:r=_F;break;case 16:r=Gg;break;case 536870912:r=yF;break;default:r=Gg}r=UL(r,NL.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function NL(e,t){if(xg=-1,Mg=0,ar&6)throw Error(Ye(327));var r=e.callbackNode;if(Wu()&&e.callbackNode!==r)return null;var n=Hg(e,e===Rn?Gn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=u_(e,n);else{t=n;var s=ar;ar|=2;var i=FL();(Rn!==e||Gn!==t)&&(Vo=null,dd=hn()+500,dc(e,t));do try{m9();break}catch(a){RL(e,a)}while(!0);oM(),a_.current=i,ar=s,bn!==null?t=0:(Rn=null,Gn=0,t=An)}if(t!==0){if(t===2&&(s=$b(e),s!==0&&(n=s,t=ix(e,s))),t===1)throw r=Nf,dc(e,0),Pa(e,n),Ps(e,hn()),r;if(t===6)Pa(e,n);else{if(s=e.current.alternate,!(n&30)&&!f9(s)&&(t=u_(e,n),t===2&&(i=$b(e),i!==0&&(n=i,t=ix(e,i))),t===1))throw r=Nf,dc(e,0),Pa(e,n),Ps(e,hn()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Ye(345));case 2:Gl(e,ws,Vo);break;case 3:if(Pa(e,n),(n&130023424)===n&&(t=bM+500-hn(),10<t)){if(Hg(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){ps(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Lb(Gl.bind(null,e,ws,Vo),t);break}Gl(e,ws,Vo);break;case 4:if(Pa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-qi(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=hn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*h9(n/1960))-n,10<n){e.timeoutHandle=Lb(Gl.bind(null,e,ws,Vo),n);break}Gl(e,ws,Vo);break;case 5:Gl(e,ws,Vo);break;default:throw Error(Ye(329))}}}return Ps(e,hn()),e.callbackNode===r?NL.bind(null,e):null}function ix(e,t){var r=lf;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),e=u_(e,t),e!==2&&(t=ws,ws=r,t!==null&&ox(t)),e}function ox(e){ws===null?ws=e:ws.push.apply(ws,e)}function f9(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Xi(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Pa(e,t){for(t&=~wM,t&=~Z_,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-qi(t),n=1<<r;e[r]=-1,t&=~n}}function QA(e){if(ar&6)throw Error(Ye(327));Wu();var t=Hg(e,0);if(!(t&1))return Ps(e,hn()),null;var r=u_(e,t);if(e.tag!==0&&r===2){var n=$b(e);n!==0&&(t=n,r=ix(e,n))}if(r===1)throw r=Nf,dc(e,0),Pa(e,t),Ps(e,hn()),r;if(r===6)throw Error(Ye(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gl(e,ws,Vo),Ps(e,hn()),null}function xM(e,t){var r=ar;ar|=1;try{return e(t)}finally{ar=r,ar===0&&(dd=hn()+500,Q_&&ol())}}function xc(e){Da!==null&&Da.tag===0&&!(ar&6)&&Wu();var t=ar;ar|=1;var r=pi.transition,n=Mr;try{if(pi.transition=null,Mr=1,e)return e()}finally{Mr=n,pi.transition=r,ar=t,!(ar&6)&&ol()}}function MM(){Rs=Au.current,Lr(Au)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,UK(r)),bn!==null)for(r=bn.return;r!==null;){var n=r;switch(nM(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xg();break;case 3:cd(),Lr(Es),Lr(ns),hM();break;case 5:dM(n);break;case 4:cd();break;case 13:Lr(Kr);break;case 19:Lr(Kr);break;case 10:aM(n.type._context);break;case 22:case 23:MM()}r=r.return}if(Rn=e,bn=e=Wa(e.current,null),Gn=Rs=t,An=0,Nf=null,wM=Z_=bc=0,ws=lf=null,tc!==null){for(t=0;t<tc.length;t++)if(r=tc[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}tc=null}return e}function RL(e,t){do{var r=bn;try{if(oM(),vg.current=o_,i_){for(var n=Qr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}i_=!1}if(wc=0,Nn=kn=Qr=null,of=!1,Of=0,vM.current=null,r===null||r.return===null){An=1,Nf=t,bn=null;break}e:{var i=e,o=r.return,a=r,l=t;if(t=Gn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=NA(o);if(f!==null){f.flags&=-257,RA(f,o,a,i,t),f.mode&1&&DA(i,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var _=new Set;_.add(l),t.updateQueue=_}else p.add(l);break e}else{if(!(t&1)){DA(i,c,t),TM();break e}l=Error(Ye(426))}}else if(zr&&a.mode&1){var w=NA(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),RA(w,o,a,i,t),sM(ud(l,a));break e}}i=l=ud(l,a),An!==4&&(An=2),lf===null?lf=[i]:lf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=wL(i,l,t);kA(i,y);break e;case 1:a=l;var g=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Va===null||!Va.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var b=bL(i,a,t);kA(i,b);break e}}i=i.return}while(i!==null)}BL(r)}catch(x){t=x,bn===r&&r!==null&&(bn=r=r.return);continue}break}while(!0)}function FL(){var e=a_.current;return a_.current=o_,e===null?o_:e}function TM(){(An===0||An===3||An===2)&&(An=4),Rn===null||!(bc&268435455)&&!(Z_&268435455)||Pa(Rn,Gn)}function u_(e,t){var r=ar;ar|=2;var n=FL();(Rn!==e||Gn!==t)&&(Vo=null,dc(e,t));do try{p9();break}catch(s){RL(e,s)}while(!0);if(oM(),ar=r,a_.current=n,bn!==null)throw Error(Ye(261));return Rn=null,Gn=0,An}function p9(){for(;bn!==null;)LL(bn)}function m9(){for(;bn!==null&&!BH();)LL(bn)}function LL(e){var t=VL(e.alternate,e,Rs);e.memoizedProps=e.pendingProps,t===null?BL(e):bn=t,vM.current=null}function BL(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=l9(r,t),r!==null){r.flags&=32767,bn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{An=6,bn=null;return}}else if(r=a9(r,t,Rs),r!==null){bn=r;return}if(t=t.sibling,t!==null){bn=t;return}bn=t=e}while(t!==null);An===0&&(An=5)}function Gl(e,t,r){var n=Mr,s=pi.transition;try{pi.transition=null,Mr=1,g9(e,t,r,n)}finally{pi.transition=s,Mr=n}return null}function g9(e,t,r,n){do Wu();while(Da!==null);if(ar&6)throw Error(Ye(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ye(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(YH(e,i),e===Rn&&(bn=Rn=null,Gn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||km||(km=!0,UL(Gg,function(){return Wu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=pi.transition,pi.transition=null;var o=Mr;Mr=1;var a=ar;ar|=4,vM.current=null,u9(e,r),jL(r,e),NK(Rb),Kg=!!Nb,Rb=Nb=null,e.current=r,d9(r),zH(),ar=a,Mr=o,pi.transition=i}else e.current=r;if(km&&(km=!1,Da=e,c_=s),i=e.pendingLanes,i===0&&(Va=null),WH(r.stateNode),Ps(e,hn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(l_)throw l_=!1,e=nx,nx=null,e;return c_&1&&e.tag!==0&&Wu(),i=e.pendingLanes,i&1?e===sx?cf++:(cf=0,sx=e):cf=0,ol(),null}function Wu(){if(Da!==null){var e=wF(c_),t=pi.transition,r=Mr;try{if(pi.transition=null,Mr=16>e?16:e,Da===null)var n=!1;else{if(e=Da,Da=null,c_=0,ar&6)throw Error(Ye(331));var s=ar;for(ar|=4,dt=e.current;dt!==null;){var i=dt,o=i.child;if(dt.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(dt=c;dt!==null;){var u=dt;switch(u.tag){case 0:case 11:case 15:af(8,u,i)}var d=u.child;if(d!==null)d.return=u,dt=d;else for(;dt!==null;){u=dt;var h=u.sibling,f=u.return;if($L(u),u===c){dt=null;break}if(h!==null){h.return=f,dt=h;break}dt=f}}}var p=i.alternate;if(p!==null){var _=p.child;if(_!==null){p.child=null;do{var w=_.sibling;_.sibling=null,_=w}while(_!==null)}}dt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,dt=o;else e:for(;dt!==null;){if(i=dt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:af(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,dt=y;break e}dt=i.return}}var g=e.current;for(dt=g;dt!==null;){o=dt;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,dt=v;else e:for(o=g;dt!==null;){if(a=dt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:J_(9,a)}}catch(x){on(a,a.return,x)}if(a===o){dt=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,dt=b;break e}dt=a.return}}if(ar=s,ol(),To&&typeof To.onPostCommitFiberRoot=="function")try{To.onPostCommitFiberRoot(W_,e)}catch{}n=!0}return n}finally{Mr=r,pi.transition=t}}return!1}function YA(e,t,r){t=ud(r,t),t=wL(e,t,1),e=za(e,t,1),t=ps(),e!==null&&(ip(e,1,t),Ps(e,t))}function on(e,t,r){if(e.tag===3)YA(e,e,r);else for(;t!==null;){if(t.tag===3){YA(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Va===null||!Va.has(n))){e=ud(r,e),e=bL(t,e,1),t=za(t,e,1),e=ps(),t!==null&&(ip(t,1,e),Ps(t,e));break}}t=t.return}}function _9(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ps(),e.pingedLanes|=e.suspendedLanes&r,Rn===e&&(Gn&r)===r&&(An===4||An===3&&(Gn&130023424)===Gn&&500>hn()-bM?dc(e,0):wM|=r),Ps(e,t)}function zL(e,t){t===0&&(e.mode&1?(t=vm,vm<<=1,!(vm&130023424)&&(vm=4194304)):t=1);var r=ps();e=Xo(e,t),e!==null&&(ip(e,t,r),Ps(e,r))}function y9(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),zL(e,r)}function v9(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ye(314))}n!==null&&n.delete(t),zL(e,r)}var VL;VL=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Es.current)xs=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return xs=!1,o9(e,t,r);xs=!!(e.flags&131072)}else xs=!1,zr&&t.flags&1048576&&HF(t,e_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;bg(e,t),e=t.pendingProps;var s=od(t,ns.current);Uu(t,r),s=pM(null,t,n,e,s,r);var i=mM();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ss(n)?(i=!0,Jg(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,cM(t),s.updater=X_,t.stateNode=s,s._reactInternals=t,Hb(t,n,e,r),t=Qb(null,t,n,!0,i,r)):(t.tag=0,zr&&i&&rM(t),cs(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(bg(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=b9(n),e=Di(n,e),s){case 0:t=qb(null,t,n,e,r);break e;case 1:t=BA(null,t,n,e,r);break e;case 11:t=FA(null,t,n,e,r);break e;case 14:t=LA(null,t,n,Di(n.type,e),r);break e}throw Error(Ye(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Di(n,s),qb(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Di(n,s),BA(e,t,n,s,r);case 3:e:{if(EL(t),e===null)throw Error(Ye(387));n=t.pendingProps,i=t.memoizedState,s=i.element,JF(e,t),n_(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ud(Error(Ye(423)),t),t=zA(e,t,n,r,s);break e}else if(n!==s){s=ud(Error(Ye(424)),t),t=zA(e,t,n,r,s);break e}else for(Vs=Ba(t.stateNode.containerInfo.firstChild),Us=t,zr=!0,zi=null,r=YF(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ad(),n===s){t=Jo(e,t,r);break e}cs(e,t,n,r)}t=t.child}return t;case 5:return ZF(t),e===null&&Ub(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Fb(n,s)?o=null:i!==null&&Fb(n,i)&&(t.flags|=32),TL(e,t),cs(e,t,o,r),t.child;case 6:return e===null&&Ub(t),null;case 13:return SL(e,t,r);case 4:return uM(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ld(t,null,n,r):cs(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Di(n,s),FA(e,t,n,s,r);case 7:return cs(e,t,t.pendingProps,r),t.child;case 8:return cs(e,t,t.pendingProps.children,r),t.child;case 12:return cs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Dr(t_,n._currentValue),n._currentValue=o,i!==null)if(Xi(i.value,o)){if(i.children===s.children&&!Es.current){t=Jo(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=qo(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Wb(i.return,r,t),a.lanes|=r;break}l=l.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ye(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Wb(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}cs(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Uu(t,r),s=_i(s),n=n(s),t.flags|=1,cs(e,t,n,r),t.child;case 14:return n=t.type,s=Di(n,t.pendingProps),s=Di(n.type,s),LA(e,t,n,s,r);case 15:return xL(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Di(n,s),bg(e,t),t.tag=1,Ss(n)?(e=!0,Jg(t)):e=!1,Uu(t,r),vL(t,n,s),Hb(t,n,s,r),Qb(null,t,n,!0,e,r);case 19:return PL(e,t,r);case 22:return ML(e,t,r)}throw Error(Ye(156,t.tag))};function UL(e,t){return gF(e,t)}function w9(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(e,t,r,n){return new w9(e,t,r,n)}function EM(e){return e=e.prototype,!(!e||!e.isReactComponent)}function b9(e){if(typeof e=="function")return EM(e)?1:0;if(e!=null){if(e=e.$$typeof,e===W1)return 11;if(e===G1)return 14}return 2}function Wa(e,t){var r=e.alternate;return r===null?(r=fi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Tg(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")EM(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case wu:return hc(r.children,s,i,t);case U1:o=8,s|=8;break;case gb:return e=fi(12,r,t,s|2),e.elementType=gb,e.lanes=i,e;case _b:return e=fi(13,r,t,s),e.elementType=_b,e.lanes=i,e;case yb:return e=fi(19,r,t,s),e.elementType=yb,e.lanes=i,e;case ZR:return ey(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XR:o=10;break e;case JR:o=9;break e;case W1:o=11;break e;case G1:o=14;break e;case Ta:o=16,n=null;break e}throw Error(Ye(130,e==null?e:typeof e,""))}return t=fi(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function hc(e,t,r,n){return e=fi(7,e,n,t),e.lanes=r,e}function ey(e,t,r,n){return e=fi(22,e,n,t),e.elementType=ZR,e.lanes=r,e.stateNode={isHidden:!1},e}function w0(e,t,r){return e=fi(6,e,null,t),e.lanes=r,e}function b0(e,t,r){return t=fi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function x9(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=t0(0),this.expirationTimes=t0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=t0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function SM(e,t,r,n,s,i,o,a,l){return e=new x9(e,t,r,a,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},cM(i),e}function M9(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function WL(e){if(!e)return Qa;e=e._reactInternals;e:{if(Oc(e)!==e||e.tag!==1)throw Error(Ye(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ss(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ye(171))}if(e.tag===1){var r=e.type;if(Ss(r))return WF(e,r,t)}return t}function GL(e,t,r,n,s,i,o,a,l){return e=SM(r,n,!0,e,s,i,o,a,l),e.context=WL(null),r=e.current,n=ps(),s=Ua(r),i=qo(n,s),i.callback=t??null,za(r,i,s),e.current.lanes=s,ip(e,s,n),Ps(e,n),e}function ty(e,t,r,n){var s=t.current,i=ps(),o=Ua(s);return r=WL(r),t.context===null?t.context=r:t.pendingContext=r,t=qo(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=za(s,t,o),e!==null&&(Qi(e,s,o,i),yg(e,s,o)),o}function d_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function XA(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function PM(e,t){XA(e,t),(e=e.alternate)&&XA(e,t)}function T9(){return null}var HL=typeof reportError=="function"?reportError:function(e){console.error(e)};function CM(e){this._internalRoot=e}ry.prototype.render=CM.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ye(409));ty(e,t,null,null)};ry.prototype.unmount=CM.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;xc(function(){ty(null,e,null,null)}),t[Yo]=null}};function ry(e){this._internalRoot=e}ry.prototype.unstable_scheduleHydration=function(e){if(e){var t=MF();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Sa.length&&t!==0&&t<Sa[r].priority;r++);Sa.splice(r,0,e),r===0&&EF(e)}};function kM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ny(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function JA(){}function E9(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=d_(o);i.call(c)}}var o=GL(t,n,e,0,null,!1,!1,"",JA);return e._reactRootContainer=o,e[Yo]=o.current,Cf(e.nodeType===8?e.parentNode:e),xc(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var c=d_(l);a.call(c)}}var l=SM(e,0,!1,null,null,!1,!1,"",JA);return e._reactRootContainer=l,e[Yo]=l.current,Cf(e.nodeType===8?e.parentNode:e),xc(function(){ty(t,l,r,n)}),l}function sy(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=d_(o);a.call(l)}}ty(t,o,e,s)}else o=E9(r,t,e,s,n);return d_(o)}bF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Gh(t.pendingLanes);r!==0&&(q1(t,r|1),Ps(t,hn()),!(ar&6)&&(dd=hn()+500,ol()))}break;case 13:xc(function(){var n=Xo(e,1);if(n!==null){var s=ps();Qi(n,e,1,s)}}),PM(e,1)}};Q1=function(e){if(e.tag===13){var t=Xo(e,134217728);if(t!==null){var r=ps();Qi(t,e,134217728,r)}PM(e,134217728)}};xF=function(e){if(e.tag===13){var t=Ua(e),r=Xo(e,t);if(r!==null){var n=ps();Qi(r,e,t,n)}PM(e,t)}};MF=function(){return Mr};TF=function(e,t){var r=Mr;try{return Mr=e,t()}finally{Mr=r}};Cb=function(e,t,r){switch(t){case"input":if(bb(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=q_(n);if(!s)throw Error(Ye(90));tF(n),bb(n,s)}}}break;case"textarea":nF(e,r);break;case"select":t=r.value,t!=null&&Lu(e,!!r.multiple,t,!1)}};uF=xM;dF=xc;var S9={usingClientEntryPoint:!1,Events:[ap,Tu,q_,lF,cF,xM]},Sh={findFiberByHostInstance:ec,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},P9={bundleType:Sh.bundleType,version:Sh.version,rendererPackageName:Sh.rendererPackageName,rendererConfig:Sh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:na.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pF(e),e===null?null:e.stateNode},findFiberByHostInstance:Sh.findFiberByHostInstance||T9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Am=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Am.isDisabled&&Am.supportsFiber)try{W_=Am.inject(P9),To=Am}catch{}}qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S9;qs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kM(t))throw Error(Ye(200));return M9(e,t,null,r)};qs.createRoot=function(e,t){if(!kM(e))throw Error(Ye(299));var r=!1,n="",s=HL;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=SM(e,1,!1,null,null,r,!1,n,s),e[Yo]=t.current,Cf(e.nodeType===8?e.parentNode:e),new CM(t)};qs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ye(188)):(e=Object.keys(e).join(","),Error(Ye(268,e)));return e=pF(t),e=e===null?null:e.stateNode,e};qs.flushSync=function(e){return xc(e)};qs.hydrate=function(e,t,r){if(!ny(t))throw Error(Ye(200));return sy(null,e,t,!0,r)};qs.hydrateRoot=function(e,t,r){if(!kM(e))throw Error(Ye(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=HL;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=GL(t,null,e,1,r??null,s,!1,i,o),e[Yo]=t.current,Cf(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new ry(t)};qs.render=function(e,t,r){if(!ny(t))throw Error(Ye(200));return sy(null,e,t,!1,r)};qs.unmountComponentAtNode=function(e){if(!ny(e))throw Error(Ye(40));return e._reactRootContainer?(xc(function(){sy(null,null,e,!1,function(){e._reactRootContainer=null,e[Yo]=null})}),!0):!1};qs.unstable_batchedUpdates=xM;qs.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ny(r))throw Error(Ye(200));if(e==null||e._reactInternals===void 0)throw Error(Ye(38));return sy(e,t,r,!1,n)};qs.version="18.3.1-next-f1338f8080-20240426";function KL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KL)}catch(e){console.error(e)}}KL(),KR.exports=qs;var jc=KR.exports;const qL=OR(jc);var QL,ZA=jc;QL=ZA.createRoot,ZA.hydrateRoot;const C9=1,k9=1e6;let x0=0;function A9(){return x0=(x0+1)%Number.MAX_SAFE_INTEGER,x0.toString()}const M0=new Map,e$=e=>{if(M0.has(e))return;const t=setTimeout(()=>{M0.delete(e),uf({type:"REMOVE_TOAST",toastId:e})},k9);M0.set(e,t)},$9=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,C9)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?e$(r):e.toasts.forEach(n=>{e$(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Eg=[];let Sg={toasts:[]};function uf(e){Sg=$9(Sg,e),Eg.forEach(t=>{t(Sg)})}function I9({...e}){const t=A9(),r=s=>uf({type:"UPDATE_TOAST",toast:{...s,id:t}}),n=()=>uf({type:"DISMISS_TOAST",toastId:t});return uf({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||n()}}}),{id:t,dismiss:n,update:r}}function vi(){const[e,t]=C.useState(Sg);return C.useEffect(()=>(Eg.push(t),()=>{const r=Eg.indexOf(t);r>-1&&Eg.splice(r,1)}),[e]),{...e,toast:I9,dismiss:r=>uf({type:"DISMISS_TOAST",toastId:r})}}function Ct(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function O9(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function YL(...e){return t=>e.forEach(r=>O9(r,t))}function kr(...e){return C.useCallback(YL(...e),e)}function j9(e,t=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];function c(d){const{scope:h,children:f,...p}=d,_=(h==null?void 0:h[e][l])||a,w=C.useMemo(()=>p,Object.values(p));return m.jsx(_.Provider,{value:w,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=C.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[e])||i;return C.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[n,D9(s,...t)]}function D9(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return C.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var Mc=C.forwardRef((e,t)=>{const{children:r,...n}=e,s=C.Children.toArray(r),i=s.find(N9);if(i){const o=i.props.children,a=s.map(l=>l===i?C.Children.count(o)>1?C.Children.only(null):C.isValidElement(o)?o.props.children:null:l);return m.jsx(ax,{...n,ref:t,children:C.isValidElement(o)?C.cloneElement(o,void 0,a):null})}return m.jsx(ax,{...n,ref:t,children:r})});Mc.displayName="Slot";var ax=C.forwardRef((e,t)=>{const{children:r,...n}=e;if(C.isValidElement(r)){const s=F9(r);return C.cloneElement(r,{...R9(n,r.props),ref:t?YL(t,s):s})}return C.Children.count(r)>1?C.Children.only(null):null});ax.displayName="SlotClone";var XL=({children:e})=>m.jsx(m.Fragment,{children:e});function N9(e){return C.isValidElement(e)&&e.type===XL}function R9(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...a)=>{i(...a),s(...a)}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}function F9(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function AM(e){const t=e+"CollectionProvider",[r,n]=j9(t),[s,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:p,children:_}=f,w=et.useRef(null),y=et.useRef(new Map).current;return m.jsx(s,{scope:p,itemMap:y,collectionRef:w,children:_})};o.displayName=t;const a=e+"CollectionSlot",l=et.forwardRef((f,p)=>{const{scope:_,children:w}=f,y=i(a,_),g=kr(p,y.collectionRef);return m.jsx(Mc,{ref:g,children:w})});l.displayName=a;const c=e+"CollectionItemSlot",u="data-radix-collection-item",d=et.forwardRef((f,p)=>{const{scope:_,children:w,...y}=f,g=et.useRef(null),v=kr(p,g),b=i(c,_);return et.useEffect(()=>(b.itemMap.set(g,{ref:g,...y}),()=>void b.itemMap.delete(g))),m.jsx(Mc,{[u]:"",ref:v,children:w})});d.displayName=c;function h(f){const p=i(e+"CollectionConsumer",f);return et.useCallback(()=>{const w=p.collectionRef.current;if(!w)return[];const y=Array.from(w.querySelectorAll(`[${u}]`));return Array.from(p.itemMap.values()).sort((b,x)=>y.indexOf(b.ref.current)-y.indexOf(x.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,n]}function L9(e,t){const r=C.createContext(t),n=i=>{const{children:o,...a}=i,l=C.useMemo(()=>a,Object.values(a));return m.jsx(r.Provider,{value:l,children:o})};n.displayName=e+"Provider";function s(i){const o=C.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,s]}function Dc(e,t=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];const c=d=>{var y;const{scope:h,children:f,...p}=d,_=((y=h==null?void 0:h[e])==null?void 0:y[l])||a,w=C.useMemo(()=>p,Object.values(p));return m.jsx(_.Provider,{value:w,children:f})};c.displayName=i+"Provider";function u(d,h){var _;const f=((_=h==null?void 0:h[e])==null?void 0:_[l])||a,p=C.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[e])||i;return C.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[n,B9(s,...t)]}function B9(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return C.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var z9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Nt=z9.reduce((e,t)=>{const r=C.forwardRef((n,s)=>{const{asChild:i,...o}=n,a=i?Mc:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(a,{...o,ref:s})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function JL(e,t){e&&jc.flushSync(()=>e.dispatchEvent(t))}function ms(e){const t=C.useRef(e);return C.useEffect(()=>{t.current=e}),C.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function V9(e,t=globalThis==null?void 0:globalThis.document){const r=ms(e);C.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var U9="DismissableLayer",lx="dismissableLayer.update",W9="dismissableLayer.pointerDownOutside",G9="dismissableLayer.focusOutside",t$,ZL=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),cp=C.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=e,c=C.useContext(ZL),[u,d]=C.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=C.useState({}),p=kr(t,E=>d(E)),_=Array.from(c.layers),[w]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=_.indexOf(w),g=u?_.indexOf(u):-1,v=c.layersWithOutsidePointerEventsDisabled.size>0,b=g>=y,x=K9(E=>{const P=E.target,I=[...c.branches].some(O=>O.contains(P));!b||I||(s==null||s(E),o==null||o(E),E.defaultPrevented||a==null||a())},h),M=q9(E=>{const P=E.target;[...c.branches].some(O=>O.contains(P))||(i==null||i(E),o==null||o(E),E.defaultPrevented||a==null||a())},h);return V9(E=>{g===c.layers.size-1&&(n==null||n(E),!E.defaultPrevented&&a&&(E.preventDefault(),a()))},h),C.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(t$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),r$(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=t$)}},[u,h,r,c]),C.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),r$())},[u,c]),C.useEffect(()=>{const E=()=>f({});return document.addEventListener(lx,E),()=>document.removeEventListener(lx,E)},[]),m.jsx(Nt.div,{...l,ref:p,style:{pointerEvents:v?b?"auto":"none":void 0,...e.style},onFocusCapture:Ct(e.onFocusCapture,M.onFocusCapture),onBlurCapture:Ct(e.onBlurCapture,M.onBlurCapture),onPointerDownCapture:Ct(e.onPointerDownCapture,x.onPointerDownCapture)})});cp.displayName=U9;var H9="DismissableLayerBranch",e3=C.forwardRef((e,t)=>{const r=C.useContext(ZL),n=C.useRef(null),s=kr(t,n);return C.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),m.jsx(Nt.div,{...e,ref:s})});e3.displayName=H9;function K9(e,t=globalThis==null?void 0:globalThis.document){const r=ms(e),n=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const i=a=>{if(a.target&&!n.current){let l=function(){t3(W9,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function q9(e,t=globalThis==null?void 0:globalThis.document){const r=ms(e),n=C.useRef(!1);return C.useEffect(()=>{const s=i=>{i.target&&!n.current&&t3(G9,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function r$(){const e=new CustomEvent(lx);document.dispatchEvent(e)}function t3(e,t,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?JL(s,i):s.dispatchEvent(i)}var Q9=cp,Y9=e3,Fn=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},X9="Portal",iy=C.forwardRef((e,t)=>{var a;const{container:r,...n}=e,[s,i]=C.useState(!1);Fn(()=>i(!0),[]);const o=r||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?qL.createPortal(m.jsx(Nt.div,{...n,ref:t}),o):null});iy.displayName=X9;function J9(e,t){return C.useReducer((r,n)=>t[r][n]??r,e)}var al=e=>{const{present:t,children:r}=e,n=Z9(t),s=typeof r=="function"?r({present:n.isPresent}):C.Children.only(r),i=kr(n.ref,eq(s));return typeof r=="function"||n.isPresent?C.cloneElement(s,{ref:i}):null};al.displayName="Presence";function Z9(e){const[t,r]=C.useState(),n=C.useRef({}),s=C.useRef(e),i=C.useRef("none"),o=e?"mounted":"unmounted",[a,l]=J9(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=$m(n.current);i.current=a==="mounted"?c:"none"},[a]),Fn(()=>{const c=n.current,u=s.current;if(u!==e){const h=i.current,f=$m(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),Fn(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=f=>{const _=$m(n.current).includes(f.animationName);if(f.target===t&&_&&(l("ANIMATION_END"),!s.current)){const w=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=w)})}},h=f=>{f.target===t&&(i.current=$m(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:C.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function $m(e){return(e==null?void 0:e.animationName)||"none"}function eq(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Tc({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,s]=tq({defaultProp:t,onChange:r}),i=e!==void 0,o=i?e:n,a=ms(r),l=C.useCallback(c=>{if(i){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else s(c)},[i,e,s,a]);return[o,l]}function tq({defaultProp:e,onChange:t}){const r=C.useState(e),[n]=r,s=C.useRef(n),i=ms(t);return C.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}var rq="VisuallyHidden",up=C.forwardRef((e,t)=>m.jsx(Nt.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));up.displayName=rq;var nq=up,$M="ToastProvider",[IM,sq,iq]=AM("Toast"),[r3,Nhe]=Dc("Toast",[iq]),[oq,oy]=r3($M),n3=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=e,[a,l]=C.useState(null),[c,u]=C.useState(0),d=C.useRef(!1),h=C.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${$M}\`. Expected non-empty \`string\`.`),m.jsx(IM.Provider,{scope:t,children:m.jsx(oq,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:C.useCallback(()=>u(f=>f+1),[]),onToastRemove:C.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:o})})};n3.displayName=$M;var s3="ToastViewport",aq=["F8"],cx="toast.viewportPause",ux="toast.viewportResume",i3=C.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=aq,label:s="Notifications ({hotkey})",...i}=e,o=oy(s3,r),a=sq(r),l=C.useRef(null),c=C.useRef(null),u=C.useRef(null),d=C.useRef(null),h=kr(t,d,o.onViewportChange),f=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;C.useEffect(()=>{const w=y=>{var v;n.length!==0&&n.every(b=>y[b]||y.code===b)&&((v=d.current)==null||v.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[n]),C.useEffect(()=>{const w=l.current,y=d.current;if(p&&w&&y){const g=()=>{if(!o.isClosePausedRef.current){const M=new CustomEvent(cx);y.dispatchEvent(M),o.isClosePausedRef.current=!0}},v=()=>{if(o.isClosePausedRef.current){const M=new CustomEvent(ux);y.dispatchEvent(M),o.isClosePausedRef.current=!1}},b=M=>{!w.contains(M.relatedTarget)&&v()},x=()=>{w.contains(document.activeElement)||v()};return w.addEventListener("focusin",g),w.addEventListener("focusout",b),w.addEventListener("pointermove",g),w.addEventListener("pointerleave",x),window.addEventListener("blur",g),window.addEventListener("focus",v),()=>{w.removeEventListener("focusin",g),w.removeEventListener("focusout",b),w.removeEventListener("pointermove",g),w.removeEventListener("pointerleave",x),window.removeEventListener("blur",g),window.removeEventListener("focus",v)}}},[p,o.isClosePausedRef]);const _=C.useCallback(({tabbingDirection:w})=>{const g=a().map(v=>{const b=v.ref.current,x=[b,...wq(b)];return w==="forwards"?x:x.reverse()});return(w==="forwards"?g.reverse():g).flat()},[a]);return C.useEffect(()=>{const w=d.current;if(w){const y=g=>{var x,M,E;const v=g.altKey||g.ctrlKey||g.metaKey;if(g.key==="Tab"&&!v){const P=document.activeElement,I=g.shiftKey;if(g.target===w&&I){(x=c.current)==null||x.focus();return}const U=_({tabbingDirection:I?"backwards":"forwards"}),B=U.findIndex(Y=>Y===P);T0(U.slice(B+1))?g.preventDefault():I?(M=c.current)==null||M.focus():(E=u.current)==null||E.focus()}};return w.addEventListener("keydown",y),()=>w.removeEventListener("keydown",y)}},[a,_]),m.jsxs(Y9,{ref:l,role:"region","aria-label":s.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&m.jsx(dx,{ref:c,onFocusFromOutsideViewport:()=>{const w=_({tabbingDirection:"forwards"});T0(w)}}),m.jsx(IM.Slot,{scope:r,children:m.jsx(Nt.ol,{tabIndex:-1,...i,ref:h})}),p&&m.jsx(dx,{ref:u,onFocusFromOutsideViewport:()=>{const w=_({tabbingDirection:"backwards"});T0(w)}})]})});i3.displayName=s3;var o3="ToastFocusProxy",dx=C.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,i=oy(o3,r);return m.jsx(up,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&n()}})});dx.displayName=o3;var ay="Toast",lq="toast.swipeStart",cq="toast.swipeMove",uq="toast.swipeCancel",dq="toast.swipeEnd",a3=C.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:i,...o}=e,[a=!0,l]=Tc({prop:n,defaultProp:s,onChange:i});return m.jsx(al,{present:r||a,children:m.jsx(pq,{open:a,...o,ref:t,onClose:()=>l(!1),onPause:ms(e.onPause),onResume:ms(e.onResume),onSwipeStart:Ct(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ct(e.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Ct(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ct(e.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});a3.displayName=ay;var[hq,fq]=r3(ay,{onClose(){}}),pq=C.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=e,_=oy(ay,r),[w,y]=C.useState(null),g=kr(t,Y=>y(Y)),v=C.useRef(null),b=C.useRef(null),x=s||_.duration,M=C.useRef(0),E=C.useRef(x),P=C.useRef(0),{onToastAdd:I,onToastRemove:O}=_,V=ms(()=>{var K;(w==null?void 0:w.contains(document.activeElement))&&((K=_.viewport)==null||K.focus()),o()}),U=C.useCallback(Y=>{!Y||Y===1/0||(window.clearTimeout(P.current),M.current=new Date().getTime(),P.current=window.setTimeout(V,Y))},[V]);C.useEffect(()=>{const Y=_.viewport;if(Y){const K=()=>{U(E.current),c==null||c()},X=()=>{const G=new Date().getTime()-M.current;E.current=E.current-G,window.clearTimeout(P.current),l==null||l()};return Y.addEventListener(cx,X),Y.addEventListener(ux,K),()=>{Y.removeEventListener(cx,X),Y.removeEventListener(ux,K)}}},[_.viewport,x,l,c,U]),C.useEffect(()=>{i&&!_.isClosePausedRef.current&&U(x)},[i,x,_.isClosePausedRef,U]),C.useEffect(()=>(I(),()=>O()),[I,O]);const B=C.useMemo(()=>w?p3(w):null,[w]);return _.viewport?m.jsxs(m.Fragment,{children:[B&&m.jsx(mq,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:B}),m.jsx(hq,{scope:r,onClose:V,children:jc.createPortal(m.jsx(IM.ItemSlot,{scope:r,children:m.jsx(Q9,{asChild:!0,onEscapeKeyDown:Ct(a,()=>{_.isFocusedToastEscapeKeyDownRef.current||V(),_.isFocusedToastEscapeKeyDownRef.current=!1}),children:m.jsx(Nt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":_.swipeDirection,...p,ref:g,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Ct(e.onKeyDown,Y=>{Y.key==="Escape"&&(a==null||a(Y.nativeEvent),Y.nativeEvent.defaultPrevented||(_.isFocusedToastEscapeKeyDownRef.current=!0,V()))}),onPointerDown:Ct(e.onPointerDown,Y=>{Y.button===0&&(v.current={x:Y.clientX,y:Y.clientY})}),onPointerMove:Ct(e.onPointerMove,Y=>{if(!v.current)return;const K=Y.clientX-v.current.x,X=Y.clientY-v.current.y,G=!!b.current,R=["left","right"].includes(_.swipeDirection),te=["left","up"].includes(_.swipeDirection)?Math.min:Math.max,re=R?te(0,K):0,L=R?0:te(0,X),j=Y.pointerType==="touch"?10:2,q={x:re,y:L},ne={originalEvent:Y,delta:q};G?(b.current=q,Im(cq,d,ne,{discrete:!1})):n$(q,_.swipeDirection,j)?(b.current=q,Im(lq,u,ne,{discrete:!1}),Y.target.setPointerCapture(Y.pointerId)):(Math.abs(K)>j||Math.abs(X)>j)&&(v.current=null)}),onPointerUp:Ct(e.onPointerUp,Y=>{const K=b.current,X=Y.target;if(X.hasPointerCapture(Y.pointerId)&&X.releasePointerCapture(Y.pointerId),b.current=null,v.current=null,K){const G=Y.currentTarget,R={originalEvent:Y,delta:K};n$(K,_.swipeDirection,_.swipeThreshold)?Im(dq,f,R,{discrete:!0}):Im(uq,h,R,{discrete:!0}),G.addEventListener("click",te=>te.preventDefault(),{once:!0})}})})})}),_.viewport)})]}):null}),mq=e=>{const{__scopeToast:t,children:r,...n}=e,s=oy(ay,t),[i,o]=C.useState(!1),[a,l]=C.useState(!1);return yq(()=>o(!0)),C.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:m.jsx(iy,{asChild:!0,children:m.jsx(up,{...n,children:i&&m.jsxs(m.Fragment,{children:[s.label," ",r]})})})},gq="ToastTitle",l3=C.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return m.jsx(Nt.div,{...n,ref:t})});l3.displayName=gq;var _q="ToastDescription",c3=C.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return m.jsx(Nt.div,{...n,ref:t})});c3.displayName=_q;var u3="ToastAction",d3=C.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?m.jsx(f3,{altText:r,asChild:!0,children:m.jsx(OM,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${u3}\`. Expected non-empty \`string\`.`),null)});d3.displayName=u3;var h3="ToastClose",OM=C.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=fq(h3,r);return m.jsx(f3,{asChild:!0,children:m.jsx(Nt.button,{type:"button",...n,ref:t,onClick:Ct(e.onClick,s.onClose)})})});OM.displayName=h3;var f3=C.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return m.jsx(Nt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function p3(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),vq(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...p3(n))}}),t}function Im(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?JL(s,i):s.dispatchEvent(i)}var n$=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),i=n>s;return t==="left"||t==="right"?i&&n>r:!i&&s>r};function yq(e=()=>{}){const t=ms(e);Fn(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function vq(e){return e.nodeType===e.ELEMENT_NODE}function wq(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function T0(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var bq=n3,m3=i3,g3=a3,_3=l3,y3=c3,v3=d3,w3=OM;function b3(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=b3(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function x3(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=b3(e))&&(n&&(n+=" "),n+=t);return n}const s$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,i$=x3,ly=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return i$(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,o=Object.keys(s).map(c=>{const u=r==null?void 0:r[c],d=i==null?void 0:i[c];if(u===null)return null;const h=s$(u)||s$(d);return s[c][h]}),a=r&&Object.entries(r).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(p=>{let[_,w]=p;return Array.isArray(w)?w.includes({...i,...a}[_]):{...i,...a}[_]===w})?[...c,d,h]:c},[]);return i$(e,o,l,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xq=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),M3=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Mq={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tq=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...a},l)=>C.createElement("svg",{ref:l,...Mq,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:M3("lucide",s),...a},[...o.map(([c,u])=>C.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=(e,t)=>{const r=C.forwardRef(({className:n,...s},i)=>C.createElement(Tq,{ref:i,iconNode:t,className:M3(`lucide-${xq(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=ur("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eq=ur("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sq=ur("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pq=ur("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=ur("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=ur("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cq=ur("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=ur("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kq=ur("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=ur("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aq=ur("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=ur("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $q=ur("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=ur("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iq=ur("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oq=ur("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=ur("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=ur("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=ur("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=ur("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=ur("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jq=ur("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dq=ur("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=ur("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=ur("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=ur("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=ur("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nq=ur("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=ur("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=ur("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rq=ur("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fq=ur("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=ur("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),jM="-",Lq=e=>{const t=zq(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const a=o.split(jM);return a[0]===""&&a.length!==1&&a.shift(),j3(a,t)||Bq(o)},getConflictingClassGroupIds:(o,a)=>{const l=r[o]||[];return a&&n[o]?[...l,...n[o]]:l}}},j3=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?j3(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(jM);return(o=t.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},o$=/^\[(.+)\]$/,Bq=e=>{if(o$.test(e)){const t=o$.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},zq=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Uq(Object.entries(e.classGroups),r).forEach(([i,o])=>{px(o,n,i,t)}),n},px=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:a$(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(Vq(s)){px(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,o])=>{px(o,a$(t,i),r,n)})})},a$=(e,t)=>{let r=e;return t.split(jM).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Vq=e=>e.isThemeGetter,Uq=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[t+o,a])):i);return[r,s]}):e,Wq=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return s(i,o),o},set(i,o){r.has(i)?r.set(i,o):s(i,o)}}},D3="!",Gq=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,o=a=>{const l=[];let c=0,u=0,d;for(let w=0;w<a.length;w++){let y=a[w];if(c===0){if(y===s&&(n||a.slice(w,w+i)===t)){l.push(a.slice(u,w)),u=w+i;continue}if(y==="/"){d=w;continue}}y==="["?c++:y==="]"&&c--}const h=l.length===0?a:a.substring(u),f=h.startsWith(D3),p=f?h.substring(1):h,_=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:_}};return r?a=>r({className:a,parseClassName:o}):o},Hq=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Kq=e=>({cache:Wq(e.cacheSize),parseClassName:Gq(e),...Lq(e)}),qq=/\s+/,Qq=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],o=e.trim().split(qq);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=r(c);let p=!!f,_=n(p?h.substring(0,f):h);if(!_){if(!p){a=c+(a.length>0?" "+a:a);continue}if(_=n(h),!_){a=c+(a.length>0?" "+a:a);continue}p=!1}const w=Hq(u).join(":"),y=d?w+D3:w,g=y+_;if(i.includes(g))continue;i.push(g);const v=s(_,p);for(let b=0;b<v.length;++b){const x=v[b];i.push(y+x)}a=c+(a.length>0?" "+a:a)}return a};function Yq(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=N3(t))&&(n&&(n+=" "),n+=r);return n}const N3=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=N3(e[n]))&&(r&&(r+=" "),r+=t);return r};function Xq(e,...t){let r,n,s,i=o;function o(l){const c=t.reduce((u,d)=>d(u),e());return r=Kq(c),n=r.cache.get,s=r.cache.set,i=a,a(l)}function a(l){const c=n(l);if(c)return c;const u=Qq(l,r);return s(l,u),u}return function(){return i(Yq.apply(null,arguments))}}const Rr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},R3=/^\[(?:([a-z-]+):)?(.+)\]$/i,Jq=/^\d+\/\d+$/,Zq=new Set(["px","full","screen"]),e7=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,t7=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,r7=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,n7=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,s7=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ro=e=>Gu(e)||Zq.has(e)||Jq.test(e),fa=e=>Sd(e,"length",h7),Gu=e=>!!e&&!Number.isNaN(Number(e)),E0=e=>Sd(e,"number",Gu),Ph=e=>!!e&&Number.isInteger(Number(e)),i7=e=>e.endsWith("%")&&Gu(e.slice(0,-1)),Gt=e=>R3.test(e),pa=e=>e7.test(e),o7=new Set(["length","size","percentage"]),a7=e=>Sd(e,o7,F3),l7=e=>Sd(e,"position",F3),c7=new Set(["image","url"]),u7=e=>Sd(e,c7,p7),d7=e=>Sd(e,"",f7),Ch=()=>!0,Sd=(e,t,r)=>{const n=R3.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},h7=e=>t7.test(e)&&!r7.test(e),F3=()=>!1,f7=e=>n7.test(e),p7=e=>s7.test(e),m7=()=>{const e=Rr("colors"),t=Rr("spacing"),r=Rr("blur"),n=Rr("brightness"),s=Rr("borderColor"),i=Rr("borderRadius"),o=Rr("borderSpacing"),a=Rr("borderWidth"),l=Rr("contrast"),c=Rr("grayscale"),u=Rr("hueRotate"),d=Rr("invert"),h=Rr("gap"),f=Rr("gradientColorStops"),p=Rr("gradientColorStopPositions"),_=Rr("inset"),w=Rr("margin"),y=Rr("opacity"),g=Rr("padding"),v=Rr("saturate"),b=Rr("scale"),x=Rr("sepia"),M=Rr("skew"),E=Rr("space"),P=Rr("translate"),I=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],V=()=>["auto",Gt,t],U=()=>[Gt,t],B=()=>["",Ro,fa],Y=()=>["auto",Gu,Gt],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>["start","end","center","between","around","evenly","stretch"],te=()=>["","0",Gt],re=()=>["auto","avoid","all","avoid-page","page","left","right","column"],L=()=>[Gu,Gt];return{cacheSize:500,separator:":",theme:{colors:[Ch],spacing:[Ro,fa],blur:["none","",pa,Gt],brightness:L(),borderColor:[e],borderRadius:["none","","full",pa,Gt],borderSpacing:U(),borderWidth:B(),contrast:L(),grayscale:te(),hueRotate:L(),invert:te(),gap:U(),gradientColorStops:[e],gradientColorStopPositions:[i7,fa],inset:V(),margin:V(),opacity:L(),padding:U(),saturate:L(),scale:L(),sepia:te(),skew:L(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",Gt]}],container:["container"],columns:[{columns:[pa]}],"break-after":[{"break-after":re()}],"break-before":[{"break-before":re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),Gt]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ph,Gt]}],basis:[{basis:V()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Gt]}],grow:[{grow:te()}],shrink:[{shrink:te()}],order:[{order:["first","last","none",Ph,Gt]}],"grid-cols":[{"grid-cols":[Ch]}],"col-start-end":[{col:["auto",{span:["full",Ph,Gt]},Gt]}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":[Ch]}],"row-start-end":[{row:["auto",{span:[Ph,Gt]},Gt]}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Gt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Gt]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...R()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...R(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...R(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Gt,t]}],"min-w":[{"min-w":[Gt,t,"min","max","fit"]}],"max-w":[{"max-w":[Gt,t,"none","full","min","max","fit","prose",{screen:[pa]},pa]}],h:[{h:[Gt,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Gt,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Gt,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Gt,t,"auto","min","max","fit"]}],"font-size":[{text:["base",pa,fa]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",E0]}],"font-family":[{font:[Ch]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Gt]}],"line-clamp":[{"line-clamp":["none",Gu,E0]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ro,Gt]}],"list-image":[{"list-image":["none",Gt]}],"list-style-type":[{list:["none","disc","decimal",Gt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ro,fa]}],"underline-offset":[{"underline-offset":["auto",Ro,Gt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Gt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Gt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),l7]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",a7]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},u7]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:X()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Ro,Gt]}],"outline-w":[{outline:[Ro,fa]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Ro,fa]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",pa,d7]}],"shadow-color":[{shadow:[Ch]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",pa,Gt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[x]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[x]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Gt]}],duration:[{duration:L()}],ease:[{ease:["linear","in","out","in-out",Gt]}],delay:[{delay:L()}],animate:[{animate:["none","spin","ping","pulse","bounce",Gt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Ph,Gt]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Gt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Gt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Gt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ro,fa,E0]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},g7=Xq(m7);function zt(...e){return g7(x3(e))}const _7=bq,L3=C.forwardRef(({className:e,...t},r)=>m.jsx(m3,{ref:r,className:zt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));L3.displayName=m3.displayName;const y7=ly("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),B3=C.forwardRef(({className:e,variant:t,...r},n)=>m.jsx(g3,{ref:n,className:zt(y7({variant:t}),e),...r}));B3.displayName=g3.displayName;const v7=C.forwardRef(({className:e,...t},r)=>m.jsx(v3,{ref:r,className:zt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));v7.displayName=v3.displayName;const z3=C.forwardRef(({className:e,...t},r)=>m.jsx(w3,{ref:r,className:zt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:m.jsx(O3,{className:"h-4 w-4"})}));z3.displayName=w3.displayName;const V3=C.forwardRef(({className:e,...t},r)=>m.jsx(_3,{ref:r,className:zt("text-sm font-semibold",e),...t}));V3.displayName=_3.displayName;const U3=C.forwardRef(({className:e,...t},r)=>m.jsx(y3,{ref:r,className:zt("text-sm opacity-90",e),...t}));U3.displayName=y3.displayName;function w7(){const{toasts:e}=vi();return m.jsxs(_7,{children:[e.map(function({id:t,title:r,description:n,action:s,...i}){return m.jsxs(B3,{...i,children:[m.jsxs("div",{className:"grid gap-1",children:[r&&m.jsx(V3,{children:r}),n&&m.jsx(U3,{children:n})]}),s,m.jsx(z3,{})]},t)}),m.jsx(L3,{})]})}var l$=["light","dark"],b7="(prefers-color-scheme: dark)",x7=C.createContext(void 0),M7={setTheme:e=>{},themes:[]},T7=()=>{var e;return(e=C.useContext(x7))!=null?e:M7};C.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(p=>`'${p}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,d=s?l$.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(p,_=!1,w=!0)=>{let y=o?o[p]:p,g=_?p+"|| ''":`'${y}'`,v="";return s&&w&&!_&&l$.includes(p)&&(v+=`d.style.colorScheme = '${p}';`),r==="class"?_||y?v+=`c.add(${g})`:v+="null":y&&(v+=`d[s](n,${g})`),v},f=e?`!function(){${u}${h(e)}}()`:n?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${c})){var t='${b7}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}${c?"":"else{"+h(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}else{${h(i,!1,!1)};}${d}}catch(t){}}();`;return C.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:f}})});var E7=e=>{switch(e){case"success":return C7;case"info":return A7;case"warning":return k7;case"error":return $7;default:return null}},S7=Array(12).fill(0),P7=({visible:e})=>et.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},et.createElement("div",{className:"sonner-spinner"},S7.map((t,r)=>et.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),C7=et.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},et.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),k7=et.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},et.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),A7=et.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},et.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),$7=et.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},et.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),I7=()=>{let[e,t]=et.useState(document.hidden);return et.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},mx=1,O7=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:n,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:mx++,o=this.toasts.find(l=>l.id===i),a=t.dismissible===void 0?!0:t.dismissible;return o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:n}),{...l,...t,id:i,dismissible:a,title:n}):l):this.addToast({title:n,...s,dismissible:a,id:i}),i},this.dismiss=t=>(t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let s=t instanceof Promise?t:t(),i=n!==void 0;return s.then(async o=>{if(D7(o)&&!o.ok){i=!1;let a=typeof r.error=="function"?await r.error(`HTTP error! status: ${o.status}`):r.error,l=typeof r.description=="function"?await r.description(`HTTP error! status: ${o.status}`):r.description;this.create({id:n,type:"error",message:a,description:l})}else if(r.success!==void 0){i=!1;let a=typeof r.success=="function"?await r.success(o):r.success,l=typeof r.description=="function"?await r.description(o):r.description;this.create({id:n,type:"success",message:a,description:l})}}).catch(async o=>{if(r.error!==void 0){i=!1;let a=typeof r.error=="function"?await r.error(o):r.error,l=typeof r.description=="function"?await r.description(o):r.description;this.create({id:n,type:"error",message:a,description:l})}}).finally(()=>{var o;i&&(this.dismiss(n),n=void 0),(o=r.finally)==null||o.call(r)}),n},this.custom=(t,r)=>{let n=(r==null?void 0:r.id)||mx++;return this.create({jsx:t(n),id:n,...r}),n},this.subscribers=[],this.toasts=[]}},Ns=new O7,j7=(e,t)=>{let r=(t==null?void 0:t.id)||mx++;return Ns.addToast({title:e,...t,id:r}),r},D7=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",N7=j7,R7=()=>Ns.toasts;Object.assign(N7,{success:Ns.success,info:Ns.info,warning:Ns.warning,error:Ns.error,custom:Ns.custom,message:Ns.message,promise:Ns.promise,dismiss:Ns.dismiss,loading:Ns.loading},{getHistory:R7});function F7(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}F7(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Om(e){return e.label!==void 0}var L7=3,B7="32px",z7=4e3,V7=356,U7=14,W7=20,G7=200;function H7(...e){return e.filter(Boolean).join(" ")}var K7=e=>{var t,r,n,s,i,o,a,l,c,u;let{invert:d,toast:h,unstyled:f,interacting:p,setHeights:_,visibleToasts:w,heights:y,index:g,toasts:v,expanded:b,removeToast:x,defaultRichColors:M,closeButton:E,style:P,cancelButtonStyle:I,actionButtonStyle:O,className:V="",descriptionClassName:U="",duration:B,position:Y,gap:K,loadingIcon:X,expandByDefault:G,classNames:R,icons:te,closeButtonAriaLabel:re="Close toast",pauseWhenPageIsHidden:L,cn:j}=e,[q,ne]=et.useState(!1),[me,ae]=et.useState(!1),[fe,Pe]=et.useState(!1),[Ne,de]=et.useState(!1),[Q,se]=et.useState(0),[J,be]=et.useState(0),xe=et.useRef(null),Te=et.useRef(null),Ee=g===0,$e=g+1<=w,Ie=h.type,Ue=h.dismissible!==!1,Ke=h.className||"",Je=h.descriptionClassName||"",je=et.useMemo(()=>y.findIndex(F=>F.toastId===h.id)||0,[y,h.id]),qe=et.useMemo(()=>{var F;return(F=h.closeButton)!=null?F:E},[h.closeButton,E]),ot=et.useMemo(()=>h.duration||B||z7,[h.duration,B]),ft=et.useRef(0),it=et.useRef(0),We=et.useRef(0),Be=et.useRef(null),[De,yt]=Y.split("-"),Mt=et.useMemo(()=>y.reduce((F,ce,W)=>W>=je?F:F+ce.height,0),[y,je]),Lt=I7(),dr=h.invert||d,pr=Ie==="loading";it.current=et.useMemo(()=>je*K+Mt,[je,Mt]),et.useEffect(()=>{ne(!0)},[]),et.useLayoutEffect(()=>{if(!q)return;let F=Te.current,ce=F.style.height;F.style.height="auto";let W=F.getBoundingClientRect().height;F.style.height=ce,be(W),_(le=>le.find(ye=>ye.toastId===h.id)?le.map(ye=>ye.toastId===h.id?{...ye,height:W}:ye):[{toastId:h.id,height:W,position:h.position},...le])},[q,h.title,h.description,_,h.id]);let at=et.useCallback(()=>{ae(!0),se(it.current),_(F=>F.filter(ce=>ce.toastId!==h.id)),setTimeout(()=>{x(h)},G7)},[h,x,_,it]);et.useEffect(()=>{if(h.promise&&Ie==="loading"||h.duration===1/0||h.type==="loading")return;let F,ce=ot;return b||p||L&&Lt?(()=>{if(We.current<ft.current){let W=new Date().getTime()-ft.current;ce=ce-W}We.current=new Date().getTime()})():ce!==1/0&&(ft.current=new Date().getTime(),F=setTimeout(()=>{var W;(W=h.onAutoClose)==null||W.call(h,h),at()},ce)),()=>clearTimeout(F)},[b,p,G,h,ot,at,h.promise,Ie,L,Lt]),et.useEffect(()=>{let F=Te.current;if(F){let ce=F.getBoundingClientRect().height;return be(ce),_(W=>[{toastId:h.id,height:ce,position:h.position},...W]),()=>_(W=>W.filter(le=>le.toastId!==h.id))}},[_,h.id]),et.useEffect(()=>{h.delete&&at()},[at,h.delete]);function Kn(){return te!=null&&te.loading?et.createElement("div",{className:"sonner-loader","data-visible":Ie==="loading"},te.loading):X?et.createElement("div",{className:"sonner-loader","data-visible":Ie==="loading"},X):et.createElement(P7,{visible:Ie==="loading"})}return et.createElement("li",{"aria-live":h.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Te,className:j(V,Ke,R==null?void 0:R.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,R==null?void 0:R.default,R==null?void 0:R[Ie],(r=h==null?void 0:h.classNames)==null?void 0:r[Ie]),"data-sonner-toast":"","data-rich-colors":(n=h.richColors)!=null?n:M,"data-styled":!(h.jsx||h.unstyled||f),"data-mounted":q,"data-promise":!!h.promise,"data-removed":me,"data-visible":$e,"data-y-position":De,"data-x-position":yt,"data-index":g,"data-front":Ee,"data-swiping":fe,"data-dismissible":Ue,"data-type":Ie,"data-invert":dr,"data-swipe-out":Ne,"data-expanded":!!(b||G&&q),style:{"--index":g,"--toasts-before":g,"--z-index":v.length-g,"--offset":`${me?Q:it.current}px`,"--initial-height":G?"auto":`${J}px`,...P,...h.style},onPointerDown:F=>{pr||!Ue||(xe.current=new Date,se(it.current),F.target.setPointerCapture(F.pointerId),F.target.tagName!=="BUTTON"&&(Pe(!0),Be.current={x:F.clientX,y:F.clientY}))},onPointerUp:()=>{var F,ce,W,le;if(Ne||!Ue)return;Be.current=null;let ye=Number(((F=Te.current)==null?void 0:F.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Re=new Date().getTime()-((ce=xe.current)==null?void 0:ce.getTime()),Se=Math.abs(ye)/Re;if(Math.abs(ye)>=W7||Se>.11){se(it.current),(W=h.onDismiss)==null||W.call(h,h),at(),de(!0);return}(le=Te.current)==null||le.style.setProperty("--swipe-amount","0px"),Pe(!1)},onPointerMove:F=>{var ce;if(!Be.current||!Ue)return;let W=F.clientY-Be.current.y,le=F.clientX-Be.current.x,ye=(De==="top"?Math.min:Math.max)(0,W),Re=F.pointerType==="touch"?10:2;Math.abs(ye)>Re?(ce=Te.current)==null||ce.style.setProperty("--swipe-amount",`${W}px`):Math.abs(le)>Re&&(Be.current=null)}},qe&&!h.jsx?et.createElement("button",{"aria-label":re,"data-disabled":pr,"data-close-button":!0,onClick:pr||!Ue?()=>{}:()=>{var F;at(),(F=h.onDismiss)==null||F.call(h,h)},className:j(R==null?void 0:R.closeButton,(s=h==null?void 0:h.classNames)==null?void 0:s.closeButton)},et.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},et.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),et.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,h.jsx||et.isValidElement(h.title)?h.jsx||h.title:et.createElement(et.Fragment,null,Ie||h.icon||h.promise?et.createElement("div",{"data-icon":"",className:j(R==null?void 0:R.icon,(i=h==null?void 0:h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||Kn():null,h.type!=="loading"?h.icon||(te==null?void 0:te[Ie])||E7(Ie):null):null,et.createElement("div",{"data-content":"",className:j(R==null?void 0:R.content,(o=h==null?void 0:h.classNames)==null?void 0:o.content)},et.createElement("div",{"data-title":"",className:j(R==null?void 0:R.title,(a=h==null?void 0:h.classNames)==null?void 0:a.title)},h.title),h.description?et.createElement("div",{"data-description":"",className:j(U,Je,R==null?void 0:R.description,(l=h==null?void 0:h.classNames)==null?void 0:l.description)},h.description):null),et.isValidElement(h.cancel)?h.cancel:h.cancel&&Om(h.cancel)?et.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||I,onClick:F=>{var ce,W;Om(h.cancel)&&Ue&&((W=(ce=h.cancel).onClick)==null||W.call(ce,F),at())},className:j(R==null?void 0:R.cancelButton,(c=h==null?void 0:h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,et.isValidElement(h.action)?h.action:h.action&&Om(h.action)?et.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||O,onClick:F=>{var ce,W;Om(h.action)&&(F.defaultPrevented||((W=(ce=h.action).onClick)==null||W.call(ce,F),at()))},className:j(R==null?void 0:R.actionButton,(u=h==null?void 0:h.classNames)==null?void 0:u.actionButton)},h.action.label):null))};function c$(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var q7=e=>{let{invert:t,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:a,theme:l="light",richColors:c,duration:u,style:d,visibleToasts:h=L7,toastOptions:f,dir:p=c$(),gap:_=U7,loadingIcon:w,icons:y,containerAriaLabel:g="Notifications",pauseWhenPageIsHidden:v,cn:b=H7}=e,[x,M]=et.useState([]),E=et.useMemo(()=>Array.from(new Set([r].concat(x.filter(L=>L.position).map(L=>L.position)))),[x,r]),[P,I]=et.useState([]),[O,V]=et.useState(!1),[U,B]=et.useState(!1),[Y,K]=et.useState(l!=="system"?l:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=et.useRef(null),G=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=et.useRef(null),te=et.useRef(!1),re=et.useCallback(L=>{var j;(j=x.find(q=>q.id===L.id))!=null&&j.delete||Ns.dismiss(L.id),M(q=>q.filter(({id:ne})=>ne!==L.id))},[x]);return et.useEffect(()=>Ns.subscribe(L=>{if(L.dismiss){M(j=>j.map(q=>q.id===L.id?{...q,delete:!0}:q));return}setTimeout(()=>{qL.flushSync(()=>{M(j=>{let q=j.findIndex(ne=>ne.id===L.id);return q!==-1?[...j.slice(0,q),{...j[q],...L},...j.slice(q+1)]:[L,...j]})})})}),[]),et.useEffect(()=>{if(l!=="system"){K(l);return}l==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:L})=>{K(L?"dark":"light")})},[l]),et.useEffect(()=>{x.length<=1&&V(!1)},[x]),et.useEffect(()=>{let L=j=>{var q,ne;n.every(me=>j[me]||j.code===me)&&(V(!0),(q=X.current)==null||q.focus()),j.code==="Escape"&&(document.activeElement===X.current||(ne=X.current)!=null&&ne.contains(document.activeElement))&&V(!1)};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[n]),et.useEffect(()=>{if(X.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,te.current=!1)}},[X.current]),x.length?et.createElement("section",{"aria-label":`${g} ${G}`,tabIndex:-1},E.map((L,j)=>{var q;let[ne,me]=L.split("-");return et.createElement("ol",{key:L,dir:p==="auto"?c$():p,tabIndex:-1,ref:X,className:o,"data-sonner-toaster":!0,"data-theme":Y,"data-y-position":ne,"data-x-position":me,style:{"--front-toast-height":`${((q=P[0])==null?void 0:q.height)||0}px`,"--offset":typeof a=="number"?`${a}px`:a||B7,"--width":`${V7}px`,"--gap":`${_}px`,...d},onBlur:ae=>{te.current&&!ae.currentTarget.contains(ae.relatedTarget)&&(te.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:ae=>{ae.target instanceof HTMLElement&&ae.target.dataset.dismissible==="false"||te.current||(te.current=!0,R.current=ae.relatedTarget)},onMouseEnter:()=>V(!0),onMouseMove:()=>V(!0),onMouseLeave:()=>{U||V(!1)},onPointerDown:ae=>{ae.target instanceof HTMLElement&&ae.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},x.filter(ae=>!ae.position&&j===0||ae.position===L).map((ae,fe)=>{var Pe,Ne;return et.createElement(K7,{key:ae.id,icons:y,index:fe,toast:ae,defaultRichColors:c,duration:(Pe=f==null?void 0:f.duration)!=null?Pe:u,className:f==null?void 0:f.className,descriptionClassName:f==null?void 0:f.descriptionClassName,invert:t,visibleToasts:h,closeButton:(Ne=f==null?void 0:f.closeButton)!=null?Ne:i,interacting:U,position:L,style:f==null?void 0:f.style,unstyled:f==null?void 0:f.unstyled,classNames:f==null?void 0:f.classNames,cancelButtonStyle:f==null?void 0:f.cancelButtonStyle,actionButtonStyle:f==null?void 0:f.actionButtonStyle,removeToast:re,toasts:x.filter(de=>de.position==ae.position),heights:P.filter(de=>de.position==ae.position),setHeights:I,expandByDefault:s,gap:_,loadingIcon:w,expanded:O,pauseWhenPageIsHidden:v,cn:b})}))})):null};const Q7=({...e})=>{const{theme:t="system"}=T7();return m.jsx(q7,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Y7=GR.useId||(()=>{}),X7=0;function Ga(e){const[t,r]=C.useState(Y7());return Fn(()=>{e||r(n=>n??String(X7++))},[e]),e||(t?`radix-${t}`:"")}const J7=["top","right","bottom","left"],Xa=Math.min,Fs=Math.max,h_=Math.round,jm=Math.floor,Ja=e=>({x:e,y:e}),Z7={left:"right",right:"left",bottom:"top",top:"bottom"},eQ={start:"end",end:"start"};function gx(e,t,r){return Fs(e,Xa(t,r))}function Zo(e,t){return typeof e=="function"?e(t):e}function ea(e){return e.split("-")[0]}function Pd(e){return e.split("-")[1]}function DM(e){return e==="x"?"y":"x"}function NM(e){return e==="y"?"height":"width"}function Za(e){return["top","bottom"].includes(ea(e))?"y":"x"}function RM(e){return DM(Za(e))}function tQ(e,t,r){r===void 0&&(r=!1);const n=Pd(e),s=RM(e),i=NM(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=f_(o)),[o,f_(o)]}function rQ(e){const t=f_(e);return[_x(e),t,_x(t)]}function _x(e){return e.replace(/start|end/g,t=>eQ[t])}function nQ(e,t,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return r?t?s:n:t?n:s;case"left":case"right":return t?i:o;default:return[]}}function sQ(e,t,r,n){const s=Pd(e);let i=nQ(ea(e),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),t&&(i=i.concat(i.map(_x)))),i}function f_(e){return e.replace(/left|right|bottom|top/g,t=>Z7[t])}function iQ(e){return{top:0,right:0,bottom:0,left:0,...e}}function W3(e){return typeof e!="number"?iQ(e):{top:e,right:e,bottom:e,left:e}}function p_(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function u$(e,t,r){let{reference:n,floating:s}=e;const i=Za(t),o=RM(t),a=NM(o),l=ea(t),c=i==="y",u=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,h=n[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:n.y-s.height};break;case"bottom":f={x:u,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:d};break;case"left":f={x:n.x-s.width,y:d};break;default:f={x:n.x,y:n.y}}switch(Pd(t)){case"start":f[o]-=h*(r&&c?-1:1);break;case"end":f[o]+=h*(r&&c?-1:1);break}return f}const oQ=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=u$(c,n,l),h=n,f={},p=0;for(let _=0;_<a.length;_++){const{name:w,fn:y}=a[_],{x:g,y:v,data:b,reset:x}=await y({x:u,y:d,initialPlacement:n,placement:h,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:e,floating:t}});u=g??u,d=v??d,f={...f,[w]:{...f[w],...b}},x&&p<=50&&(p++,typeof x=="object"&&(x.placement&&(h=x.placement),x.rects&&(c=x.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):x.rects),{x:u,y:d}=u$(c,h,l)),_=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:f}};async function Rf(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:i,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Zo(t,e),p=W3(f),w=a[h?d==="floating"?"reference":"floating":d],y=p_(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(w)))==null||r?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),g=d==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,v=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),b=await(i.isElement==null?void 0:i.isElement(v))?await(i.getScale==null?void 0:i.getScale(v))||{x:1,y:1}:{x:1,y:1},x=p_(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:g,offsetParent:v,strategy:l}):g);return{top:(y.top-x.top+p.top)/b.y,bottom:(x.bottom-y.bottom+p.bottom)/b.y,left:(y.left-x.left+p.left)/b.x,right:(x.right-y.right+p.right)/b.x}}const aQ=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=Zo(e,t)||{};if(c==null)return{};const d=W3(u),h={x:r,y:n},f=RM(s),p=NM(f),_=await o.getDimensions(c),w=f==="y",y=w?"top":"left",g=w?"bottom":"right",v=w?"clientHeight":"clientWidth",b=i.reference[p]+i.reference[f]-h[f]-i.floating[p],x=h[f]-i.reference[f],M=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let E=M?M[v]:0;(!E||!await(o.isElement==null?void 0:o.isElement(M)))&&(E=a.floating[v]||i.floating[p]);const P=b/2-x/2,I=E/2-_[p]/2-1,O=Xa(d[y],I),V=Xa(d[g],I),U=O,B=E-_[p]-V,Y=E/2-_[p]/2+P,K=gx(U,Y,B),X=!l.arrow&&Pd(s)!=null&&Y!==K&&i.reference[p]/2-(Y<U?O:V)-_[p]/2<0,G=X?Y<U?Y-U:Y-B:0;return{[f]:h[f]+G,data:{[f]:K,centerOffset:Y-K-G,...X&&{alignmentOffset:G}},reset:X}}}),lQ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:_=!0,...w}=Zo(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=ea(s),g=Za(a),v=ea(a)===a,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),x=h||(v||!_?[f_(a)]:rQ(a)),M=p!=="none";!h&&M&&x.push(...sQ(a,_,p,b));const E=[a,...x],P=await Rf(t,w),I=[];let O=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&I.push(P[y]),d){const Y=tQ(s,o,b);I.push(P[Y[0]],P[Y[1]])}if(O=[...O,{placement:s,overflows:I}],!I.every(Y=>Y<=0)){var V,U;const Y=(((V=i.flip)==null?void 0:V.index)||0)+1,K=E[Y];if(K)return{data:{index:Y,overflows:O},reset:{placement:K}};let X=(U=O.filter(G=>G.overflows[0]<=0).sort((G,R)=>G.overflows[1]-R.overflows[1])[0])==null?void 0:U.placement;if(!X)switch(f){case"bestFit":{var B;const G=(B=O.filter(R=>{if(M){const te=Za(R.placement);return te===g||te==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(te=>te>0).reduce((te,re)=>te+re,0)]).sort((R,te)=>R[1]-te[1])[0])==null?void 0:B[0];G&&(X=G);break}case"initialPlacement":X=a;break}if(s!==X)return{reset:{placement:X}}}return{}}}};function d$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function h$(e){return J7.some(t=>e[t]>=0)}const cQ=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=Zo(e,t);switch(n){case"referenceHidden":{const i=await Rf(t,{...s,elementContext:"reference"}),o=d$(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:h$(o)}}}case"escaped":{const i=await Rf(t,{...s,altBoundary:!0}),o=d$(i,r.floating);return{data:{escapedOffsets:o,escaped:h$(o)}}}default:return{}}}}};async function uQ(e,t){const{placement:r,platform:n,elements:s}=e,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=ea(r),a=Pd(r),l=Za(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,d=Zo(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const dQ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:i,placement:o,middlewareData:a}=t,l=await uQ(t,e);return o===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},hQ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:w=>{let{x:y,y:g}=w;return{x:y,y:g}}},...l}=Zo(e,t),c={x:r,y:n},u=await Rf(t,l),d=Za(ea(s)),h=DM(d);let f=c[h],p=c[d];if(i){const w=h==="y"?"top":"left",y=h==="y"?"bottom":"right",g=f+u[w],v=f-u[y];f=gx(g,f,v)}if(o){const w=d==="y"?"top":"left",y=d==="y"?"bottom":"right",g=p+u[w],v=p-u[y];p=gx(g,p,v)}const _=a.fn({...t,[h]:f,[d]:p});return{..._,data:{x:_.x-r,y:_.y-n,enabled:{[h]:i,[d]:o}}}}}},fQ=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:i,middlewareData:o}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Zo(e,t),u={x:r,y:n},d=Za(s),h=DM(d);let f=u[h],p=u[d];const _=Zo(a,t),w=typeof _=="number"?{mainAxis:_,crossAxis:0}:{mainAxis:0,crossAxis:0,..._};if(l){const v=h==="y"?"height":"width",b=i.reference[h]-i.floating[v]+w.mainAxis,x=i.reference[h]+i.reference[v]-w.mainAxis;f<b?f=b:f>x&&(f=x)}if(c){var y,g;const v=h==="y"?"width":"height",b=["top","left"].includes(ea(s)),x=i.reference[d]-i.floating[v]+(b&&((y=o.offset)==null?void 0:y[d])||0)+(b?0:w.crossAxis),M=i.reference[d]+i.reference[v]+(b?0:((g=o.offset)==null?void 0:g[d])||0)-(b?w.crossAxis:0);p<x?p=x:p>M&&(p=M)}return{[h]:f,[d]:p}}}},pQ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:i,platform:o,elements:a}=t,{apply:l=()=>{},...c}=Zo(e,t),u=await Rf(t,c),d=ea(s),h=Pd(s),f=Za(s)==="y",{width:p,height:_}=i.floating;let w,y;d==="top"||d==="bottom"?(w=d,y=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(y=d,w=h==="end"?"top":"bottom");const g=_-u.top-u.bottom,v=p-u.left-u.right,b=Xa(_-u[w],g),x=Xa(p-u[y],v),M=!t.middlewareData.shift;let E=b,P=x;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(P=v),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(E=g),M&&!h){const O=Fs(u.left,0),V=Fs(u.right,0),U=Fs(u.top,0),B=Fs(u.bottom,0);f?P=p-2*(O!==0||V!==0?O+V:Fs(u.left,u.right)):E=_-2*(U!==0||B!==0?U+B:Fs(u.top,u.bottom))}await l({...t,availableWidth:P,availableHeight:E});const I=await o.getDimensions(a.floating);return p!==I.width||_!==I.height?{reset:{rects:!0}}:{}}}};function uy(){return typeof window<"u"}function Cd(e){return G3(e)?(e.nodeName||"").toLowerCase():"#document"}function Ws(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Oo(e){var t;return(t=(G3(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function G3(e){return uy()?e instanceof Node||e instanceof Ws(e).Node:!1}function Ji(e){return uy()?e instanceof Element||e instanceof Ws(e).Element:!1}function $o(e){return uy()?e instanceof HTMLElement||e instanceof Ws(e).HTMLElement:!1}function f$(e){return!uy()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ws(e).ShadowRoot}function dp(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=Zi(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(s)}function mQ(e){return["table","td","th"].includes(Cd(e))}function dy(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function FM(e){const t=LM(),r=Ji(e)?Zi(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function gQ(e){let t=el(e);for(;$o(t)&&!fd(t);){if(FM(t))return t;if(dy(t))return null;t=el(t)}return null}function LM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fd(e){return["html","body","#document"].includes(Cd(e))}function Zi(e){return Ws(e).getComputedStyle(e)}function hy(e){return Ji(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function el(e){if(Cd(e)==="html")return e;const t=e.assignedSlot||e.parentNode||f$(e)&&e.host||Oo(e);return f$(t)?t.host:t}function H3(e){const t=el(e);return fd(t)?e.ownerDocument?e.ownerDocument.body:e.body:$o(t)&&dp(t)?t:H3(t)}function Ff(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=H3(e),i=s===((n=e.ownerDocument)==null?void 0:n.body),o=Ws(s);if(i){const a=yx(o);return t.concat(o,o.visualViewport||[],dp(s)?s:[],a&&r?Ff(a):[])}return t.concat(s,Ff(s,[],r))}function yx(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function K3(e){const t=Zi(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=$o(e),i=s?e.offsetWidth:r,o=s?e.offsetHeight:n,a=h_(r)!==i||h_(n)!==o;return a&&(r=i,n=o),{width:r,height:n,$:a}}function BM(e){return Ji(e)?e:e.contextElement}function Hu(e){const t=BM(e);if(!$o(t))return Ja(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:i}=K3(t);let o=(i?h_(r.width):r.width)/n,a=(i?h_(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const _Q=Ja(0);function q3(e){const t=Ws(e);return!LM()||!t.visualViewport?_Q:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function yQ(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ws(e)?!1:t}function Ec(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),i=BM(e);let o=Ja(1);t&&(n?Ji(n)&&(o=Hu(n)):o=Hu(e));const a=yQ(i,r,n)?q3(i):Ja(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(i){const h=Ws(i),f=n&&Ji(n)?Ws(n):n;let p=h,_=yx(p);for(;_&&n&&f!==p;){const w=Hu(_),y=_.getBoundingClientRect(),g=Zi(_),v=y.left+(_.clientLeft+parseFloat(g.paddingLeft))*w.x,b=y.top+(_.clientTop+parseFloat(g.paddingTop))*w.y;l*=w.x,c*=w.y,u*=w.x,d*=w.y,l+=v,c+=b,p=Ws(_),_=yx(p)}}return p_({width:u,height:d,x:l,y:c})}function vQ(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const i=s==="fixed",o=Oo(n),a=t?dy(t.floating):!1;if(n===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=Ja(1);const u=Ja(0),d=$o(n);if((d||!d&&!i)&&((Cd(n)!=="body"||dp(o))&&(l=hy(n)),$o(n))){const h=Ec(n);c=Hu(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x,y:r.y*c.y-l.scrollTop*c.y+u.y}}function wQ(e){return Array.from(e.getClientRects())}function vx(e,t){const r=hy(e).scrollLeft;return t?t.left+r:Ec(Oo(e)).left+r}function bQ(e){const t=Oo(e),r=hy(e),n=e.ownerDocument.body,s=Fs(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=Fs(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+vx(e);const a=-r.scrollTop;return Zi(n).direction==="rtl"&&(o+=Fs(t.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:a}}function xQ(e,t){const r=Ws(e),n=Oo(e),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=LM();(!c||c&&t==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function MQ(e,t){const r=Ec(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,i=$o(e)?Hu(e):Ja(1),o=e.clientWidth*i.x,a=e.clientHeight*i.y,l=s*i.x,c=n*i.y;return{width:o,height:a,x:l,y:c}}function p$(e,t,r){let n;if(t==="viewport")n=xQ(e,r);else if(t==="document")n=bQ(Oo(e));else if(Ji(t))n=MQ(t,r);else{const s=q3(e);n={...t,x:t.x-s.x,y:t.y-s.y}}return p_(n)}function Q3(e,t){const r=el(e);return r===t||!Ji(r)||fd(r)?!1:Zi(r).position==="fixed"||Q3(r,t)}function TQ(e,t){const r=t.get(e);if(r)return r;let n=Ff(e,[],!1).filter(a=>Ji(a)&&Cd(a)!=="body"),s=null;const i=Zi(e).position==="fixed";let o=i?el(e):e;for(;Ji(o)&&!fd(o);){const a=Zi(o),l=FM(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||dp(o)&&!l&&Q3(e,o))?n=n.filter(u=>u!==o):s=a,o=el(o)}return t.set(e,n),n}function EQ(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?dy(t)?[]:TQ(t,this._c):[].concat(r),n],a=o[0],l=o.reduce((c,u)=>{const d=p$(t,u,s);return c.top=Fs(d.top,c.top),c.right=Xa(d.right,c.right),c.bottom=Xa(d.bottom,c.bottom),c.left=Fs(d.left,c.left),c},p$(t,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function SQ(e){const{width:t,height:r}=K3(e);return{width:t,height:r}}function PQ(e,t,r){const n=$o(t),s=Oo(t),i=r==="fixed",o=Ec(e,!0,i,t);let a={scrollLeft:0,scrollTop:0};const l=Ja(0);if(n||!n&&!i)if((Cd(t)!=="body"||dp(s))&&(a=hy(t)),n){const f=Ec(t,!0,i,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else s&&(l.x=vx(s));let c=0,u=0;if(s&&!n&&!i){const f=s.getBoundingClientRect();u=f.top+a.scrollTop,c=f.left+a.scrollLeft-vx(s,f)}const d=o.left+a.scrollLeft-l.x-c,h=o.top+a.scrollTop-l.y-u;return{x:d,y:h,width:o.width,height:o.height}}function S0(e){return Zi(e).position==="static"}function m$(e,t){if(!$o(e)||Zi(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Oo(e)===r&&(r=r.ownerDocument.body),r}function Y3(e,t){const r=Ws(e);if(dy(e))return r;if(!$o(e)){let s=el(e);for(;s&&!fd(s);){if(Ji(s)&&!S0(s))return s;s=el(s)}return r}let n=m$(e,t);for(;n&&mQ(n)&&S0(n);)n=m$(n,t);return n&&fd(n)&&S0(n)&&!FM(n)?r:n||gQ(e)||r}const CQ=async function(e){const t=this.getOffsetParent||Y3,r=this.getDimensions,n=await r(e.floating);return{reference:PQ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function kQ(e){return Zi(e).direction==="rtl"}const AQ={convertOffsetParentRelativeRectToViewportRelativeRect:vQ,getDocumentElement:Oo,getClippingRect:EQ,getOffsetParent:Y3,getElementRects:CQ,getClientRects:wQ,getDimensions:SQ,getScale:Hu,isElement:Ji,isRTL:kQ};function $Q(e,t){let r=null,n;const s=Oo(e);function i(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const{left:c,top:u,width:d,height:h}=e.getBoundingClientRect();if(a||t(),!d||!h)return;const f=jm(u),p=jm(s.clientWidth-(c+d)),_=jm(s.clientHeight-(u+h)),w=jm(c),g={rootMargin:-f+"px "+-p+"px "+-_+"px "+-w+"px",threshold:Fs(0,Xa(1,l))||1};let v=!0;function b(x){const M=x[0].intersectionRatio;if(M!==l){if(!v)return o();M?o(!1,M):n=setTimeout(()=>{o(!1,1e-7)},1e3)}v=!1}try{r=new IntersectionObserver(b,{...g,root:s.ownerDocument})}catch{r=new IntersectionObserver(b,g)}r.observe(e)}return o(!0),i}function IQ(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=BM(e),u=s||i?[...c?Ff(c):[],...Ff(t)]:[];u.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const d=c&&a?$Q(c,r):null;let h=-1,f=null;o&&(f=new ResizeObserver(y=>{let[g]=y;g&&g.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=f)==null||v.observe(t)})),r()}),c&&!l&&f.observe(c),f.observe(t));let p,_=l?Ec(e):null;l&&w();function w(){const y=Ec(e);_&&(y.x!==_.x||y.y!==_.y||y.width!==_.width||y.height!==_.height)&&r(),_=y,p=requestAnimationFrame(w)}return r(),()=>{var y;u.forEach(g=>{s&&g.removeEventListener("scroll",r),i&&g.removeEventListener("resize",r)}),d==null||d(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const OQ=dQ,jQ=hQ,DQ=lQ,NQ=pQ,RQ=cQ,g$=aQ,FQ=fQ,LQ=(e,t,r)=>{const n=new Map,s={platform:AQ,...r},i={...s.platform,_c:n};return oQ(e,t,{...s,platform:i})};var kg=typeof document<"u"?C.useLayoutEffect:C.useEffect;function m_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!m_(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&e.$$typeof)&&!m_(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function X3(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function _$(e,t){const r=X3(e);return Math.round(t*r)/r}function P0(e){const t=C.useRef(e);return kg(()=>{t.current=e}),t}function BQ(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=C.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,f]=C.useState(n);m_(h,n)||f(n);const[p,_]=C.useState(null),[w,y]=C.useState(null),g=C.useCallback(R=>{R!==M.current&&(M.current=R,_(R))},[]),v=C.useCallback(R=>{R!==E.current&&(E.current=R,y(R))},[]),b=i||p,x=o||w,M=C.useRef(null),E=C.useRef(null),P=C.useRef(u),I=l!=null,O=P0(l),V=P0(s),U=P0(c),B=C.useCallback(()=>{if(!M.current||!E.current)return;const R={placement:t,strategy:r,middleware:h};V.current&&(R.platform=V.current),LQ(M.current,E.current,R).then(te=>{const re={...te,isPositioned:U.current!==!1};Y.current&&!m_(P.current,re)&&(P.current=re,jc.flushSync(()=>{d(re)}))})},[h,t,r,V,U]);kg(()=>{c===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,d(R=>({...R,isPositioned:!1})))},[c]);const Y=C.useRef(!1);kg(()=>(Y.current=!0,()=>{Y.current=!1}),[]),kg(()=>{if(b&&(M.current=b),x&&(E.current=x),b&&x){if(O.current)return O.current(b,x,B);B()}},[b,x,B,O,I]);const K=C.useMemo(()=>({reference:M,floating:E,setReference:g,setFloating:v}),[g,v]),X=C.useMemo(()=>({reference:b,floating:x}),[b,x]),G=C.useMemo(()=>{const R={position:r,left:0,top:0};if(!X.floating)return R;const te=_$(X.floating,u.x),re=_$(X.floating,u.y);return a?{...R,transform:"translate("+te+"px, "+re+"px)",...X3(X.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:te,top:re}},[r,a,X.floating,u.x,u.y]);return C.useMemo(()=>({...u,update:B,refs:K,elements:X,floatingStyles:G}),[u,B,K,X,G])}const zQ=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?g$({element:n.current,padding:s}).fn(r):{}:n?g$({element:n,padding:s}).fn(r):{}}}},VQ=(e,t)=>({...OQ(e),options:[e,t]}),UQ=(e,t)=>({...jQ(e),options:[e,t]}),WQ=(e,t)=>({...FQ(e),options:[e,t]}),GQ=(e,t)=>({...DQ(e),options:[e,t]}),HQ=(e,t)=>({...NQ(e),options:[e,t]}),KQ=(e,t)=>({...RQ(e),options:[e,t]}),qQ=(e,t)=>({...zQ(e),options:[e,t]});var QQ="Arrow",J3=C.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...i}=e;return m.jsx(Nt.svg,{...i,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:m.jsx("polygon",{points:"0,0 30,0 15,10"})})});J3.displayName=QQ;var YQ=J3;function XQ(e,t=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];function c(d){const{scope:h,children:f,...p}=d,_=(h==null?void 0:h[e][l])||a,w=C.useMemo(()=>p,Object.values(p));return m.jsx(_.Provider,{value:w,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=C.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[e])||i;return C.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[n,JQ(s,...t)]}function JQ(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return C.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Z3(e){const[t,r]=C.useState(void 0);return Fn(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=e.offsetWidth,a=e.offsetHeight;r({width:o,height:a})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var zM="Popper",[eB,fy]=XQ(zM),[ZQ,tB]=eB(zM),rB=e=>{const{__scopePopper:t,children:r}=e,[n,s]=C.useState(null);return m.jsx(ZQ,{scope:t,anchor:n,onAnchorChange:s,children:r})};rB.displayName=zM;var nB="PopperAnchor",sB=C.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,i=tB(nB,r),o=C.useRef(null),a=kr(t,o);return C.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:m.jsx(Nt.div,{...s,ref:a})});sB.displayName=nB;var VM="PopperContent",[eY,tY]=eB(VM),iB=C.forwardRef((e,t)=>{var fe,Pe,Ne,de,Q,se;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,..._}=e,w=tB(VM,r),[y,g]=C.useState(null),v=kr(t,J=>g(J)),[b,x]=C.useState(null),M=Z3(b),E=(M==null?void 0:M.width)??0,P=(M==null?void 0:M.height)??0,I=n+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},V=Array.isArray(c)?c:[c],U=V.length>0,B={padding:O,boundary:V.filter(nY),altBoundary:U},{refs:Y,floatingStyles:K,placement:X,isPositioned:G,middlewareData:R}=BQ({strategy:"fixed",placement:I,whileElementsMounted:(...J)=>IQ(...J,{animationFrame:f==="always"}),elements:{reference:w.anchor},middleware:[VQ({mainAxis:s+P,alignmentAxis:o}),l&&UQ({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?WQ():void 0,...B}),l&&GQ({...B}),HQ({...B,apply:({elements:J,rects:be,availableWidth:xe,availableHeight:Te})=>{const{width:Ee,height:$e}=be.reference,Ie=J.floating.style;Ie.setProperty("--radix-popper-available-width",`${xe}px`),Ie.setProperty("--radix-popper-available-height",`${Te}px`),Ie.setProperty("--radix-popper-anchor-width",`${Ee}px`),Ie.setProperty("--radix-popper-anchor-height",`${$e}px`)}}),b&&qQ({element:b,padding:a}),sY({arrowWidth:E,arrowHeight:P}),h&&KQ({strategy:"referenceHidden",...B})]}),[te,re]=lB(X),L=ms(p);Fn(()=>{G&&(L==null||L())},[G,L]);const j=(fe=R.arrow)==null?void 0:fe.x,q=(Pe=R.arrow)==null?void 0:Pe.y,ne=((Ne=R.arrow)==null?void 0:Ne.centerOffset)!==0,[me,ae]=C.useState();return Fn(()=>{y&&ae(window.getComputedStyle(y).zIndex)},[y]),m.jsx("div",{ref:Y.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:G?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(de=R.transformOrigin)==null?void 0:de.x,(Q=R.transformOrigin)==null?void 0:Q.y].join(" "),...((se=R.hide)==null?void 0:se.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:m.jsx(eY,{scope:r,placedSide:te,onArrowChange:x,arrowX:j,arrowY:q,shouldHideArrow:ne,children:m.jsx(Nt.div,{"data-side":te,"data-align":re,..._,ref:v,style:{..._.style,animation:G?void 0:"none"}})})})});iB.displayName=VM;var oB="PopperArrow",rY={top:"bottom",right:"left",bottom:"top",left:"right"},aB=C.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,i=tY(oB,n),o=rY[i.placedSide];return m.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:m.jsx(YQ,{...s,ref:r,style:{...s.style,display:"block"}})})});aB.displayName=oB;function nY(e){return e!==null}var sY=e=>({name:"transformOrigin",options:e,fn(t){var w,y,g;const{placement:r,rects:n,middlewareData:s}=t,o=((w=s.arrow)==null?void 0:w.centerOffset)!==0,a=o?0:e.arrowWidth,l=o?0:e.arrowHeight,[c,u]=lB(r),d={start:"0%",center:"50%",end:"100%"}[u],h=(((y=s.arrow)==null?void 0:y.x)??0)+a/2,f=(((g=s.arrow)==null?void 0:g.y)??0)+l/2;let p="",_="";return c==="bottom"?(p=o?d:`${h}px`,_=`${-l}px`):c==="top"?(p=o?d:`${h}px`,_=`${n.floating.height+l}px`):c==="right"?(p=`${-l}px`,_=o?d:`${f}px`):c==="left"&&(p=`${n.floating.width+l}px`,_=o?d:`${f}px`),{data:{x:p,y:_}}}});function lB(e){const[t,r="center"]=e.split("-");return[t,r]}var iY=rB,cB=sB,uB=iB,dB=aB,[py,Fhe]=Dc("Tooltip",[fy]),UM=fy(),hB="TooltipProvider",oY=700,y$="tooltip.open",[aY,fB]=py(hB),pB=e=>{const{__scopeTooltip:t,delayDuration:r=oY,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=e,[o,a]=C.useState(!0),l=C.useRef(!1),c=C.useRef(0);return C.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),m.jsx(aY,{scope:t,isOpenDelayed:o,delayDuration:r,onOpen:C.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:C.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:C.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};pB.displayName=hB;var mB="Tooltip",[Lhe,my]=py(mB),wx="TooltipTrigger",lY=C.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=my(wx,r),i=fB(wx,r),o=UM(r),a=C.useRef(null),l=kr(t,a,s.onTriggerChange),c=C.useRef(!1),u=C.useRef(!1),d=C.useCallback(()=>c.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),m.jsx(cB,{asChild:!0,...o,children:m.jsx(Nt.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:l,onPointerMove:Ct(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Ct(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Ct(e.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Ct(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Ct(e.onBlur,s.onClose),onClick:Ct(e.onClick,s.onClose)})})});lY.displayName=wx;var cY="TooltipPortal",[Bhe,uY]=py(cY,{forceMount:void 0}),pd="TooltipContent",gB=C.forwardRef((e,t)=>{const r=uY(pd,e.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=e,o=my(pd,e.__scopeTooltip);return m.jsx(al,{present:n||o.open,children:o.disableHoverableContent?m.jsx(_B,{side:s,...i,ref:t}):m.jsx(dY,{side:s,...i,ref:t})})}),dY=C.forwardRef((e,t)=>{const r=my(pd,e.__scopeTooltip),n=fB(pd,e.__scopeTooltip),s=C.useRef(null),i=kr(t,s),[o,a]=C.useState(null),{trigger:l,onClose:c}=r,u=s.current,{onPointerInTransitChange:d}=n,h=C.useCallback(()=>{a(null),d(!1)},[d]),f=C.useCallback((p,_)=>{const w=p.currentTarget,y={x:p.clientX,y:p.clientY},g=mY(y,w.getBoundingClientRect()),v=gY(y,g),b=_Y(_.getBoundingClientRect()),x=vY([...v,...b]);a(x),d(!0)},[d]);return C.useEffect(()=>()=>h(),[h]),C.useEffect(()=>{if(l&&u){const p=w=>f(w,u),_=w=>f(w,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",_),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",_)}}},[l,u,f,h]),C.useEffect(()=>{if(o){const p=_=>{const w=_.target,y={x:_.clientX,y:_.clientY},g=(l==null?void 0:l.contains(w))||(u==null?void 0:u.contains(w)),v=!yY(y,o);g?h():v&&(h(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,o,c,h]),m.jsx(_B,{...e,ref:i})}),[hY,fY]=py(mB,{isInside:!1}),_B=C.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=e,l=my(pd,r),c=UM(r),{onClose:u}=l;return C.useEffect(()=>(document.addEventListener(y$,u),()=>document.removeEventListener(y$,u)),[u]),C.useEffect(()=>{if(l.trigger){const d=h=>{const f=h.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),m.jsx(cp,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:m.jsxs(uB,{"data-state":l.stateAttribute,...c,...a,ref:t,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[m.jsx(XL,{children:n}),m.jsx(hY,{scope:r,isInside:!0,children:m.jsx(nq,{id:l.contentId,role:"tooltip",children:s||n})})]})})});gB.displayName=pd;var yB="TooltipArrow",pY=C.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=UM(r);return fY(yB,r).isInside?null:m.jsx(dB,{...s,...n,ref:t})});pY.displayName=yB;function mY(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function gY(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function _Y(e){const{top:t,right:r,bottom:n,left:s}=e;return[{x:s,y:t},{x:r,y:t},{x:r,y:n},{x:s,y:n}]}function yY(e,t){const{x:r,y:n}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const a=t[i].x,l=t[i].y,c=t[o].x,u=t[o].y;l>n!=u>n&&r<(c-a)*(n-l)/(u-l)+a&&(s=!s)}return s}function vY(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),wY(t)}function wY(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const s=e[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const s=e[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var bY=pB,vB=gB;const xY=bY,MY=C.forwardRef(({className:e,sideOffset:t=4,...r},n)=>m.jsx(vB,{ref:n,sideOffset:t,className:zt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));MY.displayName=vB.displayName;var gy=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},_y=typeof window>"u"||"Deno"in globalThis;function Ni(){}function TY(e,t){return typeof e=="function"?e(t):e}function EY(e){return typeof e=="number"&&e>=0&&e!==1/0}function SY(e,t){return Math.max(e+(t||0)-Date.now(),0)}function v$(e,t){return typeof e=="function"?e(t):e}function PY(e,t){return typeof e=="function"?e(t):e}function w$(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:o,stale:a}=e;if(o){if(n){if(t.queryHash!==WM(o,t.options))return!1}else if(!Bf(t.queryKey,o))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||s&&s!==t.state.fetchStatus||i&&!i(t))}function b$(e,t){const{exact:r,status:n,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Lf(t.options.mutationKey)!==Lf(i))return!1}else if(!Bf(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function WM(e,t){return((t==null?void 0:t.queryKeyHashFn)||Lf)(e)}function Lf(e){return JSON.stringify(e,(t,r)=>bx(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Bf(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!Bf(e[r],t[r])):!1}function wB(e,t){if(e===t)return e;const r=x$(e)&&x$(t);if(r||bx(e)&&bx(t)){const n=r?e:Object.keys(e),s=n.length,i=r?t:Object.keys(t),o=i.length,a=r?[]:{};let l=0;for(let c=0;c<o;c++){const u=r?c:i[c];(!r&&n.includes(u)||r)&&e[u]===void 0&&t[u]===void 0?(a[u]=void 0,l++):(a[u]=wB(e[u],t[u]),a[u]===e[u]&&e[u]!==void 0&&l++)}return s===o&&l===s?e:a}return t}function x$(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function bx(e){if(!M$(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!M$(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function M$(e){return Object.prototype.toString.call(e)==="[object Object]"}function CY(e){return new Promise(t=>{setTimeout(t,e)})}function kY(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?wB(e,t):t}function AY(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function $Y(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var GM=Symbol();function bB(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===GM?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ac,ka,Yu,ER,IY=(ER=class extends gy{constructor(){super();yr(this,ac);yr(this,ka);yr(this,Yu);Kt(this,Yu,t=>{if(!_y&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Le(this,ka)||this.setEventListener(Le(this,Yu))}onUnsubscribe(){var t;this.hasListeners()||((t=Le(this,ka))==null||t.call(this),Kt(this,ka,void 0))}setEventListener(t){var r;Kt(this,Yu,t),(r=Le(this,ka))==null||r.call(this),Kt(this,ka,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){Le(this,ac)!==t&&(Kt(this,ac,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Le(this,ac)=="boolean"?Le(this,ac):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ac=new WeakMap,ka=new WeakMap,Yu=new WeakMap,ER),xB=new IY,Xu,Aa,Ju,SR,OY=(SR=class extends gy{constructor(){super();yr(this,Xu,!0);yr(this,Aa);yr(this,Ju);Kt(this,Ju,t=>{if(!_y&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Le(this,Aa)||this.setEventListener(Le(this,Ju))}onUnsubscribe(){var t;this.hasListeners()||((t=Le(this,Aa))==null||t.call(this),Kt(this,Aa,void 0))}setEventListener(t){var r;Kt(this,Ju,t),(r=Le(this,Aa))==null||r.call(this),Kt(this,Aa,t(this.setOnline.bind(this)))}setOnline(t){Le(this,Xu)!==t&&(Kt(this,Xu,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return Le(this,Xu)}},Xu=new WeakMap,Aa=new WeakMap,Ju=new WeakMap,SR),g_=new OY;function jY(){let e,t;const r=new Promise((s,i)=>{e=s,t=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function DY(e){return Math.min(1e3*2**e,3e4)}function MB(e){return(e??"online")==="online"?g_.isOnline():!0}var TB=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function C0(e){return e instanceof TB}function EB(e){let t=!1,r=0,n=!1,s;const i=jY(),o=_=>{var w;n||(h(new TB(_)),(w=e.abort)==null||w.call(e))},a=()=>{t=!0},l=()=>{t=!1},c=()=>xB.isFocused()&&(e.networkMode==="always"||g_.isOnline())&&e.canRun(),u=()=>MB(e.networkMode)&&e.canRun(),d=_=>{var w;n||(n=!0,(w=e.onSuccess)==null||w.call(e,_),s==null||s(),i.resolve(_))},h=_=>{var w;n||(n=!0,(w=e.onError)==null||w.call(e,_),s==null||s(),i.reject(_))},f=()=>new Promise(_=>{var w;s=y=>{(n||c())&&_(y)},(w=e.onPause)==null||w.call(e)}).then(()=>{var _;s=void 0,n||(_=e.onContinue)==null||_.call(e)}),p=()=>{if(n)return;let _;const w=r===0?e.initialPromise:void 0;try{_=w??e.fn()}catch(y){_=Promise.reject(y)}Promise.resolve(_).then(d).catch(y=>{var M;if(n)return;const g=e.retry??(_y?0:3),v=e.retryDelay??DY,b=typeof v=="function"?v(r,y):v,x=g===!0||typeof g=="number"&&r<g||typeof g=="function"&&g(r,y);if(t||!x){h(y);return}r++,(M=e.onFail)==null||M.call(e,r,y),CY(b).then(()=>c()?void 0:f()).then(()=>{t?h(y):p()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?p():f().then(p),i)}}function NY(){let e=[],t=0,r=a=>{a()},n=a=>{a()},s=a=>setTimeout(a,0);const i=a=>{t?e.push(a):s(()=>{r(a)})},o=()=>{const a=e;e=[],a.length&&s(()=>{n(()=>{a.forEach(l=>{r(l)})})})};return{batch:a=>{let l;t++;try{l=a()}finally{t--,t||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{r=a},setBatchNotifyFunction:a=>{n=a},setScheduler:a=>{s=a}}}var ds=NY(),lc,PR,SB=(PR=class{constructor(){yr(this,lc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),EY(this.gcTime)&&Kt(this,lc,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(_y?1/0:5*60*1e3))}clearGcTimeout(){Le(this,lc)&&(clearTimeout(Le(this,lc)),Kt(this,lc,void 0))}},lc=new WeakMap,PR),Zu,ed,li,Zn,rp,cc,Fi,zo,CR,RY=(CR=class extends SB{constructor(t){super();yr(this,Fi);yr(this,Zu);yr(this,ed);yr(this,li);yr(this,Zn);yr(this,rp);yr(this,cc);Kt(this,cc,!1),Kt(this,rp,t.defaultOptions),this.setOptions(t.options),this.observers=[],Kt(this,li,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Kt(this,Zu,LY(this.options)),this.state=t.state??Le(this,Zu),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Le(this,Zn))==null?void 0:t.promise}setOptions(t){this.options={...Le(this,rp),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Le(this,li).remove(this)}setData(t,r){const n=kY(this.state.data,t,this.options);return Yn(this,Fi,zo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Yn(this,Fi,zo).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=Le(this,Zn))==null?void 0:n.promise;return(s=Le(this,Zn))==null||s.cancel(t),r?r.then(Ni).catch(Ni):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Le(this,Zu))}isActive(){return this.observers.some(t=>PY(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===GM||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!SY(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Le(this,Zn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Le(this,Zn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Le(this,li).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Le(this,Zn)&&(Le(this,cc)?Le(this,Zn).cancel({revert:!0}):Le(this,Zn).cancelRetry()),this.scheduleGc()),Le(this,li).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Yn(this,Fi,zo).call(this,{type:"invalidate"})}fetch(t,r){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Le(this,Zn))return Le(this,Zn).continueRetry(),Le(this,Zn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const n=new AbortController,s=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(Kt(this,cc,!0),n.signal)})},i=()=>{const d=bB(this.options,r),h={queryKey:this.queryKey,meta:this.meta};return s(h),Kt(this,cc,!1),this.options.persister?this.options.persister(d,h,this):d(h)},o={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};s(o),(l=this.options.behavior)==null||l.onFetch(o,this),Kt(this,ed,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&Yn(this,Fi,zo).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta});const a=d=>{var h,f,p,_;C0(d)&&d.silent||Yn(this,Fi,zo).call(this,{type:"error",error:d}),C0(d)||((f=(h=Le(this,li).config).onError)==null||f.call(h,d,this),(_=(p=Le(this,li).config).onSettled)==null||_.call(p,this.state.data,d,this)),this.scheduleGc()};return Kt(this,Zn,EB({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onSuccess:d=>{var h,f,p,_;if(d===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(w){a(w);return}(f=(h=Le(this,li).config).onSuccess)==null||f.call(h,d,this),(_=(p=Le(this,li).config).onSettled)==null||_.call(p,d,this.state.error,this),this.scheduleGc()},onError:a,onFail:(d,h)=>{Yn(this,Fi,zo).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{Yn(this,Fi,zo).call(this,{type:"pause"})},onContinue:()=>{Yn(this,Fi,zo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),Le(this,Zn).start()}},Zu=new WeakMap,ed=new WeakMap,li=new WeakMap,Zn=new WeakMap,rp=new WeakMap,cc=new WeakMap,Fi=new WeakSet,zo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...FY(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return C0(s)&&s.revert&&Le(this,ed)?{...Le(this,ed),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),ds.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Le(this,li).notify({query:this,type:"updated",action:t})})},CR);function FY(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:MB(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function LY(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var _o,kR,BY=(kR=class extends gy{constructor(t={}){super();yr(this,_o);this.config=t,Kt(this,_o,new Map)}build(t,r,n){const s=r.queryKey,i=r.queryHash??WM(s,r);let o=this.get(i);return o||(o=new RY({cache:this,queryKey:s,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){Le(this,_o).has(t.queryHash)||(Le(this,_o).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Le(this,_o).get(t.queryHash);r&&(t.destroy(),r===t&&Le(this,_o).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ds.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Le(this,_o).get(t)}getAll(){return[...Le(this,_o).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>w$(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>w$(t,n)):r}notify(t){ds.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){ds.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ds.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_o=new WeakMap,kR),yo,ls,uc,vo,wa,AR,zY=(AR=class extends SB{constructor(t){super();yr(this,vo);yr(this,yo);yr(this,ls);yr(this,uc);this.mutationId=t.mutationId,Kt(this,ls,t.mutationCache),Kt(this,yo,[]),this.state=t.state||VY(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Le(this,yo).includes(t)||(Le(this,yo).push(t),this.clearGcTimeout(),Le(this,ls).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Kt(this,yo,Le(this,yo).filter(r=>r!==t)),this.scheduleGc(),Le(this,ls).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Le(this,yo).length||(this.state.status==="pending"?this.scheduleGc():Le(this,ls).remove(this))}continue(){var t;return((t=Le(this,uc))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,i,o,a,l,c,u,d,h,f,p,_,w,y,g,v,b,x,M,E;Kt(this,uc,EB({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(P,I)=>{Yn(this,vo,wa).call(this,{type:"failed",failureCount:P,error:I})},onPause:()=>{Yn(this,vo,wa).call(this,{type:"pause"})},onContinue:()=>{Yn(this,vo,wa).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Le(this,ls).canRun(this)}));const r=this.state.status==="pending",n=!Le(this,uc).canStart();try{if(!r){Yn(this,vo,wa).call(this,{type:"pending",variables:t,isPaused:n}),await((i=(s=Le(this,ls).config).onMutate)==null?void 0:i.call(s,t,this));const I=await((a=(o=this.options).onMutate)==null?void 0:a.call(o,t));I!==this.state.context&&Yn(this,vo,wa).call(this,{type:"pending",context:I,variables:t,isPaused:n})}const P=await Le(this,uc).start();return await((c=(l=Le(this,ls).config).onSuccess)==null?void 0:c.call(l,P,t,this.state.context,this)),await((d=(u=this.options).onSuccess)==null?void 0:d.call(u,P,t,this.state.context)),await((f=(h=Le(this,ls).config).onSettled)==null?void 0:f.call(h,P,null,this.state.variables,this.state.context,this)),await((_=(p=this.options).onSettled)==null?void 0:_.call(p,P,null,t,this.state.context)),Yn(this,vo,wa).call(this,{type:"success",data:P}),P}catch(P){try{throw await((y=(w=Le(this,ls).config).onError)==null?void 0:y.call(w,P,t,this.state.context,this)),await((v=(g=this.options).onError)==null?void 0:v.call(g,P,t,this.state.context)),await((x=(b=Le(this,ls).config).onSettled)==null?void 0:x.call(b,void 0,P,this.state.variables,this.state.context,this)),await((E=(M=this.options).onSettled)==null?void 0:E.call(M,void 0,P,t,this.state.context)),P}finally{Yn(this,vo,wa).call(this,{type:"error",error:P})}}finally{Le(this,ls).runNext(this)}}},yo=new WeakMap,ls=new WeakMap,uc=new WeakMap,vo=new WeakSet,wa=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),ds.batch(()=>{Le(this,yo).forEach(n=>{n.onMutationUpdate(t)}),Le(this,ls).notify({mutation:this,type:"updated",action:t})})},AR);function VY(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ds,np,$R,UY=($R=class extends gy{constructor(t={}){super();yr(this,Ds);yr(this,np);this.config=t,Kt(this,Ds,new Map),Kt(this,np,Date.now())}build(t,r,n){const s=new zY({mutationCache:this,mutationId:++fm(this,np)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){const r=Dm(t),n=Le(this,Ds).get(r)??[];n.push(t),Le(this,Ds).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=Dm(t);if(Le(this,Ds).has(r)){const s=(n=Le(this,Ds).get(r))==null?void 0:n.filter(i=>i!==t);s&&(s.length===0?Le(this,Ds).delete(r):Le(this,Ds).set(r,s))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=Le(this,Ds).get(Dm(t)))==null?void 0:n.find(s=>s.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=Le(this,Ds).get(Dm(t)))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){ds.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...Le(this,Ds).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>b$(r,n))}findAll(t={}){return this.getAll().filter(r=>b$(t,r))}notify(t){ds.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return ds.batch(()=>Promise.all(t.map(r=>r.continue().catch(Ni))))}},Ds=new WeakMap,np=new WeakMap,$R);function Dm(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function T$(e){return{onFetch:(t,r)=>{var u,d,h,f,p;const n=t.options,s=(h=(d=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,i=((f=t.state.data)==null?void 0:f.pages)||[],o=((p=t.state.data)==null?void 0:p.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let _=!1;const w=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?_=!0:t.signal.addEventListener("abort",()=>{_=!0}),t.signal)})},y=bB(t.options,t.fetchOptions),g=async(v,b,x)=>{if(_)return Promise.reject();if(b==null&&v.pages.length)return Promise.resolve(v);const M={queryKey:t.queryKey,pageParam:b,direction:x?"backward":"forward",meta:t.options.meta};w(M);const E=await y(M),{maxPages:P}=t.options,I=x?$Y:AY;return{pages:I(v.pages,E,P),pageParams:I(v.pageParams,b,P)}};if(s&&i.length){const v=s==="backward",b=v?WY:E$,x={pages:i,pageParams:o},M=b(n,x);a=await g(x,M,v)}else{const v=e??i.length;do{const b=l===0?o[0]??n.initialPageParam:E$(n,a);if(l>0&&b==null)break;a=await g(a,b),l++}while(l<v)}return a};t.options.persister?t.fetchFn=()=>{var _,w;return(w=(_=t.options).persister)==null?void 0:w.call(_,c,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function E$(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function WY(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var nn,$a,Ia,td,rd,Oa,nd,sd,IR,GY=(IR=class{constructor(e={}){yr(this,nn);yr(this,$a);yr(this,Ia);yr(this,td);yr(this,rd);yr(this,Oa);yr(this,nd);yr(this,sd);Kt(this,nn,e.queryCache||new BY),Kt(this,$a,e.mutationCache||new UY),Kt(this,Ia,e.defaultOptions||{}),Kt(this,td,new Map),Kt(this,rd,new Map),Kt(this,Oa,0)}mount(){fm(this,Oa)._++,Le(this,Oa)===1&&(Kt(this,nd,xB.subscribe(async e=>{e&&(await this.resumePausedMutations(),Le(this,nn).onFocus())})),Kt(this,sd,g_.subscribe(async e=>{e&&(await this.resumePausedMutations(),Le(this,nn).onOnline())})))}unmount(){var e,t;fm(this,Oa)._--,Le(this,Oa)===0&&((e=Le(this,nd))==null||e.call(this),Kt(this,nd,void 0),(t=Le(this,sd))==null||t.call(this),Kt(this,sd,void 0))}isFetching(e){return Le(this,nn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Le(this,$a).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Le(this,nn).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=Le(this,nn).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(v$(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return Le(this,nn).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=Le(this,nn).get(n.queryHash),i=s==null?void 0:s.state.data,o=TY(t,i);if(o!==void 0)return Le(this,nn).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return ds.batch(()=>Le(this,nn).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Le(this,nn).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Le(this,nn);ds.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Le(this,nn),n={type:"active",...e};return ds.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=ds.batch(()=>Le(this,nn).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(Ni).catch(Ni)}invalidateQueries(e={},t={}){return ds.batch(()=>{if(Le(this,nn).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=ds.batch(()=>Le(this,nn).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(Ni)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Ni)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Le(this,nn).build(this,t);return r.isStaleByTime(v$(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ni).catch(Ni)}fetchInfiniteQuery(e){return e.behavior=T$(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ni).catch(Ni)}ensureInfiniteQueryData(e){return e.behavior=T$(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return g_.isOnline()?Le(this,$a).resumePausedMutations():Promise.resolve()}getQueryCache(){return Le(this,nn)}getMutationCache(){return Le(this,$a)}getDefaultOptions(){return Le(this,Ia)}setDefaultOptions(e){Kt(this,Ia,e)}setQueryDefaults(e,t){Le(this,td).set(Lf(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Le(this,td).values()];let r={};return t.forEach(n=>{Bf(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){Le(this,rd).set(Lf(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Le(this,rd).values()];let r={};return t.forEach(n=>{Bf(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Le(this,Ia).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=WM(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===GM&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Le(this,Ia).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Le(this,nn).clear(),Le(this,$a).clear()}},nn=new WeakMap,$a=new WeakMap,Ia=new WeakMap,td=new WeakMap,rd=new WeakMap,Oa=new WeakMap,nd=new WeakMap,sd=new WeakMap,IR),HY=C.createContext(void 0),KY=({client:e,children:t})=>(C.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),m.jsx(HY.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zf(){return zf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zf.apply(this,arguments)}var Na;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Na||(Na={}));const S$="popstate";function qY(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:o,hash:a}=n.location;return xx("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:__(s)}return YY(t,r,null,e)}function Yr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function PB(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function QY(){return Math.random().toString(36).substr(2,8)}function P$(e,t){return{usr:e.state,key:e.key,idx:t}}function xx(e,t,r,n){return r===void 0&&(r=null),zf({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?kd(t):t,{state:r,key:t&&t.key||n||QY()})}function __(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function kd(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function YY(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,a=Na.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(zf({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Na.Pop;let w=u(),y=w==null?null:w-c;c=w,l&&l({action:a,location:_.location,delta:y})}function h(w,y){a=Na.Push;let g=xx(_.location,w,y);c=u()+1;let v=P$(g,c),b=_.createHref(g);try{o.pushState(v,"",b)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;s.location.assign(b)}i&&l&&l({action:a,location:_.location,delta:1})}function f(w,y){a=Na.Replace;let g=xx(_.location,w,y);c=u();let v=P$(g,c),b=_.createHref(g);o.replaceState(v,"",b),i&&l&&l({action:a,location:_.location,delta:0})}function p(w){let y=s.location.origin!=="null"?s.location.origin:s.location.href,g=typeof w=="string"?w:__(w);return g=g.replace(/ $/,"%20"),Yr(y,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,y)}let _={get action(){return a},get location(){return e(s,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(S$,d),l=w,()=>{s.removeEventListener(S$,d),l=null}},createHref(w){return t(s,w)},createURL:p,encodeLocation(w){let y=p(w);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:f,go(w){return o.go(w)}};return _}var C$;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(C$||(C$={}));function XY(e,t,r){return r===void 0&&(r="/"),JY(e,t,r,!1)}function JY(e,t,r,n){let s=typeof t=="string"?kd(t):t,i=md(s.pathname||"/",r);if(i==null)return null;let o=CB(e);ZY(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=uX(i);a=lX(o[l],c,n)}return a}function CB(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Yr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ha([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(Yr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),CB(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:oX(c,i.index),routesMeta:u})};return e.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of kB(i.path))s(i,o,l)}),t}function kB(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=kB(n.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>e.startsWith("/")&&l===""?"/":l)}function ZY(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:aX(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const eX=/^:[\w-]+$/,tX=3,rX=2,nX=1,sX=10,iX=-2,k$=e=>e==="*";function oX(e,t){let r=e.split("/"),n=r.length;return r.some(k$)&&(n+=iX),t&&(n+=rX),r.filter(s=>!k$(s)).reduce((s,i)=>s+(eX.test(i)?tX:i===""?nX:sX),n)}function aX(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function lX(e,t,r){let{routesMeta:n}=e,s={},i="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",d=y_({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=y_({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:Ha([i,d.pathname]),pathnameBase:pX(Ha([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=Ha([i,d.pathnameBase]))}return o}function y_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=cX(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let _=a[d]||"";o=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?c[h]=void 0:c[h]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:e}}function cX(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),PB(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function uX(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return PB(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function md(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function dX(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?kd(e):e;return{pathname:r?r.startsWith("/")?r:hX(r,t):t,search:mX(n),hash:gX(s)}}function hX(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function k0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fX(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function HM(e,t){let r=fX(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function KM(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=kd(e):(s=zf({},e),Yr(!s.pathname||!s.pathname.includes("?"),k0("?","pathname","search",s)),Yr(!s.pathname||!s.pathname.includes("#"),k0("#","pathname","hash",s)),Yr(!s.search||!s.search.includes("#"),k0("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=r;else{let d=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}a=d>=0?t[d]:"/"}let l=dX(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ha=e=>e.join("/").replace(/\/\/+/g,"/"),pX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),mX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,gX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function _X(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const AB=["post","put","patch","delete"];new Set(AB);const yX=["get",...AB];new Set(yX);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vf.apply(this,arguments)}const yy=C.createContext(null),$B=C.createContext(null),sa=C.createContext(null),vy=C.createContext(null),jo=C.createContext({outlet:null,matches:[],isDataRoute:!1}),IB=C.createContext(null);function vX(e,t){let{relative:r}=t===void 0?{}:t;Ad()||Yr(!1);let{basename:n,navigator:s}=C.useContext(sa),{hash:i,pathname:o,search:a}=wy(e,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:Ha([n,o])),s.createHref({pathname:l,search:a,hash:i})}function Ad(){return C.useContext(vy)!=null}function Nc(){return Ad()||Yr(!1),C.useContext(vy).location}function OB(e){C.useContext(sa).static||C.useLayoutEffect(e)}function Ys(){let{isDataRoute:e}=C.useContext(jo);return e?jX():wX()}function wX(){Ad()||Yr(!1);let e=C.useContext(yy),{basename:t,future:r,navigator:n}=C.useContext(sa),{matches:s}=C.useContext(jo),{pathname:i}=Nc(),o=JSON.stringify(HM(s,r.v7_relativeSplatPath)),a=C.useRef(!1);return OB(()=>{a.current=!0}),C.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let d=KM(c,JSON.parse(o),i,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ha([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,o,i,e])}const bX=C.createContext(null);function xX(e){let t=C.useContext(jo).outlet;return t&&C.createElement(bX.Provider,{value:e},t)}function jB(){let{matches:e}=C.useContext(jo),t=e[e.length-1];return t?t.params:{}}function wy(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=C.useContext(sa),{matches:s}=C.useContext(jo),{pathname:i}=Nc(),o=JSON.stringify(HM(s,n.v7_relativeSplatPath));return C.useMemo(()=>KM(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function MX(e,t){return TX(e,t)}function TX(e,t,r,n){Ad()||Yr(!1);let{navigator:s}=C.useContext(sa),{matches:i}=C.useContext(jo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Nc(),u;if(t){var d;let w=typeof t=="string"?kd(t):t;l==="/"||(d=w.pathname)!=null&&d.startsWith(l)||Yr(!1),u=w}else u=c;let h=u.pathname||"/",f=h;if(l!=="/"){let w=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let p=XY(e,{pathname:f}),_=kX(p&&p.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:Ha([l,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Ha([l,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,n);return t&&_?C.createElement(vy.Provider,{value:{location:Vf({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Na.Pop}},_):_}function EX(){let e=OX(),t=_X(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,null)}const SX=C.createElement(EX,null);class PX extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?C.createElement(jo.Provider,{value:this.props.routeContext},C.createElement(IB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function CX(e){let{routeContext:t,match:r,children:n}=e,s=C.useContext(yy);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(jo.Provider,{value:t},n)}function kX(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,a=(s=r)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||Yr(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=r,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,h)=>{let f,p=!1,_=null,w=null;r&&(f=a&&d.route.id?a[d.route.id]:void 0,_=d.route.errorElement||SX,l&&(c<0&&h===0?(p=!0,w=null):c===h&&(p=!0,w=d.route.hydrateFallbackElement||null)));let y=t.concat(o.slice(0,h+1)),g=()=>{let v;return f?v=_:p?v=w:d.route.Component?v=C.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=u,C.createElement(CX,{match:d,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:v})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?C.createElement(PX,{location:r.location,revalidation:r.revalidation,component:_,error:f,children:g(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):g()},null)}var DB=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DB||{}),v_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(v_||{});function AX(e){let t=C.useContext(yy);return t||Yr(!1),t}function $X(e){let t=C.useContext($B);return t||Yr(!1),t}function IX(e){let t=C.useContext(jo);return t||Yr(!1),t}function NB(e){let t=IX(),r=t.matches[t.matches.length-1];return r.route.id||Yr(!1),r.route.id}function OX(){var e;let t=C.useContext(IB),r=$X(v_.UseRouteError),n=NB(v_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function jX(){let{router:e}=AX(DB.UseNavigateStable),t=NB(v_.UseNavigateStable),r=C.useRef(!1);return OB(()=>{r.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Vf({fromRouteId:t},i)))},[e,t])}function DX(e){let{to:t,replace:r,state:n,relative:s}=e;Ad()||Yr(!1);let{future:i,static:o}=C.useContext(sa),{matches:a}=C.useContext(jo),{pathname:l}=Nc(),c=Ys(),u=KM(t,HM(a,i.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(u);return C.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:s}),[c,d,s,r,n]),null}function NX(e){return xX(e.context)}function as(e){Yr(!1)}function RX(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Na.Pop,navigator:i,static:o=!1,future:a}=e;Ad()&&Yr(!1);let l=t.replace(/^\/*/,"/"),c=C.useMemo(()=>({basename:l,navigator:i,static:o,future:Vf({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof n=="string"&&(n=kd(n));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=n,_=C.useMemo(()=>{let w=md(u,l);return w==null?null:{location:{pathname:w,search:d,hash:h,state:f,key:p},navigationType:s}},[l,u,d,h,f,p,s]);return _==null?null:C.createElement(sa.Provider,{value:c},C.createElement(vy.Provider,{children:r,value:_}))}function FX(e){let{children:t,location:r}=e;return MX(Mx(t),r)}new Promise(()=>{});function Mx(e,t){t===void 0&&(t=[]);let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let i=[...t,s];if(n.type===C.Fragment){r.push.apply(r,Mx(n.props.children,i));return}n.type!==as&&Yr(!1),!n.props.index||!n.props.children||Yr(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Mx(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w_(){return w_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w_.apply(this,arguments)}function RB(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function LX(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function BX(e,t){return e.button===0&&(!t||t==="_self")&&!LX(e)}const zX=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],VX=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],UX="6";try{window.__reactRouterVersion=UX}catch{}const WX=C.createContext({isTransitioning:!1}),GX="startTransition",A$=GR[GX];function HX(e){let{basename:t,children:r,future:n,window:s}=e,i=C.useRef();i.current==null&&(i.current=qY({window:s,v5Compat:!0}));let o=i.current,[a,l]=C.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},u=C.useCallback(d=>{c&&A$?A$(()=>l(d)):l(d)},[l,c]);return C.useLayoutEffect(()=>o.listen(u),[o,u]),C.createElement(RX,{basename:t,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const KX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,QX=C.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=t,h=RB(t,zX),{basename:f}=C.useContext(sa),p,_=!1;if(typeof c=="string"&&qX.test(c)&&(p=c,KX))try{let v=new URL(window.location.href),b=c.startsWith("//")?new URL(v.protocol+c):new URL(c),x=md(b.pathname,f);b.origin===v.origin&&x!=null?c=x+b.search+b.hash:_=!0}catch{}let w=vX(c,{relative:s}),y=XX(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:d});function g(v){n&&n(v),v.defaultPrevented||y(v)}return C.createElement("a",w_({},h,{href:p||w,onClick:_||i?n:g,ref:r,target:l}))}),kh=C.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:l,viewTransition:c,children:u}=t,d=RB(t,VX),h=wy(l,{relative:d.relative}),f=Nc(),p=C.useContext($B),{navigator:_,basename:w}=C.useContext(sa),y=p!=null&&JX(h)&&c===!0,g=_.encodeLocation?_.encodeLocation(h).pathname:h.pathname,v=f.pathname,b=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;s||(v=v.toLowerCase(),b=b?b.toLowerCase():null,g=g.toLowerCase()),b&&w&&(b=md(b,w)||b);const x=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let M=v===g||!o&&v.startsWith(g)&&v.charAt(x)==="/",E=b!=null&&(b===g||!o&&b.startsWith(g)&&b.charAt(g.length)==="/"),P={isActive:M,isPending:E,isTransitioning:y},I=M?n:void 0,O;typeof i=="function"?O=i(P):O=[i,M?"active":null,E?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(P):a;return C.createElement(QX,w_({},d,{"aria-current":I,className:O,ref:r,style:V,to:l,viewTransition:c}),typeof u=="function"?u(P):u)});var Tx;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Tx||(Tx={}));var $$;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})($$||($$={}));function YX(e){let t=C.useContext(yy);return t||Yr(!1),t}function XX(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:a}=t===void 0?{}:t,l=Ys(),c=Nc(),u=wy(e,{relative:o});return C.useCallback(d=>{if(BX(d,r)){d.preventDefault();let h=n!==void 0?n:__(c)===__(u);l(e,{replace:h,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,n,s,r,e,i,o,a])}function JX(e,t){t===void 0&&(t={});let r=C.useContext(WX);r==null&&Yr(!1);let{basename:n}=YX(Tx.useViewTransitionState),s=wy(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=md(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=md(r.nextLocation.pathname,n)||r.nextLocation.pathname;return y_(s.pathname,o)!=null||y_(s.pathname,i)!=null}var Ex=function(e,t){return Ex=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Ex(e,t)};function FB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ex(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var di=function(){return di=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},di.apply(this,arguments)};function ll(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function LB(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i}function BB(e,t){return function(r,n){t(r,n,e)}}function zB(e,t,r,n,s,i){function o(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var a=n.kind,l=a==="getter"?"get":a==="setter"?"set":"value",c=!t&&e?n.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d,h=!1,f=r.length-1;f>=0;f--){var p={};for(var _ in n)p[_]=_==="access"?{}:n[_];for(var _ in n.access)p.access[_]=n.access[_];p.addInitializer=function(y){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(y||null))};var w=(0,r[f])(a==="accessor"?{get:u.get,set:u.set}:u[l],p);if(a==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(d=o(w.get))&&(u.get=d),(d=o(w.set))&&(u.set=d),(d=o(w.init))&&s.unshift(d)}else(d=o(w))&&(a==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,n.name,u),h=!0}function VB(e,t,r){for(var n=arguments.length>2,s=0;s<t.length;s++)r=n?t[s].call(e,r):t[s].call(e);return n?r:void 0}function UB(e){return typeof e=="symbol"?e:"".concat(e)}function WB(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function GB(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function wt(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(d){o(d)}}function l(u){try{c(n.throw(u))}catch(d){o(d)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(e,t||[])).next())})}function HB(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(n=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,s=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],s=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var by=Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function KB(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&by(t,e,r)}function b_(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function qM(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function qB(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(qM(arguments[t]));return e}function QB(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function QM(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function gd(e){return this instanceof gd?(this.v=e,this):new gd(e)}function YB(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){n[f]&&(s[f]=function(_){return new Promise(function(w,y){i.push([f,_,w,y])>1||l(f,_)})},p&&(s[f]=p(s[f])))}function l(f,p){try{c(n[f](p))}catch(_){h(i[0][3],_)}}function c(f){f.value instanceof gd?Promise.resolve(f.value.v).then(u,d):h(i[0][2],f)}function u(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),i.shift(),i.length&&l(i[0][0],i[0][1])}}function XB(e){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,i){t[s]=e[s]?function(o){return(r=!r)?{value:gd(e[s](o)),done:!1}:i?i(o):o}:i}}function JB(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof b_=="function"?b_(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(o){return new Promise(function(a,l){o=e[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},o)}}function ZB(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var ZX=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Sx=function(e){return Sx=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Sx(e)};function ez(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Sx(e),n=0;n<r.length;n++)r[n]!=="default"&&by(t,e,r[n]);return ZX(t,e),t}function tz(e){return e&&e.__esModule?e:{default:e}}function rz(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function nz(e,t,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(e,r):s?s.value=r:t.set(e,r),r}function sz(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function iz(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var eJ=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function oz(e){function t(i){e.error=e.hasError?new eJ(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var r,n=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(s,function(o){return t(o),s()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}function az(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,s,i,o){return n?t?".jsx":".js":s&&(!i||!o)?r:s+i+"."+o.toLowerCase()+"js"}):e}const tJ={__extends:FB,__assign:di,__rest:ll,__decorate:LB,__param:BB,__esDecorate:zB,__runInitializers:VB,__propKey:UB,__setFunctionName:WB,__metadata:GB,__awaiter:wt,__generator:HB,__createBinding:by,__exportStar:KB,__values:b_,__read:qM,__spread:qB,__spreadArrays:QB,__spreadArray:QM,__await:gd,__asyncGenerator:YB,__asyncDelegator:XB,__asyncValues:JB,__makeTemplateObject:ZB,__importStar:ez,__importDefault:tz,__classPrivateFieldGet:rz,__classPrivateFieldSet:nz,__classPrivateFieldIn:sz,__addDisposableResource:iz,__disposeResources:oz,__rewriteRelativeImportExtension:az},rJ=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:iz,get __assign(){return di},__asyncDelegator:XB,__asyncGenerator:YB,__asyncValues:JB,__await:gd,__awaiter:wt,__classPrivateFieldGet:rz,__classPrivateFieldIn:sz,__classPrivateFieldSet:nz,__createBinding:by,__decorate:LB,__disposeResources:oz,__esDecorate:zB,__exportStar:KB,__extends:FB,__generator:HB,__importDefault:tz,__importStar:ez,__makeTemplateObject:ZB,__metadata:GB,__param:BB,__propKey:UB,__read:qM,__rest:ll,__rewriteRelativeImportExtension:az,__runInitializers:VB,__setFunctionName:WB,__spread:qB,__spreadArray:QM,__spreadArrays:QB,__values:b_,default:tJ},Symbol.toStringTag,{value:"Module"})),nJ="modulepreload",sJ=function(e){return"/"+e},I$={},$d=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=sJ(l),l in I$)return;I$[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":nJ,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})},iJ=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$d(async()=>{const{default:n}=await Promise.resolve().then(()=>Rc);return{default:n}},[]).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class YM extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class O$ extends YM{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class j$ extends YM{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class D$ extends YM{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Px;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Px||(Px={}));class oJ{constructor(t,{headers:r={},customFetch:n,region:s=Px.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=iJ(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return wt(this,arguments,void 0,function*(r,n={}){var s;try{const{headers:i,method:o,body:a,signal:l}=n;let c={},{region:u}=n;u||(u=this.region);const d=new URL(`${this.url}/${r}`);u&&u!=="any"&&(c["x-region"]=u,d.searchParams.set("forceFunctionRegion",u));let h;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=a):typeof a=="string"?(c["Content-Type"]="text/plain",h=a):typeof FormData<"u"&&a instanceof FormData?h=a:(c["Content-Type"]="application/json",h=JSON.stringify(a)):h=a;const f=yield this.fetch(d.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),i),body:h,signal:l}).catch(y=>{throw y.name==="AbortError"?y:new O$(y)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new j$(f);if(!f.ok)throw new D$(f);let _=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),w;return _==="application/json"?w=yield f.json():_==="application/octet-stream"||_==="application/pdf"?w=yield f.blob():_==="text/event-stream"?w=f:_==="multipart/form-data"?w=yield f.formData():w=yield f.text(),{data:w,error:null,response:f}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new O$(i)}:{data:null,error:i,response:i instanceof D$||i instanceof j$?i.context:void 0}}})}}var bs={};const Id=jR(rJ);var Nm={},Rm={},Fm={},Lm={},Bm={},aJ=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_d=aJ();const lJ=_d.fetch,lz=_d.fetch.bind(_d),cz=_d.Headers,cJ=_d.Request,uJ=_d.Response,Rc=Object.freeze(Object.defineProperty({__proto__:null,Headers:cz,Request:cJ,Response:uJ,default:lz,fetch:lJ},Symbol.toStringTag,{value:"Module"})),dJ=jR(Rc);var zm={},N$;function uz(){if(N$)return zm;N$=1,Object.defineProperty(zm,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return zm.default=e,zm}var R$;function dz(){if(R$)return Bm;R$=1,Object.defineProperty(Bm,"__esModule",{value:!0});const e=Id,t=e.__importDefault(dJ),r=e.__importDefault(uz());class n{constructor(i){var o,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(o=i.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=new Headers(this.headers),this.headers.set(i,o),this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h,f;let p=null,_=null,w=null,y=c.status,g=c.statusText;if(c.ok){if(this.method!=="HEAD"){const M=await c.text();M===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?_=M:_=JSON.parse(M))}const b=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),x=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");b&&x&&x.length>1&&(w=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(p={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,w=null,y=406,g="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const b=await c.text();try{p=JSON.parse(b),Array.isArray(p)&&c.status===404&&(_=[],p=null,y=200,g="OK")}catch{c.status===404&&b===""?(y=204,g="No Content"):p={message:b}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,y=200,g="OK"),p&&this.shouldThrowOnError)throw new r.default(p)}return{error:p,data:_,count:w,status:y,statusText:g}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return Bm.default=n,Bm}var F$;function hz(){if(F$)return Lm;F$=1,Object.defineProperty(Lm,"__esModule",{value:!0});const t=Id.__importDefault(dz());class r extends t.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const d=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${h}"; options=${d};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Lm.default=r,Lm}var L$;function XM(){if(L$)return Fm;L$=1,Object.defineProperty(Fm,"__esModule",{value:!0});const t=Id.__importDefault(hz());class r extends t.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${l}fts${c}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return Fm.default=r,Fm}var B$;function fz(){if(B$)return Rm;B$=1,Object.defineProperty(Rm,"__esModule",{value:!0});const t=Id.__importDefault(XM());class r{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=new Headers(i),this.schema=o,this.fetch=a}select(s,i){const{head:o=!1,count:a}=i??{},l=o?"HEAD":"GET";let c=!1;const u=(s??"*").split("").map(d=>/\s/.test(d)&&!c?"":(d==='"'&&(c=!c),d)).join("");return this.url.searchParams.set("select",u),a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:o=!0}={}){var a;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const c=s.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(d.length>0){const h=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(s,{count:i}={}){var o;const a="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var i;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Rm.default=r,Rm}var z$;function hJ(){if(z$)return Nm;z$=1,Object.defineProperty(Nm,"__esModule",{value:!0});const e=Id,t=e.__importDefault(fz()),r=e.__importDefault(XM());class n{constructor(i,{headers:o={},schema:a,fetch:l}={}){this.url=i,this.headers=new Headers(o),this.schemaName=a,this.fetch=l}from(i){const o=new URL(`${this.url}/${i}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:a=!1,get:l=!1,count:c}={}){var u;let d;const h=new URL(`${this.url}/rpc/${i}`);let f;a||l?(d=a?"HEAD":"GET",Object.entries(o).filter(([_,w])=>w!==void 0).map(([_,w])=>[_,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([_,w])=>{h.searchParams.append(_,w)})):(d="POST",f=o);const p=new Headers(this.headers);return c&&p.set("Prefer",`count=${c}`),new r.default({method:d,url:h,headers:p,schema:this.schemaName,body:f,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return Nm.default=n,Nm}Object.defineProperty(bs,"__esModule",{value:!0});bs.PostgrestError=bs.PostgrestBuilder=bs.PostgrestTransformBuilder=bs.PostgrestFilterBuilder=bs.PostgrestQueryBuilder=bs.PostgrestClient=void 0;const Od=Id,pz=Od.__importDefault(hJ());bs.PostgrestClient=pz.default;const mz=Od.__importDefault(fz());bs.PostgrestQueryBuilder=mz.default;const gz=Od.__importDefault(XM());bs.PostgrestFilterBuilder=gz.default;const _z=Od.__importDefault(hz());bs.PostgrestTransformBuilder=_z.default;const yz=Od.__importDefault(dz());bs.PostgrestBuilder=yz.default;const vz=Od.__importDefault(uz());bs.PostgrestError=vz.default;var fJ=bs.default={PostgrestClient:pz.default,PostgrestQueryBuilder:mz.default,PostgrestFilterBuilder:gz.default,PostgrestTransformBuilder:_z.default,PostgrestBuilder:yz.default,PostgrestError:vz.default};const{PostgrestClient:pJ,PostgrestQueryBuilder:zhe,PostgrestFilterBuilder:Vhe,PostgrestTransformBuilder:Uhe,PostgrestBuilder:Whe,PostgrestError:Ghe}=fJ;class mJ{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const gJ="2.76.1",_J=`realtime-js/${gJ}`,yJ="1.0.0",Cx=1e4,vJ=1e3,wJ=100;var df;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(df||(df={}));var Pn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Pn||(Pn={}));var Bi;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Bi||(Bi={}));var kx;(function(e){e.websocket="websocket"})(kx||(kx={}));var Yl;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Yl||(Yl={}));class bJ{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(t.slice(o,o+s));o=o+s;const l=n.decode(t.slice(o,o+i));o=o+i;const c=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class wz{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var jr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(jr||(jr={}));const V$=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=xJ(o,e,t,s),i),{}):{}},xJ=(e,t,r,n)=>{const s=t.find(a=>a.name===e),i=s==null?void 0:s.type,o=r[e];return i&&!n.includes(i)?bz(i,o):Ax(o)},bz=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return SJ(t,r)}switch(e){case jr.bool:return MJ(t);case jr.float4:case jr.float8:case jr.int2:case jr.int4:case jr.int8:case jr.numeric:case jr.oid:return TJ(t);case jr.json:case jr.jsonb:return EJ(t);case jr.timestamp:return PJ(t);case jr.abstime:case jr.date:case jr.daterange:case jr.int4range:case jr.int8range:case jr.money:case jr.reltime:case jr.text:case jr.time:case jr.timestamptz:case jr.timetz:case jr.tsrange:case jr.tstzrange:return Ax(t);default:return Ax(t)}},Ax=e=>e,MJ=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},TJ=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},EJ=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},SJ=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>bz(t,a))}return e},PJ=e=>typeof e=="string"?e.replace(" ","T"):e,xz=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class A0{constructor(t,r,n={},s=Cx){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var U$;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(U$||(U$={}));class hf{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hf.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=hf.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=hf.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const d=i[c];if(d){const h=u.map(w=>w.presence_ref),f=d.map(w=>w.presence_ref),p=u.filter(w=>f.indexOf(w.presence_ref)<0),_=d.filter(w=>h.indexOf(w.presence_ref)<0);p.length>0&&(a[c]=p),_.length>0&&(l[c]=_)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=t[a])!==null&&c!==void 0?c:[];if(t[a]=this.cloneDeep(l),u.length>0){const d=t[a].map(f=>f.presence_ref),h=u.filter(f=>d.indexOf(f.presence_ref)<0);t[a].unshift(...h)}n(a,u,l)}),this.map(o,(a,l)=>{let c=t[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[a]=c,s(a,c,l),c.length===0&&delete t[a]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var W$;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(W$||(W$={}));var ff;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ff||(ff={}));var Uo;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Uo||(Uo={}));class JM{constructor(t,r={config:{}},n){var s,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Pn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new A0(this,Bi.join,this.params,this.timeout),this.rejoinTimer=new wz(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Pn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Pn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Pn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Pn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Pn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Bi.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new hf(this),this.broadcastEndpointURL=xz(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Pn.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[ff.PRESENCE]&&this.bindings[ff.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},h={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(f=>t==null?void 0:t(Uo.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(Uo.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket.setAuth(),f===void 0){t==null||t(Uo.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(p=_==null?void 0:_.length)!==null&&p!==void 0?p:0,y=[];for(let g=0;g<w;g++){const v=_[g],{filter:{event:b,schema:x,table:M,filter:E}}=v,P=f&&f[g];if(P&&P.event===b&&P.schema===x&&P.table===M&&P.filter===E)y.push(Object.assign(Object.assign({},v),{id:P.id}));else{this.unsubscribe(),this.state=Pn.errored,t==null||t(Uo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(Uo.SUBSCRIBED);return}}).receive("error",f=>{this.state=Pn.errored,t==null||t(Uo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Uo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Pn.joined&&t===ff.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const c=await a.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Pn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Bi.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new A0(this,Bi.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Pn.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new A0(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>wJ){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const o=t.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Bi;if(n&&[a,l,c,u].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var p,_,w;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((w=(_=f.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(f=>f.callback(h,n)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,_,w,y,g,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const b=f.id,x=(p=f.filter)===null||p===void 0?void 0:p.event;return b&&((_=r.ids)===null||_===void 0?void 0:_.includes(b))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const b=(g=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return b==="*"||b===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:_,table:w,commit_timestamp:y,type:g,errors:v}=p;h=Object.assign(Object.assign({},{schema:_,table:w,commit_timestamp:y,eventType:g,new:{},old:{},errors:v}),this._getPayloadRecords(p))}f.callback(h,n)})}_isClosed(){return this.state===Pn.closed}_isJoined(){return this.state===Pn.joined}_isJoining(){return this.state===Pn.joining}_isLeaving(){return this.state===Pn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&JM.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Bi.close,{},t)}_onError(t){this._on(Bi.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Pn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=V$(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=V$(t.columns,t.old_record)),r}}const $0=()=>{},Vm={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},CJ=[1e3,2e3,5e3,1e4],kJ=1e4,AJ=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $J{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Cx,this.transport=null,this.heartbeatIntervalMs=Vm.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=$0,this.ref=0,this.reconnectTimer=null,this.logger=$0,this.conn=null,this.sendBuffer=[],this.serializer=new bJ,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>$d(async()=>{const{default:a}=await Promise.resolve().then(()=>Rc);return{default:a}},void 0).then(({default:a})=>a(...o)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${kx.websocket}`,this.httpEndpoint=xz(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=mJ.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:yJ}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case df.connecting:return Yl.Connecting;case df.open:return Yl.Open;case df.closing:return Yl.Closing;default:return Yl.Closed}}isConnected(){return this.connectionState()===Yl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new JM(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,o=()=>{this.encode(t,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(vJ,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Vm.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:o}=r,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${s} ${a}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Bi.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([AJ],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:_J};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Bi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new wz(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vm.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,o,a,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Cx,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Vm.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=t==null?void 0:t.heartbeatCallback)!==null&&a!==void 0?a:$0,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:d=>CJ[d-1]||kJ,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,h)=>h(JSON.stringify(d)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ZM extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Hr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class IJ extends ZM{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class $x extends ZM{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const eT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$d(async()=>{const{default:n}=await Promise.resolve().then(()=>Rc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},OJ=()=>wt(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $d(()=>Promise.resolve().then(()=>Rc),void 0)).Response:Response}),Ix=e=>{if(Array.isArray(e))return e.map(r=>Ix(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Ix(n)}),t},jJ=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},I0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),DJ=(e,t,r)=>wt(void 0,void 0,void 0,function*(){const n=yield OJ();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,o=(s==null?void 0:s.statusCode)||i+"";t(new IJ(I0(s),i,o))}).catch(s=>{t(new $x(I0(s),s))}):t(new $x(I0(e),e))}),NJ=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(jJ(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function hp(e,t,r,n,s,i){return wt(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(r,NJ(t,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>DJ(l,a,n))})})}function Uf(e,t,r,n){return wt(this,void 0,void 0,function*(){return hp(e,"GET",t,r,n)})}function Ri(e,t,r,n,s){return wt(this,void 0,void 0,function*(){return hp(e,"POST",t,n,s,r)})}function Ox(e,t,r,n,s){return wt(this,void 0,void 0,function*(){return hp(e,"PUT",t,n,s,r)})}function RJ(e,t,r,n){return wt(this,void 0,void 0,function*(){return hp(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function tT(e,t,r,n,s){return wt(this,void 0,void 0,function*(){return hp(e,"DELETE",t,n,s,r)})}class FJ{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return wt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Hr(t))return{data:null,error:t};throw t}})}}var Mz;class LJ{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Mz]="BlobDownloadBuilder",this.promise=null}asStream(){return new FJ(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return wt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Hr(t))return{data:null,error:t};throw t}})}}Mz=Symbol.toStringTag;const BJ={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},G$={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class zJ{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=eT(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return wt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},G$),s);let a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield(t=="PUT"?Ox:Ri)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Hr(i))return{data:null,error:i};throw i}})}upload(t,r,n){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return wt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:G$.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield Ox(this.fetch,a.toString(),l,{headers:u});return{data:{path:i,fullPath:d.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Hr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return wt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Ri(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new ZM("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Hr(n))return{data:null,error:n};throw n}})}update(t,r,n){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return wt(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Hr(s))return{data:null,error:s};throw s}})}copy(t,r,n){return wt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ri(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Hr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return wt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Ri(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Hr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return wt(this,void 0,void 0,function*(){try{const s=yield Ri(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Hr(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"",a=this._getFinalPath(t),l=()=>Uf(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0});return new LJ(l,this.shouldThrowOnError)}info(t){return wt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Uf(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ix(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Hr(n))return{data:null,error:n};throw n}})}exists(t){return wt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield RJ(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Hr(n)&&n instanceof $x){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(t){return wt(this,void 0,void 0,function*(){try{return{data:yield tT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}list(t,r,n){return wt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},BJ),r),{prefix:t||""});return{data:yield Ri(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Hr(s))return{data:null,error:s};throw s}})}listV2(t,r){return wt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Ri(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Hr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Tz="2.76.1",Ez={"X-Client-Info":`storage-js/${Tz}`};class VJ{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ez),r),this.fetch=eT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return wt(this,void 0,void 0,function*(){try{return{data:yield Uf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Hr(t))return{data:null,error:t};throw t}})}getBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:yield Uf(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}createBucket(t){return wt(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Ri(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Hr(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return wt(this,void 0,void 0,function*(){try{return{data:yield Ox(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Hr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:yield tT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}}class UJ{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ez),r),this.fetch=eT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:yield Ri(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}listBuckets(t){return wt(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`,i=yield Uf(this.fetch,s,{headers:this.headers});return{data:Array.isArray(i)?i.filter(a=>a.type==="ANALYTICS"):[],error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:yield tT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Hr(r))return{data:null,error:r};throw r}})}}const rT={"X-Client-Info":`storage-js/${Tz}`,"Content-Type":"application/json"};class Sz extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Bs(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class O0 extends Sz{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class WJ extends Sz{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var H$;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(H$||(H$={}));const nT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$d(async()=>{const{default:n}=await Promise.resolve().then(()=>Rc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},GJ=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},K$=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),HJ=(e,t,r)=>wt(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,i=e;if(typeof i.json=="function")i.json().then(o=>{const a=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||s+"";t(new O0(K$(o),s,a))}).catch(()=>{const o=s+"",a=i.statusText||`HTTP ${s} error`;t(new O0(a,s,o))});else{const o=s+"",a=i.statusText||`HTTP ${s} error`;t(new O0(a,s,o))}}else t(new WJ(K$(e),e))}),KJ=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(GJ(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r)):s};function qJ(e,t,r,n,s,i){return wt(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(r,KJ(t,n,s,i)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>HJ(l,a,n))})})}function zs(e,t,r,n,s){return wt(this,void 0,void 0,function*(){return qJ(e,"POST",t,n,s,r)})}class QJ{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rT),r),this.fetch=nT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return wt(this,void 0,void 0,function*(){try{return{data:(yield zs(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}getIndex(t,r){return wt(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bs(n))return{data:null,error:n};throw n}})}listIndexes(t){return wt(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return wt(this,void 0,void 0,function*(){try{return{data:(yield zs(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Bs(n))return{data:null,error:n};throw n}})}}class YJ{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rT),r),this.fetch=nT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return wt(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield zs(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}getVectors(t){return wt(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}listVectors(t){return wt(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield zs(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}queryVectors(t){return wt(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}deleteVectors(t){return wt(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield zs(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}}class XJ{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},rT),r),this.fetch=nT(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:(yield zs(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}getBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}listBuckets(){return wt(this,arguments,void 0,function*(t={}){try{return{data:yield zs(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}deleteBucket(t){return wt(this,void 0,void 0,function*(){try{return{data:(yield zs(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Bs(r))return{data:null,error:r};throw r}})}}class JJ extends XJ{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new ZJ(this.url,this.headers,t,this.fetch)}}class ZJ extends QJ{constructor(t,r,n,s){super(t,r,s),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return wt(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return wt(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return wt(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return wt(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new eZ(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class eZ extends YJ{constructor(t,r,n,s,i){super(t,r,i),this.vectorBucketName=n,this.indexName=s}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return wt(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return wt(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return wt(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return wt(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return wt(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class tZ extends VJ{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new zJ(this.url,this.headers,t,this.fetch)}get vectors(){return new JJ(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new UJ(this.url+"/iceberg",this.headers,this.fetch)}}const rZ="2.76.1";let Kh="";typeof Deno<"u"?Kh="deno":typeof document<"u"?Kh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Kh="react-native":Kh="node";const nZ={"X-Client-Info":`supabase-js-${Kh}/${rZ}`},sZ={headers:nZ},iZ={schema:"public"},oZ={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},aZ={},lZ=e=>{let t;return e?t=e:typeof fetch>"u"?t=lz:t=fetch,(...r)=>t(...r)},cZ=()=>typeof Headers>"u"?cz:Headers,uZ=(e,t,r)=>{const n=lZ(r),s=cZ();return async(i,o)=>{var a;const l=(a=await t())!==null&&a!==void 0?a:e;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:c}))}};function dZ(e){return e.endsWith("/")?e:e+"/"}function hZ(e,t){var r,n;const{db:s,auth:i,realtime:o,global:a}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function fZ(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(dZ(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Pz="2.76.1",mu=30*1e3,jx=3,j0=jx*mu,pZ="http://localhost:9999",mZ="supabase.auth.token",gZ={"X-Client-Info":`gotrue-js/${Pz}`},Dx="X-Supabase-Api-Version",Cz={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_Z=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yZ=10*60*1e3;class Wf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Pt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class vZ extends Wf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function wZ(e){return Pt(e)&&e.name==="AuthApiError"}class Xl extends Wf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class cl extends Wf{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class ba extends cl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bZ(e){return Pt(e)&&e.name==="AuthSessionMissingError"}class su extends cl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Um extends cl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wm extends cl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function xZ(e){return Pt(e)&&e.name==="AuthImplicitGrantRedirectError"}class q$ extends cl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nx extends cl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function D0(e){return Pt(e)&&e.name==="AuthRetryableFetchError"}class Q$ extends cl{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Rx extends cl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const x_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Y$=` 	
\r=`.split(""),MZ=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Y$.length;t+=1)e[Y$[t].charCodeAt(0)]=-2;for(let t=0;t<x_.length;t+=1)e[x_[t].charCodeAt(0)]=t;return e})();function X$(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(x_[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(x_[n]),t.queuedBits-=6}}function kz(e,t,r){const n=MZ[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function J$(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{SZ(o,n,r)};for(let o=0;o<e.length;o+=1)kz(e.charCodeAt(o),s,i);return t.join("")}function TZ(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function EZ(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}TZ(n,t)}}function SZ(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ku(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)kz(e.charCodeAt(s),r,n);return new Uint8Array(t)}function PZ(e){const t=[];return EZ(e,r=>t.push(r)),new Uint8Array(t)}function nc(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>X$(s,r,n)),X$(null,r,n),t.join("")}function CZ(e){return Math.round(Date.now()/1e3)+e}function kZ(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const js=()=>typeof window<"u"&&typeof document<"u",Rl={tested:!1,writable:!1},Az=()=>{if(!js())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rl.tested)return Rl.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Rl.tested=!0,Rl.writable=!0}catch{Rl.tested=!0,Rl.writable=!1}return Rl.writable};function AZ(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const $z=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>$d(async()=>{const{default:n}=await Promise.resolve().then(()=>Rc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},$Z=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",gu=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Fl=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ma=async(e,t)=>{await e.removeItem(t)};class xy{constructor(){this.promise=new xy.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}xy.promiseConstructor=Promise;function N0(e){const t=e.split(".");if(t.length!==3)throw new Rx("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!_Z.test(t[n]))throw new Rx("JWT not in base64url format");return{header:JSON.parse(J$(t[0])),payload:JSON.parse(J$(t[1])),signature:Ku(t[2]),raw:{header:t[0],payload:t[1]}}}async function IZ(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function OZ(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function jZ(e){return("0"+e.toString(16)).substr(-2)}function DZ(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,jZ).join("")}async function NZ(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function RZ(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await NZ(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function iu(e,t,r=!1){const n=DZ();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await gu(e,`${t}-code-verifier`,s);const i=await RZ(n);return[i,n===i?"plain":"s256"]}const FZ=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function LZ(e){const t=e.headers.get(Dx);if(!t||!t.match(FZ))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function BZ(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function zZ(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const VZ=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ou(e){if(!VZ.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function R0(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Z$(e){return JSON.parse(JSON.stringify(e))}const Hl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),UZ=[502,503,504];async function eI(e){var t;if(!$Z(e))throw new Nx(Hl(e),0);if(UZ.includes(e.status))throw new Nx(Hl(e),e.status);let r;try{r=await e.json()}catch(i){throw new Xl(Hl(i),i)}let n;const s=LZ(e);if(s&&s.getTime()>=Cz["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Q$(Hl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ba}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Q$(Hl(r),e.status,r.weak_password.reasons);throw new vZ(Hl(r),e.status||500,n)}const WZ=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Vt(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Dx]||(i[Dx]=Cz["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await GZ(e,t,r+a,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function GZ(e,t,r,n,s,i){const o=WZ(t,n,s,i);let a;try{a=await e(r,Object.assign({},o))}catch(l){throw console.error(l),new Nx(Hl(l),0)}if(a.ok||await eI(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await eI(l)}}function Ii(e){var t;let r=null;qZ(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=CZ(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function tI(e){const t=Ii(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ca(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function HZ(e){return{data:e,error:null}}function KZ(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,o=ll(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function rI(e){return e}function qZ(e){return e.access_token&&e.refresh_token&&e.expires_in}const F0=["global","local","others"];class QZ{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=$z(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=F0[0]){if(F0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${F0.join(", ")}`);try{return await Vt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Vt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ca})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ll(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Vt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:KZ,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ca})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Vt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:rI});if(u.error)throw u.error;const d=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const _=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(p.split(";")[1].split("=")[1]);c[`${w}Page`]=_}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Pt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){ou(t);try{return await Vt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ca})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ou(t);try{return await Vt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ca})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ou(t);try{return await Vt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ca})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ou(t.userId);try{const{data:r,error:n}=await Vt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ou(t.userId),ou(t.id);try{return{data:await Vt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Vt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:rI});if(u.error)throw u.error;const d=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const _=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(p.split(";")[1].split("=")[1]);c[`${w}Page`]=_}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Pt(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Vt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await Vt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}}function nI(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const au={debug:!!(globalThis&&Az()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Iz extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class YZ extends Iz{}async function XZ(e,t,r){au.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),au.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){au.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{au.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw au.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new YZ(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(au.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function JZ(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Oz(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function ZZ(e){return parseInt(e,16)}function eee(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function tee(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:d,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const f=Oz(e.address),p=u?`${u}://${n}`:n,_=e.statement?`${e.statement}
`:"",w=`${p} wants you to sign in with your Ethereum account:
${f}

${_}`;let y=`URI: ${d}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),a&&(y+=`
Not Before: ${a.toISOString()}`),l&&(y+=`
Request ID: ${l}`),c){let g=`
Resources:`;for(const v of c){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);g+=`
- ${v}`}y+=g}return`${w}
${y}`}class vn extends Error{constructor({message:t,code:r,cause:n,name:s}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class M_ extends vn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function ree({error:e,options:t}){var r,n,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new vn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new vn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new vn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new vn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new vn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new vn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new vn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new vn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(jz(o)){if(i.rp.id!==o)return new vn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new vn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new vn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new vn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new vn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function nee({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new vn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new vn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(jz(n)){if(r.rpId!==n)return new vn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new vn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new vn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new vn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class see{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const iee=new see;function oee(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=ll(e,["challenge","user","excludeCredentials"]),i=Ku(t).buffer,o=Object.assign(Object.assign({},r),{id:Ku(r.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:i,user:o});if(n&&n.length>0){a.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Ku(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function aee(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ll(e,["challenge","allowCredentials"]),s=Ku(t).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const a=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:Ku(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function lee(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:nc(new Uint8Array(e.response.attestationObject)),clientDataJSON:nc(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function cee(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:nc(new Uint8Array(s.authenticatorData)),clientDataJSON:nc(new Uint8Array(s.clientDataJSON)),signature:nc(new Uint8Array(s.signature)),userHandle:s.userHandle?nc(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jz(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function sI(){var e,t;return!!(js()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function uee(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new M_("Browser returned unexpected credential type",t)}:{data:null,error:new M_("Empty credential response",t)}}catch(t){return{data:null,error:ree({error:t,options:e})}}}async function dee(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new M_("Browser returned unexpected credential type",t)}:{data:null,error:new M_("Empty credential response",t)}}catch(t){return{data:null,error:nee({error:t,options:e})}}}const hee={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},fee={userVerification:"preferred",hints:["security-key"]};function T_(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(t(o)){const a=n[i];t(a)?n[i]=T_(a,o):n[i]=T_(o)}else n[i]=o}return n}function pee(e,t){return T_(hee,e,t||{})}function mee(e,t){return T_(fee,e,t||{})}class gee{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:a};const l=s??iee.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=pee(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:d}=await uee({publicKey:c,signal:l});return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:d}}case"request":{const c=mee(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:d}=await dee(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:d}}}}catch(o){return Pt(o)?{data:null,error:o}:{data:null,error:new Xl("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},i){if(!r)return{data:null,error:new Wf("rpId is required for WebAuthn authentication")};try{if(!sI())return{data:null,error:new Xl("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(o){return Pt(o)?{data:null,error:o}:{data:null,error:new Xl("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},i){if(!r)return{data:null,error:new Wf("rpId is required for WebAuthn registration")};try{if(!sI())return{data:null,error:new Xl("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var d;return(d=u.data)===null||d===void 0?void 0:d.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return Pt(o)?{data:null,error:o}:{data:null,error:new Xl("Unexpected error in register",o)}}}}JZ();const _ee={url:pZ,storageKey:mZ,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:gZ,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function iI(e,t,r){return await r()}const lu={};class Gf{get jwks(){var t,r;return(r=(t=lu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){lu[this.storageKey]=Object.assign(Object.assign({},lu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=lu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){lu[this.storageKey]=Object.assign(Object.assign({},lu[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Gf.nextInstanceID,Gf.nextInstanceID+=1,this.instanceID>0&&js()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},_ee),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new QZ({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=$z(s.fetch),this.lock=s.lock||iI,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:js()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=XZ:this.lock=iI,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new gee(this)},this.persistSession?(s.storage?this.storage=s.storage:Az()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=nI(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=nI(this.memoryStorage)),js()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Pz}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=AZ(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),js()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),xZ(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pt(r)?{error:r}:{error:new Xl("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ii}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Pt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:u,password:d,options:h}=t;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await iu(this.storage,this.storageKey)),i=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},xform:Ii})}else if("phone"in t){const{phone:u,password:d,options:h}=t;i=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ii})}else throw new Um("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Pt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:a}=t;r=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:tI})}else if("phone"in t){const{phone:i,password:o,options:a}=t;r=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:tI})}else throw new Um("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new su}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,i,o,a,l,c,u,d,h;let f,p;if("message"in t)f=t.message,p=t.signature;else{const{chain:_,wallet:w,statement:y,options:g}=t;let v;if(js())if(typeof w=="object")v=w;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")v=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=w}const b=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href),x=await v.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!x||x.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=Oz(x[0]);let E=(n=g==null?void 0:g.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!E){const I=await v.request({method:"eth_chainId"});E=ZZ(I)}const P={domain:b.host,address:M,statement:y,uri:b.href,version:"1",chainId:E,nonce:(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=g==null?void 0:g.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=g==null?void 0:g.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=g==null?void 0:g.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=g==null?void 0:g.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=tee(P),p=await v.request({method:"personal_sign",params:[eee(f),M]})}try{const{data:_,error:w}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ii});if(w)throw w;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new su}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:w})}catch(_){if(Pt(_))return{data:{user:null,session:null},error:_};throw _}}async signInWithSolana(t){var r,n,s,i,o,a,l,c,u,d,h,f;let p,_;if("message"in t)p=t.message,_=t.signature;else{const{chain:w,wallet:y,statement:g,options:v}=t;let b;if(js())if(typeof y=="object")b=y;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))b=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const x=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const M=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),g?{statement:g}:null));let E;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")E=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)E=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)p=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),_=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${x.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(s=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((d=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...v.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const M=await b.signMessage(new TextEncoder().encode(p),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=M}}try{const{data:w,error:y}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:nc(_)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Ii});if(y)throw y;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new su}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:y})}catch(w){if(Pt(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(t){const r=await Fl(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ii});if(await ma(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new su}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(Pt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=t,a=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ii}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new su}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,o;try{if("email"in t){const{email:a,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await iu(this.storage,this.storageKey));const{error:d}=await Vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:a,options:l}=t,{data:c,error:u}=await Vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Um("You must provide either an email or phone number.")}catch(a){if(Pt(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await Vt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Ii});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await iu(this.storage,this.storageKey)),await Vt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:HZ})}catch(i){if(Pt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ba;const{error:s}=await Vt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Pt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:o}=await Vt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:o,error:a}=await Vt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Um("You must provide either an email or phone number and a type")}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Fl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<j0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Fl(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=R0()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ca}):await this._useSession(async r=>{var n,s,i;const{data:o,error:a}=r;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ba}:await Vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ca})})}catch(r){if(Pt(r))return bZ(r)&&(await this._removeSession(),await ma(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new ba;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&t.email!=null&&([a,l]=await iu(this.storage,this.storageKey));const{data:c,error:u}=await Vt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ca});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ba;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=N0(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{data:a,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Pt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:a}=r;if(a)throw a;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ba;const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!js())throw new Wm("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wm(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new q$("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wm("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new q$("No code detected.");const{data:g,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=t;if(!i||!a||!o||!c)throw new Wm("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;l&&(h=parseInt(l));const f=h-u;f*1e3<=mu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const p=h-d;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,u);const{data:_,error:w}=await this._getUser(i);if(w)throw w;const y={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:h,refresh_token:o,token_type:c,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Pt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Fl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,t);if(a&&!(wZ(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return t!=="others"&&(await this._removeSession(),await ma(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=kZ(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await iu(this.storage,this.storageKey,!0));try{return await Vt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Pt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:d,error:h}=i;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Vt(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return js()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Pt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:o,provider:a,token:l,access_token:c,nonce:u}=t,d=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ii}),{data:h,error:f}=d;return f?{data:{user:null,session:null},error:f}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new su}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),{data:h,error:f})}catch(s){if(Pt(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await Vt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await OZ(async s=>(s>0&&await IZ(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Vt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ii})),(s,i)=>{const o=200*Math.pow(2,s);return i&&D0(i)&&Date.now()+o-n<mu})}catch(n){if(this._debug(r,"error",n),Pt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),js()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Fl(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Fl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await gu(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:R0()}else if(s&&!s.user&&!s.user){const o=await Fl(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await ma(this.storage,this.storageKey+"-user"),await gu(this.storage,this.storageKey,s)):s.user=R0()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<j0;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${j0}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),D0(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ba;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new xy;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new ba;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),Pt(i)){const o={data:null,error:i};return D0(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await gu(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=Z$(s);await gu(this.storage,this.storageKey,i)}else{const s=Z$(r);await gu(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ma(this.storage,this.storageKey),await ma(this.storage,this.storageKey+"-code-verifier"),await ma(this.storage,this.storageKey+"-user"),this.userStorage&&await ma(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&js()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),mu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/mu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${mu}ms, refresh threshold is ${jx} ticks`),s<=jx&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Iz)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!js()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await iu(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Vt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Vt(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&l.type==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?lee(t.webauthn.credential_response):cee(t.webauthn.credential_response)})}:{code:t.code}),{data:a,error:l}=await Vt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=await Vt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:oee(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:aee(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Pt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=N0(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+yZ>s)return n;const{data:i,error:o}=await Vt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(a=>a.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};n=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=N0(n);r!=null&&r.allowExpired||BZ(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=zZ(s.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,PZ(`${a}.${l}`)))throw new Rx("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}}Gf.nextInstanceID=0;const yee=Gf;class vee extends yee{constructor(t){super(t)}}class wee{constructor(t,r,n){var s,i,o;this.supabaseUrl=t,this.supabaseKey=r;const a=fZ(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:iZ,realtime:aZ,auth:Object.assign(Object.assign({},oZ),{storageKey:l}),global:sZ},u=hZ(n??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=uZ(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new pJ(new URL("rest/v1",a).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new tZ(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new oJ(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:o,flowType:a,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vee({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:a,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new $J(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bee=(e,t,r)=>new wee(e,t,r);function xee(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}xee()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Mee="https://cjexzkadgrslxsjphhpb.supabase.co",Tee="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNqZXh6a2FkZ3JzbHhzanBoaHBiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzOTc1NjcsImV4cCI6MjA3Njk3MzU2N30.5_2Nt309ugNce_CH8eXsOi60zXvxoiEk08e5nfJGQmE",xr=bee(Mee,Tee,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),Dz=C.createContext(void 0),Do=()=>{const e=C.useContext(Dz);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},Eee=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState(null),[i,o]=C.useState(!0);C.useEffect(()=>{const{data:{subscription:d}}=xr.auth.onAuthStateChange((h,f)=>{s(f),r((f==null?void 0:f.user)??null),o(!1)});return xr.auth.getSession().then(({data:{session:h}})=>{s(h),r((h==null?void 0:h.user)??null),o(!1)}),()=>d.unsubscribe()},[]);const u={user:t,session:n,signUp:async(d,h)=>{const f=`${window.location.origin}/`,{error:p}=await xr.auth.signUp({email:d,password:h,options:{emailRedirectTo:f}});return{error:p}},signIn:async(d,h)=>{const{error:f}=await xr.auth.signInWithPassword({email:d,password:h});return{error:f}},signOut:async()=>{await xr.auth.signOut()},loading:i};return m.jsx(Dz.Provider,{value:u,children:e})},See=({children:e})=>{const{user:t,loading:r}=Do();return r?m.jsx("div",{className:"min-h-screen flex items-center justify-center",children:m.jsx(S3,{className:"h-8 w-8 animate-spin text-outfit-primary"})}):t?m.jsx(m.Fragment,{children:e}):m.jsx(DX,{to:"/auth",replace:!0})},Pee=()=>m.jsxs("nav",{className:"bottom-nav",children:[m.jsxs(kh,{to:"/",className:({isActive:e})=>`bottom-nav-item ${e?"active":""}`,end:!0,children:[m.jsx($q,{className:"bottom-nav-icon"}),m.jsx("span",{children:"Home"})]}),m.jsxs(kh,{to:"/wardrobe",className:({isActive:e})=>`bottom-nav-item ${e?"active":""}`,children:[m.jsx(A3,{className:"bottom-nav-icon"}),m.jsx("span",{children:"Wardrobe"})]}),m.jsxs(kh,{to:"/outfits",className:({isActive:e})=>`bottom-nav-item ${e?"active":""}`,children:[m.jsx(Eq,{className:"bottom-nav-icon"}),m.jsx("span",{children:"Outfits"})]}),m.jsxs(kh,{to:"/weather-outfits",className:({isActive:e})=>`bottom-nav-item ${e?"active":""}`,children:[m.jsx(Pg,{className:"bottom-nav-icon"}),m.jsx("span",{children:"Weather"})]}),m.jsxs(kh,{to:"/profile",className:({isActive:e})=>`bottom-nav-item ${e?"active":""}`,children:[m.jsx(Fq,{className:"bottom-nav-icon"}),m.jsx("span",{children:"Profile"})]})]}),Cee=()=>m.jsxs("div",{className:"mobile-container",children:[m.jsx("div",{className:"content-area pt-safe",children:m.jsx(NX,{})}),m.jsx(Pee,{})]}),sT=C.createContext({});function iT(e){const t=C.useRef(null);return t.current===null&&(t.current=e()),t.current}const oT=typeof window<"u",Nz=oT?C.useLayoutEffect:C.useEffect,My=C.createContext(null);function aT(e,t){e.indexOf(t)===-1&&e.push(t)}function lT(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const ta=(e,t,r)=>r>t?t:r<e?e:r;let E_=()=>{};const ra={},Rz=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Fz(e){return typeof e=="object"&&e!==null}const Lz=e=>/^0[^.\s]+$/u.test(e);function cT(e){let t;return()=>(t===void 0&&(t=e()),t)}const mi=e=>e,kee=(e,t)=>r=>t(e(r)),fp=(...e)=>e.reduce(kee),Hf=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class uT{constructor(){this.subscriptions=[]}add(t){return aT(this.subscriptions,t),()=>lT(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const So=e=>e*1e3,Po=e=>e/1e3;function Bz(e,t){return t?e*(1e3/t):0}const zz=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Aee=1e-7,$ee=12;function Iee(e,t,r,n,s){let i,o,a=0;do o=t+(r-t)/2,i=zz(o,n,s)-e,i>0?r=o:t=o;while(Math.abs(i)>Aee&&++a<$ee);return o}function pp(e,t,r,n){if(e===t&&r===n)return mi;const s=i=>Iee(i,0,1,e,r);return i=>i===0||i===1?i:zz(s(i),t,n)}const Vz=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Uz=e=>t=>1-e(1-t),Wz=pp(.33,1.53,.69,.99),dT=Uz(Wz),Gz=Vz(dT),Hz=e=>(e*=2)<1?.5*dT(e):.5*(2-Math.pow(2,-10*(e-1))),hT=e=>1-Math.sin(Math.acos(e)),Kz=Uz(hT),qz=Vz(hT),Oee=pp(.42,0,1,1),jee=pp(0,0,.58,1),Qz=pp(.42,0,.58,1),Dee=e=>Array.isArray(e)&&typeof e[0]!="number",Yz=e=>Array.isArray(e)&&typeof e[0]=="number",oI={linear:mi,easeIn:Oee,easeInOut:Qz,easeOut:jee,circIn:hT,circInOut:qz,circOut:Kz,backIn:dT,backInOut:Gz,backOut:Wz,anticipate:Hz},Nee=e=>typeof e=="string",aI=e=>{if(Yz(e)){E_(e.length===4);const[t,r,n,s]=e;return pp(t,r,n,s)}else if(Nee(e))return E_(oI[e]!==void 0),oI[e];return e},Gm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],lI={value:null,addProjectionMetrics:null};function Ree(e,t){let r=new Set,n=new Set,s=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){o.has(d)&&(u.schedule(d),e()),l++,d(a)}const u={schedule:(d,h=!1,f=!1)=>{const _=f&&s?r:n;return h&&o.add(d),_.has(d)||_.add(d),d},cancel:d=>{n.delete(d),o.delete(d)},process:d=>{if(a=d,s){i=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),t&&lI.value&&lI.value.frameloop[t].push(l),l=0,r.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Fee=40;function Xz(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=Gm.reduce((v,b)=>(v[b]=Ree(i,t?b:void 0),v),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:f,postRender:p}=o,_=()=>{const v=ra.useManualTiming?s.timestamp:performance.now();r=!1,ra.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(v-s.timestamp,Fee),1)),s.timestamp=v,s.isProcessing=!0,a.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),f.process(s),p.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(_))},w=()=>{r=!0,n=!0,s.isProcessing||e(_)};return{schedule:Gm.reduce((v,b)=>{const x=o[b];return v[b]=(M,E=!1,P=!1)=>(r||w(),x.schedule(M,E,P)),v},{}),cancel:v=>{for(let b=0;b<Gm.length;b++)o[Gm[b]].cancel(v)},state:s,steps:o}}const{schedule:Ur,cancel:tl,state:Un,steps:L0}=Xz(typeof requestAnimationFrame<"u"?requestAnimationFrame:mi,!0);let Ag;function Lee(){Ag=void 0}const Ms={now:()=>(Ag===void 0&&Ms.set(Un.isProcessing||ra.useManualTiming?Un.timestamp:performance.now()),Ag),set:e=>{Ag=e,queueMicrotask(Lee)}},Jz=e=>t=>typeof t=="string"&&t.startsWith(e),fT=Jz("--"),Bee=Jz("var(--"),pT=e=>Bee(e)?zee.test(e.split("/*")[0].trim()):!1,zee=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,jd={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Kf={...jd,transform:e=>ta(0,1,e)},Hm={...jd,default:1},pf=e=>Math.round(e*1e5)/1e5,mT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Vee(e){return e==null}const Uee=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,gT=(e,t)=>r=>!!(typeof r=="string"&&Uee.test(r)&&r.startsWith(e)||t&&!Vee(r)&&Object.prototype.hasOwnProperty.call(r,t)),Zz=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,i,o,a]=n.match(mT);return{[e]:parseFloat(s),[t]:parseFloat(i),[r]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Wee=e=>ta(0,255,e),B0={...jd,transform:e=>Math.round(Wee(e))},sc={test:gT("rgb","red"),parse:Zz("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+B0.transform(e)+", "+B0.transform(t)+", "+B0.transform(r)+", "+pf(Kf.transform(n))+")"};function Gee(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Fx={test:gT("#"),parse:Gee,transform:sc.transform},mp=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),xa=mp("deg"),Co=mp("%"),It=mp("px"),Hee=mp("vh"),Kee=mp("vw"),cI={...Co,parse:e=>Co.parse(e)/100,transform:e=>Co.transform(e*100)},$u={test:gT("hsl","hue"),parse:Zz("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Co.transform(pf(t))+", "+Co.transform(pf(r))+", "+pf(Kf.transform(n))+")"},wn={test:e=>sc.test(e)||Fx.test(e)||$u.test(e),parse:e=>sc.test(e)?sc.parse(e):$u.test(e)?$u.parse(e):Fx.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?sc.transform(e):$u.transform(e),getAnimatableNone:e=>{const t=wn.parse(e);return t.alpha=0,wn.transform(t)}},qee=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Qee(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(mT))==null?void 0:t.length)||0)+(((r=e.match(qee))==null?void 0:r.length)||0)>0}const e4="number",t4="color",Yee="var",Xee="var(",uI="${}",Jee=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function qf(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let i=0;const a=t.replace(Jee,l=>(wn.test(l)?(n.color.push(i),s.push(t4),r.push(wn.parse(l))):l.startsWith(Xee)?(n.var.push(i),s.push(Yee),r.push(l)):(n.number.push(i),s.push(e4),r.push(parseFloat(l))),++i,uI)).split(uI);return{values:r,split:a,indexes:n,types:s}}function r4(e){return qf(e).values}function n4(e){const{split:t,types:r}=qf(e),n=t.length;return s=>{let i="";for(let o=0;o<n;o++)if(i+=t[o],s[o]!==void 0){const a=r[o];a===e4?i+=pf(s[o]):a===t4?i+=wn.transform(s[o]):i+=s[o]}return i}}const Zee=e=>typeof e=="number"?0:wn.test(e)?wn.getAnimatableNone(e):e;function ete(e){const t=r4(e);return n4(e)(t.map(Zee))}const rl={test:Qee,parse:r4,createTransformer:n4,getAnimatableNone:ete};function z0(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function tte({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,i=0,o=0;if(!t)s=i=o=r;else{const a=r<.5?r*(1+t):r+t-r*t,l=2*r-a;s=z0(l,a,e+1/3),i=z0(l,a,e),o=z0(l,a,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}function S_(e,t){return r=>r>0?t:e}const qr=(e,t,r)=>e+(t-e)*r,V0=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},rte=[Fx,sc,$u],nte=e=>rte.find(t=>t.test(e));function dI(e){const t=nte(e);if(!t)return!1;let r=t.parse(e);return t===$u&&(r=tte(r)),r}const hI=(e,t)=>{const r=dI(e),n=dI(t);if(!r||!n)return S_(e,t);const s={...r};return i=>(s.red=V0(r.red,n.red,i),s.green=V0(r.green,n.green,i),s.blue=V0(r.blue,n.blue,i),s.alpha=qr(r.alpha,n.alpha,i),sc.transform(s))},Lx=new Set(["none","hidden"]);function ste(e,t){return Lx.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function ite(e,t){return r=>qr(e,t,r)}function _T(e){return typeof e=="number"?ite:typeof e=="string"?pT(e)?S_:wn.test(e)?hI:lte:Array.isArray(e)?s4:typeof e=="object"?wn.test(e)?hI:ote:S_}function s4(e,t){const r=[...e],n=r.length,s=e.map((i,o)=>_T(i)(i,t[o]));return i=>{for(let o=0;o<n;o++)r[o]=s[o](i);return r}}function ote(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=_T(e[s])(e[s],t[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}}function ate(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],o=e.indexes[i][n[i]],a=e.values[o]??0;r[s]=a,n[i]++}return r}const lte=(e,t)=>{const r=rl.createTransformer(t),n=qf(e),s=qf(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Lx.has(e)&&!s.values.length||Lx.has(t)&&!n.values.length?ste(e,t):fp(s4(ate(n,s),s.values),r):S_(e,t)};function i4(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?qr(e,t,r):_T(e)(e,t)}const cte=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Ur.update(t,r),stop:()=>tl(t),now:()=>Un.isProcessing?Un.timestamp:Ms.now()}},o4=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let i=0;i<s;i++)n+=Math.round(e(i/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},P_=2e4;function yT(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<P_;)t+=r,n=e.next(t);return t>=P_?1/0:t}function ute(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(yT(n),P_);return{type:"keyframes",ease:i=>n.next(s*i).value/t,duration:Po(s)}}const dte=5;function a4(e,t,r){const n=Math.max(t-dte,0);return Bz(r-e(n),t-n)}const sn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},U0=.001;function hte({duration:e=sn.duration,bounce:t=sn.bounce,velocity:r=sn.velocity,mass:n=sn.mass}){let s,i,o=1-t;o=ta(sn.minDamping,sn.maxDamping,o),e=ta(sn.minDuration,sn.maxDuration,Po(e)),o<1?(s=c=>{const u=c*o,d=u*e,h=u-r,f=Bx(c,o),p=Math.exp(-d);return U0-h/f*p},i=c=>{const d=c*o*e,h=d*r+r,f=Math.pow(o,2)*Math.pow(c,2)*e,p=Math.exp(-d),_=Bx(Math.pow(c,2),o);return(-s(c)+U0>0?-1:1)*((h-f)*p)/_}):(s=c=>{const u=Math.exp(-c*e),d=(c-r)*e+1;return-U0+u*d},i=c=>{const u=Math.exp(-c*e),d=(r-c)*(e*e);return u*d});const a=5/e,l=pte(s,i,a);if(e=So(e),isNaN(l))return{stiffness:sn.stiffness,damping:sn.damping,duration:e};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:e}}}const fte=12;function pte(e,t,r){let n=r;for(let s=1;s<fte;s++)n=n-e(n)/t(n);return n}function Bx(e,t){return e*Math.sqrt(1-t*t)}const mte=["duration","bounce"],gte=["stiffness","damping","mass"];function fI(e,t){return t.some(r=>e[r]!==void 0)}function _te(e){let t={velocity:sn.velocity,stiffness:sn.stiffness,damping:sn.damping,mass:sn.mass,isResolvedFromDuration:!1,...e};if(!fI(e,gte)&&fI(e,mte))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,i=2*ta(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:sn.mass,stiffness:s,damping:i}}else{const r=hte(e);t={...t,...r,mass:sn.mass},t.isResolvedFromDuration=!0}return t}function C_(e=sn.visualDuration,t=sn.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=_te({...r,velocity:-Po(r.velocity||0)}),p=h||0,_=c/(2*Math.sqrt(l*u)),w=o-i,y=Po(Math.sqrt(l/u)),g=Math.abs(w)<5;n||(n=g?sn.restSpeed.granular:sn.restSpeed.default),s||(s=g?sn.restDelta.granular:sn.restDelta.default);let v;if(_<1){const x=Bx(y,_);v=M=>{const E=Math.exp(-_*y*M);return o-E*((p+_*y*w)/x*Math.sin(x*M)+w*Math.cos(x*M))}}else if(_===1)v=x=>o-Math.exp(-y*x)*(w+(p+y*w)*x);else{const x=y*Math.sqrt(_*_-1);v=M=>{const E=Math.exp(-_*y*M),P=Math.min(x*M,300);return o-E*((p+_*y*w)*Math.sinh(P)+x*w*Math.cosh(P))/x}}const b={calculatedDuration:f&&d||null,next:x=>{const M=v(x);if(f)a.done=x>=d;else{let E=x===0?p:0;_<1&&(E=x===0?So(p):a4(v,x,M));const P=Math.abs(E)<=n,I=Math.abs(o-M)<=s;a.done=P&&I}return a.value=a.done?o:M,a},toString:()=>{const x=Math.min(yT(b),P_),M=o4(E=>b.next(x*E).value,x,30);return x+"ms "+M},toTransition:()=>{}};return b}C_.applyToOptions=e=>{const t=ute(e,100,C_);return e.ease=t.ease,e.duration=So(t.duration),e.type="keyframes",e};function zx({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},f=P=>a!==void 0&&P<a||l!==void 0&&P>l,p=P=>a===void 0?l:l===void 0||Math.abs(a-P)<Math.abs(l-P)?a:l;let _=r*t;const w=d+_,y=o===void 0?w:o(w);y!==w&&(_=y-d);const g=P=>-_*Math.exp(-P/n),v=P=>y+g(P),b=P=>{const I=g(P),O=v(P);h.done=Math.abs(I)<=c,h.value=h.done?y:O};let x,M;const E=P=>{f(h.value)&&(x=P,M=C_({keyframes:[h.value,p(h.value)],velocity:a4(v,P,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return E(0),{calculatedDuration:null,next:P=>{let I=!1;return!M&&x===void 0&&(I=!0,b(P),E(P)),x!==void 0&&P>=x?M.next(P-x):(!I&&b(P),h)}}}function yte(e,t,r){const n=[],s=r||ra.mix||i4,i=e.length-1;for(let o=0;o<i;o++){let a=s(e[o],e[o+1]);if(t){const l=Array.isArray(t)?t[o]||mi:t;a=fp(l,a)}n.push(a)}return n}function vte(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const i=e.length;if(E_(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=yte(t,n,s),l=a.length,c=u=>{if(o&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=Hf(e[d],e[d+1],u);return a[d](h)};return r?u=>c(ta(e[0],e[i-1],u)):c}function wte(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Hf(0,t,n);e.push(qr(r,1,s))}}function bte(e){const t=[0];return wte(t,e.length-1),t}function xte(e,t){return e.map(r=>r*t)}function Mte(e,t){return e.map(()=>t||Qz).splice(0,e.length-1)}function mf({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=Dee(n)?n.map(aI):aI(n),i={done:!1,value:t[0]},o=xte(r&&r.length===t.length?r:bte(t),e),a=vte(o,t,{ease:Array.isArray(s)?s:Mte(t,s)});return{calculatedDuration:e,next:l=>(i.value=a(l),i.done=l>=e,i)}}const Tte=e=>e!==null;function vT(e,{repeat:t,repeatType:r="loop"},n,s=1){const i=e.filter(Tte),a=s<0||t&&r!=="loop"&&t%2===1?0:i.length-1;return!a||n===void 0?i[a]:n}const Ete={decay:zx,inertia:zx,tween:mf,keyframes:mf,spring:C_};function l4(e){typeof e.type=="string"&&(e.type=Ete[e.type])}class wT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const Ste=e=>e/100;class bT extends wT{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==Ms.now()&&this.tick(Ms.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;l4(t);const{type:r=mf,repeat:n=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=t;let{keyframes:a}=t;const l=r||mf;l!==mf&&typeof a[0]!="number"&&(this.mixKeyframes=fp(Ste,i4(a[0],a[1])),a=[0,100]);const c=l({...t,keyframes:a});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...a].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=yT(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=c}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:f,type:p,onUpdate:_,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const y=this.currentTime-c*(this.playbackSpeed>=0?1:-1),g=this.playbackSpeed>=0?y<0:y>s;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let v=this.currentTime,b=n;if(d){const P=Math.min(this.currentTime,s)/a;let I=Math.floor(P),O=P%1;!O&&P>=1&&(O=1),O===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(O=1-O,f&&(O-=f/a)):h==="mirror"&&(b=o)),v=ta(0,1,O)*a}const x=g?{done:!1,value:u[0]}:b.next(v);i&&(x.value=i(x.value));let{done:M}=x;!g&&l!==null&&(M=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const E=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return E&&p!==zx&&(x.value=vT(u,this.options,w,this.speed)),_&&_(x.value),E&&this.finish(),x}then(t,r){return this.finished.then(t,r)}get duration(){return Po(this.calculatedDuration)}get time(){return Po(this.currentTime)}set time(t){var r;t=So(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ms.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Po(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:t=cte,startTime:r}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(i=(s=this.options).onPlay)==null||i.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ms.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function Pte(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const ic=e=>e*180/Math.PI,Vx=e=>{const t=ic(Math.atan2(e[1],e[0]));return Ux(t)},Cte={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Vx,rotateZ:Vx,skewX:e=>ic(Math.atan(e[1])),skewY:e=>ic(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Ux=e=>(e=e%360,e<0&&(e+=360),e),pI=Vx,mI=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),gI=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),kte={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:mI,scaleY:gI,scale:e=>(mI(e)+gI(e))/2,rotateX:e=>Ux(ic(Math.atan2(e[6],e[5]))),rotateY:e=>Ux(ic(Math.atan2(-e[2],e[0]))),rotateZ:pI,rotate:pI,skewX:e=>ic(Math.atan(e[4])),skewY:e=>ic(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Wx(e){return e.includes("scale")?1:0}function Gx(e,t){if(!e||e==="none")return Wx(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=kte,s=r;else{const a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Cte,s=a}if(!s)return Wx(t);const i=n[t],o=s[1].split(",").map($te);return typeof i=="function"?i(o):o[i]}const Ate=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return Gx(r,t)};function $te(e){return parseFloat(e.trim())}const Dd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nd=new Set(Dd),_I=e=>e===jd||e===It,Ite=new Set(["x","y","z"]),Ote=Dd.filter(e=>!Ite.has(e));function jte(e){const t=[];return Ote.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const fc={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Gx(t,"x"),y:(e,{transform:t})=>Gx(t,"y")};fc.translateX=fc.x;fc.translateY=fc.y;const pc=new Set;let Hx=!1,Kx=!1,qx=!1;function c4(){if(Kx){const e=Array.from(pc).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=jte(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([i,o])=>{var a;(a=n.getValue(i))==null||a.set(o)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Kx=!1,Hx=!1,pc.forEach(e=>e.complete(qx)),pc.clear()}function u4(){pc.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Kx=!0)})}function Dte(){qx=!0,u4(),c4(),qx=!1}class xT{constructor(t,r,n,s,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(pc.add(this),Hx||(Hx=!0,Ur.read(u4),Ur.resolveKeyframes(c4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),o=t[t.length-1];if(i!==void 0)t[0]=i;else if(n&&r){const a=n.readValue(r,o);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=o),s&&i===void 0&&s.set(t[0])}Pte(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),pc.delete(this)}cancel(){this.state==="scheduled"&&(pc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Nte=e=>e.startsWith("--");function Rte(e,t,r){Nte(t)?e.style.setProperty(t,r):e.style[t]=r}const Fte=cT(()=>window.ScrollTimeline!==void 0),Lte={};function Bte(e,t){const r=cT(e);return()=>Lte[t]??r()}const d4=Bte(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),qh=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,yI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:qh([0,.65,.55,1]),circOut:qh([.55,0,1,.45]),backIn:qh([.31,.01,.66,-.59]),backOut:qh([.33,1.53,.69,.99])};function h4(e,t){if(e)return typeof e=="function"?d4()?o4(e,t):"ease-out":Yz(e)?qh(e):Array.isArray(e)?e.map(r=>h4(r,t)||yI.easeOut):yI[e]}function zte(e,t,r,{delay:n=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[t]:r};l&&(u.offset=l);const d=h4(a,s);Array.isArray(d)&&(u.easing=d);const h={delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function f4(e){return typeof e=="function"&&"applyToOptions"in e}function Vte({type:e,...t}){return f4(e)&&d4()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class Ute extends wT{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=t,E_(typeof t.type!="string");const c=Vte(t);this.animation=zte(r,n,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=vT(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):Rte(r,n,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,n;const t=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Po(Number(t))}get time(){return Po(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=So(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Fte()?(this.animation.timeline=t,mi):r(this)}}const p4={anticipate:Hz,backInOut:Gz,circInOut:qz};function Wte(e){return e in p4}function Gte(e){typeof e.ease=="string"&&Wte(e.ease)&&(e.ease=p4[e.ease])}const vI=10;class Hte extends Ute{constructor(t){Gte(t),l4(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:i,...o}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const a=new bT({...o,autoplay:!1}),l=So(this.finishedTime??this.time);r.setWithVelocity(a.sample(l-vI).value,a.sample(l).value,vI),a.stop()}}const wI=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(rl.test(e)||e==="0")&&!e.startsWith("url("));function Kte(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function qte(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=wI(s,t),a=wI(i,t);return!o||!a?!1:Kte(e)||(r==="spring"||f4(r))&&n}function Qx(e){e.duration=0,e.type}const Qte=new Set(["opacity","clipPath","filter","transform"]),Yte=cT(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Xte(e){var u;const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:i,type:o}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Yte()&&r&&Qte.has(r)&&(r!=="transform"||!c)&&!l&&!n&&s!=="mirror"&&i!==0&&o!=="inertia"}const Jte=40;class Zte extends wT{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",keyframes:a,name:l,motionValue:c,element:u,...d}){var p;super(),this.stop=()=>{var _,w;this._animation&&(this._animation.stop(),(_=this.stopTimeline)==null||_.call(this)),(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=Ms.now();const h={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:i,repeatType:o,name:l,motionValue:c,element:u,...d},f=(u==null?void 0:u.KeyframeResolver)||xT;this.keyframeResolver=new f(a,(_,w,y)=>this.onKeyframesResolved(_,w,h,!y),l,c,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:i,type:o,velocity:a,delay:l,isHandoff:c,onUpdate:u}=n;this.resolvedAt=Ms.now(),qte(t,i,o,a)||((ra.instantAnimations||!l)&&(u==null||u(vT(t,n,r))),t[0]=t[t.length-1],Qx(n),n.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>Jte?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},f=!c&&Xte(h)?new Hte({...h,element:h.motionValue.owner.current}):new bT(h);f.finished.then(()=>this.notifyFinished()).catch(mi),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),Dte()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const ere=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function tre(e){const t=ere.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function m4(e,t,r=1){const[n,s]=tre(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const o=i.trim();return Rz(o)?parseFloat(o):o}return pT(s)?m4(s,t,r+1):s}function MT(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const g4=new Set(["width","height","top","left","right","bottom",...Dd]),rre={test:e=>e==="auto",parse:e=>e},_4=e=>t=>t.test(e),y4=[jd,It,Co,xa,Kee,Hee,rre],bI=e=>y4.find(_4(e));function nre(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Lz(e):!0}const sre=new Set(["brightness","contrast","saturate","opacity"]);function ire(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(mT)||[];if(!n)return e;const s=r.replace(n,"");let i=sre.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+s+")"}const ore=/\b([a-z-]*)\(.*?\)/gu,Yx={...rl,getAnimatableNone:e=>{const t=e.match(ore);return t?t.map(ire).join(" "):e}},xI={...jd,transform:Math.round},are={rotate:xa,rotateX:xa,rotateY:xa,rotateZ:xa,scale:Hm,scaleX:Hm,scaleY:Hm,scaleZ:Hm,skew:xa,skewX:xa,skewY:xa,distance:It,translateX:It,translateY:It,translateZ:It,x:It,y:It,z:It,perspective:It,transformPerspective:It,opacity:Kf,originX:cI,originY:cI,originZ:It},TT={borderWidth:It,borderTopWidth:It,borderRightWidth:It,borderBottomWidth:It,borderLeftWidth:It,borderRadius:It,radius:It,borderTopLeftRadius:It,borderTopRightRadius:It,borderBottomRightRadius:It,borderBottomLeftRadius:It,width:It,maxWidth:It,height:It,maxHeight:It,top:It,right:It,bottom:It,left:It,padding:It,paddingTop:It,paddingRight:It,paddingBottom:It,paddingLeft:It,margin:It,marginTop:It,marginRight:It,marginBottom:It,marginLeft:It,backgroundPositionX:It,backgroundPositionY:It,...are,zIndex:xI,fillOpacity:Kf,strokeOpacity:Kf,numOctaves:xI},lre={...TT,color:wn,backgroundColor:wn,outlineColor:wn,fill:wn,stroke:wn,borderColor:wn,borderTopColor:wn,borderRightColor:wn,borderBottomColor:wn,borderLeftColor:wn,filter:Yx,WebkitFilter:Yx},v4=e=>lre[e];function w4(e,t){let r=v4(e);return r!==Yx&&(r=rl),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const cre=new Set(["auto","none","0"]);function ure(e,t,r){let n=0,s;for(;n<e.length&&!s;){const i=e[n];typeof i=="string"&&!cre.has(i)&&qf(i).values.length&&(s=e[n]),n++}if(s&&r)for(const i of t)e[i]=w4(r,s)}class dre extends xT{constructor(t,r,n,s,i){super(t,r,n,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),pT(c))){const u=m4(c,r.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!g4.has(n)||t.length!==2)return;const[s,i]=t,o=bI(s),a=bI(i);if(o!==a)if(_I(o)&&_I(a))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else fc[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||nre(t[s]))&&n.push(s);n.length&&ure(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fc[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){var a;const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const i=n.length-1,o=n[i];n[i]=fc[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function hre(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const s=document.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const b4=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function x4(e){return Fz(e)&&"offsetHeight"in e}const MI=30,fre=e=>!isNaN(parseFloat(e));class pre{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var i;const s=Ms.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Ms.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=fre(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new uT);const n=this.events[t].add(r);return t==="change"?()=>{n(),Ur.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ms.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>MI)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,MI);return Bz(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function yd(e,t){return new pre(e,t)}const{schedule:ET,cancel:Hhe}=Xz(queueMicrotask,!1),Oi={x:!1,y:!1};function M4(){return Oi.x||Oi.y}function mre(e){return e==="x"||e==="y"?Oi[e]?null:(Oi[e]=!0,()=>{Oi[e]=!1}):Oi.x||Oi.y?null:(Oi.x=Oi.y=!0,()=>{Oi.x=Oi.y=!1})}function T4(e,t){const r=hre(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function TI(e){return!(e.pointerType==="touch"||M4())}function gre(e,t,r={}){const[n,s,i]=T4(e,r),o=a=>{if(!TI(a))return;const{target:l}=a,c=t(l,a);if(typeof c!="function"||!l)return;const u=d=>{TI(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return n.forEach(a=>{a.addEventListener("pointerenter",o,s)}),i}const E4=(e,t)=>t?e===t?!0:E4(e,t.parentElement):!1,ST=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,_re=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function yre(e){return _re.has(e.tagName)||e.tabIndex!==-1}const $g=new WeakSet;function EI(e){return t=>{t.key==="Enter"&&e(t)}}function W0(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const vre=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=EI(()=>{if($g.has(r))return;W0(r,"down");const s=EI(()=>{W0(r,"up")}),i=()=>W0(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",i,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function SI(e){return ST(e)&&!M4()}function wre(e,t,r={}){const[n,s,i]=T4(e,r),o=a=>{const l=a.currentTarget;if(!SI(a))return;$g.add(l);const c=t(l,a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),$g.has(l)&&$g.delete(l),SI(f)&&typeof c=="function"&&c(f,{success:p})},d=f=>{u(f,l===window||l===document||r.useGlobalTarget||E4(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return n.forEach(a=>{(r.useGlobalTarget?window:a).addEventListener("pointerdown",o,s),x4(a)&&(a.addEventListener("focus",c=>vre(c,s)),!yre(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),i}function S4(e){return Fz(e)&&"ownerSVGElement"in e}function bre(e){return S4(e)&&e.tagName==="svg"}const rs=e=>!!(e&&e.getVelocity),xre=[...y4,wn,rl],Mre=e=>xre.find(_4(e)),PT=C.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Tre extends C.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=x4(n)&&n.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Ere({children:e,isPresent:t,anchorX:r,root:n}){const s=C.useId(),i=C.useRef(null),o=C.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=C.useContext(PT);return C.useInsertionEffect(()=>{const{width:l,height:c,top:u,left:d,right:h}=o.current;if(t||!i.current||!l||!c)return;const f=r==="left"?`left: ${d}`:`right: ${h}`;i.current.dataset.motionPopId=s;const p=document.createElement("style");a&&(p.nonce=a);const _=n??document.head;return _.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            ${f}px !important;
            top: ${u}px !important;
          }
        `),()=>{_.contains(p)&&_.removeChild(p)}},[t]),m.jsx(Tre,{isPresent:t,childRef:i,sizeRef:o,children:C.cloneElement(e,{ref:i})})}const Sre=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:o,anchorX:a,root:l})=>{const c=iT(Pre),u=C.useId();let d=!0,h=C.useMemo(()=>(d=!1,{id:u,initial:t,isPresent:r,custom:s,onExitComplete:f=>{c.set(f,!0);for(const p of c.values())if(!p)return;n&&n()},register:f=>(c.set(f,!1),()=>c.delete(f))}),[r,c,n]);return i&&d&&(h={...h}),C.useMemo(()=>{c.forEach((f,p)=>c.set(p,!1))},[r]),C.useEffect(()=>{!r&&!c.size&&n&&n()},[r]),o==="popLayout"&&(e=m.jsx(Ere,{isPresent:r,anchorX:a,root:l,children:e})),m.jsx(My.Provider,{value:h,children:e})};function Pre(){return new Map}function P4(e=!0){const t=C.useContext(My);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,i=C.useId();C.useEffect(()=>{if(e)return s(i)},[e]);const o=C.useCallback(()=>e&&n&&n(i),[i,n,e]);return!r&&n?[!1,o]:[!0]}const Km=e=>e.key||"";function PI(e){const t=[];return C.Children.forEach(e,r=>{C.isValidElement(r)&&t.push(r)}),t}const Xx=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1,anchorX:a="left",root:l})=>{const[c,u]=P4(o),d=C.useMemo(()=>PI(e),[e]),h=o&&!c?[]:d.map(Km),f=C.useRef(!0),p=C.useRef(d),_=iT(()=>new Map),[w,y]=C.useState(d),[g,v]=C.useState(d);Nz(()=>{f.current=!1,p.current=d;for(let M=0;M<g.length;M++){const E=Km(g[M]);h.includes(E)?_.delete(E):_.get(E)!==!0&&_.set(E,!1)}},[g,h.length,h.join("-")]);const b=[];if(d!==w){let M=[...d];for(let E=0;E<g.length;E++){const P=g[E],I=Km(P);h.includes(I)||(M.splice(E,0,P),b.push(P))}return i==="wait"&&b.length&&(M=b),v(PI(M)),y(d),null}const{forceRender:x}=C.useContext(sT);return m.jsx(m.Fragment,{children:g.map(M=>{const E=Km(M),P=o&&!c?!1:d===g||h.includes(E),I=()=>{if(_.has(E))_.set(E,!0);else return;let O=!0;_.forEach(V=>{V||(O=!1)}),O&&(x==null||x(),v(p.current),o&&(u==null||u()),n&&n())};return m.jsx(Sre,{isPresent:P,initial:!f.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,root:l,onExitComplete:P?void 0:I,anchorX:a,children:M},E)})})},C4=C.createContext({strict:!1}),CI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},vd={};for(const e in CI)vd[e]={isEnabled:t=>CI[e].some(r=>!!t[r])};function Cre(e){for(const t in e)vd[t]={...vd[t],...e[t]}}const kre=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function k_(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||kre.has(e)}let k4=e=>!k_(e);function Are(e){typeof e=="function"&&(k4=t=>t.startsWith("on")?!k_(t):e(t))}try{Are(require("@emotion/is-prop-valid").default)}catch{}function $re(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(k4(s)||r===!0&&k_(s)||!t&&!k_(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const Ty=C.createContext({});function Ey(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Qf(e){return typeof e=="string"||Array.isArray(e)}const CT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kT=["initial",...CT];function Sy(e){return Ey(e.animate)||kT.some(t=>Qf(e[t]))}function A4(e){return!!(Sy(e)||e.variants)}function Ire(e,t){if(Sy(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Qf(r)?r:void 0,animate:Qf(n)?n:void 0}}return e.inherit!==!1?t:{}}function Ore(e){const{initial:t,animate:r}=Ire(e,C.useContext(Ty));return C.useMemo(()=>({initial:t,animate:r}),[kI(t),kI(r)])}function kI(e){return Array.isArray(e)?e.join(" "):e}const Yf={};function jre(e){for(const t in e)Yf[t]=e[t],fT(t)&&(Yf[t].isCSSVariable=!0)}function $4(e,{layout:t,layoutId:r}){return Nd.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Yf[e]||e==="opacity")}const Dre={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Nre=Dd.length;function Rre(e,t,r){let n="",s=!0;for(let i=0;i<Nre;i++){const o=Dd[i],a=e[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||r){const c=b4(a,TT[o]);if(!l){s=!1;const u=Dre[o]||o;n+=`${u}(${c}) `}r&&(t[o]=c)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function AT(e,t,r){const{style:n,vars:s,transformOrigin:i}=e;let o=!1,a=!1;for(const l in t){const c=t[l];if(Nd.has(l)){o=!0;continue}else if(fT(l)){s[l]=c;continue}else{const u=b4(c,TT[l]);l.startsWith("origin")?(a=!0,i[l]=u):n[l]=u}}if(t.transform||(o||r?n.transform=Rre(t,e.transform,r):n.transform&&(n.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;n.transformOrigin=`${l} ${c} ${u}`}}const $T=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function I4(e,t,r){for(const n in t)!rs(t[n])&&!$4(n,r)&&(e[n]=t[n])}function Fre({transformTemplate:e},t){return C.useMemo(()=>{const r=$T();return AT(r,t,e),Object.assign({},r.vars,r.style)},[t])}function Lre(e,t){const r=e.style||{},n={};return I4(n,r,e),Object.assign(n,Fre(e,t)),n}function Bre(e,t){const r={},n=Lre(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const zre={offset:"stroke-dashoffset",array:"stroke-dasharray"},Vre={offset:"strokeDashoffset",array:"strokeDasharray"};function Ure(e,t,r=1,n=0,s=!0){e.pathLength=1;const i=s?zre:Vre;e[i.offset]=It.transform(-n);const o=It.transform(t),a=It.transform(r);e[i.array]=`${o} ${a}`}function O4(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:i=1,pathOffset:o=0,...a},l,c,u){if(AT(e,a,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),r!==void 0&&(d.y=r),n!==void 0&&(d.scale=n),s!==void 0&&Ure(d,s,i,o,!1)}const j4=()=>({...$T(),attrs:{}}),D4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Wre(e,t,r,n){const s=C.useMemo(()=>{const i=j4();return O4(i,t,D4(n),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};I4(i,e.style,e),s.style={...i,...s.style}}return s}const Gre=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function IT(e){return typeof e!="string"||e.includes("-")?!1:!!(Gre.indexOf(e)>-1||/[A-Z]/u.test(e))}function Hre(e,t,r,{latestValues:n},s,i=!1){const a=(IT(e)?Wre:Bre)(t,n,s,e),l=$re(t,typeof e=="string",i),c=e!==C.Fragment?{...l,...a,ref:r}:{},{children:u}=t,d=C.useMemo(()=>rs(u)?u.get():u,[u]);return C.createElement(e,{...c,children:d})}function AI(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function OT(e,t,r,n){if(typeof t=="function"){const[s,i]=AI(n);t=t(r!==void 0?r:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=AI(n);t=t(r!==void 0?r:e.custom,s,i)}return t}function Ig(e){return rs(e)?e.get():e}function Kre({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:qre(r,n,s,e),renderState:t()}}function qre(e,t,r,n){const s={},i=n(e,{});for(const h in i)s[h]=Ig(i[h]);let{initial:o,animate:a}=e;const l=Sy(e),c=A4(e);t&&c&&!l&&e.inherit!==!1&&(o===void 0&&(o=t.initial),a===void 0&&(a=t.animate));let u=r?r.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!Ey(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const p=OT(e,h[f]);if(p){const{transitionEnd:_,transition:w,...y}=p;for(const g in y){let v=y[g];if(Array.isArray(v)){const b=u?v.length-1:0;v=v[b]}v!==null&&(s[g]=v)}for(const g in _)s[g]=_[g]}}}return s}const N4=e=>(t,r)=>{const n=C.useContext(Ty),s=C.useContext(My),i=()=>Kre(e,t,n,s);return r?i():iT(i)};function jT(e,t,r){var i;const{style:n}=e,s={};for(const o in n)(rs(n[o])||t.style&&rs(t.style[o])||$4(o,e)||((i=r==null?void 0:r.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(s[o]=n[o]);return s}const Qre=N4({scrapeMotionValuesFromProps:jT,createRenderState:$T});function R4(e,t,r){const n=jT(e,t,r);for(const s in e)if(rs(e[s])||rs(t[s])){const i=Dd.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[i]=e[s]}return n}const Yre=N4({scrapeMotionValuesFromProps:R4,createRenderState:j4}),Xre=Symbol.for("motionComponentSymbol");function Iu(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Jre(e,t,r){return C.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Iu(r)&&(r.current=n))},[t])}const DT=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Zre="framerAppearId",F4="data-"+DT(Zre),L4=C.createContext({});function ene(e,t,r,n,s){var _,w;const{visualElement:i}=C.useContext(Ty),o=C.useContext(C4),a=C.useContext(My),l=C.useContext(PT).reducedMotion,c=C.useRef(null);n=n||o.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:i,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=C.useContext(L4);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&tne(c.current,r,s,d);const h=C.useRef(!1);C.useInsertionEffect(()=>{u&&h.current&&u.update(r,a)});const f=r[F4],p=C.useRef(!!f&&!((_=window.MotionHandoffIsComplete)!=null&&_.call(window,f))&&((w=window.MotionHasOptimisedAnimation)==null?void 0:w.call(window,f)));return Nz(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),p.current&&u.animationState&&u.animationState.animateChanges())}),C.useEffect(()=>{u&&(!p.current&&u.animationState&&u.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)==null||y.call(window,f)}),p.current=!1),u.enteringChildren=void 0)}),u}function tne(e,t,r,n){const{layoutId:s,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:B4(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||a&&Iu(a),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,crossfade:u,layoutScroll:l,layoutRoot:c})}function B4(e){if(e)return e.options.allowProjection!==!1?e.projection:B4(e.parent)}function G0(e,{forwardMotionProps:t=!1}={},r,n){r&&Cre(r);const s=IT(e)?Yre:Qre;function i(a,l){let c;const u={...C.useContext(PT),...a,layoutId:rne(a)},{isStatic:d}=u,h=Ore(a),f=s(a,d);if(!d&&oT){nne();const p=sne(u);c=p.MeasureLayout,h.visualElement=ene(e,f,u,n,p.ProjectionNode)}return m.jsxs(Ty.Provider,{value:h,children:[c&&h.visualElement?m.jsx(c,{visualElement:h.visualElement,...u}):null,Hre(e,a,Jre(f,h.visualElement,l),f,d,t)]})}i.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const o=C.forwardRef(i);return o[Xre]=e,o}function rne({layoutId:e}){const t=C.useContext(sT).id;return t&&e!==void 0?t+"-"+e:e}function nne(e,t){C.useContext(C4).strict}function sne(e){const{drag:t,layout:r}=vd;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function ine(e,t){if(typeof Proxy>"u")return G0;const r=new Map,n=(i,o)=>G0(i,o,e,t),s=(i,o)=>n(i,o);return new Proxy(s,{get:(i,o)=>o==="create"?n:(r.has(o)||r.set(o,G0(o,void 0,e,t)),r.get(o))})}function z4({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function one({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function ane(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function H0(e){return e===void 0||e===1}function Jx({scale:e,scaleX:t,scaleY:r}){return!H0(e)||!H0(t)||!H0(r)}function Kl(e){return Jx(e)||V4(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function V4(e){return $I(e.x)||$I(e.y)}function $I(e){return e&&e!=="0%"}function A_(e,t,r){const n=e-r,s=t*n;return r+s}function II(e,t,r,n,s){return s!==void 0&&(e=A_(e,s,n)),A_(e,r,n)+t}function Zx(e,t=0,r=1,n,s){e.min=II(e.min,t,r,n,s),e.max=II(e.max,t,r,n,s)}function U4(e,{x:t,y:r}){Zx(e.x,t.translate,t.scale,t.originPoint),Zx(e.y,r.translate,r.scale,r.originPoint)}const OI=.999999999999,jI=1.0000000000001;function lne(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let i,o;for(let a=0;a<s;a++){i=r[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ju(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,U4(e,o)),n&&Kl(i.latestValues)&&ju(e,i.latestValues))}t.x<jI&&t.x>OI&&(t.x=1),t.y<jI&&t.y>OI&&(t.y=1)}function Ou(e,t){e.min=e.min+t,e.max=e.max+t}function DI(e,t,r,n,s=.5){const i=qr(e.min,e.max,s);Zx(e,t,r,i,n)}function ju(e,t){DI(e.x,t.x,t.scaleX,t.scale,t.originX),DI(e.y,t.y,t.scaleY,t.scale,t.originY)}function W4(e,t){return z4(ane(e.getBoundingClientRect(),t))}function cne(e,t,r){const n=W4(e,r),{scroll:s}=t;return s&&(Ou(n.x,s.offset.x),Ou(n.y,s.offset.y)),n}const NI=()=>({translate:0,scale:1,origin:0,originPoint:0}),Du=()=>({x:NI(),y:NI()}),RI=()=>({min:0,max:0}),dn=()=>({x:RI(),y:RI()}),e1={current:null},G4={current:!1};function une(){if(G4.current=!0,!!oT)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>e1.current=e.matches;e.addEventListener("change",t),t()}else e1.current=!1}const dne=new WeakMap;function hne(e,t,r){for(const n in t){const s=t[n],i=r[n];if(rs(s))e.addValue(n,s);else if(rs(i))e.addValue(n,yd(s,{owner:e}));else if(i!==s)if(e.hasValue(n)){const o=e.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=e.getStaticValue(n);e.addValue(n,yd(o!==void 0?o:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const FI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class fne{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=xT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Ms.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Ur.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=Sy(r),this.isVariantNode=A4(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in d){const f=d[h];l[h]!==void 0&&rs(f)&&f.set(l[h])}}mount(t){var r;this.current=t,dne.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),G4.current||une(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:e1.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),tl(this.notifyUpdate),tl(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Nd.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Ur.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in vd){const r=vd[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):dn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<FI.length;n++){const s=FI[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=t[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=hne(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=yd(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(Rz(n)||Lz(n))?n=parseFloat(n):!Mre(n)&&rl.test(r)&&(n=w4(t,r)),this.setBaseTarget(t,rs(n)?n.get():n)),rs(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var i;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const o=OT(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);o&&(n=o[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!rs(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new uT),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){ET.render(this.render)}}class H4 extends fne{constructor(){super(...arguments),this.KeyframeResolver=dre}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;rs(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function K4(e,{style:t,vars:r},n,s){const i=e.style;let o;for(o in t)i[o]=t[o];s==null||s.applyProjectionStyles(i,n);for(o in r)i.setProperty(o,r[o])}function pne(e){return window.getComputedStyle(e)}class mne extends H4{constructor(){super(...arguments),this.type="html",this.renderInstance=K4}readValueFromInstance(t,r){var n;if(Nd.has(r))return(n=this.projection)!=null&&n.isProjecting?Wx(r):Ate(t,r);{const s=pne(t),i=(fT(r)?s.getPropertyValue(r):s[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return W4(t,r)}build(t,r,n){AT(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return jT(t,r,n)}}const q4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function gne(e,t,r,n){K4(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(q4.has(s)?s:DT(s),t.attrs[s])}class _ne extends H4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=dn}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Nd.has(r)){const n=v4(r);return n&&n.default||0}return r=q4.has(r)?r:DT(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return R4(t,r,n)}build(t,r,n){O4(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){gne(t,r,n,s)}mount(t){this.isSVGTag=D4(t.tagName),super.mount(t)}}const yne=(e,t)=>IT(e)?new _ne(t):new mne(t,{allowProjection:e!==C.Fragment});function qu(e,t,r){const n=e.getProps();return OT(n,t,r!==void 0?r:n.custom,e)}const t1=e=>Array.isArray(e);function vne(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,yd(r))}function wne(e){return t1(e)?e[e.length-1]||0:e}function bne(e,t){const r=qu(e,t);let{transitionEnd:n={},transition:s={},...i}=r||{};i={...i,...n};for(const o in i){const a=wne(i[o]);vne(e,o,a)}}function xne(e){return!!(rs(e)&&e.add)}function r1(e,t){const r=e.getValue("willChange");if(xne(r))return r.add(t);if(!r&&ra.WillChange){const n=new ra.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function Q4(e){return e.props[F4]}const Mne=e=>e!==null;function Tne(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(Mne),i=t&&r!=="loop"&&t%2===1?0:s.length-1;return!i||n===void 0?s[i]:n}const Ene={type:"spring",stiffness:500,damping:25,restSpeed:10},Sne=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Pne={type:"keyframes",duration:.8},Cne={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},kne=(e,{keyframes:t})=>t.length>2?Pne:Nd.has(e)?e.startsWith("scale")?Sne(t[1]):Ene:Cne;function Ane({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const NT=(e,t,r,n={},s,i)=>o=>{const a=MT(n,e)||{},l=a.delay||n.delay||0;let{elapsed:c=0}=n;c=c-So(l);const u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-c,onUpdate:h=>{t.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:i?void 0:s};Ane(a)||Object.assign(u,kne(e,u)),u.duration&&(u.duration=So(u.duration)),u.repeatDelay&&(u.repeatDelay=So(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(Qx(u),u.delay===0&&(d=!0)),(ra.instantAnimations||ra.skipAnimations)&&(d=!0,Qx(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!i&&t.get()!==void 0){const h=Tne(u.keyframes,a);if(h!==void 0){Ur.update(()=>{u.onUpdate(h),u.onComplete()});return}}return a.isSync?new bT(u):new Zte(u)};function $ne({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function Y4(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:o,...a}=t;n&&(i=n);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in a){const d=e.getValue(u,e.latestValues[u]??null),h=a[u];if(h===void 0||c&&$ne(c,u))continue;const f={delay:r,...MT(i||{},u)},p=d.get();if(p!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===p&&!f.velocity)continue;let _=!1;if(window.MotionHandoffAnimation){const y=Q4(e);if(y){const g=window.MotionHandoffAnimation(y,u,Ur);g!==null&&(f.startTime=g,_=!0)}}r1(e,u),d.start(NT(u,d,h,e.shouldReduceMotion&&g4.has(u)?{type:!1}:f,e,_));const w=d.animation;w&&l.push(w)}return o&&Promise.all(l).then(()=>{Ur.update(()=>{o&&bne(e,o)})}),l}function X4(e,t,r,n=0,s=1){const i=Array.from(e).sort((c,u)=>c.sortNodePosition(u)).indexOf(t),o=e.size,a=(o-1)*n;return typeof r=="function"?r(i,o):s===1?i*n:a-i*n}function n1(e,t,r={}){var l;const n=qu(e,t,r.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const i=n?()=>Promise.all(Y4(e,n,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return Ine(e,t,c,u,d,h,r)}:()=>Promise.resolve(),{when:a}=s;if(a){const[c,u]=a==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(r.delay)])}function Ine(e,t,r=0,n=0,s=0,i=1,o){const a=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),a.push(n1(l,t,{...o,delay:r+(typeof n=="function"?0:n)+X4(e.variantChildren,l,n,s,i)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(a)}function One(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(i=>n1(e,i,r));n=Promise.all(s)}else if(typeof t=="string")n=n1(e,t,r);else{const s=typeof t=="function"?qu(e,t,r.custom):t;n=Promise.all(Y4(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function J4(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const jne=kT.length;function Z4(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?Z4(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<jne;r++){const n=kT[r],s=e.props[n];(Qf(s)||s===!1)&&(t[n]=s)}return t}const Dne=[...CT].reverse(),Nne=CT.length;function Rne(e){return t=>Promise.all(t.map(({animation:r,options:n})=>One(e,r,n)))}function Fne(e){let t=Rne(e),r=LI(),n=!0;const s=l=>(c,u)=>{var h;const d=qu(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,..._}=d;c={...c,..._,...p}}return c};function i(l){t=l(e)}function o(l){const{props:c}=e,u=Z4(e.parent)||{},d=[],h=new Set;let f={},p=1/0;for(let w=0;w<Nne;w++){const y=Dne[w],g=r[y],v=c[y]!==void 0?c[y]:u[y],b=Qf(v),x=y===l?g.isActive:null;x===!1&&(p=w);let M=v===u[y]&&v!==c[y]&&b;if(M&&n&&e.manuallyAnimateOnMount&&(M=!1),g.protectedKeys={...f},!g.isActive&&x===null||!v&&!g.prevProp||Ey(v)||typeof v=="boolean")continue;const E=Lne(g.prevProp,v);let P=E||y===l&&g.isActive&&!M&&b||w>p&&b,I=!1;const O=Array.isArray(v)?v:[v];let V=O.reduce(s(y),{});x===!1&&(V={});const{prevResolvedValues:U={}}=g,B={...U,...V},Y=G=>{P=!0,h.has(G)&&(I=!0,h.delete(G)),g.needsAnimating[G]=!0;const R=e.getValue(G);R&&(R.liveStyle=!1)};for(const G in B){const R=V[G],te=U[G];if(f.hasOwnProperty(G))continue;let re=!1;t1(R)&&t1(te)?re=!J4(R,te):re=R!==te,re?R!=null?Y(G):h.add(G):R!==void 0&&h.has(G)?Y(G):g.protectedKeys[G]=!0}g.prevProp=v,g.prevResolvedValues=V,g.isActive&&(f={...f,...V}),n&&e.blockInitialAnimation&&(P=!1);const K=M&&E;P&&(!K||I)&&d.push(...O.map(G=>{const R={type:y};if(typeof G=="string"&&n&&!K&&e.manuallyAnimateOnMount&&e.parent){const{parent:te}=e,re=qu(te,G);if(te.enteringChildren&&re){const{delayChildren:L}=re.transition||{};R.delay=X4(te.enteringChildren,e,L)}}return{animation:G,options:R}}))}if(h.size){const w={};if(typeof c.initial!="boolean"){const y=qu(e,Array.isArray(c.initial)?c.initial[0]:c.initial);y&&y.transition&&(w.transition=y.transition)}h.forEach(y=>{const g=e.getBaseTarget(y),v=e.getValue(y);v&&(v.liveStyle=!0),w[y]=g??null}),d.push({animation:w})}let _=!!d.length;return n&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(_=!1),n=!1,_?t(d):Promise.resolve()}function a(l,c){var d;if(r[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var f;return(f=h.animationState)==null?void 0:f.setActive(l,c)}),r[l].isActive=c;const u=o(l);for(const h in r)r[h].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>r,reset:()=>{r=LI(),n=!0}}}function Lne(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!J4(t,e):!1}function Ll(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function LI(){return{animate:Ll(!0),whileInView:Ll(),whileHover:Ll(),whileTap:Ll(),whileDrag:Ll(),whileFocus:Ll(),exit:Ll()}}class ul{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Bne extends ul{constructor(t){super(t),t.animationState||(t.animationState=Fne(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Ey(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let zne=0;class Vne extends ul{constructor(){super(...arguments),this.id=zne++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Une={animation:{Feature:Bne},exit:{Feature:Vne}};function Xf(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function gp(e){return{point:{x:e.pageX,y:e.pageY}}}const Wne=e=>t=>ST(t)&&e(t,gp(t));function gf(e,t,r,n){return Xf(e,t,Wne(r),n)}const eV=1e-4,Gne=1-eV,Hne=1+eV,tV=.01,Kne=0-tV,qne=0+tV;function fs(e){return e.max-e.min}function Qne(e,t,r){return Math.abs(e-t)<=r}function BI(e,t,r,n=.5){e.origin=n,e.originPoint=qr(t.min,t.max,e.origin),e.scale=fs(r)/fs(t),e.translate=qr(r.min,r.max,e.origin)-e.originPoint,(e.scale>=Gne&&e.scale<=Hne||isNaN(e.scale))&&(e.scale=1),(e.translate>=Kne&&e.translate<=qne||isNaN(e.translate))&&(e.translate=0)}function _f(e,t,r,n){BI(e.x,t.x,r.x,n?n.originX:void 0),BI(e.y,t.y,r.y,n?n.originY:void 0)}function zI(e,t,r){e.min=r.min+t.min,e.max=e.min+fs(t)}function Yne(e,t,r){zI(e.x,t.x,r.x),zI(e.y,t.y,r.y)}function VI(e,t,r){e.min=t.min-r.min,e.max=e.min+fs(t)}function yf(e,t,r){VI(e.x,t.x,r.x),VI(e.y,t.y,r.y)}function oi(e){return[e("x"),e("y")]}const rV=({current:e})=>e?e.ownerDocument.defaultView:null,UI=(e,t)=>Math.abs(e-t);function Xne(e,t){const r=UI(e.x,t.x),n=UI(e.y,t.y);return Math.sqrt(r**2+n**2)}class nV{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=q0(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=Xne(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!p)return;const{point:_}=h,{timestamp:w}=Un;this.history.push({..._,timestamp:w});const{onStart:y,onMove:g}=this.handlers;f||(y&&y(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=K0(f,this.transformPagePoint),Ur.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:p,onSessionEnd:_,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=q0(h.type==="pointercancel"?this.lastMoveEventInfo:K0(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,y),_&&_(h,y)},!ST(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=s||window;const a=gp(t),l=K0(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=Un;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,q0(l,this.history)),this.removeListeners=fp(gf(this.contextWindow,"pointermove",this.handlePointerMove),gf(this.contextWindow,"pointerup",this.handlePointerUp),gf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),tl(this.updatePoint)}}function K0(e,t){return t?{point:t(e.point)}:e}function WI(e,t){return{x:e.x-t.x,y:e.y-t.y}}function q0({point:e},t){return{point:e,delta:WI(e,sV(t)),offset:WI(e,Jne(t)),velocity:Zne(t,.1)}}function Jne(e){return e[0]}function sV(e){return e[e.length-1]}function Zne(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=sV(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>So(t)));)r--;if(!n)return{x:0,y:0};const i=Po(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function ese(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?qr(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?qr(r,e,n.max):Math.min(e,r)),e}function GI(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function tse(e,{top:t,left:r,bottom:n,right:s}){return{x:GI(e.x,r,s),y:GI(e.y,t,n)}}function HI(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function rse(e,t){return{x:HI(e.x,t.x),y:HI(e.y,t.y)}}function nse(e,t){let r=.5;const n=fs(e),s=fs(t);return s>n?r=Hf(t.min,t.max-n,e.min):n>s&&(r=Hf(e.min,e.max-s,t.min)),ta(0,1,r)}function sse(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const s1=.35;function ise(e=s1){return e===!1?e=0:e===!0&&(e=s1),{x:KI(e,"left","right"),y:KI(e,"top","bottom")}}function KI(e,t,r){return{min:qI(e,t),max:qI(e,r)}}function qI(e,t){return typeof e=="number"?e:e[t]||0}const ose=new WeakMap;class ase{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=dn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(gp(d).point)},o=(d,h)=>{const{drag:f,dragPropagation:p,onDragStart:_}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=mre(f),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),oi(y=>{let g=this.getAxisMotionValue(y).get()||0;if(Co.test(g)){const{projection:v}=this.visualElement;if(v&&v.layout){const b=v.layout.layoutBox[y];b&&(g=fs(b)*(parseFloat(g)/100))}}this.originPoint[y]=g}),_&&Ur.postRender(()=>_(d,h)),r1(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},a=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h;const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:_,onDrag:w}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:y}=h;if(p&&this.currentDirection===null){this.currentDirection=lse(y),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),w&&w(d,h)},l=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h,this.stop(d,h),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>oi(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)==null?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new nV(t,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:n,contextWindow:rV(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!n)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&Ur.postRender(()=>a(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!qm(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=ese(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&Iu(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=tse(n.layoutBox,t):this.constraints=!1,this.elastic=ise(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&oi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=sse(n.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Iu(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=cne(n,s.root,this.visualElement.getTransformPagePoint());let o=rse(s.layout.layoutBox,i);if(r){const a=r(one(o));this.hasMutatedConstraints=!!a,a&&(o=z4(a))}return o}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=oi(u=>{if(!qm(u,r,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const h=s?200:1e6,f=s?40:1e7,p={type:"inertia",velocity:n?t[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return r1(this.visualElement,t),n.start(NT(t,n,0,r,this.visualElement,!1))}stopAnimation(){oi(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){oi(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){oi(r=>{const{drag:n}=this.getProps();if(!qm(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[r];i.set(t[r]-qr(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Iu(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};oi(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();s[o]=nse({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),oi(o=>{if(!qm(o,t,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(qr(l,c,s[o]))})}addListeners(){if(!this.visualElement.current)return;ose.set(this.visualElement,this);const t=this.visualElement.current,r=gf(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Iu(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Ur.read(n);const o=Xf(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(oi(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=s1,dragMomentum:a=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function qm(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function lse(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class cse extends ul{constructor(t){super(t),this.removeGroupControls=mi,this.removeListeners=mi,this.controls=new ase(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||mi}unmount(){this.removeGroupControls(),this.removeListeners()}}const QI=e=>(t,r)=>{e&&Ur.postRender(()=>e(t,r))};class use extends ul{constructor(){super(...arguments),this.removePointerDownListener=mi}onPointerDown(t){this.session=new nV(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:rV(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:QI(t),onStart:QI(r),onMove:n,onEnd:(i,o)=>{delete this.session,s&&Ur.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=gf(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Og={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function YI(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ah={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(It.test(e))e=parseFloat(e);else return e;const r=YI(e,t.target.x),n=YI(e,t.target.y);return`${r}% ${n}%`}},dse={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=rl.parse(e);if(s.length>5)return n;const i=rl.createTransformer(e),o=typeof s[0]!="number"?1:0,a=r.x.scale*t.x,l=r.y.scale*t.y;s[0+o]/=a,s[1+o]/=l;const c=qr(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=c),typeof s[3+o]=="number"&&(s[3+o]/=c),i(s)}};let Q0=!1;class hse extends C.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=t;jre(fse),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),Q0&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Og.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,{projection:o}=n;return o&&(o.isPresent=i,Q0=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==i?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||Ur.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),ET.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;Q0=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function iV(e){const[t,r]=P4(),n=C.useContext(sT);return m.jsx(hse,{...e,layoutGroup:n,switchLayoutGroup:C.useContext(L4),isPresent:t,safeToRemove:r})}const fse={borderRadius:{...Ah,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ah,borderTopRightRadius:Ah,borderBottomLeftRadius:Ah,borderBottomRightRadius:Ah,boxShadow:dse};function pse(e,t,r){const n=rs(e)?e:yd(e);return n.start(NT("",n,t,r)),n.animation}const mse=(e,t)=>e.depth-t.depth;class gse{constructor(){this.children=[],this.isDirty=!1}add(t){aT(this.children,t),this.isDirty=!0}remove(t){lT(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(mse),this.isDirty=!1,this.children.forEach(t)}}function _se(e,t){const r=Ms.now(),n=({timestamp:s})=>{const i=s-r;i>=t&&(tl(n),e(i-t))};return Ur.setup(n,!0),()=>tl(n)}const oV=["TopLeft","TopRight","BottomLeft","BottomRight"],yse=oV.length,XI=e=>typeof e=="string"?parseFloat(e):e,JI=e=>typeof e=="number"||It.test(e);function vse(e,t,r,n,s,i){s?(e.opacity=qr(0,r.opacity??1,wse(n)),e.opacityExit=qr(t.opacity??1,0,bse(n))):i&&(e.opacity=qr(t.opacity??1,r.opacity??1,n));for(let o=0;o<yse;o++){const a=`border${oV[o]}Radius`;let l=ZI(t,a),c=ZI(r,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||JI(l)===JI(c)?(e[a]=Math.max(qr(XI(l),XI(c),n),0),(Co.test(c)||Co.test(l))&&(e[a]+="%")):e[a]=c}(t.rotate||r.rotate)&&(e.rotate=qr(t.rotate||0,r.rotate||0,n))}function ZI(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const wse=aV(0,.5,Kz),bse=aV(.5,.95,mi);function aV(e,t,r){return n=>n<e?0:n>t?1:r(Hf(e,t,n))}function eO(e,t){e.min=t.min,e.max=t.max}function ii(e,t){eO(e.x,t.x),eO(e.y,t.y)}function tO(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function rO(e,t,r,n,s){return e-=t,e=A_(e,1/r,n),s!==void 0&&(e=A_(e,1/s,n)),e}function xse(e,t=0,r=1,n=.5,s,i=e,o=e){if(Co.test(t)&&(t=parseFloat(t),t=qr(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=qr(i.min,i.max,n);e===i&&(a-=t),e.min=rO(e.min,t,r,a,s),e.max=rO(e.max,t,r,a,s)}function nO(e,t,[r,n,s],i,o){xse(e,t[r],t[n],t[s],t.scale,i,o)}const Mse=["x","scaleX","originX"],Tse=["y","scaleY","originY"];function sO(e,t,r,n){nO(e.x,t,Mse,r?r.x:void 0,n?n.x:void 0),nO(e.y,t,Tse,r?r.y:void 0,n?n.y:void 0)}function iO(e){return e.translate===0&&e.scale===1}function lV(e){return iO(e.x)&&iO(e.y)}function oO(e,t){return e.min===t.min&&e.max===t.max}function Ese(e,t){return oO(e.x,t.x)&&oO(e.y,t.y)}function aO(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function cV(e,t){return aO(e.x,t.x)&&aO(e.y,t.y)}function lO(e){return fs(e.x)/fs(e.y)}function cO(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Sse{constructor(){this.members=[]}add(t){aT(this.members,t),t.scheduleRender()}remove(t){if(lT(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Pse(e,t,r){let n="";const s=e.x.translate/t.x,i=e.y.translate/t.y,o=(r==null?void 0:r.z)||0;if((s||i||o)&&(n=`translate3d(${s}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:p}=r;c&&(n=`perspective(${c}px) ${n}`),u&&(n+=`rotate(${u}deg) `),d&&(n+=`rotateX(${d}deg) `),h&&(n+=`rotateY(${h}deg) `),f&&(n+=`skewX(${f}deg) `),p&&(n+=`skewY(${p}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const Y0=["","X","Y","Z"],Cse=1e3;let kse=0;function X0(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function uV(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Q4(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Ur,!(s||i))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&uV(n)}function dV({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},a=t==null?void 0:t()){this.id=kse++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Ise),this.nodes.forEach(Nse),this.nodes.forEach(Rse),this.nodes.forEach(Ose)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new gse)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new uT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=S4(o)&&!bre(o),this.instance=o;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),e){let u,d=0;const h=()=>this.root.updateBlockedByResize=!1;Ur.read(()=>{d=window.innerWidth}),e(o,()=>{const f=window.innerWidth;f!==d&&(d=f,this.root.updateBlockedByResize=!0,u&&u(),u=_se(h,250),Og.hasAnimatedSinceResize&&(Og.hasAnimatedSinceResize=!1,this.nodes.forEach(hO)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||Vse,{onLayoutAnimationStart:_,onLayoutAnimationComplete:w}=c.getProps(),y=!this.targetLayout||!cV(this.targetLayout,f),g=!d&&h;if(this.options.layoutRoot||this.resumeFrom||g||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const v={...MT(p,"layout"),onPlay:_,onComplete:w};(c.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v),this.setAnimationOrigin(u,g)}else d||hO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),tl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Fse),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&uV(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(uO);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(dO);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Dse),this.nodes.forEach(Ase),this.nodes.forEach($se)):this.nodes.forEach(dO),this.clearAllSnapshots();const a=Ms.now();Un.delta=ta(0,1e3/60,a-Un.timestamp),Un.timestamp=a,Un.isProcessing=!0,L0.update.process(Un),L0.preRender.process(Un),L0.render.process(Un),Un.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ET.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(jse),this.sharedNodes.forEach(Lse)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ur.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ur.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!fs(this.snapshot.measuredBox.x)&&!fs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=dn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!lV(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&this.instance&&(a||Kl(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Use(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return dn();const a=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(Wse))){const{scroll:u}=this.root;u&&(Ou(a.x,u.offset.x),Ou(a.y,u.offset.y))}return a}removeElementScroll(o){var l;const a=dn();if(ii(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&ii(a,o),Ou(a.x,d.offset.x),Ou(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const l=dn();ii(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&ju(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Kl(u.latestValues)&&ju(l,u.latestValues)}return Kl(this.latestValues)&&ju(l,this.latestValues),l}removeTransform(o){const a=dn();ii(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Kl(c.latestValues))continue;Jx(c.latestValues)&&c.updateSnapshot();const u=dn(),d=c.measurePageBox();ii(u,d),sO(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Kl(this.latestValues)&&sO(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Un.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var h;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Un.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),yf(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),ii(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=dn(),this.targetWithTransforms=dn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Yne(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ii(this.target,this.layout.layoutBox),U4(this.target,this.targetDelta)):ii(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),yf(this.relativeTargetOrigin,this.target,f.target),ii(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Jx(this.parent.latestValues)||V4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Un.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;ii(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;lne(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=dn());const{target:f}=o;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(tO(this.prevProjectionDelta.x,this.projectionDelta.x),tO(this.prevProjectionDelta.y,this.projectionDelta.y)),_f(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!cO(this.projectionDelta.x,this.prevProjectionDelta.x)||!cO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Du(),this.projectionDelta=Du(),this.projectionDeltaWithTransform=Du()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Du();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=dn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,_=f!==p,w=this.getStack(),y=!w||w.members.length<=1,g=!!(_&&!y&&this.options.crossfade===!0&&!this.path.some(zse));this.animationProgress=0;let v;this.mixTargetDelta=b=>{const x=b/1e3;fO(d.x,o.x,x),fO(d.y,o.y,x),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(yf(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Bse(this.relativeTarget,this.relativeTargetOrigin,h,x),v&&Ese(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=dn()),ii(v,this.relativeTarget)),_&&(this.animationValues=u,vse(u,c,this.latestValues,x,g,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=x},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,c;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(),this.pendingAnimation&&(tl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ur.update(()=>{Og.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=yd(0)),this.currentAnimation=pse(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Cse),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&hV(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||dn();const d=fs(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=fs(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}ii(a,l),ju(a,u),_f(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Sse),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&X0("z",o,c,this.animationValues);for(let u=0;u<Y0.length;u++)X0(`rotate${Y0[u]}`,o,c,this.animationValues),X0(`skew${Y0[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Ig(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Ig(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Kl(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let d=Pse(this.projectionDeltaWithTransform,this.treeScale,u);l&&(d=l(u,d)),o.transform=d;const{x:h,y:f}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${f.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in Yf){if(u[p]===void 0)continue;const{correct:_,applyTo:w,isCSSVariable:y}=Yf[p],g=d==="none"?u[p]:_(u[p],c);if(w){const v=w.length;for(let b=0;b<v;b++)o[w[b]]=g}else y?this.options.visualElement.renderState.vars[p]=g:o[p]=g}this.options.layoutId&&(o.pointerEvents=c===this?Ig(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(uO),this.root.sharedNodes.clear()}}}function Ase(e){e.updateLayout()}function $se(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:i}=e.options,o=t.source!==e.layout.source;i==="size"?oi(d=>{const h=o?t.measuredBox[d]:t.layoutBox[d],f=fs(h);h.min=n[d].min,h.max=h.min+f}):hV(i,t.layoutBox,n)&&oi(d=>{const h=o?t.measuredBox[d]:t.layoutBox[d],f=fs(n[d]);h.max=h.min+f,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+f)});const a=Du();_f(a,n,t.layoutBox);const l=Du();o?_f(l,e.applyTransform(s,!0),t.measuredBox):_f(l,n,t.layoutBox);const c=!lV(a);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const p=dn();yf(p,t.layoutBox,h.layoutBox);const _=dn();yf(_,n,f.layoutBox),cV(p,_)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=_,e.relativeTargetOrigin=p,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Ise(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Ose(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function jse(e){e.clearSnapshot()}function uO(e){e.clearMeasurements()}function dO(e){e.isLayoutDirty=!1}function Dse(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function hO(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Nse(e){e.resolveTargetDelta()}function Rse(e){e.calcProjection()}function Fse(e){e.resetSkewAndRotation()}function Lse(e){e.removeLeadSnapshot()}function fO(e,t,r){e.translate=qr(t.translate,0,r),e.scale=qr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function pO(e,t,r,n){e.min=qr(t.min,r.min,n),e.max=qr(t.max,r.max,n)}function Bse(e,t,r,n){pO(e.x,t.x,r.x,n),pO(e.y,t.y,r.y,n)}function zse(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Vse={duration:.45,ease:[.4,0,.1,1]},mO=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),gO=mO("applewebkit/")&&!mO("chrome/")?Math.round:mi;function _O(e){e.min=gO(e.min),e.max=gO(e.max)}function Use(e){_O(e.x),_O(e.y)}function hV(e,t,r){return e==="position"||e==="preserve-aspect"&&!Qne(lO(t),lO(r),.2)}function Wse(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Gse=dV({attachResizeListener:(e,t)=>Xf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),J0={current:void 0},fV=dV({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!J0.current){const e=new Gse({});e.mount(window),e.setOptions({layoutScroll:!0}),J0.current=e}return J0.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Hse={pan:{Feature:use},drag:{Feature:cse,ProjectionNode:fV,MeasureLayout:iV}};function yO(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,i=n[s];i&&Ur.postRender(()=>i(t,gp(t)))}class Kse extends ul{mount(){const{current:t}=this.node;t&&(this.unmount=gre(t,(r,n)=>(yO(this.node,n,"Start"),s=>yO(this.node,s,"End"))))}unmount(){}}class qse extends ul{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fp(Xf(this.node.current,"focus",()=>this.onFocus()),Xf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function vO(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),i=n[s];i&&Ur.postRender(()=>i(t,gp(t)))}class Qse extends ul{mount(){const{current:t}=this.node;t&&(this.unmount=wre(t,(r,n)=>(vO(this.node,n,"Start"),(s,{success:i})=>vO(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const i1=new WeakMap,Z0=new WeakMap,Yse=e=>{const t=i1.get(e.target);t&&t(e)},Xse=e=>{e.forEach(Yse)};function Jse({root:e,...t}){const r=e||document;Z0.has(r)||Z0.set(r,{});const n=Z0.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(Xse,{root:e,...t})),n[s]}function Zse(e,t,r){const n=Jse(t);return i1.set(e,r),n.observe(e),()=>{i1.delete(e),n.unobserve(e)}}const eie={some:0,all:1};class tie extends ul{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=t,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:eie[s]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return Zse(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(rie(t,r))&&this.startObserver()}unmount(){}}function rie({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const nie={inView:{Feature:tie},tap:{Feature:Qse},focus:{Feature:qse},hover:{Feature:Kse}},sie={layout:{ProjectionNode:fV,MeasureLayout:iV}},iie={...Une,...nie,...Hse,...sie},Cn=ine(iie,yne),o1=ly("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Bt=C.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},i)=>{const o=n?Mc:"button";return m.jsx(o,{className:zt(o1({variant:t,size:r,className:e})),ref:i,...s})});Bt.displayName="Button";const vr=C.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:zt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));vr.displayName="Card";const Wi=C.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:zt("flex flex-col space-y-1.5 p-6",e),...t}));Wi.displayName="CardHeader";const Gi=C.forwardRef(({className:e,...t},r)=>m.jsx("h3",{ref:r,className:zt("text-2xl font-semibold leading-none tracking-tight",e),...t}));Gi.displayName="CardTitle";const pV=C.forwardRef(({className:e,...t},r)=>m.jsx("p",{ref:r,className:zt("text-sm text-muted-foreground",e),...t}));pV.displayName="CardDescription";const Cr=C.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:zt("p-6 pt-0",e),...t}));Cr.displayName="CardContent";const oie=C.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:zt("flex items-center p-6 pt-0",e),...t}));oie.displayName="CardFooter";const jg="/assets/logo-CM8P8ze5.png",aie=({onComplete:e})=>{const[t,r]=C.useState("welcome"),[n,s]=C.useState(!1),i=()=>{r("transition"),setTimeout(()=>{r("message"),s(!0)},800)},o=()=>{s(!1),r("complete"),setTimeout(()=>{e()},500)};return C.useEffect(()=>{if(t==="message"){const a=setTimeout(()=>{o()},3e3);return()=>clearTimeout(a)}},[t]),m.jsx(Xx,{children:t!=="complete"&&m.jsxs(Cn.div,{initial:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50",children:[t==="welcome"&&m.jsxs(Cn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full h-full bg-white flex flex-col items-center justify-center p-8",children:[m.jsx(Cn.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:1,ease:"easeOut"},className:"mb-16",children:m.jsx("img",{src:jg,alt:"Fashion App Logo",className:"w-32 h-32 object-contain"})}),m.jsx(Cn.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5,duration:.8},children:m.jsx(Bt,{onClick:i,size:"lg",className:"px-12 py-4 text-lg font-semibold bg-gradient-primary hover:scale-105 transform transition-all duration-300 shadow-glow",children:"Get Started"})})]}),t==="transition"&&m.jsx(Cn.div,{initial:{opacity:1},animate:{opacity:1},className:"w-full h-full bg-white flex items-center justify-center",children:m.jsx(Cn.img,{src:jg,alt:"Fashion App Logo",initial:{scale:1,x:0,y:0},animate:{scale:.3,x:-150,y:-200},transition:{duration:.8,ease:"easeInOut"},className:"w-32 h-32 object-contain"})}),t==="message"&&m.jsxs(Cn.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full h-full relative",children:[m.jsx(Cn.div,{initial:{backdropFilter:"blur(0px)"},animate:{backdropFilter:"blur(10px)"},transition:{duration:.5},className:"absolute inset-0 bg-gradient-to-br from-outfit-primary/20 via-transparent to-outfit-secondary/20"}),m.jsx(Cn.img,{src:jg,alt:"Fashion App Logo",initial:{scale:.3,x:-150,y:-200},animate:{scale:.2,x:-180,y:-250},className:"absolute top-8 left-8 w-32 h-32 object-contain opacity-60"}),m.jsx(Xx,{children:n&&m.jsx(Cn.div,{initial:{opacity:0,scale:.8,y:50},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:-50},transition:{duration:.6,type:"spring",stiffness:200},className:"absolute inset-0 flex items-center justify-center p-8",children:m.jsx(vr,{className:"relative p-6 bg-gradient-card shadow-glow border-0 max-w-sm w-full",children:m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsxs("div",{className:"relative flex-shrink-0",children:[m.jsx("div",{className:"w-12 h-12 bg-gradient-primary rounded-full flex items-center justify-center",children:m.jsx(Cn.div,{animate:{rotate:[0,360]},transition:{duration:2,repeat:1/0,ease:"linear"},className:"text-white text-xl",children:""})}),m.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-gradient-primary rounded-full animate-pulse"})]}),m.jsx("div",{className:"flex-1 min-w-0",children:m.jsx(Cn.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-lg font-medium bg-gradient-primary bg-clip-text text-transparent",children:"Let's create some outfits for you! "})})]})})})})]})]})})},lie="/assets/onboarding-wardrobe-CU79QhAD.png",cie="/assets/onboarding-ai-styling-Dr1WDoBV.png",uie="/assets/onboarding-calendar-Cqicmulz.png",die=({onComplete:e})=>{const[t,r]=C.useState(0),n=[{title:"Unlock Your Virtual Wardrobe",description:"Digitize your clothes & see everything you own",image:lie,buttonText:"Next: Smart Styling"},{title:"AI-Powered Styling",description:"Get personalized outfit suggestions based on weather, occasion, and your style",image:cie,buttonText:"Next: Plan Outfits"},{title:"Plan & Track Outfits",description:"Schedule your weekly looks and discover your most-loved pieces",image:uie,buttonText:"Get Started"}],s=()=>{t<n.length-1?r(t+1):e()},i=n[t];return m.jsx("div",{className:"fixed inset-0 z-50 bg-background",children:m.jsxs("div",{className:"h-full w-full flex flex-col",children:[m.jsx("div",{className:"flex justify-center pt-8 pb-4",children:m.jsx(Cn.img,{src:jg,alt:"OutfitFlex",className:"h-16 w-16",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{duration:.6,type:"spring"}})}),m.jsx(Cn.h2,{className:"text-center text-2xl font-bold text-foreground mb-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:"OutfitFlex"}),m.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-6 pb-4",children:m.jsx(Xx,{mode:"wait",children:m.jsxs(Cn.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.4},className:"w-full max-w-md flex flex-col items-center text-center space-y-6",children:[m.jsx(Cn.div,{className:"w-full max-w-sm aspect-square rounded-3xl overflow-hidden shadow-lg",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5},children:m.jsx("img",{src:i.image,alt:i.title,className:"w-full h-full object-cover"})}),m.jsxs("div",{className:"space-y-3 px-4",children:[m.jsx(Cn.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-3xl font-bold text-foreground",children:i.title}),m.jsx(Cn.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-base text-muted-foreground leading-relaxed",children:i.description})]})]},t)})}),m.jsxs("div",{className:"pb-8 px-6 space-y-6",children:[m.jsxs(Bt,{onClick:s,className:"w-full h-14 text-lg font-semibold rounded-full bg-gradient-to-r from-[hsl(20,70%,65%)] to-[hsl(25,75%,70%)] hover:opacity-90 transition-opacity shadow-lg text-white",children:[i.buttonText,m.jsx(E3,{className:"ml-2 h-5 w-5"})]}),m.jsx("div",{className:"flex justify-center gap-2",children:n.map((o,a)=>m.jsx(Cn.div,{className:`h-2 rounded-full transition-all duration-300 ${a===t?"w-8 bg-[hsl(20,70%,65%)]":"w-2 bg-muted"}`,animate:{scale:1}},a))})]})]})})},Rd=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!0),{user:s}=Do(),i=async()=>{if(!s)return;n(!0);const{data:c,error:u}=await xr.from("clothing_items").select("*").order("created_at",{ascending:!1});u?console.error("Error fetching clothing items:",u):t(c||[]),n(!1)},o=async c=>{if(!s)return;const{data:u,error:d}=await xr.from("clothing_items").insert([{...c,user_id:s.id}]).select().single();if(d)throw console.error("Error adding clothing item:",d),d;return t(h=>[u,...h]),u},a=async(c,u)=>{const{data:d,error:h}=await xr.from("clothing_items").update(u).eq("id",c).select().single();if(h)throw console.error("Error updating clothing item:",h),h;return t(f=>f.map(p=>p.id===c?d:p)),d},l=async c=>{const{error:u}=await xr.from("clothing_items").delete().eq("id",c);if(u)throw console.error("Error deleting clothing item:",u),u;t(d=>d.filter(h=>h.id!==c))};return C.useEffect(()=>{i()},[s]),{items:e,loading:r,addItem:o,updateItem:a,deleteItem:l,refetch:i}},Fd=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!0),{user:s}=Do(),i=async()=>{if(!s)return;n(!0);const{data:u,error:d}=await xr.from("outfits").select(`
        *,
        outfit_items (
          id,
          clothing_item_id,
          clothing_items (
            id,
            name,
            image_url,
            color,
            category
          )
        )
      `).order("created_at",{ascending:!1});if(d)console.error("Error fetching outfits:",d);else{const h=(u==null?void 0:u.map(f=>{var p;return{...f,items:(p=f.outfit_items)==null?void 0:p.map(_=>({id:_.id,clothing_item_id:_.clothing_item_id,clothing_item:_.clothing_items}))}}))||[];t(h)}n(!1)},o=async u=>{if(!s)return;const{data:d,error:h}=await xr.from("outfits").insert([{name:u.name,description:u.description,season:u.season,occasion:u.occasion,weather:u.weather,user_id:s.id}]).select().single();if(h)throw console.error("Error creating outfit:",h),h;if(u.itemIds.length>0){const{error:f}=await xr.from("outfit_items").insert(u.itemIds.map(p=>({outfit_id:d.id,clothing_item_id:p})));if(f)throw console.error("Error adding items to outfit:",f),f}return await i(),d},a=async(u,d)=>{const{data:h,error:f}=await xr.from("outfits").update(d).eq("id",u).select().single();if(f)throw console.error("Error updating outfit:",f),f;return t(p=>p.map(_=>_.id===u?{..._,...h}:_)),h},l=async u=>{const{error:d}=await xr.from("outfits").delete().eq("id",u);if(d)throw console.error("Error deleting outfit:",d),d;t(h=>h.filter(f=>f.id!==u))},c=async u=>{const d=e.find(h=>h.id===u);d&&await a(u,{is_favorite:!d.is_favorite})};return C.useEffect(()=>{i()},[s]),{outfits:e,loading:r,createOutfit:o,updateOutfit:a,deleteOutfit:l,toggleFavorite:c,refetch:i}},_p=()=>{const{user:e}=Do(),{toast:t}=vi(),[r,n]=C.useState(null),[s,i]=C.useState(!0);C.useEffect(()=>{e?o():(n(null),i(!1))},[e]);const o=async()=>{try{const{data:u,error:d}=await xr.from("profiles").select("*").eq("id",e==null?void 0:e.id).single();if(d&&d.code!=="PGRST116")throw d;if(u)n(u);else{const h={id:e==null?void 0:e.id,email:e==null?void 0:e.email,full_name:null,avatar_url:null},{error:f}=await xr.from("profiles").insert([h]);f?console.error("Error creating profile:",f):n(h)}}catch(u){console.error("Error fetching profile:",u)}finally{i(!1)}};return{profile:r,loading:s,updateProfile:async u=>{try{const{error:d}=await xr.from("profiles").update(u).eq("id",e==null?void 0:e.id);if(d)throw d;return n(h=>h?{...h,...u}:null),t({title:"Profile updated",description:"Your profile has been updated successfully."}),{success:!0}}catch(d){return console.error("Error updating profile:",d),t({title:"Error updating profile",description:"Please try again.",variant:"destructive"}),{success:!1,error:d}}},getDisplayName:()=>r!=null&&r.full_name?r.full_name:r!=null&&r.email?r.email.split("@")[0]:"Fashion Enthusiast",getFirstName:()=>r!=null&&r.full_name?r.full_name.split(" ")[0]:r!=null&&r.email?r.email.split("@")[0]:"there",refetch:o}},mV="/assets/fashion-character-DR9pR-V0.png",hie=({onClose:e})=>{const[t,r]=C.useState(!0),[n,s]=C.useState(0),i=["Hey beautiful! ","Let's see how we're gonna style you today! ","Ready to discover your perfect outfit? "];return C.useEffect(()=>{const o=setInterval(()=>{s(l=>(l+1)%i.length)},3e3),a=setTimeout(()=>{r(!1),e==null||e()},8e3);return()=>{clearInterval(o),clearTimeout(a)}},[e]),t?m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm",children:m.jsx(vr,{className:"relative max-w-sm mx-4 p-6 bg-gradient-card shadow-elegant border-0 animate-bounce-in",children:m.jsxs("div",{className:"text-center space-y-4",children:[m.jsxs("div",{className:"relative inline-block",children:[m.jsx("img",{src:mV,alt:"Fashion Stylist Character",className:"w-32 h-32 mx-auto animate-float"}),m.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-gradient-primary rounded-full animate-pulse-glow"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h2",{className:"text-xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:i[n]}),m.jsx("div",{className:"flex justify-center space-x-1",children:i.map((o,a)=>m.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${a===n?"bg-primary scale-125":"bg-muted"}`},a))})]}),m.jsx("button",{onClick:()=>{r(!1),e==null||e()},className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-muted hover:bg-accent flex items-center justify-center text-muted-foreground hover:text-foreground transition-colors",children:""})]})})}):null},fie=()=>{const e=Ys(),{items:t}=Rd(),{outfits:r}=Fd(),{getFirstName:n}=_p(),[s,i]=C.useState(!0),[o,a]=C.useState(!1),l=t.slice(0,4),c=r.slice(0,3);return C.useEffect(()=>{localStorage.getItem("hasVisitedOutfitFlex")?i(!1):(a(!0),localStorage.setItem("hasVisitedOutfitFlex","true"))},[]),m.jsxs(m.Fragment,{children:[o&&s&&m.jsx(hie,{onClose:()=>i(!1)}),m.jsxs("div",{className:"space-y-6 pb-6 animate-fade-in",children:[m.jsxs("div",{className:"relative px-4 pt-8 pb-6 bg-gradient-hero rounded-b-[2rem] shadow-elegant",children:[m.jsxs("div",{className:"text-center text-white space-y-3",children:[m.jsxs("div",{className:"flex justify-center items-center gap-2 mb-2",children:[m.jsx(Ao,{className:"h-6 w-6 text-pink-200 animate-pulse"}),m.jsx("h1",{className:"text-3xl font-bold",children:"OutfitFlex"}),m.jsx(hd,{className:"h-6 w-6 text-yellow-200 animate-pulse"})]}),m.jsx("p",{className:"text-purple-100 text-lg font-medium",children:"Your Personal Style Companion"}),m.jsxs("p",{className:"text-purple-200 text-sm max-w-xs mx-auto",children:["Hey ",n(),"! Discover perfect outfits with AI-powered styling magic "]})]}),m.jsx("div",{className:"absolute top-4 left-4 w-4 h-4 bg-white/20 rounded-full animate-float"}),m.jsx("div",{className:"absolute top-8 right-6 w-3 h-3 bg-pink-300/30 rounded-full animate-float",style:{animationDelay:"1s"}}),m.jsx("div",{className:"absolute bottom-4 left-8 w-2 h-2 bg-yellow-300/40 rounded-full animate-float",style:{animationDelay:"2s"}})]}),m.jsxs("div",{className:"px-4 space-y-6",children:[m.jsx(vr,{className:"relative overflow-hidden bg-gradient-primary text-white shadow-glow border-0 group hover:shadow-elegant transition-all duration-300",children:m.jsxs(Cr,{className:"p-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"space-y-3",children:[m.jsx("h2",{className:"text-2xl font-bold",children:"Get Daily Outfit Ideas"}),m.jsx("p",{className:"text-purple-100 text-sm",children:"AI-powered suggestions tailored just for you"}),m.jsxs(Bt,{onClick:()=>e("/outfits/suggestions"),className:"bg-white/20 text-white border border-white/30 hover:bg-white hover:text-purple-600 transition-all duration-300 shadow-lg backdrop-blur-sm",children:[m.jsx(hs,{className:"h-4 w-4 mr-2"}),"Style Me Now"]})]}),m.jsxs("div",{className:"relative",children:[m.jsx(hs,{className:"h-16 w-16 opacity-60 group-hover:animate-pulse"}),m.jsx("div",{className:"absolute inset-0 bg-shimmer bg-[length:200%_100%] animate-shimmer opacity-30"})]})]}),m.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -translate-y-16 translate-x-16"}),m.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full translate-y-12 -translate-x-12"})]})}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs(vr,{className:"group hover:shadow-card transition-all duration-300 bg-gradient-card border-0 hover:scale-105 cursor-pointer",onClick:()=>e("/wardrobe"),children:[m.jsx(Wi,{className:"pb-2",children:m.jsxs(Gi,{className:"text-lg flex items-center gap-2 text-primary",children:[m.jsx("div",{className:"p-2 bg-primary/10 rounded-lg group-hover:bg-primary/20 transition-colors",children:m.jsx(hx,{className:"h-5 w-5"})}),"Wardrobe"]})}),m.jsxs(Cr,{className:"space-y-3",children:[m.jsx("p",{className:"text-3xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:t.length}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Fashion Items"}),m.jsx("div",{className:"h-1 w-full bg-gradient-primary rounded-full opacity-30"})]})]}),m.jsxs(vr,{className:"group hover:shadow-card transition-all duration-300 bg-gradient-card border-0 hover:scale-105 cursor-pointer",onClick:()=>e("/outfits"),children:[m.jsx(Wi,{className:"pb-2",children:m.jsxs(Gi,{className:"text-lg flex items-center gap-2 text-secondary",children:[m.jsx("div",{className:"p-2 bg-secondary/10 rounded-lg group-hover:bg-secondary/20 transition-colors",children:m.jsx(fx,{className:"h-5 w-5"})}),"Outfits"]})}),m.jsxs(Cr,{className:"space-y-3",children:[m.jsx("p",{className:"text-3xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:r.length}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Style Combos"}),m.jsx("div",{className:"h-1 w-full bg-gradient-secondary rounded-full opacity-30"})]})]})]}),l.length>0&&m.jsxs(vr,{className:"bg-gradient-card border-0 shadow-card",children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"text-lg flex items-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 bg-gradient-primary rounded-full animate-pulse"}),"Recent Additions"]})}),m.jsx(Cr,{children:m.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map((u,d)=>m.jsxs("div",{className:"group cursor-pointer hover:scale-105 transition-all duration-300",onClick:()=>e(`/wardrobe/item/${u.id}`),style:{animationDelay:`${d*100}ms`},children:[m.jsxs("div",{className:"aspect-square bg-muted rounded-xl overflow-hidden mb-3 shadow-sm group-hover:shadow-md transition-shadow relative",children:[u.image_url?m.jsx("img",{src:u.image_url,alt:u.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-secondary/10",children:m.jsx("div",{className:"w-12 h-12 rounded-full border-3 border-white shadow-lg",style:{backgroundColor:u.hex_color||u.color}})}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),m.jsx("h3",{className:"font-semibold text-sm truncate group-hover:text-primary transition-colors",children:u.name}),m.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:u.category})]},u.id))})})]}),c.length>0&&m.jsxs(vr,{className:"bg-gradient-card border-0 shadow-card",children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"text-lg flex items-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 bg-gradient-secondary rounded-full animate-pulse"}),"Latest Style Combos"]})}),m.jsx(Cr,{children:m.jsx("div",{className:"space-y-4",children:c.map((u,d)=>{var h,f,p,_;return m.jsxs("div",{className:"group flex items-center gap-4 p-3 rounded-xl hover:bg-accent/50 cursor-pointer transition-all duration-300 hover:shadow-sm animate-slide-up",onClick:()=>e(`/outfits/detail/${u.id}`),style:{animationDelay:`${d*150}ms`},children:[m.jsxs("div",{className:"flex -space-x-3",children:[(h=u.items)==null?void 0:h.slice(0,3).map((w,y)=>{var g,v;return m.jsx("div",{className:"w-10 h-10 rounded-full border-3 border-white bg-muted overflow-hidden shadow-md group-hover:scale-110 transition-transform",style:{zIndex:10-y,animationDelay:`${y*100}ms`},children:(g=w.clothing_item)!=null&&g.image_url?m.jsx("img",{src:w.clothing_item.image_url,alt:w.clothing_item.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full bg-gradient-primary/20",style:{backgroundColor:((v=w.clothing_item)==null?void 0:v.color)||"#e5e7eb"}})},w.id)}),(((f=u.items)==null?void 0:f.length)||0)>3&&m.jsxs("div",{className:"w-10 h-10 rounded-full border-3 border-white bg-gradient-primary flex items-center justify-center text-white text-xs font-bold shadow-md",children:["+",(((p=u.items)==null?void 0:p.length)||0)-3]})]}),m.jsxs("div",{className:"flex-1 space-y-1",children:[m.jsx("h3",{className:"font-semibold text-sm group-hover:text-primary transition-colors",children:u.name}),m.jsxs("p",{className:"text-xs text-muted-foreground",children:[((_=u.items)==null?void 0:_.length)||0," pieces  Perfect match"]})]}),m.jsx("div",{className:"text-primary opacity-0 group-hover:opacity-100 transition-opacity",children:""})]},u.id)})})})]})]}),m.jsxs("div",{className:"flex justify-center gap-4 px-4 pt-4",children:[m.jsxs(Bt,{onClick:()=>e("/wardrobe/add"),className:"flex-1 bg-gradient-primary hover:shadow-elegant transition-all duration-300 border-0 shadow-lg",children:[m.jsx(C3,{className:"h-4 w-4 mr-2"}),"Add New Item"]}),m.jsxs(Bt,{variant:"outline",onClick:()=>e("/outfits/suggestions"),className:"flex-1 border-2 border-primary/30 hover:bg-primary hover:text-white transition-all duration-300",children:[m.jsx(hs,{className:"h-4 w-4 mr-2"}),"Style Me"]})]})]})]})};function pie(e,t=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];function c(d){const{scope:h,children:f,...p}=d,_=(h==null?void 0:h[e][l])||a,w=C.useMemo(()=>p,Object.values(p));return m.jsx(_.Provider,{value:w,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=C.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[e])||i;return C.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[n,mie(s,...t)]}function mie(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return C.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var gie=C.createContext(void 0);function RT(e){const t=C.useContext(gie);return e||t||"ltr"}var ew="rovingFocusGroup.onEntryFocus",_ie={bubbles:!1,cancelable:!0},Py="RovingFocusGroup",[a1,gV,yie]=AM(Py),[vie,_V]=pie(Py,[yie]),[wie,bie]=vie(Py),yV=C.forwardRef((e,t)=>m.jsx(a1.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(a1.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(xie,{...e,ref:t})})}));yV.displayName=Py;var xie=C.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=C.useRef(null),f=kr(t,h),p=RT(i),[_=null,w]=Tc({prop:o,defaultProp:a,onChange:l}),[y,g]=C.useState(!1),v=ms(c),b=gV(r),x=C.useRef(!1),[M,E]=C.useState(0);return C.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(ew,v),()=>P.removeEventListener(ew,v)},[v]),m.jsx(wie,{scope:r,orientation:n,dir:p,loop:s,currentTabStopId:_,onItemFocus:C.useCallback(P=>w(P),[w]),onItemShiftTab:C.useCallback(()=>g(!0),[]),onFocusableItemAdd:C.useCallback(()=>E(P=>P+1),[]),onFocusableItemRemove:C.useCallback(()=>E(P=>P-1),[]),children:m.jsx(Nt.div,{tabIndex:y||M===0?-1:0,"data-orientation":n,...d,ref:f,style:{outline:"none",...e.style},onMouseDown:Ct(e.onMouseDown,()=>{x.current=!0}),onFocus:Ct(e.onFocus,P=>{const I=!x.current;if(P.target===P.currentTarget&&I&&!y){const O=new CustomEvent(ew,_ie);if(P.currentTarget.dispatchEvent(O),!O.defaultPrevented){const V=b().filter(X=>X.focusable),U=V.find(X=>X.active),B=V.find(X=>X.id===_),K=[U,B,...V].filter(Boolean).map(X=>X.ref.current);bV(K,u)}}x.current=!1}),onBlur:Ct(e.onBlur,()=>g(!1))})})}),vV="RovingFocusGroupItem",wV=C.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,...o}=e,a=Ga(),l=i||a,c=bie(vV,r),u=c.currentTabStopId===l,d=gV(r),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return C.useEffect(()=>{if(n)return h(),()=>f()},[n,h,f]),m.jsx(a1.ItemSlot,{scope:r,id:l,focusable:n,active:s,children:m.jsx(Nt.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:t,onMouseDown:Ct(e.onMouseDown,p=>{n?c.onItemFocus(l):p.preventDefault()}),onFocus:Ct(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:Ct(e.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){c.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const _=Eie(p,c.orientation,c.dir);if(_!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let y=d().filter(g=>g.focusable).map(g=>g.ref.current);if(_==="last")y.reverse();else if(_==="prev"||_==="next"){_==="prev"&&y.reverse();const g=y.indexOf(p.currentTarget);y=c.loop?Sie(y,g+1):y.slice(g+1)}setTimeout(()=>bV(y))}})})})});wV.displayName=vV;var Mie={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Tie(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Eie(e,t,r){const n=Tie(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Mie[n]}function bV(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function Sie(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Pie=yV,Cie=wV,FT="Tabs",[kie,qhe]=Dc(FT,[_V]),xV=_V(),[Aie,LT]=kie(FT),MV=C.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=e,u=RT(a),[d,h]=Tc({prop:n,onChange:s,defaultProp:i});return m.jsx(Aie,{scope:r,baseId:Ga(),value:d,onValueChange:h,orientation:o,dir:u,activationMode:l,children:m.jsx(Nt.div,{dir:u,"data-orientation":o,...c,ref:t})})});MV.displayName=FT;var TV="TabsList",EV=C.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,i=LT(TV,r),o=xV(r);return m.jsx(Pie,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:m.jsx(Nt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});EV.displayName=TV;var SV="TabsTrigger",PV=C.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...i}=e,o=LT(SV,r),a=xV(r),l=AV(o.baseId,n),c=$V(o.baseId,n),u=n===o.value;return m.jsx(Cie,{asChild:!0,...a,focusable:!s,active:u,children:m.jsx(Nt.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Ct(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?o.onValueChange(n):d.preventDefault()}),onKeyDown:Ct(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(n)}),onFocus:Ct(e.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!s&&d&&o.onValueChange(n)})})})});PV.displayName=SV;var CV="TabsContent",kV=C.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:i,...o}=e,a=LT(CV,r),l=AV(a.baseId,n),c=$V(a.baseId,n),u=n===a.value,d=C.useRef(u);return C.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),m.jsx(al,{present:s||u,children:({present:h})=>m.jsx(Nt.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});kV.displayName=CV;function AV(e,t){return`${e}-trigger-${t}`}function $V(e,t){return`${e}-content-${t}`}var $ie=MV,IV=EV,OV=PV,jV=kV;const BT=$ie,Cy=C.forwardRef(({className:e,...t},r)=>m.jsx(IV,{ref:r,className:zt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Cy.displayName=IV.displayName;const mc=C.forwardRef(({className:e,...t},r)=>m.jsx(OV,{ref:r,className:zt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));mc.displayName=OV.displayName;const gc=C.forwardRef(({className:e,...t},r)=>m.jsx(jV,{ref:r,className:zt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));gc.displayName=jV.displayName;const Iie=({name:e,category:t,color:r,hex_color:n,image:s})=>m.jsx(vr,{className:"overflow-hidden h-full animate-fade-in card-3d depth-shadow",children:m.jsxs(Cr,{className:"p-0 h-full flex flex-col",children:[m.jsx("div",{className:"aspect-square w-full overflow-hidden bg-muted",children:m.jsx("img",{src:s,alt:e,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-110"})}),m.jsxs("div",{className:"p-3",children:[m.jsx("h3",{className:"text-sm font-medium line-clamp-1",children:e}),m.jsxs("div",{className:"flex items-center justify-between mt-1",children:[m.jsx("span",{className:"text-xs text-muted-foreground",children:t}),m.jsx("div",{className:"w-4 h-4 rounded-full border border-border shadow-sm",style:{backgroundColor:n||r},"aria-label":`Color: ${r}`})]})]})]})}),ko=C.forwardRef(({className:e,type:t,...r},n)=>m.jsx("input",{type:t,className:zt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));ko.displayName="Input";function Nu({className:e,...t}){return m.jsx("div",{className:zt("animate-pulse rounded-md bg-muted",e),...t})}const Oie=["All","Tops","Bottoms","Dresses","Shoes","Accessories"],jie=()=>{const[e,t]=C.useState("All"),[r,n]=C.useState(""),s=Ys(),{items:i,loading:o}=Rd(),{getFirstName:a}=_p(),l=i.filter(c=>{const u=e==="All"||c.category===e,d=c.name.toLowerCase().includes(r.toLowerCase())||c.color.toLowerCase().includes(r.toLowerCase());return u&&d});return o?m.jsxs("div",{className:"space-y-6 pb-6 animate-fade-in",children:[m.jsx("div",{className:"relative px-4 pt-8 pb-6 bg-gradient-hero rounded-b-[2rem] shadow-elegant",children:m.jsxs("div",{className:"text-center text-white space-y-3",children:[m.jsxs("div",{className:"flex justify-center items-center gap-2 mb-2",children:[m.jsx(Ao,{className:"h-6 w-6 text-pink-200 animate-pulse"}),m.jsxs("h1",{className:"text-3xl font-bold",children:[a(),"'s Wardrobe"]}),m.jsx(hd,{className:"h-6 w-6 text-yellow-200 animate-pulse"})]}),m.jsx("p",{className:"text-purple-100 text-lg font-medium",children:"Your Fashion Collection"})]})}),m.jsx("div",{className:"px-4",children:m.jsx("div",{className:"grid grid-cols-2 gap-4",children:Array.from({length:6}).map((c,u)=>m.jsx(Nu,{className:"aspect-square rounded-xl"},u))})})]}):m.jsxs("div",{className:"space-y-6 pb-6 animate-fade-in",children:[m.jsxs("div",{className:"relative px-4 pt-8 pb-6 bg-gradient-hero rounded-b-[2rem] shadow-elegant",children:[m.jsxs("div",{className:"text-center text-white space-y-3",children:[m.jsxs("div",{className:"flex justify-center items-center gap-2 mb-2",children:[m.jsx(Ao,{className:"h-6 w-6 text-pink-200 animate-pulse"}),m.jsxs("h1",{className:"text-3xl font-bold",children:[a(),"'s Wardrobe"]}),m.jsx(hd,{className:"h-6 w-6 text-yellow-200 animate-pulse"})]}),m.jsx("p",{className:"text-purple-100 text-lg font-medium",children:"Your Fashion Collection"}),m.jsxs("p",{className:"text-purple-200 text-sm max-w-xs mx-auto",children:[i.length," beautiful items in your collection "]})]}),m.jsx("div",{className:"absolute top-4 left-4 w-4 h-4 bg-white/20 rounded-full animate-float"}),m.jsx("div",{className:"absolute top-8 right-6 w-3 h-3 bg-pink-300/30 rounded-full animate-float",style:{animationDelay:"1s"}}),m.jsx("div",{className:"absolute bottom-4 left-8 w-2 h-2 bg-yellow-300/40 rounded-full animate-float",style:{animationDelay:"2s"}})]}),m.jsxs("div",{className:"px-4 space-y-6",children:[m.jsxs("div",{className:"relative",children:[m.jsx(A3,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),m.jsx(ko,{placeholder:"Search your fashion items...",className:"pl-9 border-primary/20 focus:border-primary transition-colors rounded-xl bg-gradient-card",value:r,onChange:c=>n(c.target.value)})]}),m.jsxs(BT,{defaultValue:"All",value:e,onValueChange:t,children:[m.jsx("div",{className:"overflow-x-auto pb-2",children:m.jsx(Cy,{className:"bg-gradient-card h-auto p-1 w-auto shadow-sm border-0",children:Oie.map((c,u)=>m.jsx(mc,{value:c,className:"px-4 py-2 data-[state=active]:bg-gradient-primary data-[state=active]:text-white rounded-lg transition-all duration-300 data-[state=active]:shadow-md animate-slide-up",style:{animationDelay:`${u*100}ms`},children:c},c))})}),m.jsx(gc,{value:e,className:"mt-6",children:l.length===0?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("div",{className:"w-20 h-20 bg-gradient-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(hx,{className:"h-10 w-10 text-primary"})}),m.jsx("p",{className:"text-muted-foreground text-lg font-medium",children:i.length===0?"Your wardrobe is waiting for its first piece!":"No items match your search criteria."}),m.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:i.length===0?"Add your first fashion item to get started":"Try adjusting your search or category"})]}):m.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.map((c,u)=>m.jsx("div",{onClick:()=>s(`/wardrobe/item/${c.id}`),className:"group cursor-pointer hover:scale-105 transition-all duration-300 animate-slide-up",style:{animationDelay:`${u*100}ms`},children:m.jsx("div",{className:"bg-gradient-card rounded-xl overflow-hidden shadow-card group-hover:shadow-elegant transition-all duration-300",children:m.jsx(Iie,{id:c.id,name:c.name,category:c.category,color:c.color,hex_color:c.hex_color,image:c.image_url||"/placeholder.svg"})})},c.id))})})]})]}),m.jsx("div",{className:"flex justify-center pt-4 px-4",children:m.jsxs(Bt,{onClick:()=>s("/wardrobe/add"),className:"w-full max-w-xs bg-gradient-primary hover:shadow-elegant transition-all duration-300 border-0 shadow-lg",children:[m.jsx(hx,{className:"h-4 w-4 mr-2"}),"Add New Fashion Item"]})})]})},Die=["Yass queen! ","You're absolutely slaying! ","That outfit is giving main character energy! ","Obsessed with this look! ","Serving looks and I'm here for it! ","You understood the assignment! ","This fit is chef's kiss! ","Bestie, you look amazing! ","That style is everything! ","You're absolutely stunning! "],ky=({message:e,compliments:t=Die,isVisible:r=!0,onClose:n,autoHide:s=!0,duration:i=4e3})=>{const[o,a]=C.useState(r),[l,c]=C.useState(e||t[0]);return C.useEffect(()=>{a(r)},[r]),C.useEffect(()=>{if(o&&!e){const u=t[Math.floor(Math.random()*t.length)];c(u)}else e&&c(e)},[o,e,t]),C.useEffect(()=>{if(o&&s){const u=setTimeout(()=>{a(!1),n==null||n()},i);return()=>clearTimeout(u)}},[o,s,i,n]),o?m.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 animate-bounce-in w-[calc(100vw-2rem)] max-w-sm",children:m.jsx(vr,{className:"relative p-3 bg-gradient-card shadow-glow border-0",children:m.jsxs("div",{className:"flex items-start space-x-3",children:[m.jsxs("div",{className:"relative flex-shrink-0",children:[m.jsx("img",{src:mV,alt:"Fashion Stylist",className:"w-12 h-12 animate-float"}),m.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-gradient-primary rounded-full animate-pulse-glow"})]}),m.jsx("div",{className:"flex-1 min-w-0",children:m.jsx("p",{className:"text-sm font-medium bg-gradient-primary bg-clip-text text-transparent",children:l})}),n&&m.jsx("button",{onClick:()=>{a(!1),n()},className:"flex-shrink-0 w-6 h-6 rounded-full bg-muted hover:bg-accent flex items-center justify-center text-muted-foreground hover:text-foreground transition-colors text-xs",children:""})]})})}):null},Nie=()=>{const e=Ys(),{outfits:t,loading:r}=Fd(),{getFirstName:n}=_p(),[s,i]=et.useState(!1);et.useEffect(()=>{!r&&t.length>0&&i(!0)},[r,t.length]);const o=t.filter(c=>c.is_favorite),a=t.slice(0,5);if(r)return m.jsxs("div",{className:"space-y-6 pb-6 animate-fade-in",children:[m.jsx("div",{className:"relative px-4 pt-8 pb-6 bg-gradient-hero rounded-b-[2rem] shadow-elegant",children:m.jsxs("div",{className:"text-center text-white space-y-3",children:[m.jsxs("div",{className:"flex justify-center items-center gap-2 mb-2",children:[m.jsx(hs,{className:"h-6 w-6 text-pink-200 animate-pulse"}),m.jsxs("h1",{className:"text-3xl font-bold",children:[n(),"'s Outfits"]}),m.jsx(hd,{className:"h-6 w-6 text-yellow-200 animate-pulse"})]}),m.jsx("p",{className:"text-purple-100 text-lg font-medium",children:"Your Style Combinations"})]})}),m.jsx("div",{className:"px-4",children:m.jsx("div",{className:"grid gap-4",children:Array.from({length:3}).map((c,u)=>m.jsx(Nu,{className:"h-32 rounded-xl"},u))})})]});const l=({outfit:c})=>{var u;return m.jsx(vr,{className:"group cursor-pointer hover:shadow-card transition-all duration-300 bg-gradient-card border-0 hover:scale-105",onClick:()=>e(`/outfits/detail/${c.id}`),children:m.jsxs(Cr,{className:"p-4",children:[m.jsxs("div",{className:"flex justify-between items-start mb-2",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"font-semibold",children:c.name}),c.description&&m.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:c.description})]}),c.is_favorite&&m.jsx(Ao,{className:"h-4 w-4 fill-red-500 text-red-500 ml-2"})]}),m.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("span",{children:[((u=c.items)==null?void 0:u.length)||0," items"]}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Aq,{className:"h-3 w-3"}),c.times_worn]})]}),m.jsx("span",{children:new Date(c.created_at).toLocaleDateString()})]}),c.items&&c.items.length>0&&m.jsxs("div",{className:"flex -space-x-2 mt-3",children:[c.items.slice(0,4).map((d,h)=>{var f,p;return m.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-muted overflow-hidden",style:{zIndex:10-h},children:(f=d.clothing_item)!=null&&f.image_url?m.jsx("img",{src:d.clothing_item.image_url,alt:d.clothing_item.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full",style:{backgroundColor:((p=d.clothing_item)==null?void 0:p.color)||"#ccc"}})},d.id)}),c.items.length>4&&m.jsxs("div",{className:"w-8 h-8 rounded-full border-2 border-white bg-muted flex items-center justify-center text-xs font-medium",children:["+",c.items.length-4]})]})]})})};return m.jsxs("div",{className:"space-y-6 pb-6 animate-fade-in",children:[m.jsxs("div",{className:"relative px-4 pt-8 pb-6 bg-gradient-hero rounded-b-[2rem] shadow-elegant",children:[m.jsxs("div",{className:"text-center text-white space-y-3",children:[m.jsxs("div",{className:"flex justify-center items-center gap-2 mb-2",children:[m.jsx(hs,{className:"h-6 w-6 text-pink-200 animate-pulse"}),m.jsxs("h1",{className:"text-3xl font-bold",children:[n(),"'s Outfits"]}),m.jsx(hd,{className:"h-6 w-6 text-yellow-200 animate-pulse"})]}),m.jsx("p",{className:"text-purple-100 text-lg font-medium",children:"Your Style Combinations"}),m.jsxs("p",{className:"text-purple-200 text-sm max-w-xs mx-auto",children:[t.length," amazing outfits created with style "]})]}),m.jsx("div",{className:"absolute top-4 left-4 w-4 h-4 bg-white/20 rounded-full animate-float"}),m.jsx("div",{className:"absolute top-8 right-6 w-3 h-3 bg-pink-300/30 rounded-full animate-float",style:{animationDelay:"1s"}}),m.jsx("div",{className:"absolute bottom-4 left-8 w-2 h-2 bg-yellow-300/40 rounded-full animate-float",style:{animationDelay:"2s"}})]}),m.jsx("div",{className:"px-4 space-y-6",children:m.jsxs(BT,{defaultValue:"all",children:[m.jsxs(Cy,{className:"w-full bg-gradient-card border-0 shadow-sm h-auto p-1",children:[m.jsxs(mc,{value:"all",className:"flex-1 data-[state=active]:bg-gradient-primary data-[state=active]:text-white rounded-lg transition-all duration-300",children:["All (",t.length,")"]}),m.jsxs(mc,{value:"saved",className:"flex-1 data-[state=active]:bg-gradient-primary data-[state=active]:text-white rounded-lg transition-all duration-300",children:["Saved (",o.length,")"]}),m.jsx(mc,{value:"recent",className:"flex-1 data-[state=active]:bg-gradient-primary data-[state=active]:text-white rounded-lg transition-all duration-300",children:"Recent"})]}),m.jsx(gc,{value:"all",className:"mt-6 space-y-4",children:t.length===0?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("div",{className:"w-20 h-20 bg-gradient-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(fx,{className:"h-10 w-10 text-primary"})}),m.jsx("p",{className:"text-muted-foreground text-lg font-medium",children:"Ready to create your first outfit?"}),m.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Combine your wardrobe items into stunning outfits"})]}):m.jsx("div",{className:"space-y-4",children:t.map((c,u)=>m.jsx("div",{className:"animate-slide-up",style:{animationDelay:`${u*100}ms`},children:m.jsx(l,{outfit:c})},c.id))})}),m.jsx(gc,{value:"saved",className:"mt-6 space-y-4",children:o.length===0?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("div",{className:"w-20 h-20 bg-gradient-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(Ao,{className:"h-10 w-10 text-primary"})}),m.jsx("p",{className:"text-muted-foreground text-lg font-medium",children:"No saved outfits yet"}),m.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Mark your favorite outfits with a heart"})]}):m.jsx("div",{className:"space-y-4",children:o.map((c,u)=>m.jsx("div",{className:"animate-slide-up",style:{animationDelay:`${u*100}ms`},children:m.jsx(l,{outfit:c})},c.id))})}),m.jsx(gc,{value:"recent",className:"mt-6 space-y-4",children:a.length===0?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("div",{className:"w-20 h-20 bg-gradient-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(hs,{className:"h-10 w-10 text-primary"})}),m.jsx("p",{className:"text-muted-foreground text-lg font-medium",children:"No recent outfits to show"}),m.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Create some outfits to see them here"})]}):m.jsx("div",{className:"space-y-4",children:a.map((c,u)=>m.jsx("div",{className:"animate-slide-up",style:{animationDelay:`${u*100}ms`},children:m.jsx(l,{outfit:c})},c.id))})})]})}),m.jsx("div",{className:"flex justify-center pt-4 px-4",children:m.jsxs(Bt,{onClick:()=>e("/outfits/create"),className:"w-full max-w-xs bg-gradient-primary hover:shadow-elegant transition-all duration-300 border-0 shadow-lg",children:[m.jsx(fx,{className:"h-4 w-4 mr-2"}),"Create New Outfit"]})}),s&&m.jsx(ky,{message:`Your ${t.length} outfits are looking fire! `,isVisible:s,onClose:()=>i(!1),autoHide:!0,duration:3e3})]})};var zT="Avatar",[Rie,Qhe]=Dc(zT),[Fie,DV]=Rie(zT),NV=C.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[s,i]=C.useState("idle");return m.jsx(Fie,{scope:r,imageLoadingStatus:s,onImageLoadingStatusChange:i,children:m.jsx(Nt.span,{...n,ref:t})})});NV.displayName=zT;var RV="AvatarImage",FV=C.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:s=()=>{},...i}=e,o=DV(RV,r),a=Lie(n,i.referrerPolicy),l=ms(c=>{s(c),o.onImageLoadingStatusChange(c)});return Fn(()=>{a!=="idle"&&l(a)},[a,l]),a==="loaded"?m.jsx(Nt.img,{...i,ref:t,src:n}):null});FV.displayName=RV;var LV="AvatarFallback",BV=C.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...s}=e,i=DV(LV,r),[o,a]=C.useState(n===void 0);return C.useEffect(()=>{if(n!==void 0){const l=window.setTimeout(()=>a(!0),n);return()=>window.clearTimeout(l)}},[n]),o&&i.imageLoadingStatus!=="loaded"?m.jsx(Nt.span,{...s,ref:t}):null});BV.displayName=LV;function Lie(e,t){const[r,n]=C.useState("idle");return Fn(()=>{if(!e){n("error");return}let s=!0;const i=new window.Image,o=a=>()=>{s&&n(a)};return n("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=e,t&&(i.referrerPolicy=t),()=>{s=!1}},[e,t]),r}var zV=NV,VV=FV,UV=BV;const WV=C.forwardRef(({className:e,...t},r)=>m.jsx(zV,{ref:r,className:zt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));WV.displayName=zV.displayName;const GV=C.forwardRef(({className:e,...t},r)=>m.jsx(VV,{ref:r,className:zt("aspect-square h-full w-full",e),...t}));GV.displayName=VV.displayName;const HV=C.forwardRef(({className:e,...t},r)=>m.jsx(UV,{ref:r,className:zt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));HV.displayName=UV.displayName;var tw="focusScope.autoFocusOnMount",rw="focusScope.autoFocusOnUnmount",wO={bubbles:!1,cancelable:!0},Bie="FocusScope",VT=C.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[a,l]=C.useState(null),c=ms(s),u=ms(i),d=C.useRef(null),h=kr(t,_=>l(_)),f=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(n){let _=function(v){if(f.paused||!a)return;const b=v.target;a.contains(b)?d.current=b:Ma(d.current,{select:!0})},w=function(v){if(f.paused||!a)return;const b=v.relatedTarget;b!==null&&(a.contains(b)||Ma(d.current,{select:!0}))},y=function(v){if(document.activeElement===document.body)for(const x of v)x.removedNodes.length>0&&Ma(a)};document.addEventListener("focusin",_),document.addEventListener("focusout",w);const g=new MutationObserver(y);return a&&g.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",_),document.removeEventListener("focusout",w),g.disconnect()}}},[n,a,f.paused]),C.useEffect(()=>{if(a){xO.add(f);const _=document.activeElement;if(!a.contains(_)){const y=new CustomEvent(tw,wO);a.addEventListener(tw,c),a.dispatchEvent(y),y.defaultPrevented||(zie(Hie(KV(a)),{select:!0}),document.activeElement===_&&Ma(a))}return()=>{a.removeEventListener(tw,c),setTimeout(()=>{const y=new CustomEvent(rw,wO);a.addEventListener(rw,u),a.dispatchEvent(y),y.defaultPrevented||Ma(_??document.body,{select:!0}),a.removeEventListener(rw,u),xO.remove(f)},0)}}},[a,c,u,f]);const p=C.useCallback(_=>{if(!r&&!n||f.paused)return;const w=_.key==="Tab"&&!_.altKey&&!_.ctrlKey&&!_.metaKey,y=document.activeElement;if(w&&y){const g=_.currentTarget,[v,b]=Vie(g);v&&b?!_.shiftKey&&y===b?(_.preventDefault(),r&&Ma(v,{select:!0})):_.shiftKey&&y===v&&(_.preventDefault(),r&&Ma(b,{select:!0})):y===g&&_.preventDefault()}},[r,n,f.paused]);return m.jsx(Nt.div,{tabIndex:-1,...o,ref:h,onKeyDown:p})});VT.displayName=Bie;function zie(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Ma(n,{select:t}),document.activeElement!==r)return}function Vie(e){const t=KV(e),r=bO(t,e),n=bO(t.reverse(),e);return[r,n]}function KV(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function bO(e,t){for(const r of e)if(!Uie(r,{upTo:t}))return r}function Uie(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Wie(e){return e instanceof HTMLInputElement&&"select"in e}function Ma(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Wie(e)&&t&&e.select()}}var xO=Gie();function Gie(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=MO(e,t),e.unshift(t)},remove(t){var r;e=MO(e,t),(r=e[0])==null||r.resume()}}}function MO(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Hie(e){return e.filter(t=>t.tagName!=="A")}var nw=0;function qV(){C.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??TO()),document.body.insertAdjacentElement("beforeend",e[1]??TO()),nw++,()=>{nw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),nw--}},[])}function TO(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Dg="right-scroll-bar-position",Ng="width-before-scroll-bar",Kie="with-scroll-bars-hidden",qie="--removed-body-scroll-bar-size";function sw(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Qie(e,t){var r=C.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var Yie=typeof window<"u"?C.useLayoutEffect:C.useEffect,EO=new WeakMap;function Xie(e,t){var r=Qie(null,function(n){return e.forEach(function(s){return sw(s,n)})});return Yie(function(){var n=EO.get(r);if(n){var s=new Set(n),i=new Set(e),o=r.current;s.forEach(function(a){i.has(a)||sw(a,null)}),i.forEach(function(a){s.has(a)||sw(a,o)})}EO.set(r,e)},[e]),r}function Jie(e){return e}function Zie(e,t){t===void 0&&(t=Jie);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,n);return r.push(o),function(){r=r.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(a){return i(a)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var a=r;r=[],a.forEach(i),o=r}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),r}}}};return s}function eoe(e){e===void 0&&(e={});var t=Zie(null);return t.options=di({async:!0,ssr:!1},e),t}var QV=function(e){var t=e.sideCar,r=ll(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return C.createElement(n,di({},r))};QV.isSideCarExport=!0;function toe(e,t){return e.useMedium(t),QV}var YV=eoe(),iw=function(){},Ay=C.forwardRef(function(e,t){var r=C.useRef(null),n=C.useState({onScrollCapture:iw,onWheelCapture:iw,onTouchMoveCapture:iw}),s=n[0],i=n[1],o=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,f=e.noIsolation,p=e.inert,_=e.allowPinchZoom,w=e.as,y=w===void 0?"div":w,g=e.gapMode,v=ll(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=h,x=Xie([r,t]),M=di(di({},v),s);return C.createElement(C.Fragment,null,u&&C.createElement(b,{sideCar:YV,removeScrollBar:c,shards:d,noIsolation:f,inert:p,setCallbacks:i,allowPinchZoom:!!_,lockRef:r,gapMode:g}),o?C.cloneElement(C.Children.only(a),di(di({},M),{ref:x})):C.createElement(y,di({},M,{className:l,ref:x}),a))});Ay.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ay.classNames={fullWidth:Ng,zeroRight:Dg};var roe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function noe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=roe();return t&&e.setAttribute("nonce",t),e}function soe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function ioe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var ooe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=noe())&&(soe(t,r),ioe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},aoe=function(){var e=ooe();return function(t,r){C.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},XV=function(){var e=aoe(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},loe={left:0,top:0,right:0,gap:0},ow=function(e){return parseInt(e||"",10)||0},coe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[ow(r),ow(n),ow(s)]},uoe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return loe;var t=coe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},doe=XV(),Qu="data-scroll-locked",hoe=function(e,t,r,n){var s=e.left,i=e.top,o=e.right,a=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Kie,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(Qu,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Dg,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Ng,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Dg," .").concat(Dg,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Ng," .").concat(Ng,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Qu,`] {
    `).concat(qie,": ").concat(a,`px;
  }
`)},SO=function(){var e=parseInt(document.body.getAttribute(Qu)||"0",10);return isFinite(e)?e:0},foe=function(){C.useEffect(function(){return document.body.setAttribute(Qu,(SO()+1).toString()),function(){var e=SO()-1;e<=0?document.body.removeAttribute(Qu):document.body.setAttribute(Qu,e.toString())}},[])},poe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;foe();var i=C.useMemo(function(){return uoe(s)},[s]);return C.createElement(doe,{styles:hoe(i,!t,s,r?"":"!important")})},l1=!1;if(typeof window<"u")try{var Qm=Object.defineProperty({},"passive",{get:function(){return l1=!0,!0}});window.addEventListener("test",Qm,Qm),window.removeEventListener("test",Qm,Qm)}catch{l1=!1}var cu=l1?{passive:!1}:!1,moe=function(e){return e.tagName==="TEXTAREA"},JV=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!moe(e)&&r[t]==="visible")},goe=function(e){return JV(e,"overflowY")},_oe=function(e){return JV(e,"overflowX")},PO=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=ZV(e,n);if(s){var i=eU(e,n),o=i[1],a=i[2];if(o>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},yoe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},voe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},ZV=function(e,t){return e==="v"?goe(t):_oe(t)},eU=function(e,t){return e==="v"?yoe(t):voe(t)},woe=function(e,t){return e==="h"&&t==="rtl"?-1:1},boe=function(e,t,r,n,s){var i=woe(e,window.getComputedStyle(t).direction),o=i*n,a=r.target,l=t.contains(a),c=!1,u=o>0,d=0,h=0;do{var f=eU(e,a),p=f[0],_=f[1],w=f[2],y=_-w-i*p;(p||y)&&ZV(e,a)&&(d+=y,h+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(u&&(Math.abs(d)<1||!s)||!u&&(Math.abs(h)<1||!s))&&(c=!0),c},Ym=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},CO=function(e){return[e.deltaX,e.deltaY]},kO=function(e){return e&&"current"in e?e.current:e},xoe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Moe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Toe=0,uu=[];function Eoe(e){var t=C.useRef([]),r=C.useRef([0,0]),n=C.useRef(),s=C.useState(Toe++)[0],i=C.useState(XV)[0],o=C.useRef(e);C.useEffect(function(){o.current=e},[e]),C.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var _=QM([e.lockRef.current],(e.shards||[]).map(kO),!0).filter(Boolean);return _.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),_.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=C.useCallback(function(_,w){if("touches"in _&&_.touches.length===2||_.type==="wheel"&&_.ctrlKey)return!o.current.allowPinchZoom;var y=Ym(_),g=r.current,v="deltaX"in _?_.deltaX:g[0]-y[0],b="deltaY"in _?_.deltaY:g[1]-y[1],x,M=_.target,E=Math.abs(v)>Math.abs(b)?"h":"v";if("touches"in _&&E==="h"&&M.type==="range")return!1;var P=PO(E,M);if(!P)return!0;if(P?x=E:(x=E==="v"?"h":"v",P=PO(E,M)),!P)return!1;if(!n.current&&"changedTouches"in _&&(v||b)&&(n.current=x),!x)return!0;var I=n.current||x;return boe(I,w,_,I==="h"?v:b,!0)},[]),l=C.useCallback(function(_){var w=_;if(!(!uu.length||uu[uu.length-1]!==i)){var y="deltaY"in w?CO(w):Ym(w),g=t.current.filter(function(x){return x.name===w.type&&(x.target===w.target||w.target===x.shadowParent)&&xoe(x.delta,y)})[0];if(g&&g.should){w.cancelable&&w.preventDefault();return}if(!g){var v=(o.current.shards||[]).map(kO).filter(Boolean).filter(function(x){return x.contains(w.target)}),b=v.length>0?a(w,v[0]):!o.current.noIsolation;b&&w.cancelable&&w.preventDefault()}}},[]),c=C.useCallback(function(_,w,y,g){var v={name:_,delta:w,target:y,should:g,shadowParent:Soe(y)};t.current.push(v),setTimeout(function(){t.current=t.current.filter(function(b){return b!==v})},1)},[]),u=C.useCallback(function(_){r.current=Ym(_),n.current=void 0},[]),d=C.useCallback(function(_){c(_.type,CO(_),_.target,a(_,e.lockRef.current))},[]),h=C.useCallback(function(_){c(_.type,Ym(_),_.target,a(_,e.lockRef.current))},[]);C.useEffect(function(){return uu.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,cu),document.addEventListener("touchmove",l,cu),document.addEventListener("touchstart",u,cu),function(){uu=uu.filter(function(_){return _!==i}),document.removeEventListener("wheel",l,cu),document.removeEventListener("touchmove",l,cu),document.removeEventListener("touchstart",u,cu)}},[]);var f=e.removeScrollBar,p=e.inert;return C.createElement(C.Fragment,null,p?C.createElement(i,{styles:Moe(s)}):null,f?C.createElement(poe,{gapMode:e.gapMode}):null)}function Soe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Poe=toe(YV,Eoe);var UT=C.forwardRef(function(e,t){return C.createElement(Ay,di({},e,{ref:t,sideCar:Poe}))});UT.classNames=Ay.classNames;var Coe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},du=new WeakMap,Xm=new WeakMap,Jm={},aw=0,tU=function(e){return e&&(e.host||tU(e.parentNode))},koe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=tU(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Aoe=function(e,t,r,n){var s=koe(t,Array.isArray(e)?e:[e]);Jm[r]||(Jm[r]=new WeakMap);var i=Jm[r],o=[],a=new Set,l=new Set(s),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var f=h.getAttribute(n),p=f!==null&&f!=="false",_=(du.get(h)||0)+1,w=(i.get(h)||0)+1;du.set(h,_),i.set(h,w),o.push(h),_===1&&p&&Xm.set(h,!0),w===1&&h.setAttribute(r,"true"),p||h.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",h,y)}})};return u(t),a.clear(),aw++,function(){o.forEach(function(d){var h=du.get(d)-1,f=i.get(d)-1;du.set(d,h),i.set(d,f),h||(Xm.has(d)||d.removeAttribute(n),Xm.delete(d)),f||d.removeAttribute(r)}),aw--,aw||(du=new WeakMap,du=new WeakMap,Xm=new WeakMap,Jm={})}},rU=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=Coe(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),Aoe(n,s,r,"aria-hidden")):function(){return null}},WT="Dialog",[nU,Yhe]=Dc(WT),[$oe,no]=nU(WT),sU=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,a=C.useRef(null),l=C.useRef(null),[c=!1,u]=Tc({prop:n,defaultProp:s,onChange:i});return m.jsx($oe,{scope:t,triggerRef:a,contentRef:l,contentId:Ga(),titleId:Ga(),descriptionId:Ga(),open:c,onOpenChange:u,onOpenToggle:C.useCallback(()=>u(d=>!d),[u]),modal:o,children:r})};sU.displayName=WT;var iU="DialogTrigger",oU=C.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=no(iU,r),i=kr(t,s.triggerRef);return m.jsx(Nt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":KT(s.open),...n,ref:i,onClick:Ct(e.onClick,s.onOpenToggle)})});oU.displayName=iU;var GT="DialogPortal",[Ioe,aU]=nU(GT,{forceMount:void 0}),lU=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,i=no(GT,t);return m.jsx(Ioe,{scope:t,forceMount:r,children:C.Children.map(n,o=>m.jsx(al,{present:r||i.open,children:m.jsx(iy,{asChild:!0,container:s,children:o})}))})};lU.displayName=GT;var $_="DialogOverlay",cU=C.forwardRef((e,t)=>{const r=aU($_,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=no($_,e.__scopeDialog);return i.modal?m.jsx(al,{present:n||i.open,children:m.jsx(Ooe,{...s,ref:t})}):null});cU.displayName=$_;var Ooe=C.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=no($_,r);return m.jsx(UT,{as:Mc,allowPinchZoom:!0,shards:[s.contentRef],children:m.jsx(Nt.div,{"data-state":KT(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Sc="DialogContent",uU=C.forwardRef((e,t)=>{const r=aU(Sc,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=no(Sc,e.__scopeDialog);return m.jsx(al,{present:n||i.open,children:i.modal?m.jsx(joe,{...s,ref:t}):m.jsx(Doe,{...s,ref:t})})});uU.displayName=Sc;var joe=C.forwardRef((e,t)=>{const r=no(Sc,e.__scopeDialog),n=C.useRef(null),s=kr(t,r.contentRef,n);return C.useEffect(()=>{const i=n.current;if(i)return rU(i)},[]),m.jsx(dU,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ct(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ct(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:Ct(e.onFocusOutside,i=>i.preventDefault())})}),Doe=C.forwardRef((e,t)=>{const r=no(Sc,e.__scopeDialog),n=C.useRef(!1),s=C.useRef(!1);return m.jsx(dU,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(n.current||(a=r.triggerRef.current)==null||a.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=r.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),dU=C.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=e,a=no(Sc,r),l=C.useRef(null),c=kr(t,l);return qV(),m.jsxs(m.Fragment,{children:[m.jsx(VT,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:m.jsx(cp,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":KT(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),m.jsxs(m.Fragment,{children:[m.jsx(Noe,{titleId:a.titleId}),m.jsx(Foe,{contentRef:l,descriptionId:a.descriptionId})]})]})}),HT="DialogTitle",hU=C.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=no(HT,r);return m.jsx(Nt.h2,{id:s.titleId,...n,ref:t})});hU.displayName=HT;var fU="DialogDescription",pU=C.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=no(fU,r);return m.jsx(Nt.p,{id:s.descriptionId,...n,ref:t})});pU.displayName=fU;var mU="DialogClose",gU=C.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=no(mU,r);return m.jsx(Nt.button,{type:"button",...n,ref:t,onClick:Ct(e.onClick,()=>s.onOpenChange(!1))})});gU.displayName=mU;function KT(e){return e?"open":"closed"}var _U="DialogTitleWarning",[Xhe,yU]=L9(_U,{contentName:Sc,titleName:HT,docsSlug:"dialog"}),Noe=({titleId:e})=>{const t=yU(_U),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return C.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Roe="DialogDescriptionWarning",Foe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${yU(Roe).contentName}}.`;return C.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Loe=sU,Boe=oU,zoe=lU,vU=cU,wU=uU,bU=hU,xU=pU,Voe=gU;const MU=Loe,TU=Boe,Uoe=zoe,EU=C.forwardRef(({className:e,...t},r)=>m.jsx(vU,{ref:r,className:zt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));EU.displayName=vU.displayName;const qT=C.forwardRef(({className:e,children:t,...r},n)=>m.jsxs(Uoe,{children:[m.jsx(EU,{}),m.jsxs(wU,{ref:n,className:zt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,m.jsxs(Voe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[m.jsx(O3,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qT.displayName=wU.displayName;const QT=({className:e,...t})=>m.jsx("div",{className:zt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});QT.displayName="DialogHeader";const YT=C.forwardRef(({className:e,...t},r)=>m.jsx(bU,{ref:r,className:zt("text-lg font-semibold leading-none tracking-tight",e),...t}));YT.displayName=bU.displayName;const Woe=C.forwardRef(({className:e,...t},r)=>m.jsx(xU,{ref:r,className:zt("text-sm text-muted-foreground",e),...t}));Woe.displayName=xU.displayName;var Goe="Label",SU=C.forwardRef((e,t)=>m.jsx(Nt.label,{...e,ref:t,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));SU.displayName=Goe;var PU=SU;const Hoe=ly("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c1=C.forwardRef(({className:e,...t},r)=>m.jsx(PU,{ref:r,className:zt(Hoe(),e),...t}));c1.displayName=PU.displayName;const Koe=({children:e})=>{const{profile:t,updateProfile:r}=_p(),[n,s]=C.useState((t==null?void 0:t.full_name)||""),[i,o]=C.useState(!1),[a,l]=C.useState(!1),c=async()=>{l(!0),(await r({full_name:n})).success&&o(!1),l(!1)};return m.jsxs(MU,{open:i,onOpenChange:o,children:[m.jsx(TU,{asChild:!0,children:e}),m.jsxs(qT,{className:"sm:max-w-md bg-gradient-card border-0 shadow-elegant",children:[m.jsx(QT,{children:m.jsx(YT,{className:"text-center text-lg font-semibold bg-gradient-primary bg-clip-text text-transparent",children:"Edit Your Profile"})}),m.jsxs("div",{className:"space-y-4 py-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(c1,{htmlFor:"fullName",className:"text-sm font-medium",children:"Full Name"}),m.jsx(ko,{id:"fullName",placeholder:"Enter your full name",value:n,onChange:u=>s(u.target.value),className:"border-primary/20 focus:border-primary transition-colors"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(c1,{htmlFor:"email",className:"text-sm font-medium",children:"Email (read-only)"}),m.jsx(ko,{id:"email",value:(t==null?void 0:t.email)||"",disabled:!0,className:"bg-muted text-muted-foreground"})]})]}),m.jsxs("div",{className:"flex gap-2 pt-4",children:[m.jsx(Bt,{variant:"outline",onClick:()=>o(!1),className:"flex-1",disabled:a,children:"Cancel"}),m.jsx(Bt,{onClick:c,className:"flex-1 bg-gradient-primary hover:shadow-elegant transition-all duration-300",disabled:a,children:a?"Saving...":"Save Changes"})]})]})]})},qoe=()=>{const{user:e,signOut:t}=Do(),{items:r}=Rd(),{outfits:n}=Fd(),{profile:s,getDisplayName:i,getFirstName:o}=_p(),{toast:a}=vi(),l=async()=>{try{await t(),a({title:"Signed out successfully",description:"You have been logged out of your account."})}catch{a({title:"Error signing out",description:"Please try again.",variant:"destructive"})}},c=r.filter(u=>u.is_favorite).length;return m.jsxs("div",{className:"space-y-6 pb-6 animate-fade-in",children:[m.jsxs("div",{className:"relative px-4 pt-8 pb-6 bg-gradient-hero rounded-b-[2rem] shadow-elegant",children:[m.jsxs("div",{className:"text-center text-white space-y-3",children:[m.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[m.jsx(hd,{className:"h-6 w-6 text-yellow-200 animate-pulse"}),m.jsxs("h1",{className:"text-3xl font-bold",children:["Hey ",o(),"!"]}),m.jsx(Ao,{className:"h-6 w-6 text-pink-200 animate-pulse"})]}),m.jsx("p",{className:"text-purple-100 text-lg font-medium",children:"Your Style Profile"})]}),m.jsx("div",{className:"absolute top-4 left-4 w-4 h-4 bg-white/20 rounded-full animate-float"}),m.jsx("div",{className:"absolute top-8 right-6 w-3 h-3 bg-pink-300/30 rounded-full animate-float",style:{animationDelay:"1s"}}),m.jsx("div",{className:"absolute bottom-4 left-8 w-2 h-2 bg-yellow-300/40 rounded-full animate-float",style:{animationDelay:"2s"}})]}),m.jsxs("div",{className:"px-4 space-y-6",children:[m.jsx(vr,{className:"bg-gradient-card border-0 shadow-card",children:m.jsxs(Cr,{className:"p-6 flex items-center space-x-4",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(WV,{className:"h-20 w-20 ring-4 ring-primary/20",children:[m.jsx(GV,{src:(s==null?void 0:s.avatar_url)||"",alt:"User"}),m.jsx(HV,{className:"bg-gradient-primary text-white text-lg font-bold",children:i().split(" ").map(u=>u[0]).join("").toUpperCase().slice(0,2)})]}),m.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-gradient-primary rounded-full flex items-center justify-center",children:m.jsx(hs,{className:"h-3 w-3 text-white"})})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h2",{className:"font-bold text-xl text-foreground",children:i()}),m.jsx("p",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email}),m.jsx("div",{className:"mt-2",children:m.jsx("span",{className:"text-xs bg-gradient-primary text-white px-2 py-1 rounded-full",children:"Style Enthusiast"})})]})]})}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[m.jsx("div",{className:"w-2 h-2 bg-gradient-primary rounded-full animate-pulse"}),"Your Fashion Stats"]}),m.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[m.jsx(vr,{className:"group hover:shadow-card transition-all duration-300 bg-gradient-card border-0 hover:scale-105",children:m.jsxs(Cr,{className:"p-4 text-center space-y-2",children:[m.jsx("h4",{className:"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:r.length}),m.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Fashion Items"}),m.jsx("div",{className:"h-1 w-full bg-gradient-primary rounded-full opacity-30"})]})}),m.jsx(vr,{className:"group hover:shadow-card transition-all duration-300 bg-gradient-card border-0 hover:scale-105",children:m.jsxs(Cr,{className:"p-4 text-center space-y-2",children:[m.jsx("h4",{className:"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:n.length}),m.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Style Combos"}),m.jsx("div",{className:"h-1 w-full bg-gradient-secondary rounded-full opacity-30"})]})}),m.jsx(vr,{className:"group hover:shadow-card transition-all duration-300 bg-gradient-card border-0 hover:scale-105",children:m.jsxs(Cr,{className:"p-4 text-center space-y-2",children:[m.jsx("h4",{className:"text-2xl font-bold bg-gradient-primary bg-clip-text text-transparent",children:c}),m.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Favorites"}),m.jsx("div",{className:"h-1 w-full bg-gradient-primary rounded-full opacity-30"})]})})]})]}),m.jsxs("div",{className:"space-y-3 pt-4",children:[m.jsx(Koe,{children:m.jsxs(Bt,{className:"w-full bg-gradient-primary hover:shadow-elegant transition-all duration-300 border-0 shadow-lg",children:[m.jsx(jq,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})}),m.jsxs(Bt,{className:"w-full border-2 border-primary/30 hover:bg-primary hover:text-white transition-all duration-300",variant:"outline",onClick:l,children:[m.jsx(Iq,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})]})},Qoe=()=>m.jsx(qoe,{}),Yoe=()=>{const e=Nc();return C.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),m.jsx("div",{className:"mobile-container flex items-center justify-center p-4",children:m.jsxs("div",{className:"text-center space-y-4",children:[m.jsx("div",{className:"bg-outfit-primary/10 w-24 h-24 rounded-full flex items-center justify-center mx-auto",children:m.jsx("span",{className:"text-4xl font-bold text-outfit-primary",children:"404"})}),m.jsx("h1",{className:"text-2xl font-bold",children:"Page not found"}),m.jsx("p",{className:"text-muted-foreground",children:"We couldn't find the page you're looking for."}),m.jsx(Bt,{asChild:!0,className:"mt-4",children:m.jsx("a",{href:"/",children:"Return to Home"})})]})})},$y=C.forwardRef(({className:e,...t},r)=>m.jsx("textarea",{className:zt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));$y.displayName="Textarea";function AO(e,[t,r]){return Math.min(r,Math.max(t,e))}function CU(e){const t=C.useRef({value:e,previous:e});return C.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Xoe=[" ","Enter","ArrowUp","ArrowDown"],Joe=[" ","Enter"],yp="Select",[Iy,Oy,Zoe]=AM(yp),[Ld,Jhe]=Dc(yp,[Zoe,fy]),jy=fy(),[eae,dl]=Ld(yp),[tae,rae]=Ld(yp),kU=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:i,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:f,form:p}=e,_=jy(t),[w,y]=C.useState(null),[g,v]=C.useState(null),[b,x]=C.useState(!1),M=RT(c),[E=!1,P]=Tc({prop:n,defaultProp:s,onChange:i}),[I,O]=Tc({prop:o,defaultProp:a,onChange:l}),V=C.useRef(null),U=w?p||!!w.closest("form"):!0,[B,Y]=C.useState(new Set),K=Array.from(B).map(X=>X.props.value).join(";");return m.jsx(iY,{..._,children:m.jsxs(eae,{required:f,scope:t,trigger:w,onTriggerChange:y,valueNode:g,onValueNodeChange:v,valueNodeHasChildren:b,onValueNodeHasChildrenChange:x,contentId:Ga(),value:I,onValueChange:O,open:E,onOpenChange:P,dir:M,triggerPointerDownPosRef:V,disabled:h,children:[m.jsx(Iy.Provider,{scope:t,children:m.jsx(tae,{scope:e.__scopeSelect,onNativeOptionAdd:C.useCallback(X=>{Y(G=>new Set(G).add(X))},[]),onNativeOptionRemove:C.useCallback(X=>{Y(G=>{const R=new Set(G);return R.delete(X),R})},[]),children:r})}),U?m.jsxs(eW,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:X=>O(X.target.value),disabled:h,form:p,children:[I===void 0?m.jsx("option",{value:""}):null,Array.from(B)]},K):null]})})};kU.displayName=yp;var AU="SelectTrigger",$U=C.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,i=jy(r),o=dl(AU,r),a=o.disabled||n,l=kr(t,o.onTriggerChange),c=Oy(r),u=C.useRef("touch"),[d,h,f]=tW(_=>{const w=c().filter(v=>!v.disabled),y=w.find(v=>v.value===o.value),g=rW(w,_,y);g!==void 0&&o.onValueChange(g.value)}),p=_=>{a||(o.onOpenChange(!0),f()),_&&(o.triggerPointerDownPosRef.current={x:Math.round(_.pageX),y:Math.round(_.pageY)})};return m.jsx(cB,{asChild:!0,...i,children:m.jsx(Nt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":ZU(o.value)?"":void 0,...s,ref:l,onClick:Ct(s.onClick,_=>{_.currentTarget.focus(),u.current!=="mouse"&&p(_)}),onPointerDown:Ct(s.onPointerDown,_=>{u.current=_.pointerType;const w=_.target;w.hasPointerCapture(_.pointerId)&&w.releasePointerCapture(_.pointerId),_.button===0&&_.ctrlKey===!1&&_.pointerType==="mouse"&&(p(_),_.preventDefault())}),onKeyDown:Ct(s.onKeyDown,_=>{const w=d.current!=="";!(_.ctrlKey||_.altKey||_.metaKey)&&_.key.length===1&&h(_.key),!(w&&_.key===" ")&&Xoe.includes(_.key)&&(p(),_.preventDefault())})})})});$U.displayName=AU;var IU="SelectValue",OU=C.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:i,placeholder:o="",...a}=e,l=dl(IU,r),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=kr(t,l.onValueNodeChange);return Fn(()=>{c(u)},[c,u]),m.jsx(Nt.span,{...a,ref:d,style:{pointerEvents:"none"},children:ZU(l.value)?m.jsx(m.Fragment,{children:o}):i})});OU.displayName=IU;var nae="SelectIcon",jU=C.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return m.jsx(Nt.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});jU.displayName=nae;var sae="SelectPortal",DU=e=>m.jsx(iy,{asChild:!0,...e});DU.displayName=sae;var Pc="SelectContent",NU=C.forwardRef((e,t)=>{const r=dl(Pc,e.__scopeSelect),[n,s]=C.useState();if(Fn(()=>{s(new DocumentFragment)},[]),!r.open){const i=n;return i?jc.createPortal(m.jsx(RU,{scope:e.__scopeSelect,children:m.jsx(Iy.Slot,{scope:e.__scopeSelect,children:m.jsx("div",{children:e.children})})}),i):null}return m.jsx(FU,{...e,ref:t})});NU.displayName=Pc;var ji=10,[RU,hl]=Ld(Pc),iae="SelectContentImpl",FU=C.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:_,avoidCollisions:w,...y}=e,g=dl(Pc,r),[v,b]=C.useState(null),[x,M]=C.useState(null),E=kr(t,fe=>b(fe)),[P,I]=C.useState(null),[O,V]=C.useState(null),U=Oy(r),[B,Y]=C.useState(!1),K=C.useRef(!1);C.useEffect(()=>{if(v)return rU(v)},[v]),qV();const X=C.useCallback(fe=>{const[Pe,...Ne]=U().map(se=>se.ref.current),[de]=Ne.slice(-1),Q=document.activeElement;for(const se of fe)if(se===Q||(se==null||se.scrollIntoView({block:"nearest"}),se===Pe&&x&&(x.scrollTop=0),se===de&&x&&(x.scrollTop=x.scrollHeight),se==null||se.focus(),document.activeElement!==Q))return},[U,x]),G=C.useCallback(()=>X([P,v]),[X,P,v]);C.useEffect(()=>{B&&G()},[B,G]);const{onOpenChange:R,triggerPointerDownPosRef:te}=g;C.useEffect(()=>{if(v){let fe={x:0,y:0};const Pe=de=>{var Q,se;fe={x:Math.abs(Math.round(de.pageX)-(((Q=te.current)==null?void 0:Q.x)??0)),y:Math.abs(Math.round(de.pageY)-(((se=te.current)==null?void 0:se.y)??0))}},Ne=de=>{fe.x<=10&&fe.y<=10?de.preventDefault():v.contains(de.target)||R(!1),document.removeEventListener("pointermove",Pe),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",Pe),document.addEventListener("pointerup",Ne,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Pe),document.removeEventListener("pointerup",Ne,{capture:!0})}}},[v,R,te]),C.useEffect(()=>{const fe=()=>R(!1);return window.addEventListener("blur",fe),window.addEventListener("resize",fe),()=>{window.removeEventListener("blur",fe),window.removeEventListener("resize",fe)}},[R]);const[re,L]=tW(fe=>{const Pe=U().filter(Q=>!Q.disabled),Ne=Pe.find(Q=>Q.ref.current===document.activeElement),de=rW(Pe,fe,Ne);de&&setTimeout(()=>de.ref.current.focus())}),j=C.useCallback((fe,Pe,Ne)=>{const de=!K.current&&!Ne;(g.value!==void 0&&g.value===Pe||de)&&(I(fe),de&&(K.current=!0))},[g.value]),q=C.useCallback(()=>v==null?void 0:v.focus(),[v]),ne=C.useCallback((fe,Pe,Ne)=>{const de=!K.current&&!Ne;(g.value!==void 0&&g.value===Pe||de)&&V(fe)},[g.value]),me=n==="popper"?u1:LU,ae=me===u1?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:_,avoidCollisions:w}:{};return m.jsx(RU,{scope:r,content:v,viewport:x,onViewportChange:M,itemRefCallback:j,selectedItem:P,onItemLeave:q,itemTextRefCallback:ne,focusSelectedItem:G,selectedItemText:O,position:n,isPositioned:B,searchRef:re,children:m.jsx(UT,{as:Mc,allowPinchZoom:!0,children:m.jsx(VT,{asChild:!0,trapped:g.open,onMountAutoFocus:fe=>{fe.preventDefault()},onUnmountAutoFocus:Ct(s,fe=>{var Pe;(Pe=g.trigger)==null||Pe.focus({preventScroll:!0}),fe.preventDefault()}),children:m.jsx(cp,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:fe=>fe.preventDefault(),onDismiss:()=>g.onOpenChange(!1),children:m.jsx(me,{role:"listbox",id:g.contentId,"data-state":g.open?"open":"closed",dir:g.dir,onContextMenu:fe=>fe.preventDefault(),...y,...ae,onPlaced:()=>Y(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Ct(y.onKeyDown,fe=>{const Pe=fe.ctrlKey||fe.altKey||fe.metaKey;if(fe.key==="Tab"&&fe.preventDefault(),!Pe&&fe.key.length===1&&L(fe.key),["ArrowUp","ArrowDown","Home","End"].includes(fe.key)){let de=U().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);if(["ArrowUp","End"].includes(fe.key)&&(de=de.slice().reverse()),["ArrowUp","ArrowDown"].includes(fe.key)){const Q=fe.target,se=de.indexOf(Q);de=de.slice(se+1)}setTimeout(()=>X(de)),fe.preventDefault()}})})})})})})});FU.displayName=iae;var oae="SelectItemAlignedPosition",LU=C.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,i=dl(Pc,r),o=hl(Pc,r),[a,l]=C.useState(null),[c,u]=C.useState(null),d=kr(t,E=>u(E)),h=Oy(r),f=C.useRef(!1),p=C.useRef(!0),{viewport:_,selectedItem:w,selectedItemText:y,focusSelectedItem:g}=o,v=C.useCallback(()=>{if(i.trigger&&i.valueNode&&a&&c&&_&&w&&y){const E=i.trigger.getBoundingClientRect(),P=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),O=y.getBoundingClientRect();if(i.dir!=="rtl"){const Q=O.left-P.left,se=I.left-Q,J=E.left-se,be=E.width+J,xe=Math.max(be,P.width),Te=window.innerWidth-ji,Ee=AO(se,[ji,Math.max(ji,Te-xe)]);a.style.minWidth=be+"px",a.style.left=Ee+"px"}else{const Q=P.right-O.right,se=window.innerWidth-I.right-Q,J=window.innerWidth-E.right-se,be=E.width+J,xe=Math.max(be,P.width),Te=window.innerWidth-ji,Ee=AO(se,[ji,Math.max(ji,Te-xe)]);a.style.minWidth=be+"px",a.style.right=Ee+"px"}const V=h(),U=window.innerHeight-ji*2,B=_.scrollHeight,Y=window.getComputedStyle(c),K=parseInt(Y.borderTopWidth,10),X=parseInt(Y.paddingTop,10),G=parseInt(Y.borderBottomWidth,10),R=parseInt(Y.paddingBottom,10),te=K+X+B+R+G,re=Math.min(w.offsetHeight*5,te),L=window.getComputedStyle(_),j=parseInt(L.paddingTop,10),q=parseInt(L.paddingBottom,10),ne=E.top+E.height/2-ji,me=U-ne,ae=w.offsetHeight/2,fe=w.offsetTop+ae,Pe=K+X+fe,Ne=te-Pe;if(Pe<=ne){const Q=V.length>0&&w===V[V.length-1].ref.current;a.style.bottom="0px";const se=c.clientHeight-_.offsetTop-_.offsetHeight,J=Math.max(me,ae+(Q?q:0)+se+G),be=Pe+J;a.style.height=be+"px"}else{const Q=V.length>0&&w===V[0].ref.current;a.style.top="0px";const J=Math.max(ne,K+_.offsetTop+(Q?j:0)+ae)+Ne;a.style.height=J+"px",_.scrollTop=Pe-ne+_.offsetTop}a.style.margin=`${ji}px 0`,a.style.minHeight=re+"px",a.style.maxHeight=U+"px",n==null||n(),requestAnimationFrame(()=>f.current=!0)}},[h,i.trigger,i.valueNode,a,c,_,w,y,i.dir,n]);Fn(()=>v(),[v]);const[b,x]=C.useState();Fn(()=>{c&&x(window.getComputedStyle(c).zIndex)},[c]);const M=C.useCallback(E=>{E&&p.current===!0&&(v(),g==null||g(),p.current=!1)},[v,g]);return m.jsx(lae,{scope:r,contentWrapper:a,shouldExpandOnScrollRef:f,onScrollButtonChange:M,children:m.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:b},children:m.jsx(Nt.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});LU.displayName=oae;var aae="SelectPopperPosition",u1=C.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=ji,...i}=e,o=jy(r);return m.jsx(uB,{...o,...i,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});u1.displayName=aae;var[lae,XT]=Ld(Pc,{}),d1="SelectViewport",BU=C.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,i=hl(d1,r),o=XT(d1,r),a=kr(t,i.onViewportChange),l=C.useRef(0);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),m.jsx(Iy.Slot,{scope:r,children:m.jsx(Nt.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Ct(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=o;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const p=window.innerHeight-ji*2,_=parseFloat(d.style.minHeight),w=parseFloat(d.style.height),y=Math.max(_,w);if(y<p){const g=y+f,v=Math.min(p,g),b=g-v;d.style.height=v+"px",d.style.bottom==="0px"&&(u.scrollTop=b>0?b:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});BU.displayName=d1;var zU="SelectGroup",[cae,uae]=Ld(zU),dae=C.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Ga();return m.jsx(cae,{scope:r,id:s,children:m.jsx(Nt.div,{role:"group","aria-labelledby":s,...n,ref:t})})});dae.displayName=zU;var VU="SelectLabel",UU=C.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=uae(VU,r);return m.jsx(Nt.div,{id:s.id,...n,ref:t})});UU.displayName=VU;var I_="SelectItem",[hae,WU]=Ld(I_),GU=C.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:i,...o}=e,a=dl(I_,r),l=hl(I_,r),c=a.value===n,[u,d]=C.useState(i??""),[h,f]=C.useState(!1),p=kr(t,g=>{var v;return(v=l.itemRefCallback)==null?void 0:v.call(l,g,n,s)}),_=Ga(),w=C.useRef("touch"),y=()=>{s||(a.onValueChange(n),a.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return m.jsx(hae,{scope:r,value:n,disabled:s,textId:_,isSelected:c,onItemTextChange:C.useCallback(g=>{d(v=>v||((g==null?void 0:g.textContent)??"").trim())},[]),children:m.jsx(Iy.ItemSlot,{scope:r,value:n,disabled:s,textValue:u,children:m.jsx(Nt.div,{role:"option","aria-labelledby":_,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:p,onFocus:Ct(o.onFocus,()=>f(!0)),onBlur:Ct(o.onBlur,()=>f(!1)),onClick:Ct(o.onClick,()=>{w.current!=="mouse"&&y()}),onPointerUp:Ct(o.onPointerUp,()=>{w.current==="mouse"&&y()}),onPointerDown:Ct(o.onPointerDown,g=>{w.current=g.pointerType}),onPointerMove:Ct(o.onPointerMove,g=>{var v;w.current=g.pointerType,s?(v=l.onItemLeave)==null||v.call(l):w.current==="mouse"&&g.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ct(o.onPointerLeave,g=>{var v;g.currentTarget===document.activeElement&&((v=l.onItemLeave)==null||v.call(l))}),onKeyDown:Ct(o.onKeyDown,g=>{var b;((b=l.searchRef)==null?void 0:b.current)!==""&&g.key===" "||(Joe.includes(g.key)&&y(),g.key===" "&&g.preventDefault())})})})})});GU.displayName=I_;var Qh="SelectItemText",HU=C.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...i}=e,o=dl(Qh,r),a=hl(Qh,r),l=WU(Qh,r),c=rae(Qh,r),[u,d]=C.useState(null),h=kr(t,y=>d(y),l.onItemTextChange,y=>{var g;return(g=a.itemTextRefCallback)==null?void 0:g.call(a,y,l.value,l.disabled)}),f=u==null?void 0:u.textContent,p=C.useMemo(()=>m.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:_,onNativeOptionRemove:w}=c;return Fn(()=>(_(p),()=>w(p)),[_,w,p]),m.jsxs(m.Fragment,{children:[m.jsx(Nt.span,{id:l.textId,...i,ref:h}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?jc.createPortal(i.children,o.valueNode):null]})});HU.displayName=Qh;var KU="SelectItemIndicator",qU=C.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return WU(KU,r).isSelected?m.jsx(Nt.span,{"aria-hidden":!0,...n,ref:t}):null});qU.displayName=KU;var h1="SelectScrollUpButton",QU=C.forwardRef((e,t)=>{const r=hl(h1,e.__scopeSelect),n=XT(h1,e.__scopeSelect),[s,i]=C.useState(!1),o=kr(t,n.onScrollButtonChange);return Fn(()=>{if(r.viewport&&r.isPositioned){let a=function(){const c=l.scrollTop>0;i(c)};const l=r.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[r.viewport,r.isPositioned]),s?m.jsx(XU,{...e,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=r;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});QU.displayName=h1;var f1="SelectScrollDownButton",YU=C.forwardRef((e,t)=>{const r=hl(f1,e.__scopeSelect),n=XT(f1,e.__scopeSelect),[s,i]=C.useState(!1),o=kr(t,n.onScrollButtonChange);return Fn(()=>{if(r.viewport&&r.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=r.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[r.viewport,r.isPositioned]),s?m.jsx(XU,{...e,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=r;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});YU.displayName=f1;var XU=C.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,i=hl("SelectScrollButton",r),o=C.useRef(null),a=Oy(r),l=C.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return C.useEffect(()=>()=>l(),[l]),Fn(()=>{var u;const c=a().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),m.jsx(Nt.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Ct(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:Ct(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:Ct(s.onPointerLeave,()=>{l()})})}),fae="SelectSeparator",JU=C.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return m.jsx(Nt.div,{"aria-hidden":!0,...n,ref:t})});JU.displayName=fae;var p1="SelectArrow",pae=C.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=jy(r),i=dl(p1,r),o=hl(p1,r);return i.open&&o.position==="popper"?m.jsx(dB,{...s,...n,ref:t}):null});pae.displayName=p1;function ZU(e){return e===""||e===void 0}var eW=C.forwardRef((e,t)=>{const{value:r,...n}=e,s=C.useRef(null),i=kr(t,s),o=CU(r);return C.useEffect(()=>{const a=s.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==r&&u){const d=new Event("change",{bubbles:!0});u.call(a,r),a.dispatchEvent(d)}},[o,r]),m.jsx(up,{asChild:!0,children:m.jsx("select",{...n,ref:i,defaultValue:r})})});eW.displayName="BubbleSelect";function tW(e){const t=ms(e),r=C.useRef(""),n=C.useRef(0),s=C.useCallback(o=>{const a=r.current+o;t(a),function l(c){r.current=c,window.clearTimeout(n.current),c!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(a)},[t]),i=C.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return C.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,i]}function rW(e,t,r){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=mae(e,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==r));const l=o.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==r?l:void 0}function mae(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var gae=kU,nW=$U,_ae=OU,yae=jU,vae=DU,sW=NU,wae=BU,iW=UU,oW=GU,bae=HU,xae=qU,aW=QU,lW=YU,cW=JU;const bo=gae,xo=_ae,Hi=C.forwardRef(({className:e,children:t,...r},n)=>m.jsxs(nW,{ref:n,className:zt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,m.jsx(yae,{asChild:!0,children:m.jsx(T3,{className:"h-4 w-4 opacity-50"})})]}));Hi.displayName=nW.displayName;const uW=C.forwardRef(({className:e,...t},r)=>m.jsx(aW,{ref:r,className:zt("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(kq,{className:"h-4 w-4"})}));uW.displayName=aW.displayName;const dW=C.forwardRef(({className:e,...t},r)=>m.jsx(lW,{ref:r,className:zt("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(T3,{className:"h-4 w-4"})}));dW.displayName=lW.displayName;const Ki=C.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>m.jsx(vae,{children:m.jsxs(sW,{ref:s,className:zt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[m.jsx(uW,{}),m.jsx(wae,{className:zt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),m.jsx(dW,{})]})}));Ki.displayName=sW.displayName;const Mae=C.forwardRef(({className:e,...t},r)=>m.jsx(iW,{ref:r,className:zt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Mae.displayName=iW.displayName;const qt=C.forwardRef(({className:e,children:t,...r},n)=>m.jsxs(oW,{ref:n,className:zt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[m.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m.jsx(xae,{children:m.jsx(cy,{className:"h-4 w-4"})})}),m.jsx(bae,{children:t})]}));qt.displayName=oW.displayName;const Tae=C.forwardRef(({className:e,...t},r)=>m.jsx(cW,{ref:r,className:zt("-mx-1 my-1 h-px bg-muted",e),...t}));Tae.displayName=cW.displayName;function Eae(e,t=[]){let r=[];function n(i,o){const a=C.createContext(o),l=r.length;r=[...r,o];function c(d){const{scope:h,children:f,...p}=d,_=(h==null?void 0:h[e][l])||a,w=C.useMemo(()=>p,Object.values(p));return m.jsx(_.Provider,{value:w,children:f})}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=C.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=r.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[e])||i;return C.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[n,Sae(s,...t)]}function Sae(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return C.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var JT="Progress",ZT=100,[Pae,Zhe]=Eae(JT),[Cae,kae]=Pae(JT),hW=C.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:s,getValueLabel:i=Aae,...o}=e;(s||s===0)&&!$O(s)&&console.error($ae(`${s}`,"Progress"));const a=$O(s)?s:ZT;n!==null&&!IO(n,a)&&console.error(Iae(`${n}`,"Progress"));const l=IO(n,a)?n:null,c=O_(l)?i(l,a):void 0;return m.jsx(Cae,{scope:r,value:l,max:a,children:m.jsx(Nt.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":O_(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":mW(l,a),"data-value":l??void 0,"data-max":a,...o,ref:t})})});hW.displayName=JT;var fW="ProgressIndicator",pW=C.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,s=kae(fW,r);return m.jsx(Nt.div,{"data-state":mW(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...n,ref:t})});pW.displayName=fW;function Aae(e,t){return`${Math.round(e/t*100)}%`}function mW(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function O_(e){return typeof e=="number"}function $O(e){return O_(e)&&!isNaN(e)&&e>0}function IO(e,t){return O_(e)&&!isNaN(e)&&e<=t&&e>=0}function $ae(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ZT}\`.`}function Iae(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ZT} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var gW=hW,Oae=pW;const _W=C.forwardRef(({className:e,value:t,...r},n)=>m.jsx(gW,{ref:n,className:zt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:m.jsx(Oae,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));_W.displayName=gW.displayName;const Rg=new Map,ql=[],jae=(e,t,r)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){const n=Rg.get(e);if(n===void 0)Rg.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){const s=ql.indexOf(e);s!==-1&&ql.splice(s,1);for(let i=0;i<ql.length;i++)if(Rg.get(ql[i]).priority<=r){ql.splice(i,0,e);return}ql.push(e)}return}throw new TypeError("not a valid backend")},Dae=async e=>{const t=Rg.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{const r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(n){return r||(t.error=`${n}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},Nae=async e=>{const t=e.executionProviders||[],r=t.map(l=>typeof l=="string"?l:l.name),n=r.length===0?ql:r;let s;const i=[],o=new Set;for(const l of n){const c=await Dae(l);typeof c=="string"?i.push({name:l,err:c}):(s||(s=c),s===c&&o.add(l))}if(!s)throw new Error(`no available backend found. ERR: ${i.map(l=>`[${l.name}] ${l.err}`).join(", ")}`);for(const{name:l,err:c}of i)r.includes(l)&&console.warn(`removing requested execution provider "${l}" from session options because it is not available: ${c}`);const a=t.filter(l=>o.has(typeof l=="string"?l:l.name));return[s,new Proxy(e,{get:(l,c)=>c==="executionProviders"?a:Reflect.get(l,c)})]},Rae="1.21.0";let OO="warning";const Yi={wasm:{},webgl:{},webgpu:{},versions:{common:Rae},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);OO=e}},get logLevel(){return OO}};Object.defineProperty(Yi,"logLevel",{enumerable:!0});const Fae=Yi,Lae=(e,t)=>{const r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];const n=r.getContext("2d");if(n!=null){let s,i;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[3]):(s=e.dims[3],i=e.dims[2]);const o=(t==null?void 0:t.format)!==void 0?t.format:"RGB",a=t==null?void 0:t.norm;let l,c;a===void 0||a.mean===void 0?l=[255,255,255,255]:typeof a.mean=="number"?l=[a.mean,a.mean,a.mean,a.mean]:(l=[a.mean[0],a.mean[1],a.mean[2],0],a.mean[3]!==void 0&&(l[3]=a.mean[3])),a===void 0||a.bias===void 0?c=[0,0,0,0]:typeof a.bias=="number"?c=[a.bias,a.bias,a.bias,a.bias]:(c=[a.bias[0],a.bias[1],a.bias[2],0],a.bias[3]!==void 0&&(c[3]=a.bias[3]));const u=i*s;let d=0,h=u,f=u*2,p=-1;o==="RGBA"?(d=0,h=u,f=u*2,p=u*3):o==="RGB"?(d=0,h=u,f=u*2):o==="RBG"&&(d=0,f=u,h=u*2);for(let _=0;_<i;_++)for(let w=0;w<s;w++){const y=(e.data[d++]-c[0])*l[0],g=(e.data[h++]-c[1])*l[1],v=(e.data[f++]-c[2])*l[2],b=p===-1?255:(e.data[p++]-c[3])*l[3];n.fillStyle="rgba("+y+","+g+","+v+","+b+")",n.fillRect(w,_,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Bae=(e,t)=>{const r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let n;if(r!=null){let s,i,o;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[1],o=e.dims[3]):(s=e.dims[3],i=e.dims[2],o=e.dims[1]);const a=t!==void 0&&t.format!==void 0?t.format:"RGB",l=t==null?void 0:t.norm;let c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],255],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));const d=i*s;if(t!==void 0&&(t.format!==void 0&&o===4&&t.format!=="RGBA"||o===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const h=4;let f=0,p=1,_=2,w=3,y=0,g=d,v=d*2,b=-1;a==="RGBA"?(y=0,g=d,v=d*2,b=d*3):a==="RGB"?(y=0,g=d,v=d*2):a==="RBG"&&(y=0,v=d,g=d*2),n=r.createImageData(s,i);for(let x=0;x<i*s;f+=h,p+=h,_+=h,w+=h,x++)n.data[f]=(e.data[y++]-u[0])*c[0],n.data[p]=(e.data[g++]-u[1])*c[1],n.data[_]=(e.data[v++]-u[2])*c[2],n.data[w]=b===-1?255:(e.data[b++]-u[3])*c[3]}else throw new Error("Can not access image data");return n},lw=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:r,width:n}=t,s=t.norm??{mean:255,bias:0};let i,o;typeof s.mean=="number"?i=[s.mean,s.mean,s.mean,s.mean]:i=[s.mean[0],s.mean[1],s.mean[2],s.mean[3]??255],typeof s.bias=="number"?o=[s.bias,s.bias,s.bias,s.bias]:o=[s.bias[0],s.bias[1],s.bias[2],s.bias[3]??0];const a=t.format!==void 0?t.format:"RGBA",l=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",c=r*n,u=l==="RGBA"?new Float32Array(c*4):new Float32Array(c*3);let d=4,h=0,f=1,p=2,_=3,w=0,y=c,g=c*2,v=-1;a==="RGB"&&(d=3,h=0,f=1,p=2,_=-1),l==="RGBA"?v=c*3:l==="RBG"?(w=0,g=c,y=c*2):l==="BGR"&&(g=0,y=c,w=c*2);for(let x=0;x<c;x++,h+=d,p+=d,f+=d,_+=d)u[w++]=(e[h]+o[0])/i[0],u[y++]=(e[f]+o[1])/i[1],u[g++]=(e[p]+o[2])/i[2],v!==-1&&_!==-1&&(u[v++]=(e[_]+o[3])/i[3]);return l==="RGBA"?new hi("float32",u,[1,4,r,n]):new hi("float32",u,[1,3,r,n])},zae=async(e,t)=>{const r=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,n=typeof ImageData<"u"&&e instanceof ImageData,s=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i=typeof e=="string";let o,a=t??{};const l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},c=u=>typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||u instanceof OffscreenCanvas?u.getContext("2d"):null;if(r){const u=l();u.width=e.width,u.height=e.height;const d=c(u);if(d!=null){let h=e.height,f=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(h=t.resizedHeight,f=t.resizedWidth),t!==void 0){if(a=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");a.tensorFormat="RGBA",a.height=h,a.width=f}else a.tensorFormat="RGBA",a.height=h,a.width=f;d.drawImage(e,0,0),o=d.getImageData(0,0,f,h).data}else throw new Error("Can not access image data")}else if(n){let u,d;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(u=t.resizedHeight,d=t.resizedWidth):(u=e.height,d=e.width),t!==void 0&&(a=t),a.format="RGBA",a.height=u,a.width=d,t!==void 0){const h=l();h.width=d,h.height=u;const f=c(h);if(f!=null)f.putImageData(e,0,0),o=f.getImageData(0,0,d,u).data;else throw new Error("Can not access image data")}else o=e.data}else if(s){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");const u=l();u.width=e.width,u.height=e.height;const d=c(u);if(d!=null){const h=e.height,f=e.width;return d.drawImage(e,0,0,f,h),o=d.getImageData(0,0,f,h).data,a.height=h,a.width=f,lw(o,a)}else throw new Error("Can not access image data")}else{if(i)return new Promise((u,d)=>{const h=l(),f=c(h);if(!e||!f)return d();const p=new Image;p.crossOrigin="Anonymous",p.src=e,p.onload=()=>{h.width=p.width,h.height=p.height,f.drawImage(p,0,0,h.width,h.height);const _=f.getImageData(0,0,h.width,h.height);a.height=h.height,a.width=h.width,u(lw(_.data,a))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(o!==void 0)return lw(o,a);throw new Error("Input data provided is not supported - aborted tensor creation")},Vae=(e,t)=>{const{width:r,height:n,download:s,dispose:i}=t,o=[1,n,r,4];return new hi({location:"texture",type:"float32",texture:e,dims:o,download:s,dispose:i})},Uae=(e,t)=>{const{dataType:r,dims:n,download:s,dispose:i}=t;return new hi({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:s,dispose:i})},Wae=(e,t)=>{const{dataType:r,dims:n,download:s,dispose:i}=t;return new hi({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:n,download:s,dispose:i})},Gae=(e,t,r)=>new hi({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]}),Ru=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Fg=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let jO=!1;const Hae=()=>{if(!jO){jO=!0;const e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,r=globalThis.Float16Array,n=typeof r<"u"&&r.from;e&&(Ru.set("int64",BigInt64Array),Fg.set(BigInt64Array,"int64")),t&&(Ru.set("uint64",BigUint64Array),Fg.set(BigUint64Array,"uint64")),n?(Ru.set("float16",r),Fg.set(r,"float16")):Ru.set("float16",Uint16Array)}},Kae=e=>{let t=1;for(let r=0;r<e.length;r++){const n=e[r];if(typeof n!="number"||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},qae=(e,t)=>{switch(e.location){case"cpu":return new hi(e.type,e.data,t);case"cpu-pinned":return new hi({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new hi({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new hi({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new hi({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}};let hi=class{constructor(t,r,n){Hae();let s,i;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,s=t.type,i=t.dims,t.location){case"cpu-pinned":{const a=Ru.get(s);if(!a)throw new TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(t.data instanceof a))throw new TypeError(`buffer should be of type ${a.name}`);this.cpuData=t.data;break}case"texture":{if(s!=="float32")throw new TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="uint8"&&s!=="bool"&&s!=="uint4"&&s!=="int4")throw new TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}case"ml-tensor":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="uint64"&&s!=="int8"&&s!=="uint8"&&s!=="bool"&&s!=="uint4"&&s!=="int4")throw new TypeError(`unsupported type "${s}" to create tensor from MLTensor`);this.mlTensorData=t.mlTensor,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,l;if(typeof t=="string")if(s=t,l=n,t==="string"){if(!Array.isArray(r))throw new TypeError("A string tensor's data must be a string array.");a=r}else{const c=Ru.get(t);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(r)){if(t==="float16"&&c===Uint16Array||t==="uint4"||t==="int4")throw new TypeError(`Creating a ${t} tensor from number array is not supported. Please use ${c.name} as data.`);t==="uint64"||t==="int64"?a=c.from(r,BigInt):a=c.from(r)}else if(r instanceof c)a=r;else if(r instanceof Uint8ClampedArray)if(t==="uint8")a=Uint8Array.from(r);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(t==="float16"&&r instanceof Uint16Array&&c!==Uint16Array)a=new globalThis.Float16Array(r.buffer,r.byteOffset,r.length);else throw new TypeError(`A ${s} tensor's data must be type of ${c}`)}else if(l=r,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const c=typeof t[0];if(c==="string")s="string",a=t;else if(c==="boolean")s="bool",a=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else if(t instanceof Uint8ClampedArray)s="uint8",a=Uint8Array.from(t);else{const c=Fg.get(t.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);s=c,a=t}if(l===void 0)l=[a.length];else if(!Array.isArray(l))throw new TypeError("A tensor's dims must be a number array");i=l,this.cpuData=a,this.dataLocation="cpu"}const o=Kae(i);if(this.cpuData&&o!==this.cpuData.length&&!((s==="uint4"||s==="int4")&&Math.ceil(o/2)===this.cpuData.length))throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=s,this.dims=i,this.size=o}static async fromImage(t,r){return zae(t,r)}static fromTexture(t,r){return Vae(t,r)}static fromGpuBuffer(t,r){return Uae(t,r)}static fromMLTensor(t,r){return Wae(t,r)}static fromPinnedBuffer(t,r,n){return Gae(t,r,n)}toDataURL(t){return Lae(this,t)}toImageData(t){return Bae(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(t){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const r=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=r,t&&this.disposer&&(this.disposer(),this.disposer=void 0),r}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return qae(this,t)}};const _u=hi,yW=(e,t)=>{(typeof Yi.trace>"u"?!Yi.wasm.trace:!Yi.trace)||console.timeStamp(`${e}::ORT::${t}`)},vW=(e,t)=>{var s;const r=((s=new Error().stack)==null?void 0:s.split(/\r\n|\r|\n/g))||[];let n=!1;for(let i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){let o=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;t&&(o+=`::${t}`),yW("CPU",o);return}r[i].includes("TRACE_FUNC")&&(n=!0)}},m1=e=>{(typeof Yi.trace>"u"?!Yi.wasm.trace:!Yi.trace)||vW("BEGIN",e)},g1=e=>{(typeof Yi.trace>"u"?!Yi.wasm.trace:!Yi.trace)||vW("END",e)};let Qae=class wW{constructor(t){this.handler=t}async run(t,r,n){m1();const s={};let i={};if(typeof t!="object"||t===null||t instanceof _u||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof _u)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(const c of r){if(typeof c!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(c)===-1)throw new RangeError(`'fetches' contains invalid output name: ${c}.`);s[c]=null}if(typeof n=="object"&&n!==null)i=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{let c=!1;const u=Object.getOwnPropertyNames(r);for(const d of this.outputNames)if(u.indexOf(d)!==-1){const h=r[d];(h===null||h instanceof _u)&&(c=!0,o=!1,s[d]=h)}if(c){if(typeof n=="object"&&n!==null)i=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else i=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const c of this.inputNames)if(typeof t[c]>"u")throw new Error(`input '${c}' is missing in 'feeds'.`);if(o)for(const c of this.outputNames)s[c]=null;const a=await this.handler.run(t,s,i),l={};for(const c in a)if(Object.hasOwnProperty.call(a,c)){const u=a[c];u instanceof _u?l[c]=u:l[c]=new _u(u.type,u.data,u.dims)}return g1(),l}async release(){return this.handler.dispose()}static async create(t,r,n,s){m1();let i,o={};if(typeof t=="string"){if(i=t,typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(i=t,typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){const u=t;let d=0,h=t.byteLength;if(typeof r=="object"&&r!==null)o=r;else if(typeof r=="number"){if(d=r,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=u.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${u.byteLength}).`);if(h=t.byteLength-d,typeof n=="number"){if(h=n,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>u.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${u.byteLength-d}].`);if(typeof s=="object"&&s!==null)o=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");i=new Uint8Array(u,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[a,l]=await Nae(o),c=await a.createInferenceSessionHandler(i,l);return g1(),new wW(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const Yae=Qae,Xae=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession:Yae,TRACE:yW,TRACE_FUNC_BEGIN:m1,TRACE_FUNC_END:g1,Tensor:_u,env:Fae,registerBackend:jae},Symbol.toStringTag,{value:"Module"}));/*!
 * ONNX Runtime Web v1.22.0-dev.20250409-89f8206ba4
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var eE=Object.defineProperty,Jae=Object.getOwnPropertyDescriptor,Zae=Object.getOwnPropertyNames,ele=Object.prototype.hasOwnProperty,tle=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),He=(e,t)=>()=>(e&&(t=e(e=0)),t),Bd=(e,t)=>{for(var r in t)eE(e,r,{get:t[r],enumerable:!0})},rle=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Zae(t))!ele.call(e,s)&&s!==r&&eE(e,s,{get:()=>t[s],enumerable:!(n=Jae(t,s))||n.enumerable});return e},Jf=e=>rle(eE({},"__esModule",{value:!0}),e),$h,ga,oc,DO,bW,xW=He(()=>{$h=new Map,ga=[],oc=(e,t,r)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let n=$h.get(e);if(n===void 0)$h.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let s=ga.indexOf(e);s!==-1&&ga.splice(s,1);for(let i=0;i<ga.length;i++)if($h.get(ga[i]).priority<=r){ga.splice(i,0,e);return}ga.push(e)}return}throw new TypeError("not a valid backend")},DO=async e=>{let t=$h.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(n){return r||(t.error=`${n}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},bW=async e=>{let t=e.executionProviders||[],r=t.map(l=>typeof l=="string"?l:l.name),n=r.length===0?ga:r,s,i=[],o=new Set;for(let l of n){let c=await DO(l);typeof c=="string"?i.push({name:l,err:c}):(s||(s=c),s===c&&o.add(l))}if(!s)throw new Error(`no available backend found. ERR: ${i.map(l=>`[${l.name}] ${l.err}`).join(", ")}`);for(let{name:l,err:c}of i)r.includes(l)&&console.warn(`removing requested execution provider "${l}" from session options because it is not available: ${c}`);let a=t.filter(l=>o.has(typeof l=="string"?l:l.name));return[s,new Proxy(e,{get:(l,c)=>c==="executionProviders"?a:Reflect.get(l,c)})]}}),nle=He(()=>{xW()}),MW,sle=He(()=>{MW="1.22.0-dev.20250409-89f8206ba4"}),cw,ai,TW=He(()=>{sle(),cw="warning",ai={wasm:{},webgl:{},webgpu:{},versions:{common:MW},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);cw=e}},get logLevel(){return cw}},Object.defineProperty(ai,"logLevel",{enumerable:!0})}),Pr,ile=He(()=>{TW(),Pr=ai}),EW,SW,ole=He(()=>{EW=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(n!=null){let s,i;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[3]):(s=e.dims[3],i=e.dims[2]);let o=(t==null?void 0:t.format)!==void 0?t.format:"RGB",a=t==null?void 0:t.norm,l,c;a===void 0||a.mean===void 0?l=[255,255,255,255]:typeof a.mean=="number"?l=[a.mean,a.mean,a.mean,a.mean]:(l=[a.mean[0],a.mean[1],a.mean[2],0],a.mean[3]!==void 0&&(l[3]=a.mean[3])),a===void 0||a.bias===void 0?c=[0,0,0,0]:typeof a.bias=="number"?c=[a.bias,a.bias,a.bias,a.bias]:(c=[a.bias[0],a.bias[1],a.bias[2],0],a.bias[3]!==void 0&&(c[3]=a.bias[3]));let u=i*s,d=0,h=u,f=u*2,p=-1;o==="RGBA"?(d=0,h=u,f=u*2,p=u*3):o==="RGB"?(d=0,h=u,f=u*2):o==="RBG"&&(d=0,f=u,h=u*2);for(let _=0;_<i;_++)for(let w=0;w<s;w++){let y=(e.data[d++]-c[0])*l[0],g=(e.data[h++]-c[1])*l[1],v=(e.data[f++]-c[2])*l[2],b=p===-1?255:(e.data[p++]-c[3])*l[3];n.fillStyle="rgba("+y+","+g+","+v+","+b+")",n.fillRect(w,_,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},SW=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),n;if(r!=null){let s,i,o;(t==null?void 0:t.tensorLayout)!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[1],o=e.dims[3]):(s=e.dims[3],i=e.dims[2],o=e.dims[1]);let a=t!==void 0&&t.format!==void 0?t.format:"RGB",l=t==null?void 0:t.norm,c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],255],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));let d=i*s;if(t!==void 0&&(t.format!==void 0&&o===4&&t.format!=="RGBA"||o===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,f=0,p=1,_=2,w=3,y=0,g=d,v=d*2,b=-1;a==="RGBA"?(y=0,g=d,v=d*2,b=d*3):a==="RGB"?(y=0,g=d,v=d*2):a==="RBG"&&(y=0,v=d,g=d*2),n=r.createImageData(s,i);for(let x=0;x<i*s;f+=h,p+=h,_+=h,w+=h,x++)n.data[f]=(e.data[y++]-u[0])*c[0],n.data[p]=(e.data[g++]-u[1])*c[1],n.data[_]=(e.data[v++]-u[2])*c[2],n.data[w]=b===-1?255:(e.data[b++]-u[3])*c[3]}else throw new Error("Can not access image data");return n}}),Zm,PW,CW,kW,AW,$W,ale=He(()=>{tE(),Zm=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:r,width:n}=t,s=t.norm??{mean:255,bias:0},i,o;typeof s.mean=="number"?i=[s.mean,s.mean,s.mean,s.mean]:i=[s.mean[0],s.mean[1],s.mean[2],s.mean[3]??255],typeof s.bias=="number"?o=[s.bias,s.bias,s.bias,s.bias]:o=[s.bias[0],s.bias[1],s.bias[2],s.bias[3]??0];let a=t.format!==void 0?t.format:"RGBA",l=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",c=r*n,u=l==="RGBA"?new Float32Array(c*4):new Float32Array(c*3),d=4,h=0,f=1,p=2,_=3,w=0,y=c,g=c*2,v=-1;a==="RGB"&&(d=3,h=0,f=1,p=2,_=-1),l==="RGBA"?v=c*3:l==="RBG"?(w=0,g=c,y=c*2):l==="BGR"&&(g=0,y=c,w=c*2);for(let b=0;b<c;b++,h+=d,p+=d,f+=d,_+=d)u[w++]=(e[h]+o[0])/i[0],u[y++]=(e[f]+o[1])/i[1],u[g++]=(e[p]+o[2])/i[2],v!==-1&&_!==-1&&(u[v++]=(e[_]+o[3])/i[3]);return l==="RGBA"?new Ls("float32",u,[1,4,r,n]):new Ls("float32",u,[1,3,r,n])},PW=async(e,t)=>{let r=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,n=typeof ImageData<"u"&&e instanceof ImageData,s=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i=typeof e=="string",o,a=t??{},l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},c=u=>typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||u instanceof OffscreenCanvas?u.getContext("2d"):null;if(r){let u=l();u.width=e.width,u.height=e.height;let d=c(u);if(d!=null){let h=e.height,f=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(h=t.resizedHeight,f=t.resizedWidth),t!==void 0){if(a=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");a.tensorFormat="RGBA",a.height=h,a.width=f}else a.tensorFormat="RGBA",a.height=h,a.width=f;d.drawImage(e,0,0),o=d.getImageData(0,0,f,h).data}else throw new Error("Can not access image data")}else if(n){let u,d;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(u=t.resizedHeight,d=t.resizedWidth):(u=e.height,d=e.width),t!==void 0&&(a=t),a.format="RGBA",a.height=u,a.width=d,t!==void 0){let h=l();h.width=d,h.height=u;let f=c(h);if(f!=null)f.putImageData(e,0,0),o=f.getImageData(0,0,d,u).data;else throw new Error("Can not access image data")}else o=e.data}else if(s){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let u=l();u.width=e.width,u.height=e.height;let d=c(u);if(d!=null){let h=e.height,f=e.width;return d.drawImage(e,0,0,f,h),o=d.getImageData(0,0,f,h).data,a.height=h,a.width=f,Zm(o,a)}else throw new Error("Can not access image data")}else{if(i)return new Promise((u,d)=>{let h=l(),f=c(h);if(!e||!f)return d();let p=new Image;p.crossOrigin="Anonymous",p.src=e,p.onload=()=>{h.width=p.width,h.height=p.height,f.drawImage(p,0,0,h.width,h.height);let _=f.getImageData(0,0,h.width,h.height);a.height=h.height,a.width=h.width,u(Zm(_.data,a))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(o!==void 0)return Zm(o,a);throw new Error("Input data provided is not supported - aborted tensor creation")},CW=(e,t)=>{let{width:r,height:n,download:s,dispose:i}=t,o=[1,n,r,4];return new Ls({location:"texture",type:"float32",texture:e,dims:o,download:s,dispose:i})},kW=(e,t)=>{let{dataType:r,dims:n,download:s,dispose:i}=t;return new Ls({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:s,dispose:i})},AW=(e,t)=>{let{dataType:r,dims:n,download:s,dispose:i}=t;return new Ls({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:n,download:s,dispose:i})},$W=(e,t,r)=>new Ls({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})}),Jl,Yh,uw,IW,lle=He(()=>{Jl=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Yh=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),uw=!1,IW=()=>{if(!uw){uw=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,r=globalThis.Float16Array,n=typeof r<"u"&&r.from;e&&(Jl.set("int64",BigInt64Array),Yh.set(BigInt64Array,"int64")),t&&(Jl.set("uint64",BigUint64Array),Yh.set(BigUint64Array,"uint64")),n?(Jl.set("float16",r),Yh.set(r,"float16")):Jl.set("float16",Uint16Array)}}}),OW,jW,cle=He(()=>{tE(),OW=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if(typeof n!="number"||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},jW=(e,t)=>{switch(e.location){case"cpu":return new Ls(e.type,e.data,t);case"cpu-pinned":return new Ls({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Ls({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Ls({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Ls({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Ls,tE=He(()=>{ole(),ale(),lle(),cle(),Ls=class{constructor(e,t,r){IW();let n,s;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,n=e.type,s=e.dims,e.location){case"cpu-pinned":{let o=Jl.get(n);if(!o)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof o))throw new TypeError(`buffer should be of type ${o.name}`);this.cpuData=e.data;break}case"texture":{if(n!=="float32")throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(n!=="float32"&&n!=="float16"&&n!=="int32"&&n!=="int64"&&n!=="uint32"&&n!=="uint8"&&n!=="bool"&&n!=="uint4"&&n!=="int4")throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(n!=="float32"&&n!=="float16"&&n!=="int32"&&n!=="int64"&&n!=="uint32"&&n!=="uint64"&&n!=="int8"&&n!=="uint8"&&n!=="bool"&&n!=="uint4"&&n!=="int4")throw new TypeError(`unsupported type "${n}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,a;if(typeof e=="string")if(n=e,a=r,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let l=Jl.get(e);if(l===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&l===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${l.name} as data.`);e==="uint64"||e==="int64"?o=l.from(t,BigInt):o=l.from(t)}else if(t instanceof l)o=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")o=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&t instanceof Uint16Array&&l!==Uint16Array)o=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw new TypeError(`A ${n} tensor's data must be type of ${l}`)}else if(a=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let l=typeof e[0];if(l==="string")n="string",o=e;else if(l==="boolean")n="bool",o=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${l}.`)}else if(e instanceof Uint8ClampedArray)n="uint8",o=Uint8Array.from(e);else{let l=Yh.get(e.constructor);if(l===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=l,o=e}if(a===void 0)a=[o.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");s=a,this.cpuData=o,this.dataLocation="cpu"}let i=OW(s);if(this.cpuData&&i!==this.cpuData.length&&!((n==="uint4"||n==="int4")&&Math.ceil(i/2)===this.cpuData.length))throw new Error(`Tensor's size(${i}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=s,this.size=i}static async fromImage(e,t){return PW(e,t)}static fromTexture(e,t){return CW(e,t)}static fromGpuBuffer(e,t){return kW(e,t)}static fromMLTensor(e,t){return AW(e,t)}static fromPinnedBuffer(e,t,r){return $W(e,t,r)}toDataURL(e){return EW(this,e)}toImageData(e){return SW(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return jW(this,e)}}}),Ui,DW=He(()=>{tE(),Ui=Ls}),Zf,dw,eo,gi,NW=He(()=>{TW(),Zf=(e,t)=>{(typeof ai.trace>"u"?!ai.wasm.trace:!ai.trace)||console.timeStamp(`${e}::ORT::${t}`)},dw=(e,t)=>{var s;let r=((s=new Error().stack)==null?void 0:s.split(/\r\n|\r|\n/g))||[],n=!1;for(let i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){let o=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;t&&(o+=`::${t}`),Zf("CPU",o);return}r[i].includes("TRACE_FUNC")&&(n=!0)}},eo=e=>{(typeof ai.trace>"u"?!ai.wasm.trace:!ai.trace)||dw("BEGIN",e)},gi=e=>{(typeof ai.trace>"u"?!ai.wasm.trace:!ai.trace)||dw("END",e)}}),RW,ule=He(()=>{xW(),DW(),NW(),RW=class FW{constructor(t){this.handler=t}async run(t,r,n){eo();let s={},i={};if(typeof t!="object"||t===null||t instanceof Ui||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if(typeof r=="object"){if(r===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(r instanceof Ui)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(r)){if(r.length===0)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let c of r){if(typeof c!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(c)===-1)throw new RangeError(`'fetches' contains invalid output name: ${c}.`);s[c]=null}if(typeof n=="object"&&n!==null)i=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{let c=!1,u=Object.getOwnPropertyNames(r);for(let d of this.outputNames)if(u.indexOf(d)!==-1){let h=r[d];(h===null||h instanceof Ui)&&(c=!0,o=!1,s[d]=h)}if(c){if(typeof n=="object"&&n!==null)i=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else i=r}}else if(typeof r<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let c of this.inputNames)if(typeof t[c]>"u")throw new Error(`input '${c}' is missing in 'feeds'.`);if(o)for(let c of this.outputNames)s[c]=null;let a=await this.handler.run(t,s,i),l={};for(let c in a)if(Object.hasOwnProperty.call(a,c)){let u=a[c];u instanceof Ui?l[c]=u:l[c]=new Ui(u.type,u.data,u.dims)}return gi(),l}async release(){return this.handler.dispose()}static async create(t,r,n,s){eo();let i,o={};if(typeof t=="string"){if(i=t,typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(i=t,typeof r=="object"&&r!==null)o=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let u=t,d=0,h=t.byteLength;if(typeof r=="object"&&r!==null)o=r;else if(typeof r=="number"){if(d=r,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=u.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${u.byteLength}).`);if(h=t.byteLength-d,typeof n=="number"){if(h=n,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>u.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${u.byteLength-d}].`);if(typeof s=="object"&&s!==null)o=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");i=new Uint8Array(u,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[a,l]=await bW(o),c=await a.createInferenceSessionHandler(i,l);return gi(),new FW(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),rE,dle=He(()=>{ule(),rE=RW}),hle=He(()=>{}),fle=He(()=>{}),ple=He(()=>{}),mle=He(()=>{}),LW={};Bd(LW,{InferenceSession:()=>rE,TRACE:()=>Zf,TRACE_FUNC_BEGIN:()=>eo,TRACE_FUNC_END:()=>gi,Tensor:()=>Ui,env:()=>Pr,registerBackend:()=>oc});var so=He(()=>{nle(),ile(),dle(),DW(),hle(),fle(),NW(),ple(),mle()}),nE=He(()=>{}),BW={};Bd(BW,{default:()=>zW});var hw,fw,zW,gle=He(()=>{var e;H6(),Fc(),sE(),hw="ort-wasm-proxy-worker",fw=((e=globalThis.self)==null?void 0:e.name)===hw,fw&&(self.onmessage=t=>{let{type:r,in:n}=t.data;try{switch(r){case"init-wasm":iE(n.wasm).then(()=>{ME(n).then(()=>{postMessage({type:r})},s=>{postMessage({type:r,err:s})})},s=>{postMessage({type:r,err:s})});break;case"init-ep":{let{epName:s,env:i}=n;TE(i,s).then(()=>{postMessage({type:r})},o=>{postMessage({type:r,err:o})});break}case"copy-from":{let{buffer:s}=n,i=B_(s);postMessage({type:r,out:i});break}case"create":{let{model:s,options:i}=n;EE(s,i).then(o=>{postMessage({type:r,out:o})},o=>{postMessage({type:r,err:o})});break}case"release":SE(n),postMessage({type:r});break;case"run":{let{sessionId:s,inputIndices:i,inputs:o,outputIndices:a,options:l}=n;PE(s,i,o,a,new Array(a.length).fill(null),l).then(c=>{c.some(u=>u[3]!=="cpu")?postMessage({type:r,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:r,out:c},kE([...o,...c]))},c=>{postMessage({type:r,err:c})});break}case"end-profiling":CE(n),postMessage({type:r});break;default:}}catch(s){postMessage({type:r,err:s})}}),zW=fw?null:t=>new Worker(t??Os,{type:"module",name:hw})}),VW={};Bd(VW,{default:()=>UW});var pw,mw,UW,NO,_le=He(()=>{var e,t;mw=(pw=import.meta.url,async function(r={}){var Zc;var n,s,i=r,o=new Promise((T,A)=>{n=T,s=A}),a=typeof window=="object",l=typeof WorkerGlobalScope<"u",c=l&&((Zc=self.name)==null?void 0:Zc.startsWith("em-pthread"));i.mountExternalData=(T,A)=>{T.startsWith("./")&&(T=T.substring(2)),(i.Eb||(i.Eb=new Map)).set(T,A)},i.unmountExternalData=()=>{delete i.Eb};var u=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let d=T=>async(...A)=>{var N;try{if(i.Fb)throw Error("Session already started");let H=i.Fb={dc:A[0],errors:[]},ee=await T(...A);if(i.Fb!==H)throw Error("Session mismatch");(N=i.Jb)==null||N.flush();let pe=H.errors;if(0<pe.length){let ke=await Promise.all(pe);if(ke=ke.filter(ze=>ze),0<ke.length)throw Error(ke.join(`
`))}return ee}finally{i.Fb=null}};i.jsepInit=(T,A)=>{if(T==="webgpu"){[i.Jb,i.Ub,i.Yb,i.Kb,i.Xb,i.jb,i.Zb,i.ac,i.Vb,i.Wb,i.$b]=A;let N=i.Jb;i.jsepRegisterBuffer=(H,ee,pe,ke)=>N.registerBuffer(H,ee,pe,ke),i.jsepGetBuffer=H=>N.getBuffer(H),i.jsepCreateDownloader=(H,ee,pe)=>N.createDownloader(H,ee,pe),i.jsepOnCreateSession=H=>{N.onCreateSession(H)},i.jsepOnReleaseSession=H=>{N.onReleaseSession(H)},i.jsepOnRunStart=H=>N.onRunStart(H),i.bc=(H,ee)=>{N.upload(H,ee)}}else if(T==="webnn"){let N=A[0];[i.nc,i.Nb,i.webnnEnsureTensor,i.Ob,i.webnnDownloadTensor]=A.slice(1),i.webnnReleaseTensorId=i.Nb,i.webnnUploadTensor=i.Ob,i.webnnOnRunStart=H=>N.onRunStart(H),i.webnnOnRunEnd=N.onRunEnd.bind(N),i.webnnRegisterMLContext=(H,ee)=>{N.registerMLContext(H,ee)},i.webnnOnReleaseSession=H=>{N.onReleaseSession(H)},i.webnnCreateMLTensorDownloader=(H,ee)=>N.createMLTensorDownloader(H,ee),i.webnnRegisterMLTensor=(H,ee,pe,ke)=>N.registerMLTensor(H,ee,pe,ke),i.webnnCreateMLContext=H=>N.createMLContext(H),i.webnnRegisterMLConstant=(H,ee,pe,ke,ze,Ze)=>N.registerMLConstant(H,ee,pe,ke,ze,i.Eb,Ze),i.webnnRegisterGraphInput=N.registerGraphInput.bind(N),i.webnnIsGraphInput=N.isGraphInput.bind(N),i.webnnCreateTemporaryTensor=N.createTemporaryTensor.bind(N),i.webnnIsInt64Supported=N.isInt64Supported.bind(N)}};let h=()=>{let T=(A,N,H)=>(...ee)=>{let pe=Ar,ke=N==null?void 0:N();ee=A(...ee);let ze=N==null?void 0:N();return ke!==ze&&(A=ze,H(ke),N=H=null),Ar!=pe?new Promise((Ze,lt)=>{$s={resolve:Ze,reject:lt}}):ee};(()=>{for(let A of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])i[A]=T(i[A],()=>i[A],N=>i[A]=N)})(),d!==void 0&&(i._OrtRun=d(i._OrtRun),i._OrtRunWithBinding=d(i._OrtRunWithBinding)),h=void 0};i.asyncInit=()=>{h==null||h()};var f,p,_=Object.assign({},i),w=(T,A)=>{throw A},y="";(a||l)&&(l?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),pw&&(y=pw),y=y.startsWith("blob:")?"":y.slice(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1),l&&(p=T=>{var A=new XMLHttpRequest;return A.open("GET",T,!1),A.responseType="arraybuffer",A.send(null),new Uint8Array(A.response)}),f=async T=>{if(L(T))return new Promise((N,H)=>{var ee=new XMLHttpRequest;ee.open("GET",T,!0),ee.responseType="arraybuffer",ee.onload=()=>{ee.status==200||ee.status==0&&ee.response?N(ee.response):H(ee.status)},ee.onerror=H,ee.send(null)});var A=await fetch(T,{credentials:"same-origin"});if(A.ok)return A.arrayBuffer();throw Error(A.status+" : "+A.url)});var g=console.log.bind(console),v=console.error.bind(console),b=g,x=v;Object.assign(i,_),_=null;var M,E,P,I,O,V,U,B,Y,K,X,G,R,te=i.wasmBinary,re=!1,L=T=>T.startsWith("file://");function j(){return M.buffer!=I.buffer&&se(),I}function q(){return M.buffer!=I.buffer&&se(),O}function ne(){return M.buffer!=I.buffer&&se(),V}function me(){return M.buffer!=I.buffer&&se(),U}function ae(){return M.buffer!=I.buffer&&se(),B}function fe(){return M.buffer!=I.buffer&&se(),Y}function Pe(){return M.buffer!=I.buffer&&se(),K}function Ne(){return M.buffer!=I.buffer&&se(),R}if(c){let T=function(A){try{var N=A.data,H=N.Bb;if(H==="load"){let ee=[];self.onmessage=pe=>ee.push(pe),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let pe of ee)T(pe);self.onmessage=T};for(let pe of N.Rb)i[pe]&&!i[pe].proxy||(i[pe]=(...ke)=>{postMessage({Bb:"callHandler",Qb:pe,args:ke})},pe=="print"&&(b=i[pe]),pe=="printErr"&&(x=i[pe]));M=N.kc,se(),de(N.lc)}else if(H==="run"){W(N.Ab),qc(N.Ab,0,0,1,0,0),Kn(),Ce(N.Ab),Q||(lh(),Q=!0);try{le(N.fc,N.Hb)}catch(ee){if(ee!="unwind")throw ee}}else N.target!=="setimmediate"&&(H==="checkMailbox"?Q&&Ge():H&&(x(`worker: received unknown command ${H}`),x(N)))}catch(ee){throw Qc(),ee}};var de,Q=!1;x=function(...A){A=A.join(" "),console.error(A)},self.alert=function(...A){postMessage({Bb:"alert",text:A.join(" "),ic:Pl()})},self.onunhandledrejection=A=>{throw A.reason||A},self.onmessage=T}function se(){var T=M.buffer;i.HEAP8=I=new Int8Array(T),i.HEAP16=V=new Int16Array(T),i.HEAPU8=O=new Uint8Array(T),i.HEAPU16=U=new Uint16Array(T),i.HEAP32=B=new Int32Array(T),i.HEAPU32=Y=new Uint32Array(T),i.HEAPF32=K=new Float32Array(T),i.HEAPF64=R=new Float64Array(T),i.HEAP64=X=new BigInt64Array(T),i.HEAPU64=G=new BigUint64Array(T)}function J(){c?startWorker(i):vt.Ca()}c||(M=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),se());var be,xe=0,Te=null;function Ee(){if(--xe==0&&Te){var T=Te;Te=null,T()}}function $e(T){throw x(T="Aborted("+T+")"),re=!0,T=new WebAssembly.RuntimeError(T+". Build with -sASSERTIONS for more info."),s(T),T}function Ie(){return{a:{L:Je,Aa:Ke,b:Re,$:jt,A:ut,pa:sr,X:Er,Z:Ln,qa:Xs,na:wi,ga:Js,ma:io,J:ss,Y:oo,V:ks,oa:bi,W:ao,va:co,E:pt,Q:Zs,O:pl,D:gl,u:_l,r:yl,P:uo,z:Z,R:ie,ja:he,T:tt,aa:st,M:St,F:tr,ia:Ce,sa:Zt,t:ln,Ba:pn,w:mn,o:tn,l:ni,c:ti,n:Mp,j:aa,v:Sp,p:Pp,f:Cp,s:kp,m:Ap,e:Vd,k:$p,i:Ip,g:Ud,d:Op,da:Wd,ea:Dp,fa:Hd,ba:Vc,ca:Ml,N:Kd,xa:Rp,ua:Lp,h:Qd,C:Bp,G:Wc,ta:Fp,x:Yd,ra:zp,U:Xd,q:Np,y:No,K:Vp,S:Ny,za:Zd,ya:Up,ka:th,la:Sl,_:yt,B:rh,I:nh,ha:sh,H:oh,a:M,wa:Be}}}var Ue={829644:(T,A,N,H,ee)=>{if(i===void 0||!i.Eb)return 1;if((T=mt(Number(T>>>0))).startsWith("./")&&(T=T.substring(2)),!(T=i.Eb.get(T)))return 2;if(A=Number(A>>>0),N=Number(N>>>0),H=Number(H>>>0),A+N>T.byteLength)return 3;try{let pe=T.subarray(A,A+N);switch(ee){case 0:q().set(pe,H>>>0);break;case 1:i.mc?i.mc(H,pe):i.bc(H,pe);break;default:return 4}return 0}catch{return 4}},830468:(T,A,N)=>{i.Ob(T,q().subarray(A>>>0,A+N>>>0))},830532:()=>i.nc(),830574:T=>{i.Nb(T)},830611:()=>{i.Vb()},830642:()=>{i.Wb()},830671:()=>{i.$b()},830696:T=>i.Ub(T),830729:T=>i.Yb(T),830761:(T,A,N)=>{i.Kb(Number(T),Number(A),Number(N),!0)},830824:(T,A,N)=>{i.Kb(Number(T),Number(A),Number(N))},830881:()=>typeof wasmOffsetConverter<"u",830938:T=>{i.jb("Abs",T,void 0)},830989:T=>{i.jb("Neg",T,void 0)},831040:T=>{i.jb("Floor",T,void 0)},831093:T=>{i.jb("Ceil",T,void 0)},831145:T=>{i.jb("Reciprocal",T,void 0)},831203:T=>{i.jb("Sqrt",T,void 0)},831255:T=>{i.jb("Exp",T,void 0)},831306:T=>{i.jb("Erf",T,void 0)},831357:T=>{i.jb("Sigmoid",T,void 0)},831412:(T,A,N)=>{i.jb("HardSigmoid",T,{alpha:A,beta:N})},831491:T=>{i.jb("Log",T,void 0)},831542:T=>{i.jb("Sin",T,void 0)},831593:T=>{i.jb("Cos",T,void 0)},831644:T=>{i.jb("Tan",T,void 0)},831695:T=>{i.jb("Asin",T,void 0)},831747:T=>{i.jb("Acos",T,void 0)},831799:T=>{i.jb("Atan",T,void 0)},831851:T=>{i.jb("Sinh",T,void 0)},831903:T=>{i.jb("Cosh",T,void 0)},831955:T=>{i.jb("Asinh",T,void 0)},832008:T=>{i.jb("Acosh",T,void 0)},832061:T=>{i.jb("Atanh",T,void 0)},832114:T=>{i.jb("Tanh",T,void 0)},832166:T=>{i.jb("Not",T,void 0)},832217:(T,A,N)=>{i.jb("Clip",T,{min:A,max:N})},832286:T=>{i.jb("Clip",T,void 0)},832338:(T,A)=>{i.jb("Elu",T,{alpha:A})},832396:T=>{i.jb("Gelu",T,void 0)},832448:T=>{i.jb("Relu",T,void 0)},832500:(T,A)=>{i.jb("LeakyRelu",T,{alpha:A})},832564:(T,A)=>{i.jb("ThresholdedRelu",T,{alpha:A})},832634:(T,A)=>{i.jb("Cast",T,{to:A})},832692:T=>{i.jb("Add",T,void 0)},832743:T=>{i.jb("Sub",T,void 0)},832794:T=>{i.jb("Mul",T,void 0)},832845:T=>{i.jb("Div",T,void 0)},832896:T=>{i.jb("Pow",T,void 0)},832947:T=>{i.jb("Equal",T,void 0)},833e3:T=>{i.jb("Greater",T,void 0)},833055:T=>{i.jb("GreaterOrEqual",T,void 0)},833117:T=>{i.jb("Less",T,void 0)},833169:T=>{i.jb("LessOrEqual",T,void 0)},833228:(T,A,N,H,ee)=>{i.jb("ReduceMean",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},833403:(T,A,N,H,ee)=>{i.jb("ReduceMax",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},833577:(T,A,N,H,ee)=>{i.jb("ReduceMin",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},833751:(T,A,N,H,ee)=>{i.jb("ReduceProd",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},833926:(T,A,N,H,ee)=>{i.jb("ReduceSum",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},834100:(T,A,N,H,ee)=>{i.jb("ReduceL1",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},834273:(T,A,N,H,ee)=>{i.jb("ReduceL2",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},834446:(T,A,N,H,ee)=>{i.jb("ReduceLogSum",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},834623:(T,A,N,H,ee)=>{i.jb("ReduceSumSquare",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},834803:(T,A,N,H,ee)=>{i.jb("ReduceLogSumExp",T,{keepDims:!!A,noopWithEmptyAxes:!!N,axes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},834983:T=>{i.jb("Where",T,void 0)},835036:(T,A,N)=>{i.jb("Transpose",T,{perm:A?Array.from(ae().subarray(Number(A)>>>0,Number(N)>>>0)):[]})},835160:(T,A,N,H)=>{i.jb("DepthToSpace",T,{blocksize:A,mode:mt(N),format:H?"NHWC":"NCHW"})},835293:(T,A,N,H)=>{i.jb("DepthToSpace",T,{blocksize:A,mode:mt(N),format:H?"NHWC":"NCHW"})},835426:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn,fo)=>{i.jb("ConvTranspose",T,{format:Ze?"NHWC":"NCHW",autoPad:A,dilations:[N],group:H,kernelShape:[ee],pads:[pe,ke],strides:[ze],wIsConst:()=>!!j()[lt>>>0],outputPadding:$t?Array.from(ae().subarray(Number($t)>>>0,Number(Qt)>>>0)):[],outputShape:fr?Array.from(ae().subarray(Number(fr)>>>0,Number(gn)>>>0)):[],activation:mt(fo)})},835859:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn)=>{i.jb("ConvTranspose",T,{format:ze?"NHWC":"NCHW",autoPad:A,dilations:Array.from(ae().subarray(Number(N)>>>0,2+(Number(N)>>>0)>>>0)),group:H,kernelShape:Array.from(ae().subarray(Number(ee)>>>0,2+(Number(ee)>>>0)>>>0)),pads:Array.from(ae().subarray(Number(pe)>>>0,4+(Number(pe)>>>0)>>>0)),strides:Array.from(ae().subarray(Number(ke)>>>0,2+(Number(ke)>>>0)>>>0)),wIsConst:()=>!!j()[Ze>>>0],outputPadding:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],outputShape:Qt?Array.from(ae().subarray(Number(Qt)>>>0,Number(fr)>>>0)):[],activation:mt(gn)})},836520:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn,fo)=>{i.jb("ConvTranspose",T,{format:Ze?"NHWC":"NCHW",autoPad:A,dilations:[N],group:H,kernelShape:[ee],pads:[pe,ke],strides:[ze],wIsConst:()=>!!j()[lt>>>0],outputPadding:$t?Array.from(ae().subarray(Number($t)>>>0,Number(Qt)>>>0)):[],outputShape:fr?Array.from(ae().subarray(Number(fr)>>>0,Number(gn)>>>0)):[],activation:mt(fo)})},836953:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn)=>{i.jb("ConvTranspose",T,{format:ze?"NHWC":"NCHW",autoPad:A,dilations:Array.from(ae().subarray(Number(N)>>>0,2+(Number(N)>>>0)>>>0)),group:H,kernelShape:Array.from(ae().subarray(Number(ee)>>>0,2+(Number(ee)>>>0)>>>0)),pads:Array.from(ae().subarray(Number(pe)>>>0,4+(Number(pe)>>>0)>>>0)),strides:Array.from(ae().subarray(Number(ke)>>>0,2+(Number(ke)>>>0)>>>0)),wIsConst:()=>!!j()[Ze>>>0],outputPadding:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],outputShape:Qt?Array.from(ae().subarray(Number(Qt)>>>0,Number(fr)>>>0)):[],activation:mt(gn)})},837614:(T,A)=>{i.jb("GlobalAveragePool",T,{format:A?"NHWC":"NCHW"})},837705:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn)=>{i.jb("AveragePool",T,{format:gn?"NHWC":"NCHW",auto_pad:A,ceil_mode:N,count_include_pad:H,storage_order:ee,dilations:pe?Array.from(ae().subarray(Number(pe)>>>0,Number(ke)>>>0)):[],kernel_shape:ze?Array.from(ae().subarray(Number(ze)>>>0,Number(Ze)>>>0)):[],pads:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],strides:Qt?Array.from(ae().subarray(Number(Qt)>>>0,Number(fr)>>>0)):[]})},838184:(T,A)=>{i.jb("GlobalAveragePool",T,{format:A?"NHWC":"NCHW"})},838275:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn)=>{i.jb("AveragePool",T,{format:gn?"NHWC":"NCHW",auto_pad:A,ceil_mode:N,count_include_pad:H,storage_order:ee,dilations:pe?Array.from(ae().subarray(Number(pe)>>>0,Number(ke)>>>0)):[],kernel_shape:ze?Array.from(ae().subarray(Number(ze)>>>0,Number(Ze)>>>0)):[],pads:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],strides:Qt?Array.from(ae().subarray(Number(Qt)>>>0,Number(fr)>>>0)):[]})},838754:(T,A)=>{i.jb("GlobalMaxPool",T,{format:A?"NHWC":"NCHW"})},838841:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn)=>{i.jb("MaxPool",T,{format:gn?"NHWC":"NCHW",auto_pad:A,ceil_mode:N,count_include_pad:H,storage_order:ee,dilations:pe?Array.from(ae().subarray(Number(pe)>>>0,Number(ke)>>>0)):[],kernel_shape:ze?Array.from(ae().subarray(Number(ze)>>>0,Number(Ze)>>>0)):[],pads:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],strides:Qt?Array.from(ae().subarray(Number(Qt)>>>0,Number(fr)>>>0)):[]})},839316:(T,A)=>{i.jb("GlobalMaxPool",T,{format:A?"NHWC":"NCHW"})},839403:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn)=>{i.jb("MaxPool",T,{format:gn?"NHWC":"NCHW",auto_pad:A,ceil_mode:N,count_include_pad:H,storage_order:ee,dilations:pe?Array.from(ae().subarray(Number(pe)>>>0,Number(ke)>>>0)):[],kernel_shape:ze?Array.from(ae().subarray(Number(ze)>>>0,Number(Ze)>>>0)):[],pads:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],strides:Qt?Array.from(ae().subarray(Number(Qt)>>>0,Number(fr)>>>0)):[]})},839878:(T,A,N,H,ee)=>{i.jb("Gemm",T,{alpha:A,beta:N,transA:H,transB:ee})},839982:T=>{i.jb("MatMul",T,void 0)},840036:(T,A,N,H)=>{i.jb("ArgMax",T,{keepDims:!!A,selectLastIndex:!!N,axis:H})},840144:(T,A,N,H)=>{i.jb("ArgMin",T,{keepDims:!!A,selectLastIndex:!!N,axis:H})},840252:(T,A)=>{i.jb("Softmax",T,{axis:A})},840315:(T,A)=>{i.jb("Concat",T,{axis:A})},840375:(T,A,N,H,ee)=>{i.jb("Split",T,{axis:A,numOutputs:N,splitSizes:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},840531:T=>{i.jb("Expand",T,void 0)},840585:(T,A)=>{i.jb("Gather",T,{axis:Number(A)})},840656:(T,A)=>{i.jb("GatherElements",T,{axis:Number(A)})},840735:(T,A)=>{i.jb("GatherND",T,{batch_dims:Number(A)})},840814:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t)=>{i.jb("Resize",T,{antialias:A,axes:N?Array.from(ae().subarray(Number(N)>>>0,Number(H)>>>0)):[],coordinateTransformMode:mt(ee),cubicCoeffA:pe,excludeOutside:ke,extrapolationValue:ze,keepAspectRatioPolicy:mt(Ze),mode:mt(lt),nearestMode:mt($t)})},841176:(T,A,N,H,ee,pe,ke)=>{i.jb("Slice",T,{starts:A?Array.from(ae().subarray(Number(A)>>>0,Number(N)>>>0)):[],ends:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[],axes:pe?Array.from(ae().subarray(Number(pe)>>>0,Number(ke)>>>0)):[]})},841440:T=>{i.jb("Tile",T,void 0)},841492:(T,A,N)=>{i.jb("InstanceNormalization",T,{epsilon:A,format:N?"NHWC":"NCHW"})},841606:(T,A,N)=>{i.jb("InstanceNormalization",T,{epsilon:A,format:N?"NHWC":"NCHW"})},841720:T=>{i.jb("Range",T,void 0)},841773:(T,A)=>{i.jb("Einsum",T,{equation:mt(A)})},841854:(T,A,N,H,ee)=>{i.jb("Pad",T,{mode:A,value:N,pads:H?Array.from(ae().subarray(Number(H)>>>0,Number(ee)>>>0)):[]})},841997:(T,A,N,H,ee,pe)=>{i.jb("BatchNormalization",T,{epsilon:A,momentum:N,spatial:!!ee,trainingMode:!!H,format:pe?"NHWC":"NCHW"})},842166:(T,A,N,H,ee,pe)=>{i.jb("BatchNormalization",T,{epsilon:A,momentum:N,spatial:!!ee,trainingMode:!!H,format:pe?"NHWC":"NCHW"})},842335:(T,A,N)=>{i.jb("CumSum",T,{exclusive:Number(A),reverse:Number(N)})},842432:(T,A,N)=>{i.jb("DequantizeLinear",T,{axis:A,blockSize:N})},842522:(T,A,N,H,ee)=>{i.jb("GridSample",T,{align_corners:A,mode:mt(N),padding_mode:mt(H),format:ee?"NHWC":"NCHW"})},842692:(T,A,N,H,ee)=>{i.jb("GridSample",T,{align_corners:A,mode:mt(N),padding_mode:mt(H),format:ee?"NHWC":"NCHW"})},842862:(T,A)=>{i.jb("ScatterND",T,{reduction:mt(A)})},842947:(T,A,N,H,ee,pe,ke,ze,Ze)=>{i.jb("Attention",T,{numHeads:A,isUnidirectional:N,maskFilterValue:H,scale:ee,doRotary:pe,qkvHiddenSizes:ke?Array.from(ae().subarray(Number(ze)>>>0,Number(ze)+ke>>>0)):[],pastPresentShareBuffer:!!Ze})},843219:T=>{i.jb("BiasAdd",T,void 0)},843274:T=>{i.jb("BiasSplitGelu",T,void 0)},843335:T=>{i.jb("FastGelu",T,void 0)},843391:(T,A,N,H,ee,pe,ke,ze,Ze,lt,$t,Qt,fr,gn,fo,Gp)=>{i.jb("Conv",T,{format:Qt?"NHWC":"NCHW",auto_pad:A,dilations:N?Array.from(ae().subarray(Number(N)>>>0,Number(H)>>>0)):[],group:ee,kernel_shape:pe?Array.from(ae().subarray(Number(pe)>>>0,Number(ke)>>>0)):[],pads:ze?Array.from(ae().subarray(Number(ze)>>>0,Number(Ze)>>>0)):[],strides:lt?Array.from(ae().subarray(Number(lt)>>>0,Number($t)>>>0)):[],w_is_const:()=>!!j()[Number(fr)>>>0],activation:mt(gn),activation_params:fo?Array.from(Pe().subarray(Number(fo)>>>0,Number(Gp)>>>0)):[]})},843975:T=>{i.jb("Gelu",T,void 0)},844027:(T,A,N,H,ee,pe,ke,ze,Ze)=>{i.jb("GroupQueryAttention",T,{numHeads:A,kvNumHeads:N,scale:H,softcap:ee,doRotary:pe,rotaryInterleaved:ke,smoothSoftmax:ze,localWindowSize:Ze})},844244:(T,A,N,H)=>{i.jb("LayerNormalization",T,{axis:A,epsilon:N,simplified:!!H})},844355:(T,A,N,H)=>{i.jb("LayerNormalization",T,{axis:A,epsilon:N,simplified:!!H})},844466:(T,A,N,H,ee,pe)=>{i.jb("MatMulNBits",T,{k:A,n:N,accuracyLevel:H,bits:ee,blockSize:pe})},844593:(T,A,N,H,ee,pe)=>{i.jb("MultiHeadAttention",T,{numHeads:A,isUnidirectional:N,maskFilterValue:H,scale:ee,doRotary:pe})},844752:(T,A)=>{i.jb("QuickGelu",T,{alpha:A})},844816:(T,A,N,H,ee)=>{i.jb("RotaryEmbedding",T,{interleaved:!!A,numHeads:N,rotaryEmbeddingDim:H,scale:ee})},844955:(T,A,N)=>{i.jb("SkipLayerNormalization",T,{epsilon:A,simplified:!!N})},845057:(T,A,N)=>{i.jb("SkipLayerNormalization",T,{epsilon:A,simplified:!!N})},845159:(T,A,N,H)=>{i.jb("GatherBlockQuantized",T,{gatherAxis:A,quantizeAxis:N,blockSize:H})},845280:T=>{i.Zb(T)},845314:(T,A)=>i.ac(Number(T),Number(A),i.Fb.dc,i.Fb.errors)};function Ke(T,A,N){return zn(async()=>{await i.Xb(Number(T),Number(A),Number(N))})}function Je(){return typeof wasmOffsetConverter<"u"}class je{constructor(A){oe(this,"name","ExitStatus");this.message=`Program terminated with exit(${A})`,this.status=A}}var qe=T=>{T.terminate(),T.onmessage=()=>{}},ot=[],ft=T=>{Mt.length==0&&(ce(),F(Mt[0]));var A=Mt.pop();if(!A)return 6;Lt.push(A),pr[T.Ab]=A,A.Ab=T.Ab;var N={Bb:"run",fc:T.ec,Hb:T.Hb,Ab:T.Ab};return A.postMessage(N,T.Mb),0},it=0,We=(T,A,...N)=>{for(var H=2*N.length,ee=$l(),pe=Xc(8*H),ke=pe>>>3,ze=0;ze<N.length;ze++){var Ze=N[ze];typeof Ze=="bigint"?(X[ke+2*ze]=1n,X[ke+2*ze+1]=Ze):(X[ke+2*ze]=0n,Ne()[ke+2*ze+1>>>0]=Ze)}return T=ch(T,0,H,pe,A),Al(ee),T};function Be(T){if(c)return We(0,1,T);if(P=T,!(0<it)){for(var A of Lt)qe(A);for(A of Mt)qe(A);Mt=[],Lt=[],pr={},re=!0}w(0,new je(T))}function De(T){if(c)return We(1,0,T);yt(T)}var yt=T=>{if(P=T,c)throw De(T),"unwind";Be(T)},Mt=[],Lt=[],dr=[],pr={},at=T=>{var A=T.Ab;delete pr[A],Mt.push(T),Lt.splice(Lt.indexOf(T),1),T.Ab=0,uh(A)};function Kn(){dr.forEach(T=>T())}var F=T=>new Promise(A=>{T.onmessage=ee=>{var pe=(ee=ee.data).Bb;if(ee.Gb&&ee.Gb!=Pl()){var ke=pr[ee.Gb];ke?ke.postMessage(ee,ee.Mb):x(`Internal error! Worker sent a message "${pe}" to target pthread ${ee.Gb}, but that thread no longer exists!`)}else pe==="checkMailbox"?Ge():pe==="spawnThread"?ft(ee):pe==="cleanupThread"?at(pr[ee.hc]):pe==="loaded"?(T.loaded=!0,A(T)):pe==="alert"?alert(`Thread ${ee.ic}: ${ee.text}`):ee.target==="setimmediate"?T.postMessage(ee):pe==="callHandler"?i[ee.Qb](...ee.args):pe&&x(`worker sent an unknown command ${pe}`)},T.onerror=ee=>{throw x(`worker sent an error! ${ee.filename}:${ee.lineno}: ${ee.message}`),ee};var N,H=[];for(N of[])i.propertyIsEnumerable(N)&&H.push(N);T.postMessage({Bb:"load",Rb:H,kc:M,lc:E})});function ce(){var T=new Worker((()=>{let A=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new A("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});Mt.push(T)}var W=T=>{se();var A=fe()[T+52>>>2>>>0];T=fe()[T+56>>>2>>>0],Yc(A,A-T),Al(A)},le=(T,A)=>{it=0,T=fh(T,A),0<it?P=T:kl(T)};class ye{constructor(A){this.Ib=A-24}}function Re(T,A,N){var H=new ye(T>>>=0);throw A>>>=0,N>>>=0,fe()[H.Ib+16>>>2>>>0]=0,fe()[H.Ib+4>>>2>>>0]=A,fe()[H.Ib+8>>>2>>>0]=N,T}function Se(T,A,N,H){return c?We(2,1,T,A,N,H):jt(T,A,N,H)}function jt(T,A,N,H){if(T>>>=0,N>>>=0,H>>>=0,u===void 0)return 6;var ee=[];return c&&ee.length===0?Se(T,A>>>=0,N,H):(T={ec:N,Ab:T,Hb:H,Mb:ee},c?(T.Bb="spawnThread",postMessage(T,ee),0):ft(T))}var er=typeof TextDecoder<"u"?new TextDecoder:void 0,bt=(T,A=0,N=NaN)=>{var H=(A>>>=0)+N;for(N=A;T[N]&&!(N>=H);)++N;if(16<N-A&&T.buffer&&er)return er.decode(T.buffer instanceof ArrayBuffer?T.subarray(A,N):T.slice(A,N));for(H="";A<N;){var ee=T[A++];if(128&ee){var pe=63&T[A++];if((224&ee)==192)H+=String.fromCharCode((31&ee)<<6|pe);else{var ke=63&T[A++];65536>(ee=(240&ee)==224?(15&ee)<<12|pe<<6|ke:(7&ee)<<18|pe<<12|ke<<6|63&T[A++])?H+=String.fromCharCode(ee):(ee-=65536,H+=String.fromCharCode(55296|ee>>10,56320|1023&ee))}}else H+=String.fromCharCode(ee)}return H},mt=(T,A)=>(T>>>=0)?bt(q(),T,A):"";function ut(T,A,N){return c?We(3,1,T,A,N):0}function sr(T,A){if(c)return We(4,1,T,A)}var wr=T=>{for(var A=0,N=0;N<T.length;++N){var H=T.charCodeAt(N);127>=H?A++:2047>=H?A+=2:55296<=H&&57343>=H?(A+=4,++N):A+=3}return A},fn=(T,A,N)=>{var H=q();if(A>>>=0,0<N){var ee=A;N=A+N-1;for(var pe=0;pe<T.length;++pe){var ke=T.charCodeAt(pe);if(55296<=ke&&57343>=ke&&(ke=65536+((1023&ke)<<10)|1023&T.charCodeAt(++pe)),127>=ke){if(A>=N)break;H[A++>>>0]=ke}else{if(2047>=ke){if(A+1>=N)break;H[A++>>>0]=192|ke>>6}else{if(65535>=ke){if(A+2>=N)break;H[A++>>>0]=224|ke>>12}else{if(A+3>=N)break;H[A++>>>0]=240|ke>>18,H[A++>>>0]=128|ke>>12&63}H[A++>>>0]=128|ke>>6&63}H[A++>>>0]=128|63&ke}}H[A>>>0]=0,T=A-ee}else T=0;return T};function Er(T,A){if(c)return We(5,1,T,A)}function Ln(T,A,N){if(c)return We(6,1,T,A,N)}function Xs(T,A,N){return c?We(7,1,T,A,N):0}function wi(T,A){if(c)return We(8,1,T,A)}function Js(T,A,N){if(c)return We(9,1,T,A,N)}function io(T,A,N,H){if(c)return We(10,1,T,A,N,H)}function ss(T,A,N,H){if(c)return We(11,1,T,A,N,H)}function oo(T,A,N,H){if(c)return We(12,1,T,A,N,H)}function ks(T){if(c)return We(13,1,T)}function bi(T,A){if(c)return We(14,1,T,A)}function ao(T,A,N){if(c)return We(15,1,T,A,N)}var lo,Wr,co=()=>$e(""),xn=T=>{for(var A="";q()[T>>>0];)A+=lo[q()[T++>>>0]];return A},xi={},qn={};function Fe(T,A,N={}){return function(H,ee,pe={}){var ke=ee.name;if(!H)throw new Wr(`type "${ke}" must have a positive integer typeid pointer`);if(qn.hasOwnProperty(H)){if(pe.Sb)return;throw new Wr(`Cannot register type '${ke}' twice`)}qn[H]=ee,xi.hasOwnProperty(H)&&(ee=xi[H],delete xi[H],ee.forEach(ze=>ze()))}(T,A,N)}var nt=(T,A,N)=>{switch(A){case 1:return N?H=>j()[H>>>0]:H=>q()[H>>>0];case 2:return N?H=>ne()[H>>>1>>>0]:H=>me()[H>>>1>>>0];case 4:return N?H=>ae()[H>>>2>>>0]:H=>fe()[H>>>2>>>0];case 8:return N?H=>X[H>>>3]:H=>G[H>>>3];default:throw new TypeError(`invalid integer width (${A}): ${T}`)}};function pt(T,A,N){N>>>=0,Fe(T>>>=0,{name:A=xn(A>>>0),fromWireType:H=>H,toWireType:function(H,ee){if(typeof ee!="bigint"&&typeof ee!="number")throw ee=ee===null?"null":(H=typeof ee)=="object"||H==="array"||H==="function"?ee.toString():""+ee,new TypeError(`Cannot convert "${ee}" to ${this.name}`);return typeof ee=="number"&&(ee=BigInt(ee)),ee},Cb:ir,readValueFromPointer:nt(A,N,A.indexOf("u")==-1),Db:null})}var ir=8;function Zs(T,A,N,H){Fe(T>>>=0,{name:A=xn(A>>>0),fromWireType:function(ee){return!!ee},toWireType:function(ee,pe){return pe?N:H},Cb:ir,readValueFromPointer:function(ee){return this.fromWireType(q()[ee>>>0])},Db:null})}var ei=[],Zr=[];function ti(T){9<(T>>>=0)&&--Zr[T+1]==0&&(Zr[T]=void 0,ei.push(T))}var en=T=>{if(!T)throw new Wr("Cannot use deleted val. handle = "+T);return Zr[T]},an=T=>{switch(T){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let A=ei.pop()||Zr.length;return Zr[A]=T,Zr[A+1]=1,A}};function ri(T){return this.fromWireType(fe()[T>>>2>>>0])}var Mi={name:"emscripten::val",fromWireType:T=>{var A=en(T);return ti(T),A},toWireType:(T,A)=>an(A),Cb:ir,readValueFromPointer:ri,Db:null};function pl(T){return Fe(T>>>0,Mi)}var ml=(T,A)=>{switch(A){case 4:return function(N){return this.fromWireType(Pe()[N>>>2>>>0])};case 8:return function(N){return this.fromWireType(Ne()[N>>>3>>>0])};default:throw new TypeError(`invalid float width (${A}): ${T}`)}};function gl(T,A,N){N>>>=0,Fe(T>>>=0,{name:A=xn(A>>>0),fromWireType:H=>H,toWireType:(H,ee)=>ee,Cb:ir,readValueFromPointer:ml(A,N),Db:null})}function _l(T,A,N,H,ee){if(T>>>=0,N>>>=0,A=xn(A>>>0),ee===-1&&(ee=4294967295),ee=ze=>ze,H===0){var pe=32-8*N;ee=ze=>ze<<pe>>>pe}var ke=A.includes("unsigned")?function(ze,Ze){return Ze>>>0}:function(ze,Ze){return Ze};Fe(T,{name:A,fromWireType:ee,toWireType:ke,Cb:ir,readValueFromPointer:nt(A,N,H!==0),Db:null})}function yl(T,A,N){function H(pe){var ke=fe()[pe>>>2>>>0];return pe=fe()[pe+4>>>2>>>0],new ee(j().buffer,pe,ke)}var ee=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][A];Fe(T>>>=0,{name:N=xn(N>>>0),fromWireType:H,Cb:ir,readValueFromPointer:H},{Sb:!0})}function uo(T,A){Fe(T>>>=0,{name:A=xn(A>>>0),fromWireType:function(N){for(var H,ee=fe()[N>>>2>>>0],pe=N+4,ke=pe,ze=0;ze<=ee;++ze){var Ze=pe+ze;ze!=ee&&q()[Ze>>>0]!=0||(ke=mt(ke,Ze-ke),H===void 0?H=ke:(H+="\0",H+=ke),ke=Ze+1)}return ys(N),H},toWireType:function(N,H){H instanceof ArrayBuffer&&(H=new Uint8Array(H));var ee=typeof H=="string";if(!(ee||H instanceof Uint8Array||H instanceof Uint8ClampedArray||H instanceof Int8Array))throw new Wr("Cannot pass non-string to std::string");var pe=ee?wr(H):H.length,ke=Cl(4+pe+1),ze=ke+4;if(fe()[ke>>>2>>>0]=pe,ee)fn(H,ze,pe+1);else if(ee)for(ee=0;ee<pe;++ee){var Ze=H.charCodeAt(ee);if(255<Ze)throw ys(ke),new Wr("String has UTF-16 code units that do not fit in 8 bits");q()[ze+ee>>>0]=Ze}else for(ee=0;ee<pe;++ee)q()[ze+ee>>>0]=H[ee];return N!==null&&N.push(ys,ke),ke},Cb:ir,readValueFromPointer:ri,Db(N){ys(N)}})}var oa=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,vl=(T,A)=>{for(var N=T>>1,H=N+A/2;!(N>=H)&&me()[N>>>0];)++N;if(32<(N<<=1)-T&&oa)return oa.decode(q().slice(T,N));for(N="",H=0;!(H>=A/2);++H){var ee=ne()[T+2*H>>>1>>>0];if(ee==0)break;N+=String.fromCharCode(ee)}return N},wl=(T,A,N)=>{if(N??(N=2147483647),2>N)return 0;var H=A;N=(N-=2)<2*T.length?N/2:T.length;for(var ee=0;ee<N;++ee){var pe=T.charCodeAt(ee);ne()[A>>>1>>>0]=pe,A+=2}return ne()[A>>>1>>>0]=0,A-H},bl=T=>2*T.length,ho=(T,A)=>{for(var N=0,H="";!(N>=A/4);){var ee=ae()[T+4*N>>>2>>>0];if(ee==0)break;++N,65536<=ee?(ee-=65536,H+=String.fromCharCode(55296|ee>>10,56320|1023&ee)):H+=String.fromCharCode(ee)}return H},_e=(T,A,N)=>{if(A>>>=0,N??(N=2147483647),4>N)return 0;var H=A;N=H+N-4;for(var ee=0;ee<T.length;++ee){var pe=T.charCodeAt(ee);if(55296<=pe&&57343>=pe&&(pe=65536+((1023&pe)<<10)|1023&T.charCodeAt(++ee)),ae()[A>>>2>>>0]=pe,(A+=4)+4>N)break}return ae()[A>>>2>>>0]=0,A-H},D=T=>{for(var A=0,N=0;N<T.length;++N){var H=T.charCodeAt(N);55296<=H&&57343>=H&&++N,A+=4}return A};function Z(T,A,N){if(T>>>=0,A>>>=0,N=xn(N>>>=0),A===2)var H=vl,ee=wl,pe=bl,ke=ze=>me()[ze>>>1>>>0];else A===4&&(H=ho,ee=_e,pe=D,ke=ze=>fe()[ze>>>2>>>0]);Fe(T,{name:N,fromWireType:ze=>{for(var Ze,lt=fe()[ze>>>2>>>0],$t=ze+4,Qt=0;Qt<=lt;++Qt){var fr=ze+4+Qt*A;Qt!=lt&&ke(fr)!=0||($t=H($t,fr-$t),Ze===void 0?Ze=$t:(Ze+="\0",Ze+=$t),$t=fr+A)}return ys(ze),Ze},toWireType:(ze,Ze)=>{if(typeof Ze!="string")throw new Wr(`Cannot pass non-string to C++ string type ${N}`);var lt=pe(Ze),$t=Cl(4+lt+A);return fe()[$t>>>2>>>0]=lt/A,ee(Ze,$t+4,lt+A),ze!==null&&ze.push(ys,$t),$t},Cb:ir,readValueFromPointer:ri,Db(ze){ys(ze)}})}function ie(T,A){Fe(T>>>=0,{Tb:!0,name:A=xn(A>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function he(T){qc(T>>>0,!l,1,!a,131072,!1),Kn()}var ge=T=>{if(!re)try{if(T(),!(0<it))try{c?kl(P):yt(P)}catch(A){A instanceof je||A=="unwind"||w(0,A)}}catch(A){A instanceof je||A=="unwind"||w(0,A)}};function Ce(T){T>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(ae(),T>>>2,T).value.then(Ge),T+=128,Atomics.store(ae(),T>>>2,1))}var Ge=()=>{var T=Pl();T&&(Ce(T),ge(hh))};function tt(T,A){(T>>>=0)==A>>>0?setTimeout(Ge):c?postMessage({Gb:T,Bb:"checkMailbox"}):(T=pr[T])&&T.postMessage({Bb:"checkMailbox"})}var Xe=[];function st(T,A,N,H,ee){for(A>>>=0,H/=2,Xe.length=H,N=ee>>>0>>>3,ee=0;ee<H;ee++)Xe[ee]=X[N+2*ee]?X[N+2*ee+1]:Ne()[N+2*ee+1>>>0];return(A?Ue[A]:Wp[T])(...Xe)}var St=()=>{it=0};function tr(T){T>>>=0,c?postMessage({Bb:"cleanupThread",hc:T}):at(pr[T])}function Zt(T){}var Sr=(T,A)=>{var N=qn[T];if(N===void 0)throw T=Kc(T),N=xn(T),ys(T),new Wr(`${A} has unknown type ${N}`);return N},hr=(T,A,N)=>{var H=[];return T=T.toWireType(H,N),H.length&&(fe()[A>>>2>>>0]=an(H)),T};function ln(T,A,N){return A>>>=0,N>>>=0,T=en(T>>>0),A=Sr(A,"emval::as"),hr(A,N,T)}function pn(T,A){return A>>>=0,T=en(T>>>0),(A=Sr(A,"emval::as")).toWireType(null,T)}var Mn=T=>{try{T()}catch(A){$e(A)}},Tn=0,Ar=null,Ti=0,_r=[],cn={},Bn={},As=0,$s=null,In=[];function zn(T){return function(A){if(!re){if(Tn===0){var N=!1,H=!1;A((ee=0)=>{if(!re&&(Ti=ee,N=!0,H)){Tn=2,Mn(()=>mh(Ar)),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),ee=!1;try{var pe=function(){var Ze=ae()[Ar+8>>>2>>>0];return Ze=vt[Bn[Ze]],--it,Ze()}()}catch(Ze){pe=Ze,ee=!0}var ke=!1;if(!Ar){var ze=$s;ze&&($s=null,(ee?ze.reject:ze.resolve)(pe),ke=!0)}if(ee&&!ke)throw pe}}),H=!0,N||(Tn=1,Ar=function(){var ee=Cl(65548),pe=ee+12;fe()[ee>>>2>>>0]=pe,fe()[ee+4>>>2>>>0]=pe+65536,pe=_r[0];var ke=cn[pe];return ke===void 0&&(ke=As++,cn[pe]=ke,Bn[ke]=pe),pe=ke,ae()[ee+8>>>2>>>0]=pe,ee}(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),Mn(()=>ph(Ar)))}else Tn===2?(Tn=0,Mn(gh),ys(Ar),Ar=null,In.forEach(ge)):$e(`invalid state: ${Tn}`);return Ti}}(A=>{T().then(A)})}function mn(T){return T>>>=0,zn(async()=>{var A=await en(T);return an(A)})}var $r=[];function tn(T,A,N,H){return N>>>=0,H>>>=0,(T=$r[T>>>0])(null,A=en(A>>>0),N,H)}var rn={},On=T=>{var A=rn[T];return A===void 0?xn(T):A};function ni(T,A,N,H,ee){return N>>>=0,H>>>=0,ee>>>=0,(T=$r[T>>>0])(A=en(A>>>0),A[N=On(N)],H,ee)}var xl=()=>typeof globalThis=="object"?globalThis:Function("return this")();function Mp(T){return(T>>>=0)==0?an(xl()):(T=On(T),an(xl()[T]))}var Tp=T=>{var A=$r.length;return $r.push(T),A},Ep=(T,A)=>{for(var N=Array(T),H=0;H<T;++H)N[H]=Sr(fe()[A+4*H>>>2>>>0],"parameter "+H);return N},zd=(T,A)=>Object.defineProperty(A,"name",{value:T});function aa(T,A,N){var H=(A=Ep(T,A>>>0)).shift();T--;var ee=`return function (obj, func, destructorsRef, args) {
`,pe=0,ke=[];N===0&&ke.push("obj");for(var ze=["retType"],Ze=[H],lt=0;lt<T;++lt)ke.push("arg"+lt),ze.push("argType"+lt),Ze.push(A[lt]),ee+=`  var arg${lt} = argType${lt}.readValueFromPointer(args${pe?"+"+pe:""});
`,pe+=A[lt].Cb;return ee+=`  var rv = ${N===1?"new func":"func.call"}(${ke.join(", ")});
`,H.Tb||(ze.push("emval_returnValue"),Ze.push(hr),ee+=`  return emval_returnValue(retType, destructorsRef, rv);
`),ze.push(ee+`};
`),T=function($t){var Qt=Function;if(!(Qt instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof Qt} which is not a function`);var fr=zd(Qt.name||"unknownFunctionName",function(){});return fr.prototype=Qt.prototype,fr=new fr,($t=Qt.apply(fr,$t))instanceof Object?$t:fr}(ze)(...Ze),N=`methodCaller<(${A.map($t=>$t.name).join(", ")}) => ${H.name}>`,Tp(zd(N,T))}function Sp(T){return T=On(T>>>0),an(i[T])}function Pp(T,A){return A>>>=0,T=en(T>>>0),A=en(A),an(T[A])}function Cp(T){9<(T>>>=0)&&(Zr[T+1]+=1)}function kp(){return an([])}function Ap(T){T=en(T>>>0);for(var A=Array(T.length),N=0;N<T.length;N++)A[N]=T[N];return an(A)}function Vd(T){return an(On(T>>>0))}function $p(){return an({})}function Ip(T){for(var A=en(T>>>=0);A.length;){var N=A.pop();A.pop()(N)}ti(T)}function Ud(T,A,N){A>>>=0,N>>>=0,T=en(T>>>0),A=en(A),N=en(N),T[A]=N}function Op(T,A){return A>>>=0,T=(T=Sr(T>>>0,"_emval_take_value")).readValueFromPointer(A),an(T)}function Wd(T,A){T=-9007199254740992>T||9007199254740992<T?NaN:Number(T),A>>>=0,T=new Date(1e3*T),ae()[A>>>2>>>0]=T.getUTCSeconds(),ae()[A+4>>>2>>>0]=T.getUTCMinutes(),ae()[A+8>>>2>>>0]=T.getUTCHours(),ae()[A+12>>>2>>>0]=T.getUTCDate(),ae()[A+16>>>2>>>0]=T.getUTCMonth(),ae()[A+20>>>2>>>0]=T.getUTCFullYear()-1900,ae()[A+24>>>2>>>0]=T.getUTCDay(),T=(T.getTime()-Date.UTC(T.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,ae()[A+28>>>2>>>0]=T}var Gd=T=>T%4==0&&(T%100!=0||T%400==0),zc=[0,31,60,91,121,152,182,213,244,274,305,335],jp=[0,31,59,90,120,151,181,212,243,273,304,334];function Dp(T,A){T=-9007199254740992>T||9007199254740992<T?NaN:Number(T),A>>>=0,T=new Date(1e3*T),ae()[A>>>2>>>0]=T.getSeconds(),ae()[A+4>>>2>>>0]=T.getMinutes(),ae()[A+8>>>2>>>0]=T.getHours(),ae()[A+12>>>2>>>0]=T.getDate(),ae()[A+16>>>2>>>0]=T.getMonth(),ae()[A+20>>>2>>>0]=T.getFullYear()-1900,ae()[A+24>>>2>>>0]=T.getDay();var N=(Gd(T.getFullYear())?zc:jp)[T.getMonth()]+T.getDate()-1|0;ae()[A+28>>>2>>>0]=N,ae()[A+36>>>2>>>0]=-60*T.getTimezoneOffset(),N=new Date(T.getFullYear(),6,1).getTimezoneOffset();var H=new Date(T.getFullYear(),0,1).getTimezoneOffset();T=0|(N!=H&&T.getTimezoneOffset()==Math.min(H,N)),ae()[A+32>>>2>>>0]=T}function Hd(T){T>>>=0;var A=new Date(ae()[T+20>>>2>>>0]+1900,ae()[T+16>>>2>>>0],ae()[T+12>>>2>>>0],ae()[T+8>>>2>>>0],ae()[T+4>>>2>>>0],ae()[T>>>2>>>0],0),N=ae()[T+32>>>2>>>0],H=A.getTimezoneOffset(),ee=new Date(A.getFullYear(),6,1).getTimezoneOffset(),pe=new Date(A.getFullYear(),0,1).getTimezoneOffset(),ke=Math.min(pe,ee);return 0>N?ae()[T+32>>>2>>>0]=+(ee!=pe&&ke==H):0<N!=(ke==H)&&(ee=Math.max(pe,ee),A.setTime(A.getTime()+6e4*((0<N?ke:ee)-H))),ae()[T+24>>>2>>>0]=A.getDay(),N=(Gd(A.getFullYear())?zc:jp)[A.getMonth()]+A.getDate()-1|0,ae()[T+28>>>2>>>0]=N,ae()[T>>>2>>>0]=A.getSeconds(),ae()[T+4>>>2>>>0]=A.getMinutes(),ae()[T+8>>>2>>>0]=A.getHours(),ae()[T+12>>>2>>>0]=A.getDate(),ae()[T+16>>>2>>>0]=A.getMonth(),ae()[T+20>>>2>>>0]=A.getYear(),T=A.getTime(),BigInt(isNaN(T)?-1:T/1e3)}function Vc(T,A,N,H,ee,pe,ke){return c?We(16,1,T,A,N,H,ee,pe,ke):-52}function Ml(T,A,N,H,ee,pe){if(c)return We(17,1,T,A,N,H,ee,pe)}var la={},Np=()=>performance.timeOrigin+performance.now();function Kd(T,A){if(c)return We(18,1,T,A);if(la[T]&&(clearTimeout(la[T].id),delete la[T]),!A)return 0;var N=setTimeout(()=>{delete la[T],ge(()=>dh(T,performance.timeOrigin+performance.now()))},A);return la[T]={id:N,qc:A},0}function Rp(T,A,N,H){T>>>=0,A>>>=0,N>>>=0,H>>>=0;var ee=new Date().getFullYear(),pe=new Date(ee,0,1).getTimezoneOffset();ee=new Date(ee,6,1).getTimezoneOffset();var ke=Math.max(pe,ee);fe()[T>>>2>>>0]=60*ke,ae()[A>>>2>>>0]=+(pe!=ee),T=(A=ze=>{var Ze=Math.abs(ze);return`UTC${0<=ze?"-":"+"}${String(Math.floor(Ze/60)).padStart(2,"0")}${String(Ze%60).padStart(2,"0")}`})(pe),A=A(ee),ee<pe?(fn(T,N,17),fn(A,H,17)):(fn(T,H,17),fn(A,N,17))}var Fp=()=>Date.now();function Lp(T,A,N){return 0<=T&&3>=T?(T===0?T=Date.now():T=performance.timeOrigin+performance.now(),X[N>>>0>>>3]=BigInt(Math.round(1e6*T)),0):28}var Uc=[],qd=(T,A)=>{Uc.length=0;for(var N;N=q()[T++>>>0];){var H=N!=105;A+=(H&=N!=112)&&A%8?4:0,Uc.push(N==112?fe()[A>>>2>>>0]:N==106?X[A>>>3]:N==105?ae()[A>>>2>>>0]:Ne()[A>>>3>>>0]),A+=H?8:4}return Uc};function Qd(T,A,N){return T>>>=0,A=qd(A>>>0,N>>>0),Ue[T](...A)}function Bp(T,A,N){return T>>>=0,A=qd(A>>>0,N>>>0),Ue[T](...A)}var Wc=()=>{};function Yd(T,A){return x(mt(T>>>0,A>>>0))}var zp=()=>{throw it+=1,"unwind"};function Xd(){return 4294901760}var No=()=>navigator.hardwareConcurrency;function Vp(){return $e("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function Ny(T){T>>>=0;var A=q().length;if(T<=A||4294901760<T)return!1;for(var N=1;4>=N;N*=2){var H=A*(1+.2/N);H=Math.min(H,T+100663296);e:{H=(Math.min(4294901760,65536*Math.ceil(Math.max(T,H)/65536))-M.buffer.byteLength+65535)/65536|0;try{M.grow(H),se();var ee=1;break e}catch{}ee=void 0}if(ee)return!0}return!1}var Tl=()=>($e("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),El={},Jd=T=>{T.forEach(A=>{Tl()})};function Zd(){var T=Error().stack.toString().split(`
`);return T[0]=="Error"&&T.shift(),Jd(T),El.Lb=Tl(),El.cc=T,El.Lb}function Up(T,A,N){if(T>>>=0,A>>>=0,El.Lb==T)var H=El.cc;else(H=Error().stack.toString().split(`
`))[0]=="Error"&&H.shift(),Jd(H);for(var ee=3;H[ee]&&Tl()!=T;)++ee;for(T=0;T<N&&H[T+ee];++T)ae()[A+4*T>>>2>>>0]=Tl();return T}var Gc,Hc={},eh=()=>{if(!Gc){var T,A={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(T in Hc)Hc[T]===void 0?delete A[T]:A[T]=Hc[T];var N=[];for(T in A)N.push(`${T}=${A[T]}`);Gc=N}return Gc};function th(T,A){if(c)return We(19,1,T,A);T>>>=0,A>>>=0;var N=0;return eh().forEach((H,ee)=>{var pe=A+N;for(ee=fe()[T+4*ee>>>2>>>0]=pe,pe=0;pe<H.length;++pe)j()[ee++>>>0]=H.charCodeAt(pe);j()[ee>>>0]=0,N+=H.length+1}),0}function Sl(T,A){if(c)return We(20,1,T,A);T>>>=0,A>>>=0;var N=eh();fe()[T>>>2>>>0]=N.length;var H=0;return N.forEach(ee=>H+=ee.length+1),fe()[A>>>2>>>0]=H,0}function rh(T){return c?We(21,1,T):52}function nh(T,A,N,H){return c?We(22,1,T,A,N,H):52}function sh(T,A,N,H){return c?We(23,1,T,A,N,H):70}var ih=[null,[],[]];function oh(T,A,N,H){if(c)return We(24,1,T,A,N,H);A>>>=0,N>>>=0,H>>>=0;for(var ee=0,pe=0;pe<N;pe++){var ke=fe()[A>>>2>>>0],ze=fe()[A+4>>>2>>>0];A+=8;for(var Ze=0;Ze<ze;Ze++){var lt=q()[ke+Ze>>>0],$t=ih[T];lt===0||lt===10?((T===1?b:x)(bt($t)),$t.length=0):$t.push(lt)}ee+=ze}return fe()[H>>>2>>>0]=ee,0}c||function(){for(var T=i.numThreads-1;T--;)ce();ot.unshift(()=>{xe++,function(A){c?A():Promise.all(Mt.map(F)).then(A)}(()=>Ee())})}();for(var ah=Array(256),ca=0;256>ca;++ca)ah[ca]=String.fromCharCode(ca);lo=ah,Wr=i.BindingError=class extends Error{constructor(T){super(T),this.name="BindingError"}},i.InternalError=class extends Error{constructor(T){super(T),this.name="InternalError"}},Zr.push(0,1,void 0,1,null,1,!0,1,!1,1),i.count_emval_handles=()=>Zr.length/2-5-ei.length;var vt,Wp=[Be,De,Se,ut,sr,Er,Ln,Xs,wi,Js,io,ss,oo,ks,bi,ao,Vc,Ml,Kd,th,Sl,rh,nh,sh,oh];(async function(){function T(H,ee){return vt=H.exports,vt=function(){var pe=vt,ke={};for(let[ze,Ze]of Object.entries(pe))ke[ze]=typeof Ze=="function"?(...lt)=>{_r.push(ze);try{return Ze(...lt)}finally{re||(_r.pop(),Ar&&Tn===1&&_r.length===0&&(Tn=0,it+=1,Mn(Jc),typeof Fibers<"u"&&Fibers.rc()))}}:Ze;return ke}(),vt=function(){var pe=vt,ke=Ze=>lt=>Ze(lt)>>>0,ze=Ze=>()=>Ze()>>>0;return(pe=Object.assign({},pe)).Da=ke(pe.Da),pe.fb=ze(pe.fb),pe.hb=ke(pe.hb),pe.tb=ke(pe.tb),pe.ub=ze(pe.ub),pe.__cxa_get_exception_ptr=ke(pe.__cxa_get_exception_ptr),pe}(),dr.push(vt.ib),E=ee,Ee(),vt}xe++;var A=Ie();if(i.instantiateWasm)return new Promise(H=>{i.instantiateWasm(A,(ee,pe)=>{T(ee,pe),H(ee.exports)})});if(c)return new Promise(H=>{de=ee=>{var pe=new WebAssembly.Instance(ee,Ie());H(T(pe,ee))}});be??(be=i.locateFile?i.locateFile?i.locateFile("ort-wasm-simd-threaded.jsep.wasm",y):y+"ort-wasm-simd-threaded.jsep.wasm":new URL("/assets/ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href);try{var N=await async function(H){var ee=be;if(!te&&typeof WebAssembly.instantiateStreaming=="function"&&!L(ee))try{var pe=fetch(ee,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(pe,H)}catch(ke){x(`wasm streaming compile failed: ${ke}`),x("falling back to ArrayBuffer instantiation")}return async function(ke,ze){try{var Ze=await async function(lt){if(!te)try{var $t=await f(lt);return new Uint8Array($t)}catch{}if(lt==be&&te)lt=new Uint8Array(te);else{if(!p)throw"both async and sync fetching of the wasm failed";lt=p(lt)}return lt}(ke);return await WebAssembly.instantiate(Ze,ze)}catch(lt){x(`failed to asynchronously prepare wasm: ${lt}`),$e(lt)}}(ee,H)}(A);return T(N.instance,N.module)}catch(H){return s(H),Promise.reject(H)}})();var Kc=T=>(Kc=vt.Da)(T),lh=()=>(lh=vt.Ea)();i._OrtInit=(T,A)=>(i._OrtInit=vt.Fa)(T,A),i._OrtGetLastError=(T,A)=>(i._OrtGetLastError=vt.Ga)(T,A),i._OrtCreateSessionOptions=(T,A,N,H,ee,pe,ke,ze,Ze,lt)=>(i._OrtCreateSessionOptions=vt.Ha)(T,A,N,H,ee,pe,ke,ze,Ze,lt),i._OrtAppendExecutionProvider=(T,A,N,H,ee)=>(i._OrtAppendExecutionProvider=vt.Ia)(T,A,N,H,ee),i._OrtAddFreeDimensionOverride=(T,A,N)=>(i._OrtAddFreeDimensionOverride=vt.Ja)(T,A,N),i._OrtAddSessionConfigEntry=(T,A,N)=>(i._OrtAddSessionConfigEntry=vt.Ka)(T,A,N),i._OrtReleaseSessionOptions=T=>(i._OrtReleaseSessionOptions=vt.La)(T),i._OrtCreateSession=(T,A,N)=>(i._OrtCreateSession=vt.Ma)(T,A,N),i._OrtReleaseSession=T=>(i._OrtReleaseSession=vt.Na)(T),i._OrtGetInputOutputCount=(T,A,N)=>(i._OrtGetInputOutputCount=vt.Oa)(T,A,N),i._OrtGetInputOutputMetadata=(T,A,N,H)=>(i._OrtGetInputOutputMetadata=vt.Pa)(T,A,N,H),i._OrtFree=T=>(i._OrtFree=vt.Qa)(T),i._OrtCreateTensor=(T,A,N,H,ee,pe)=>(i._OrtCreateTensor=vt.Ra)(T,A,N,H,ee,pe),i._OrtGetTensorData=(T,A,N,H,ee)=>(i._OrtGetTensorData=vt.Sa)(T,A,N,H,ee),i._OrtReleaseTensor=T=>(i._OrtReleaseTensor=vt.Ta)(T),i._OrtCreateRunOptions=(T,A,N,H)=>(i._OrtCreateRunOptions=vt.Ua)(T,A,N,H),i._OrtAddRunConfigEntry=(T,A,N)=>(i._OrtAddRunConfigEntry=vt.Va)(T,A,N),i._OrtReleaseRunOptions=T=>(i._OrtReleaseRunOptions=vt.Wa)(T),i._OrtCreateBinding=T=>(i._OrtCreateBinding=vt.Xa)(T),i._OrtBindInput=(T,A,N)=>(i._OrtBindInput=vt.Ya)(T,A,N),i._OrtBindOutput=(T,A,N,H)=>(i._OrtBindOutput=vt.Za)(T,A,N,H),i._OrtClearBoundOutputs=T=>(i._OrtClearBoundOutputs=vt._a)(T),i._OrtReleaseBinding=T=>(i._OrtReleaseBinding=vt.$a)(T),i._OrtRunWithBinding=(T,A,N,H,ee)=>(i._OrtRunWithBinding=vt.ab)(T,A,N,H,ee),i._OrtRun=(T,A,N,H,ee,pe,ke,ze)=>(i._OrtRun=vt.bb)(T,A,N,H,ee,pe,ke,ze),i._OrtEndProfiling=T=>(i._OrtEndProfiling=vt.cb)(T),i._JsepOutput=(T,A,N)=>(i._JsepOutput=vt.db)(T,A,N),i._JsepGetNodeName=T=>(i._JsepGetNodeName=vt.eb)(T);var Pl=()=>(Pl=vt.fb)(),ys=i._free=T=>(ys=i._free=vt.gb)(T),Cl=i._malloc=T=>(Cl=i._malloc=vt.hb)(T),qc=(T,A,N,H,ee,pe)=>(qc=vt.kb)(T,A,N,H,ee,pe),Qc=()=>(Qc=vt.lb)(),ch=(T,A,N,H,ee)=>(ch=vt.mb)(T,A,N,H,ee),uh=T=>(uh=vt.nb)(T),kl=T=>(kl=vt.ob)(T),dh=(T,A)=>(dh=vt.pb)(T,A),hh=()=>(hh=vt.qb)(),Yc=(T,A)=>(Yc=vt.rb)(T,A),Al=T=>(Al=vt.sb)(T),Xc=T=>(Xc=vt.tb)(T),$l=()=>($l=vt.ub)(),fh=i.dynCall_ii=(T,A)=>(fh=i.dynCall_ii=vt.vb)(T,A),ph=T=>(ph=vt.wb)(T),Jc=()=>(Jc=vt.xb)(),mh=T=>(mh=vt.yb)(T),gh=()=>(gh=vt.zb)();return i.stackSave=()=>$l(),i.stackRestore=T=>Al(T),i.stackAlloc=T=>Xc(T),i.setValue=function(T,A,N="i8"){switch(N.endsWith("*")&&(N="*"),N){case"i1":case"i8":j()[T>>>0]=A;break;case"i16":ne()[T>>>1>>>0]=A;break;case"i32":ae()[T>>>2>>>0]=A;break;case"i64":X[T>>>3]=BigInt(A);break;case"float":Pe()[T>>>2>>>0]=A;break;case"double":Ne()[T>>>3>>>0]=A;break;case"*":fe()[T>>>2>>>0]=A;break;default:$e(`invalid type for setValue: ${N}`)}},i.getValue=function(T,A="i8"){switch(A.endsWith("*")&&(A="*"),A){case"i1":case"i8":return j()[T>>>0];case"i16":return ne()[T>>>1>>>0];case"i32":return ae()[T>>>2>>>0];case"i64":return X[T>>>3];case"float":return Pe()[T>>>2>>>0];case"double":return Ne()[T>>>3>>>0];case"*":return fe()[T>>>2>>>0];default:$e(`invalid type for getValue: ${A}`)}},i.UTF8ToString=mt,i.stringToUTF8=fn,i.lengthBytesUTF8=wr,function T(){if(0<xe)Te=T;else if(c)n(i),J();else{for(;0<ot.length;)ot.shift()(i);0<xe?Te=T:(i.calledRun=!0,re||(J(),n(i)))}}(),i.PTR_SIZE=4,o}),UW=mw,NO=(t=(e=globalThis.self)==null?void 0:e.name)==null?void 0:t.startsWith("em-pthread"),NO&&mw()}),gw,_1,RO,Os,WW,eg,FO,LO,_w,BO,yw,GW,vw,HW,sE=He(()=>{nE(),gw=typeof location>"u"?void 0:location.origin,_1=import.meta.url>"file:"&&import.meta.url<"file;",RO=()=>{{if(_1){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,gw).href}return import.meta.url}},Os=RO(),WW=()=>{if(Os&&!Os.startsWith("blob:"))return Os.substring(0,Os.lastIndexOf("/")+1)},eg=(e,t)=>{try{let r=t??Os;return(r?new URL(e,r):new URL(e)).origin===gw}catch{return!1}},FO=(e,t)=>{let r=t??Os;try{return(r?new URL(e,r):new URL(e)).href}catch{return}},LO=(e,t)=>`${t??"./"}${e}`,_w=async e=>{let t=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},BO=async e=>(await import(e)).default,yw=(gle(),Jf(BW)).default,GW=async()=>{if(!Os)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(eg(Os))return[void 0,yw()];let e=await _w(Os);return[e,yw(e)]},vw=(_le(),Jf(VW)).default,HW=async(e,t,r)=>{if(!e&&!t&&vw&&Os&&eg(Os))return[void 0,vw];{let n="ort-wasm-simd-threaded.jsep.mjs",s=e??FO(n,t),i=r&&s&&!eg(s,t),o=i?await _w(s):s??LO(n,t);return[i?o:void 0,await BO(o)]}}}),ww,tg,Ih,bw,zO,VO,UO,iE,Tr,Fc=He(()=>{sE(),tg=!1,Ih=!1,bw=!1,zO=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},VO=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},UO=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},iE=async e=>{if(tg)return Promise.resolve();if(Ih)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(bw)throw new Error("previous call to 'initializeWebAssembly()' failed.");Ih=!0;let t=e.initTimeout,r=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!UO())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!VO())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let n=zO();r>1&&!n&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+r+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=r=1);let s=e.wasmPaths,i=typeof s=="string"?s:void 0,o=s==null?void 0:s.mjs,a=(o==null?void 0:o.href)??o,l=s==null?void 0:s.wasm,c=(l==null?void 0:l.href)??l,u=e.wasmBinary,[d,h]=await HW(a,i,r>1),f=!1,p=[];if(t>0&&p.push(new Promise(_=>{setTimeout(()=>{f=!0,_()},t)})),p.push(new Promise((_,w)=>{let y={numThreads:r};if(u)y.wasmBinary=u;else if(c||i)y.locateFile=g=>c??i+g;else if(a&&a.indexOf("blob:")!==0)y.locateFile=g=>new URL(g,a).href;else if(d){let g=WW();g&&(y.locateFile=v=>g+v)}h(y).then(g=>{Ih=!1,tg=!0,ww=g,_(),d&&URL.revokeObjectURL(d)},g=>{Ih=!1,bw=!0,w(g)})})),await Promise.race(p),f)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Tr=()=>{if(tg&&ww)return ww;throw new Error("WebAssembly is not initialized yet.")}}),Vi,j_,gr,oE=He(()=>{Fc(),Vi=(e,t)=>{let r=Tr(),n=r.lengthBytesUTF8(e)+1,s=r._malloc(n);return r.stringToUTF8(e,s,n),t.push(s),s},j_=(e,t,r,n)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([s,i])=>{let o=t?t+s:s;if(typeof i=="object")j_(i,o+".",r,n);else if(typeof i=="string"||typeof i=="number")n(o,i.toString());else if(typeof i=="boolean")n(o,i?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof i}`)})},gr=e=>{let t=Tr(),r=t.stackSave();try{let n=t.PTR_SIZE,s=t.stackAlloc(2*n);t._OrtGetLastError(s,s+n);let i=Number(t.getValue(s,n===4?"i32":"i64")),o=t.getValue(s+n,"*"),a=o?t.UTF8ToString(o):"";throw new Error(`${e} ERROR_CODE: ${i}, ERROR_MESSAGE: ${a}`)}finally{t.stackRestore(r)}}}),KW,yle=He(()=>{Fc(),oE(),KW=e=>{let t=Tr(),r=0,n=[],s=e||{};try{if((e==null?void 0:e.logSeverityLevel)===void 0)s.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if((e==null?void 0:e.logVerbosityLevel)===void 0)s.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);(e==null?void 0:e.terminate)===void 0&&(s.terminate=!1);let i=0;return(e==null?void 0:e.tag)!==void 0&&(i=Vi(e.tag,n)),r=t._OrtCreateRunOptions(s.logSeverityLevel,s.logVerbosityLevel,!!s.terminate,i),r===0&&gr("Can't create run options."),(e==null?void 0:e.extra)!==void 0&&j_(e.extra,"",new WeakSet,(o,a)=>{let l=Vi(o,n),c=Vi(a,n);t._OrtAddRunConfigEntry(r,l,c)!==0&&gr(`Can't set a run config entry: ${o} - ${a}.`)}),[r,n]}catch(i){throw r!==0&&t._OrtReleaseRunOptions(r),n.forEach(o=>t._free(o)),i}}}),WO,GO,HO,Oh,KO,qW,vle=He(()=>{Fc(),oE(),WO=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},GO=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},HO=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},Oh=(e,t,r,n)=>{let s=Vi(t,n),i=Vi(r,n);Tr()._OrtAddSessionConfigEntry(e,s,i)!==0&&gr(`Can't set a session config entry: ${t} - ${r}.`)},KO=async(e,t,r)=>{for(let n of t){let s=typeof n=="string"?n:n.name,i=[];switch(s){case"webnn":if(s="WEBNN",typeof n!="string"){let u=n==null?void 0:n.deviceType;u&&Oh(e,"deviceType",u,r)}break;case"webgpu":if(s="JS",typeof n!="string"){let u=n;if(u!=null&&u.preferredLayout){if(u.preferredLayout!=="NCHW"&&u.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${u.preferredLayout}`);Oh(e,"preferredLayout",u.preferredLayout,r)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${s}`)}let o=Vi(s,r),a=i.length,l=0,c=0;if(a>0){l=Tr()._malloc(a*Tr().PTR_SIZE),r.push(l),c=Tr()._malloc(a*Tr().PTR_SIZE),r.push(c);for(let u=0;u<a;u++)Tr().setValue(l+u*Tr().PTR_SIZE,i[u][0],"*"),Tr().setValue(c+u*Tr().PTR_SIZE,i[u][1],"*")}await Tr()._OrtAppendExecutionProvider(e,o,l,c,a)!==0&&gr(`Can't append execution provider: ${s}.`)}},qW=async e=>{let t=Tr(),r=0,n=[],s=e||{};HO(s);try{let i=WO(s.graphOptimizationLevel??"all"),o=GO(s.executionMode??"sequential"),a=typeof s.logId=="string"?Vi(s.logId,n):0,l=s.logSeverityLevel??2;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log serverity level is not valid: ${l}`);let c=s.logVerbosityLevel??0;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log verbosity level is not valid: ${c}`);let u=typeof s.optimizedModelFilePath=="string"?Vi(s.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(i,!!s.enableCpuMemArena,!!s.enableMemPattern,o,!!s.enableProfiling,0,a,l,c,u),r===0&&gr("Can't create session options."),s.executionProviders&&await KO(r,s.executionProviders,n),s.enableGraphCapture!==void 0){if(typeof s.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${s.enableGraphCapture}`);Oh(r,"enableGraphCapture",s.enableGraphCapture.toString(),n)}if(s.freeDimensionOverrides)for(let[d,h]of Object.entries(s.freeDimensionOverrides)){if(typeof d!="string")throw new Error(`free dimension override name must be a string: ${d}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let f=Vi(d,n);t._OrtAddFreeDimensionOverride(r,f,h)!==0&&gr(`Can't set a free dimension override: ${d} - ${h}.`)}return s.extra!==void 0&&j_(s.extra,"",new WeakSet,(d,h)=>{Oh(r,d,h,n)}),[r,n]}catch(i){throw r!==0&&t._OrtReleaseSessionOptions(r)!==0&&gr("Can't release session options."),n.forEach(o=>t._free(o)),i}}}),yu,Go,Zl,aE,D_,lE,cE,y1,Et=He(()=>{yu=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},Go=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},Zl=(e,t)=>{let r=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],n=typeof t=="number"?t:t.reduce((s,i)=>s*i,1);return r>0?Math.ceil(n*r):void 0},aE=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},D_=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},lE=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",cE=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",y1=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),uE,QW=He(()=>{nE(),uE=async e=>{if(typeof e=="string"){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let s=t.body.getReader(),i;try{i=new ArrayBuffer(n)}catch(a){if(a instanceof RangeError){let l=Math.ceil(n/65536);i=new WebAssembly.Memory({initial:l,maximum:l}).buffer}else throw a}let o=0;for(;;){let{done:a,value:l}=await s.read();if(a)break;let c=l.byteLength;new Uint8Array(i,o,c).set(l),o+=c}return new Uint8Array(i,0,n)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),qO,QO,YO,XO,dE,JO,Xt,ia=He(()=>{Et(),qO=["V","I","W","E","F"],QO=(e,t)=>{console.log(`[${qO[e]},${new Date().toISOString()}]${t}`)},dE=(e,t)=>{YO=e,XO=t},JO=(e,t)=>{let r=D_(e),n=D_(YO);r>=n&&QO(r,typeof t=="function"?t():t)},Xt=(...e)=>{XO&&JO(...e)}}),ZO,wd,Me,N_,YW,XW,JW,Rt=He(()=>{ZO=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},wd=class{static calcShape(e,t,r=!1){let n=e.length,s=t.length;if(n===0)return t;if(s===0)return e;let i=Math.max(e.length,t.length),o=new Array(i);if(r){if(n<2||s<2)return;let a=ZO.calcMatMulShape([e[n-2],e[n-1]],[t[s-2],t[s-1]]);if(a===void 0)return;[o[i-2],o[i-1]]=a}for(let a=r?3:1;a<=i;a++){let l=n-a<0?1:e[n-a],c=s-a<0?1:t[s-a];if(l!==c&&l>1&&c>1)return;let u=Math.max(l,c);if(l&&c)o[i-a]=Math.max(l,c);else{if(u>1)return;o[i-a]=0}}return o}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let s=1;s<=r;s++)if(e[r-s]!==1&&e[r-s]!==t[n-s])return!1;return!0}},Me=class Lg{static size(t){return Lg.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,r=4){let n=t.length;if(n===0)return[];let s=new Array(n),i=n-1;for(;i>=0;){if(t[i]%r===0){s[i]=t[i]/r;break}if(r%t[i]!==0)throw new Error("cannot convert shape");s[i]=1,r/=t[i],i--}for(i--;i>=0;i--)s[i]=t[i];return s}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return Lg.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return Lg.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,n){let s=1;for(let i=r;i<n;i++){if(t[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");s*=Number(t[i])}return s}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let n=new Array(r);n[r-1]=1,n[r-2]=t[r-1];for(let s=r-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(n=>this.normalizeAxis(n,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(n=>t[n]):t.slice().reverse()}static padShape(t,r){let n=t.length;return t.map((s,i)=>s+r[i]+r[i+n])}static areEqual(t,r){return t.length!==r.length?!1:t.every((n,s)=>n===r[s])}},N_=class Xh{static adjustPoolAttributes(t,r,n,s,i,o){if(!t&&n.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let a=0;a<r.length-2;a++)a>=n.length?n.push(r[a+2]):n[a]=r[a+2];for(let a=0;a<n.length;a++)if(a<s.length){if(s[a]<0)throw new Error("strides should be greater than or equal to 1")}else s.push(1);for(let a=0;a<n.length;a++)if(a<i.length){if(i[a]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let a=0;a<n.length*2;a++)if(a<o.length){if(o[a]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let a=0;a<n.length;a++){if(n[a]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[a]>=n[a]||o[a+n.length]>=n[a])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,s,i,o,a){if(a){if(i.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(s.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<t.length-2;l++)Xh.adjustPadAndReturnShape(t[l+(o?1:2)],r[l],n[l],s[l],i,l,l+t.length-2,a)}}static computePoolOutputShape(t,r,n,s,i,o,a){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let l=[r[0],r[1]];return Xh.computeShapeHelper(t,r,l,n,s,i,o,a),l}static computeConvOutputShape(t,r,n,s,i,o,a){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let l=[t[0],r[0]];return Xh.computeShapeHelper(!1,t,l,n,s,i,o,a),l}static computeShapeHelper(t,r,n,s,i,o,a,l){if(t)for(let c=0;c<r.length-2;c++)n.push(1);else for(let c=0;c<r.length-2;c++)n.push(Xh.adjustPadAndReturnShape(r[c+2],s[c],i[c],o[c],a,c,c+r.length-2,l))}static adjustPadAndReturnShape(t,r,n,s,i,o,a,l){let c=n*(s-1)+1;if(l&&l!=="NOTSET")switch(l){case"VALID":return i[o]=0,i[a]=0,Math.floor((t-c)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(n!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let u=((t+r-1)/r-1)*r+s-t;return i[o]=Math.floor(l==="SAME_LOWER"?(u+1)/2:u/2),i[a]=u-i[o],Math.floor((t+u-s)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+i[o]+i[a]-c)/r+1)}},YW=class{static getShapeOfGemmResult(e,t,r,n,s){if(e.length!==2||r.length!==2)throw new Error("shape need to be of size 2");let i,o,a;t?(i=e[1],o=e[0]):(i=e[0],o=e[1]);let l=-1;if(n?(a=r[0],l=1):(a=r[1],l=0),r[l]!==o)throw new Error("dimension mismatch");if(i<=0||a<=0||o<=0)throw new Error("invalid shape specified");if(s&&!wd.isValidBroadcast(s,[i,a]))throw new Error("gemm: invalid bias shape for broadcast");return[i,a,o]}},XW=-34028234663852886e22,JW=34028234663852886e22}),hE,ZW=He(()=>{Et(),hE=(e,t)=>new(aE(t))(e)}),v1,xw,ej,Mw,tj,Tw,Ew,Sw,rj,e5,wle=He(()=>{ia(),v1=(e,t=!0)=>{if(e.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let r=e.byteLength/8,n=new BigInt64Array(e.buffer,e.byteOffset,r),s=new Int32Array(r);for(let i=0;i<r;i++){let o=n[i];if(o>2147483647n||o<-2147483648n)throw new Error(`Overflow occurred when converting BigInt to Int32 at index ${i}: ${o}`);s[i]=Number(o)}return t?new Uint8Array(s.buffer):s},xw=(e,t=!0)=>{if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let r=e.byteLength/4,n=new Int32Array(e.buffer,e.byteOffset,r),s=BigInt64Array.from(n,BigInt);return t?new Uint8Array(s.buffer):s},ej=1,Mw=()=>ej++,tj=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),Tw=(e,t)=>{let r=tj.get(e);if(!r)throw new Error("Unsupported data type.");return t.length>0?Math.ceil(t.reduce((n,s)=>n*s)*r/8):0},Ew=class{constructor(e){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:t,context:r,tensor:n,dataType:s,shape:i,shouldConvertInt64toInt32:o=!1}=e;this.sessionId=t,this.mlContext=r,this.mlTensor=n,this.dataType=s,this.tensorShape=i,this.shouldConvertInt64toInt32=o}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return Tw(this.dataType,this.tensorShape)}destroy(){Xt("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e,t){if(e){let r=await this.mlContext.readTensor(this.mlTensor),n=xw(new Uint8Array(r));if(t){(t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).set(n);return}else return n.buffer}else return t?this.mlContext.readTensor(this.mlTensor,t):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,t,r){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===r.length&&this.tensorShape.every((n,s)=>n===r[s])}setIsInt64ToInt32Converted(e){this.isInt64ToInt32Converted=e}},Sw=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,r,n){let s=t,i=this.tensorManager.getMLContext(e),o=s==="int64"&&!i.opSupportLimits().input.dataTypes.includes("int64");if(o&&(s="int32",Xt("verbose",()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32")),this.wrapper){if(this.wrapper.canReuseTensor(i,s,r))return this.wrapper.tensor;if(n){if(this.wrapper.byteLength!==Tw(s,r))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let a=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,s,r,a,!0,!0,o),n&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper)if(this.wrapper.shouldConvertInt64toInt32&&(t=v1(e,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),t.byteLength===this.wrapper.byteLength){this.wrapper.write(t);return}else Xt("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){var t,r,n;if(this.activeUpload){let s=(t=this.wrapper)!=null&&t.isInt64ToInt32Converted?xw(this.activeUpload):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(s):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(s);return}else return s.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read((r=this.wrapper)==null?void 0:r.shouldConvertInt64toInt32,e):this.wrapper.read((n=this.wrapper)==null?void 0:n.shouldConvertInt64toInt32)}},rj=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw new Error("MLContext not found for session.");return t}reserveTensorId(){let e=Mw();return this.tensorTrackersById.set(e,new Sw(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,r,n,s){Xt("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${t}, dataType: ${r}, shape: ${n}, copyOld: ${s}}`);let i=this.tensorTrackersById.get(t);if(!i)throw new Error("Tensor not found.");return i.ensureTensor(e,r,n,s)}upload(e,t){let r=this.tensorTrackersById.get(e);if(!r)throw new Error("Tensor not found.");r.upload(t)}async download(e,t){Xt("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${t==null?void 0:t.byteLength}}`);let r=this.tensorTrackersById.get(e);if(!r)throw new Error("Tensor not found.");return r.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter(t=>t.sessionId!==e)}registerTensor(e,t,r,n){let s=this.getMLContext(e),i=Mw(),o=new Ew({sessionId:e,context:s,tensor:t,dataType:r,shape:n});return this.tensorTrackersById.set(i,new Sw(this,o)),this.externalTensors.add(o),i}async getCachedTensor(e,t,r,n,s,i,o=!1){let a=this.getMLContext(e);for(let[c,u]of this.freeTensors.entries())if(u.canReuseTensor(a,t,r)){Xt("verbose",()=>`[WebNN] Reusing tensor {dataType: ${t}, shape: ${r}}`);let d=this.freeTensors.splice(c,1)[0];return d.sessionId=e,d}Xt("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${t}, shape: ${r}}`);let l=await a.createTensor({dataType:t,shape:r,dimensions:r,usage:n,writable:s,readable:i});return new Ew({sessionId:e,context:a,tensor:l,dataType:t,shape:r,shouldConvertInt64toInt32:o})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},e5=(...e)=>new rj(...e)}),rg,nj,t5,ble=He(()=>{Et(),Fc(),ZW(),wle(),ia(),rg=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),nj=(e,t)=>{if(e===t)return!0;if(e===void 0||t===void 0)return!1;let r=Object.keys(e).sort(),n=Object.keys(t).sort();return r.length===n.length&&r.every((s,i)=>s===n[i]&&e[s]===t[s])},t5=class{constructor(e){this.tensorManager=e5(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,dE(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){Xt("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){Xt("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let t=this.temporarySessionTensorIds.get(e);if(t){for(let r of t)Xt("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${r}}`),this.tensorManager.releaseTensorId(r);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let r=this.mlContextCache.findIndex(n=>n.gpuDevice===e);if(r!==-1)return this.mlContextCache[r].mlContext;{let n=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:n}),n}}else if(e===void 0){let r=this.mlContextCache.findIndex(n=>n.options===void 0&&n.gpuDevice===void 0);if(r!==-1)return this.mlContextCache[r].mlContext;{let n=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:n}),n}}let t=this.mlContextCache.findIndex(r=>nj(r.options,e));if(t!==-1)return this.mlContextCache[t].mlContext;{let r=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:r}),r}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let r=this.sessionIdsByMLContext.get(t);r||(r=new Set,this.sessionIdsByMLContext.set(t,r)),r.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let r=this.sessionIdsByMLContext.get(t);if(r.delete(e),r.size===0){this.sessionIdsByMLContext.delete(t);let n=this.mlContextCache.findIndex(s=>s.mlContext===t);n!==-1&&this.mlContextCache.splice(n,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){Xt("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,r,n,s){let i=rg.get(r);if(!i)throw new Error(`Unsupported ONNX data type: ${r}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,t,i,n,s)}async createTemporaryTensor(e,t,r){Xt("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${t}, shape: ${r}}`);let n=rg.get(t);if(!n)throw new Error(`Unsupported ONNX data type: ${t}`);let s=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,s,n,r,!1);let i=this.temporarySessionTensorIds.get(e);return i?i.push(s):this.temporarySessionTensorIds.set(e,[s]),s}uploadTensor(e,t){if(!Tr().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");Xt("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${t.byteLength}}`),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let r=await this.tensorManager.download(e);return hE(r,t)}}registerMLTensor(e,t,r,n){let s=rg.get(r);if(!s)throw new Error(`Unsupported ONNX data type: ${r}`);let i=this.tensorManager.registerTensor(e,t,s,n);return Xt("verbose",()=>`[WebNN] registerMLTensor {tensor: ${t}, dataType: ${s}, dimensions: ${n}} -> {tensorId: ${i}}`),i}registerMLConstant(e,t,r,n,s,i,o=!1){if(!i)throw new Error("External mounted files are not available.");let a=e;e.startsWith("./")&&(a=e.substring(2));let l=i.get(a);if(!l)throw new Error(`File with name ${a} not found in preloaded files.`);if(t+r>l.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let c=l.slice(t,t+r).buffer,u;switch(s.dataType){case"float32":u=new Float32Array(c);break;case"float16":u=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(c):new Uint16Array(c);break;case"int32":u=new Int32Array(c);break;case"uint32":u=new Uint32Array(c);break;case"int64":o?(u=v1(new Uint8Array(c),!1),s.dataType="int32"):u=new BigInt64Array(c);break;case"uint64":u=new BigUint64Array(c);break;case"int8":u=new Int8Array(c);break;case"int4":case"uint4":case"uint8":u=new Uint8Array(c);break;default:throw new Error(`Unsupported data type: ${s.dataType} in creating WebNN Constant from external data.`)}return Xt("verbose",()=>`[WebNN] registerMLConstant {dataType: ${s.dataType}, shape: ${s.shape}}} ${o?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),n.constant(s,u)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}isGraphInput(e,t){let r=this.sessionGraphInputs.get(e);return r?r.includes(t):!1}isInt64Supported(e){var t;return!!((t=this.mlContextBySessionId.get(e))!=null&&t.opSupportLimits().input.dataTypes.includes("int64"))}flush(){}}}),fE=He(()=>{}),Pw,ng,sg,sj,ij,Cw,w1,oj,r5,xle=He(()=>{ia(),fE(),Pw=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),ng=[],sg=e=>Math.ceil(Number(e)/16)*16,sj=e=>{for(let t=0;t<ng.length;t++){let r=ng[t];if(e<=r)return r}return Math.ceil(e/16)*16},ij=1,Cw=()=>ij++,w1=async(e,t,r,n)=>{let s=sg(r),i=e.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let o=e.getCommandEncoder();e.endComputePass(),o.copyBufferToBuffer(t,0,i,0,s),e.flush(),await i.mapAsync(GPUMapMode.READ);let a=i.getMappedRange();if(n){let l=n();return l.set(new Uint8Array(a,0,r)),l}else return new Uint8Array(a.slice(0,r))}finally{i.destroy()}},oj=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[t]of Pw)ng.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let r=t.buffer,n=t.byteOffset,s=t.byteLength,i=sg(s),o=this.storageCache.get(e);if(!o)throw new Error("gpu data for uploading does not exist");if(Number(o.originalSize)!==s)throw new Error(`inconsistent data size. gpu data size=${o.originalSize}, data size=${s}`);let a=this.backend.device.createBuffer({mappedAtCreation:!0,size:i,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),l=a.getMappedRange();new Uint8Array(l).set(new Uint8Array(r,n,s)),a.unmap();let c=this.backend.device.createCommandEncoder();c.copyBufferToBuffer(a,0,o.gpuData.buffer,0,i),this.backend.device.queue.submit([c.finish()]),a.destroy(),Xt("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let s=sg(r.originalSize),i=this.backend.getCommandEncoder();this.backend.endComputePass(),i.copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,s)}registerExternalBuffer(e,t,r){let n;if(r){if(n=r[0],e===r[1])return Xt("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, buffer is the same, skip.`),n;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else n=Cw();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:e},originalSize:t}),Xt("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, registered.`),n}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),Xt("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let r=sj(e),n,s=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,i=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(s||i){let a=(s?this.freeBuffers:this.freeUniformBuffers).get(r);a?a.length>0?n=a.pop():n=this.backend.device.createBuffer({size:r,usage:t}):n=this.backend.device.createBuffer({size:r,usage:t})}else n=this.backend.device.createBuffer({size:r,usage:t});let o={id:Cw(),type:0,buffer:n};return this.storageCache.set(o.id,{gpuData:o,originalSize:Number(e)}),Xt("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${o.id}`),o}get(e){var t;return(t=this.storageCache.get(e))==null?void 0:t.gpuData}release(e){let t=typeof e=="bigint"?Number(e):e,r=this.storageCache.get(t);if(!r){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return Xt("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(e,t){let r=this.storageCache.get(Number(e));if(!r)throw new Error("data does not exist");await w1(this.backend,r.gpuData.buffer,r.originalSize,t)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let t=Pw.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let r=this.freeBuffers.get(e.size)||[];t===void 0||r.length>=t?e.destroy():r.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let r=this.freeUniformBuffers.get(e.size)||[];t===void 0||r.length>=t?e.destroy():r.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach(r=>{r.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(Xt("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(r=>{r.gpuData.buffer.destroy()}),this.storageCache=new Map)}},r5=(...e)=>new oj(...e)}),aj,lr,Jr=He(()=>{aj=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},lr=e=>new aj(e)}),bd,ig,$n,es,gt,Vr,b1,Fu,nl,ht,jh,Oe,ct,n5,pE,lj,s5,Ft=He(()=>{Et(),Rt(),bd=64,ig=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},$n=(e,t=1)=>{let r=ig(e,t);return typeof r=="string"?r:r[0]},es=(e,t=1)=>{let r=ig(e,t);return typeof r=="string"?r:r[1]},gt=(...e)=>{let t=[];return e.forEach(r=>{r.length!==0&&t.push({type:12,data:r},{type:12,data:Me.computeStrides(r)})}),t},Vr=e=>e%4===0?4:e%2===0?2:1,b1=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,Fu=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}<f32>(${r})`,nl=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,ht=(e,t,r,n)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?n==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:n==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,jh=(e,t,r,n,s)=>{let i=typeof r=="number",o=i?r:r.length,a=[...new Array(o).keys()],l=o<2?"u32":o<=4?`vec${o}<u32>`:`array<u32, ${o}>`,c=ig(t,s),u=typeof c=="string"?c:c[1],d=typeof c=="string"?c:c[0],h={indices:l,value:u,storage:d,tensor:t},f=L=>typeof L=="string"?L:`${L}u`,p={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},_=i?"uniforms.":"",w=`${_}${e}_shape`,y=`${_}${e}_strides`,g="";for(let L=0;L<o-1;L++)g+=`
    let dim${L} = current / ${ht(y,L,o)};
    let rest${L} = current % ${ht(y,L,o)};
    indices[${L}] = dim${L};
    current = rest${L};
    `;g+=`indices[${o-1}] = current;`;let v=o<2?"":`
  fn o2i_${e}(offset: u32) -> ${h.indices} {
    var indices: ${h.indices};
    var current = offset;
    ${g}
    return indices;
  }`,b=L=>(p.offsetToIndices=!0,o<2?L:`o2i_${e}(${L})`),x=[];if(o>=2)for(let L=o-1;L>=0;L--)x.push(`${ht(y,L,o)} * (indices[${L}])`);let M=o<2?"":`
  fn i2o_${e}(indices: ${h.indices}) -> u32 {
    return ${x.join("+")};
  }`,E=L=>(p.indicesToOffset=!0,o<2?L:`i2o_${e}(${L})`),P=(...L)=>o===0?"0u":`${h.indices}(${L.map(f).join(",")})`,I=(L,j)=>o<2?`${L}`:`${ht(L,j,o)}`,O=(L,j,q)=>o<2?`${L}=${q};`:`${ht(L,j,o)}=${q};`,V={},U=(L,j)=>{p.broadcastedIndicesToOffset=!0;let q=`${j.name}broadcastedIndicesTo${e}Offset`;if(q in V)return`${q}(${L})`;let ne=[];for(let me=o-1;me>=0;me--){let ae=j.indicesGet("outputIndices",me+j.rank-o);ne.push(`${I(y,me)} * (${ae} % ${I(w,me)})`)}return V[q]=`fn ${q}(outputIndices: ${j.type.indices}) -> u32 {
             return ${ne.length>0?ne.join("+"):"0u"};
           }`,`${q}(${L})`},B=(L,j)=>(()=>{if(h.storage===h.value)return`${e}[${L}]=${j};`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`${e}[${L}]=vec2<u32>(u32(${j}), select(0u, 0xFFFFFFFFu, ${j} < 0));`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`${e}[${L}]=vec2<u32>(u32(${j}), 0u);`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`${e}[${L}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${j}));`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),Y=L=>(()=>{if(h.storage===h.value)return`${e}[${L}]`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`i32(${e}[${L}].x)`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`u32(${e}[${L}].x)`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${L}] & 0xFFu), bool(${e}[${L}] & 0xFF00u), bool(${e}[${L}] & 0xFF0000u), bool(${e}[${L}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),K=o<2?"":`
  fn get_${e}ByIndices(indices: ${h.indices}) -> ${u} {
    return ${Y(`i2o_${e}(indices)`)};
  }`,X=o<2?"":(()=>{let L=a.map(q=>`d${q}: u32`).join(", "),j=a.map(q=>`d${q}`).join(", ");return`
  fn get_${e}(${L}) -> ${u} {
    return get_${e}ByIndices(${P(j)});
  }`})(),G=(...L)=>{if(L.length!==o)throw new Error(`indices length must be ${o}`);let j=L.map(f).join(",");return o===0?Y("0u"):o===1?Y(j[0]):(p.get=!0,p.getByIndices=!0,p.indicesToOffset=!0,`get_${e}(${j})`)},R=L=>o<2?Y(L):(p.getByIndices=!0,p.indicesToOffset=!0,`get_${e}ByIndices(${L})`),te=o<2?"":`
  fn set_${e}ByIndices(indices: ${h.indices}, value: ${u}) {
    ${B(`i2o_${e}(indices)`,"value")}
  }`,re=o<2?"":(()=>{let L=a.map(q=>`d${q}: u32`).join(", "),j=a.map(q=>`d${q}`).join(", ");return`
  fn set_${e}(${L}, value: ${u}) {
    set_${e}ByIndices(${P(j)}, value);
  }`})();return{impl:()=>{let L=[],j=!1;return p.offsetToIndices&&(L.push(v),j=!0),p.indicesToOffset&&(L.push(M),j=!0),p.broadcastedIndicesToOffset&&(Object.values(V).forEach(q=>L.push(q)),j=!0),p.set&&(L.push(re),j=!0),p.setByIndices&&(L.push(te),j=!0),p.get&&(L.push(X),j=!0),p.getByIndices&&(L.push(K),j=!0),!i&&j&&L.unshift(`const ${w} = ${h.indices}(${r.join(",")});`,`const ${y} = ${h.indices}(${Me.computeStrides(r).join(",")});`),L.join(`
`)},type:h,offsetToIndices:b,indicesToOffset:E,broadcastedIndicesToOffset:U,indices:P,indicesGet:I,indicesSet:O,set:(...L)=>{if(L.length!==o+1)throw new Error(`indices length must be ${o}`);let j=L[o];if(typeof j!="string")throw new Error("value must be string");let q=L.slice(0,o).map(f).join(",");return o===0?B("0u",j):o===1?B(q[0],j):(p.set=!0,p.setByIndices=!0,p.indicesToOffset=!0,`set_${e}(${q}, ${j})`)},setByOffset:B,setByIndices:(L,j)=>o<2?B(L,j):(p.setByIndices=!0,p.indicesToOffset=!0,`set_${e}ByIndices(${L}, ${j});`),get:G,getByOffset:Y,getByIndices:R,usage:n,name:e,strides:y,shape:w,rank:o}},Oe=(e,t,r,n=1)=>jh(e,t,r,"input",n),ct=(e,t,r,n=1)=>jh(e,t,r,"output",n),n5=(e,t,r)=>jh(e,t,r,"atomicOutput",1),pE=(e,t,r,n=1)=>jh(e,t,r,"internal",n),lj=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=bd){let t=typeof e=="number"?e:e[0],r=typeof e=="number"?1:e[1],n=typeof e=="number"?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||r>this.limits.maxComputeWorkgroupSizeY||n>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${t}, ${r}, ${n}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(t*r*n>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${t}, ${r}, ${n}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let s=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,i=s?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,o=s?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${t*r*n}u + local_idx;`;return`@compute @workgroup_size(${t}, ${r}, ${n})
  fn main(${i}) {
    ${o}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let r=e.usage==="input"?"read":"read_write",n=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${t}) var<storage, ${r}> ${e.name}: array<${n}>;`}declareVariables(...e){return e.map(t=>this.declareVariable(t,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(t=>this.registerInternalVariable(t)),this}registerUniform(e,t,r=1){return this.uniforms.push({name:e,type:t,length:r}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:t,type:r,length:n}of this.uniforms)if(n&&n>4)r==="f16"?e.push(`@align(16) ${t}:array<mat2x4<${r}>, ${Math.ceil(n/8)}>`):e.push(`${t}:array<vec4<${r}>, ${Math.ceil(n/4)}>`);else{let s=n==null||n===1?r:`vec${n}<${r}>`;e.push(`${t}:${s}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=t=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(t)];return this.uniforms.map(t=>[e(t.type),t.length??1])}},s5=(e,t)=>new lj(e,t)}),cj,kw,uj,dj,hj,fj,Gs,i5,o5,fl=He(()=>{Et(),Rt(),Jr(),Ft(),cj=(e,t)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(t.length!==0&&t.length!==e[0].dims.length)throw new Error(`perm size ${t.length} does not match input rank ${e[0].dims.length}`)},kw=(e,t)=>t.length!==0?t:[...new Array(e).keys()].reverse(),uj=(e,t)=>Me.sortBasedOnPerm(e,kw(e.length,t)),dj=(e,t,r,n)=>{let s=`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {
    var a: ${r.type.indices};`;for(let i=0;i<t;++i)s+=`a[${e[i]}]=i[${i}];`;return s+="return a;}"},hj=(e,t)=>{let r=[],n=[];for(let s=0;s<e.length;++s)e[s]!==1&&r.push(e[s]),e[t[s]]!==1&&n.push(t[s]);return{newShape:r,newPerm:n}},fj=(e,t)=>{let r=0;for(let n=0;n<e.length;++n)if(t[e[n]]!==1){if(e[n]<r)return!1;r=e[n]}return!0},Gs=(e,t)=>{let r=e.dataType,n=e.dims.length,s=kw(n,t),i=uj(e.dims,s),o=e.dims,a=i,l=n<2||fj(s,e.dims),c;if(l)return c=p=>{let _=Oe("input",r,o,4),w=ct("output",r,a,4);return`
  ${p.registerUniform("output_size","u32").declareVariables(_,w)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let p=Me.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(p/64/4)},programUniforms:[{type:12,data:Math.ceil(p/4)}]}},getShaderSource:c};let{newShape:u,newPerm:d}=hj(e.dims,s),h=Me.areEqual(d,[2,3,1]),f=Me.areEqual(d,[3,1,2]);if(u.length===2||h||f){o=h?[u[0],u[1]*u[2]]:f?[u[0]*u[1],u[2]]:u,a=[o[1],o[0]];let p=16;return c=_=>{let w=Oe("a",r,o.length),y=ct("output",r,a.length);return`
  ${_.registerUniform("output_size","u32").declareVariables(w,y)}
  var<workgroup> tile : array<array<${y.type.value}, ${p+1}>, ${p}>;
  ${_.mainStart([p,p,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${p} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${p}u + local_id.x;
    let input_row = workgroup_id_x * ${p}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${w.getByIndices(`${w.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${p}u + local_id.x;
    let output_row = workgroup_id_y * ${p}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${y.setByIndices(`${y.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let _=Me.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(a[1]/p),y:Math.ceil(a[0]/p)},programUniforms:[{type:12,data:_},...gt(o,a)]}},getShaderSource:c}}return c=p=>{let _=Oe("a",r,o.length),w=ct("output",r,a.length);return`
  ${p.registerUniform("output_size","u32").declareVariables(_,w)}

  ${dj(s,n,_,w)}

  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${w.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${w.setByOffset("global_idx",_.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:()=>{let p=Me.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},...gt(o,a)]}},getShaderSource:c}},i5=(e,t)=>{cj(e.inputs,t.perm),e.compute(Gs(e.inputs[0],t.perm))},o5=e=>lr({perm:e.perm})}),pj,mj,gj,_j,yj,vj,wj,bj,xj,Mj,Pi,a5,l5,c5,u5,d5,h5,f5,p5,m5,g5,Mle=He(()=>{Et(),Rt(),Ft(),mE(),fl(),pj={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},mj={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},gj={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},_j={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},yj=(e,t)=>{let r=[];for(let n=t-e;n<t;++n)r.push(n);return r},vj=(e,t)=>{let r=[],n=e.length;for(let i=0;i<n;i++)t.indexOf(i)===-1&&r.push(e[i]);let s=t.map(i=>e[i]);return[r,s]},wj=(e,t)=>{let r=e.length+t.length,n=[],s=0;for(let i=0;i<r;i++)t.indexOf(i)===-1?n.push(e[s++]):n.push(1);return n},bj=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},xj=(e,t)=>{let r=[];if(!bj(e,t)){for(let n=0;n<t;++n)e.indexOf(n)===-1&&r.push(n);e.forEach(n=>r.push(n))}return r},Mj=(e,t,r,n,s,i,o)=>{let a=r[0].dims,l=Me.size(i),c=Me.size(o),u=Oe("_A",r[0].dataType,a),d=ct("output",s,i),h=64;l===1&&(h=256);let f=`
          var<workgroup> aBestValues : array<f32, ${h}>;
       `,p=_=>`
        ${_.registerUniform("reduceSize","u32").declareVariables(u,d)}
        ${f}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${_.mainStart(h)}

          let outputIndex = global_idx / ${h};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${gj[n]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${h}) {
           let candidate = f32(${u.getByOffset("offset + k")});
           bestValue = ${pj[n]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${h}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${mj[n]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${d.setByOffset("outputIndex",`${n==="mean"?`${d.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${d.type.storage}(${_j[n]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${t};${h}`,inputDependencies:["type"]},getShaderSource:p,getRunData:()=>({outputs:[{dims:i,dataType:s}],dispatchGroup:{x:l},programUniforms:[{type:12,data:c}]})}},Pi=(e,t,r,n)=>{let s=e.inputs.length===1?r:x1(e.inputs,r),i=s.axes;i.length===0&&!s.noopWithEmptyAxes&&(i=e.inputs[0].dims.map((f,p)=>p));let o=Me.normalizeAxes(i,e.inputs[0].dims.length),a=o,l=e.inputs[0],c=xj(a,e.inputs[0].dims.length);c.length>0&&(l=e.compute(Gs(e.inputs[0],c),{inputs:[0],outputs:[-1]})[0],a=yj(a.length,l.dims.length));let[u,d]=vj(l.dims,a),h=u;s.keepDims&&(h=wj(u,o)),e.compute(Mj(t,s.cacheKey,[l],n,e.inputs[0].dataType,h,d),{inputs:[l]})},a5=(e,t)=>{Pi(e,"ReduceMeanShared",t,"mean")},l5=(e,t)=>{Pi(e,"ReduceL1Shared",t,"l1")},c5=(e,t)=>{Pi(e,"ReduceL2Shared",t,"l2")},u5=(e,t)=>{Pi(e,"ReduceLogSumExpShared",t,"logSumExp")},d5=(e,t)=>{Pi(e,"ReduceMaxShared",t,"max")},h5=(e,t)=>{Pi(e,"ReduceMinShared",t,"min")},f5=(e,t)=>{Pi(e,"ReduceProdShared",t,"prod")},p5=(e,t)=>{Pi(e,"ReduceSumShared",t,"sum")},m5=(e,t)=>{Pi(e,"ReduceSumSquareShared",t,"sumSquare")},g5=(e,t)=>{Pi(e,"ReduceLogSumShared",t,"logSum")}}),Ci,Tj,R_,x1,ki,Ej,Sj,Pj,Cj,kj,Aj,$j,Ij,Oj,jj,Ai,_5,y5,v5,w5,b5,x5,M5,T5,E5,S5,mE=He(()=>{Et(),Rt(),Jr(),Ft(),Mle(),Ci=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Tj=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],R_=(e,t,r,n,s,i,o=!1,a=!1)=>{let l=[],c=r[0].dims,u=c.length,d=Me.normalizeAxes(s,u),h=!a&&d.length===0;c.forEach((_,w)=>{h||d.indexOf(w)>=0?o&&l.push(1):l.push(_)});let f=l.length,p=Me.size(l);return{name:e,shaderCache:t,getShaderSource:_=>{let w=[],y=Oe("_A",r[0].dataType,u),g=ct("output",i,f),v=n(y,g,d),b=v[2];for(let x=0,M=0;x<u;x++)h||d.indexOf(x)>=0?(o&&M++,b=`for(var j${x}: u32 = 0; j${x} < ${c[x]}; j${x}++) {
                  ${v[2].includes("last_index")?`let last_index = j${x};`:""}
                  ${y.indicesSet("input_indices",x,`j${x}`)}
                  ${b}
                }`):(w.push(`${y.indicesSet("input_indices",x,g.indicesGet("output_indices",M))};`),M++);return`

        ${_.registerUniform("output_size","u32").declareVariables(y,g)}

        ${_.mainStart()}
          ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${y.type.indices};
          let output_indices = ${g.offsetToIndices("global_idx")};

          ${w.join(`
`)}
          ${v[0]}       // init ops for reduce max/min
          ${v[1]}
          ${b}
          ${v[3]}
          ${v.length===4?g.setByOffset("global_idx","value"):v.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:l,dataType:i}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},...gt(c,l)]})}},x1=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),lr({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},ki=(e,t,r,n)=>{let s=e.inputs,i=s.length===1?r:x1(s,r);e.compute(R_(t,{hint:i.cacheKey,inputDependencies:["rank"]},[s[0]],i.noopWithEmptyAxes&&i.axes.length===0?Tj:n,i.axes,s[0].dataType,i.keepDims,i.noopWithEmptyAxes),{inputs:[0]})},Ej=(e,t)=>{Ci(e.inputs),ki(e,"ReduceLogSum",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${r.getByIndices("input_indices")};`,"value = log(value);"])},Sj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceL1",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${r.getByIndices("input_indices")});`,""])},Pj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceL2",t,(r,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${r.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Cj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceLogSumExp",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${r.getByIndices("input_indices")});`,"value = log(value);"])},kj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceMax",t,(r,n,s)=>{let i=[];for(let o=0;o<r.rank;o++)(s.indexOf(o)>=0||s.length===0)&&i.push(r.indicesSet("input_indices",o,0));return[`${i.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};`,`value = max(value, ${r.getByIndices("input_indices")});`,""]})},Aj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceMean",t,(r,n,s)=>{let i=1;for(let o=0;o<r.rank;o++)(s.indexOf(o)>=0||s.length===0)&&(i*=e.inputs[0].dims[o]);return["var sum = f32(0);","",`sum += f32(${r.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${i});`]})},$j=(e,t)=>{Ci(e.inputs),ki(e,"ReduceMin",t,(r,n,s)=>{let i=[];for(let o=0;o<r.rank;o++)(s.indexOf(o)>=0||s.length===0)&&i.push(`input_indices[${o}] = 0;`);return[`${i.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};`,`value = min(value, ${r.getByIndices("input_indices")});`,""]})},Ij=(e,t)=>{Ci(e.inputs),ki(e,"ReduceProd",t,(r,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${r.getByIndices("input_indices")};`,""])},Oj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceSum",t,(r,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${r.getByIndices("input_indices")};`,""])},jj=(e,t)=>{Ci(e.inputs),ki(e,"ReduceSumSquare",t,(r,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${r.getByIndices("input_indices")}; value += t * t;`,""])},Ai=(e,t,r)=>{if(t.length===0)return r;let n=1,s=1;for(let i=0;i<t.length;i++)t.indexOf(i)===-1?n*=e[i]:s*=e[i];return s<32&&n>1024},_5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Aj(e,t):a5(e,t)},y5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Sj(e,t):l5(e,t)},v5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Pj(e,t):c5(e,t)},w5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Cj(e,t):u5(e,t)},b5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?kj(e,t):d5(e,t)},x5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?$j(e,t):h5(e,t)},M5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ij(e,t):f5(e,t)},T5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Oj(e,t):p5(e,t)},E5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jj(e,t):m5(e,t)},S5=(e,t)=>{Ai(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ej(e,t):g5(e,t)}}),Aw,P5,C5,M1,Tle=He(()=>{Et(),Jr(),mE(),Aw=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},P5=(e,t)=>{Aw(e.inputs);let r=(n,s,i)=>{let o=[];for(let a=0;a<n.rank;a++)(i.indexOf(a)>=0||i.length===0)&&o.push(`input_indices[${a}] = 0;`);return[`${o.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${n.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {
         value = ${n.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",s.setByOffset("global_idx","best_index")]};e.compute(R_("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},C5=(e,t)=>{Aw(e.inputs);let r=(n,s,i)=>{let o=[];for(let a=0;a<n.rank;a++)(i.indexOf(a)>=0||i.length===0)&&o.push(`input_indices[${a}] = 0;`);return[`${o.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${n.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {
         value = ${n.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",s.setByOffset("global_idx","best_index")]};e.compute(R_("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},M1=e=>lr(e)}),Dj,og,Nj,Rj,Fj,ep,Lj,k5,gE=He(()=>{Et(),Rt(),fE(),Ft(),Dj=(e,t)=>{let r=e[0],n=e[1],s=e[2],i=e[3],o=e[4],a=e[5];if(o&&a)throw new Error("Attention cannot have both past and attention_bias");if(r.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let l=r.dims[0],c=r.dims[1],u=r.dims[2];if(s.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(n.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(n.dims[0]!==u)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(s.dims[0]!==n.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let d=s.dims[0]/3,h=d,f=h;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let v of t.qkvHiddenSizes)if(v%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");d=t.qkvHiddenSizes[0],h=t.qkvHiddenSizes[1],f=t.qkvHiddenSizes[2]}let p=c;if(d!==h)throw new Error("qkv_hidden_sizes first element should be same as the second");if(s.dims[0]!==d+h+f)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let _=0;if(o){if(h!==f)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(o.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(o.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(o.dims[1]!==l)throw new Error('Input "past" second dimension must be batch_size');if(o.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(o.dims[4]!==h/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(_=o.dims[3])}let w=p+_,y=-1,g=0;if(i)throw new Error("Mask not supported");if(o)throw new Error("past is not supported");if(a){if(a.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(a.dims[0]!==l||a.dims[1]!==t.numHeads||a.dims[2]!==c||a.dims[3]!==w)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:l,sequenceLength:c,pastSequenceLength:_,kvSequenceLength:p,totalSequenceLength:w,maxSequenceLength:y,inputHiddenSize:u,hiddenSize:d,vHiddenSize:f,headSize:Math.floor(d/t.numHeads),vHeadSize:Math.floor(f/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:g,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},og=(e,t,r)=>t&&e?`
      let total_sequence_length_input = u32(${t.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e==null?void 0:e.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${r?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,Nj=(e,t,r,n,s,i,o,a)=>{let l=Vr(o?1:i),c=64,u=i/l;u<c&&(c=32);let d=Math.ceil(i/l/c),h=[{type:12,data:t},{type:12,data:r},{type:12,data:n},{type:12,data:s},{type:12,data:u},{type:12,data:d}],f=$n(e.dataType,l),p=es(1,l),_=["type"];o&&_.push("type"),a&&_.push("type");let w=y=>{let g=ct("x",e.dataType,e.dims,l),v=[g],b=o?Oe("seq_lens",o.dataType,o.dims):void 0;b&&v.push(b);let x=a?Oe("total_sequence_length_input",a.dataType,a.dims):void 0;x&&v.push(x);let M=es(e.dataType),E=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${c}>;
  var<workgroup> thread_sum: array<f32, ${c}>;
  ${y.registerUniforms(E).declareVariables(...v)}
  ${y.mainStart([c,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${og(b,x,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${c}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${o?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${p}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${p}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(l){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${c}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${p}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${p}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(l){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${c}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${g.type.value}(${M}(1.0) / ${M}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${p}(x[offset + i]);
        x[offset + i] = ${g.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${o?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${g.type.value}(${M}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${c};${f};${l}`,inputDependencies:_},getShaderSource:w,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:s,z:t*r},programUniforms:h})}},Rj=(e,t,r,n,s,i,o,a,l)=>{let c=o+i.kvSequenceLength,u=[i.batchSize,i.numHeads,i.sequenceLength,c],d=e>1&&n,h=i.kvNumHeads?i.kvNumHeads:i.numHeads,f=d?[i.batchSize,h,c,i.headSize]:void 0,p=i.nReps?i.nReps:1,_=i.scale===0?1/Math.sqrt(i.headSize):i.scale,w=Vr(i.headSize),y=i.headSize/w,g=12,v={x:Math.ceil(c/g),y:Math.ceil(i.sequenceLength/g),z:i.batchSize*i.numHeads},b=[{type:12,data:i.sequenceLength},{type:12,data:y},{type:12,data:c},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:1,data:_},{type:12,data:o},{type:12,data:i.kvSequenceLength},{type:12,data:p}],x=d&&n&&Me.size(n.dims)>0,M=["type","type"];x&&M.push("type"),s&&M.push("type"),a&&M.push("type"),l&&M.push("type");let E=[{dims:u,dataType:t.dataType,gpuDataType:0}];d&&E.push({dims:f,dataType:t.dataType,gpuDataType:0});let P=I=>{let O=Oe("q",t.dataType,t.dims,w),V=Oe("key",r.dataType,r.dims,w),U=[O,V];if(x){let te=Oe("past_key",n.dataType,n.dims,w);U.push(te)}s&&U.push(Oe("attention_bias",s.dataType,s.dims));let B=a?Oe("seq_lens",a.dataType,a.dims):void 0;B&&U.push(B);let Y=l?Oe("total_sequence_length_input",l.dataType,l.dims):void 0;Y&&U.push(Y);let K=ct("output",t.dataType,u),X=[K];d&&X.push(ct("present_key",t.dataType,f,w));let G=es(1,w),R=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${g}u;

  var<workgroup> tileQ: array<${O.type.storage}, ${g*g}>;
  var<workgroup> tileK: array<${O.type.storage}, ${g*g}>;
  ${I.registerUniforms(R).declareVariables(...U,...X)}
  ${I.mainStart([g,g,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${p===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${p===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${og(B,Y,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${x&&d?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${d?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${G}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${x&&d?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${d?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${G}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(w){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${w}`)}})()};
        output[outputIdx] = ${K.type.value} (sum * uniforms.alpha) + ${s?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${w};${s!==void 0};${n!==void 0};${e}`,inputDependencies:M},getRunData:()=>({outputs:E,dispatchGroup:v,programUniforms:b}),getShaderSource:P}},Fj=(e,t,r,n,s,i,o=void 0,a=void 0)=>{let l=i+s.kvSequenceLength,c=s.nReps?s.nReps:1,u=s.vHiddenSize*c,d=e>1&&n,h=s.kvNumHeads?s.kvNumHeads:s.numHeads,f=d?[s.batchSize,h,l,s.headSize]:void 0,p=[s.batchSize,s.sequenceLength,u],_=12,w={x:Math.ceil(s.vHeadSize/_),y:Math.ceil(s.sequenceLength/_),z:s.batchSize*s.numHeads},y=[{type:12,data:s.sequenceLength},{type:12,data:l},{type:12,data:s.vHeadSize},{type:12,data:s.numHeads},{type:12,data:s.headSize},{type:12,data:u},{type:12,data:i},{type:12,data:s.kvSequenceLength},{type:12,data:c}],g=d&&n&&Me.size(n.dims)>0,v=["type","type"];g&&v.push("type"),o&&v.push("type"),a&&v.push("type");let b=[{dims:p,dataType:t.dataType,gpuDataType:0}];d&&b.push({dims:f,dataType:t.dataType,gpuDataType:0});let x=M=>{let E=Oe("probs",t.dataType,t.dims),P=Oe("v",r.dataType,r.dims),I=[E,P];g&&I.push(Oe("past_value",n.dataType,n.dims));let O=o?Oe("seq_lens",o.dataType,o.dims):void 0;o&&I.push(O);let V=a?Oe("total_sequence_length_input",a.dataType,a.dims):void 0;a&&I.push(V);let U=[ct("output",t.dataType,p)];d&&U.push(ct("present_value",t.dataType,f));let B=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${_}u;
  var<workgroup> tileQ: array<${E.type.value}, ${_*_}>;
  var<workgroup> tileV: array<${E.type.value}, ${_*_}>;
  ${M.registerUniforms(B).declareVariables(...I,...U)}
  ${M.mainStart([_,_,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${c===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${c===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${og(O,V,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${g&&d?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${d?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${E.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${g&&d?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${d?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${n!==void 0};${e}`,inputDependencies:v},getRunData:()=>({outputs:b,dispatchGroup:w,programUniforms:y}),getShaderSource:x}},ep=(e,t,r,n,s,i,o,a,l,c,u=void 0,d=void 0)=>{let h=Math.min(e.outputCount,1+(o?1:0)+(a?1:0)),f=h>1?c.pastSequenceLength:0,p=f+c.kvSequenceLength,_=l&&Me.size(l.dims)>0?l:void 0,w=[t,r];h>1&&o&&Me.size(o.dims)>0&&w.push(o),_&&w.push(_),u&&w.push(u),d&&w.push(d);let y=e.compute(Rj(h,t,r,o,_,c,f,u,d),{inputs:w,outputs:h>1?[-1,1]:[-1]})[0];e.compute(Nj(y,c.batchSize,c.numHeads,f,c.sequenceLength,p,u,d),{inputs:u&&d?[y,u,d]:[y],outputs:[]});let g=[y,n];h>1&&a&&Me.size(a.dims)>0&&g.push(a),u&&g.push(u),d&&g.push(d),e.compute(Fj(h,y,n,a,c,f,u,d),{inputs:g,outputs:h>1?[0,2]:[0]})},Lj=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],n=t.sequenceLength,s=t.inputHiddenSize,i=t.headSize,o=12,a={x:Math.ceil(t.headSize/o),y:Math.ceil(t.sequenceLength/o),z:t.batchSize*t.numHeads},l=[e.inputs[0],e.inputs[1],e.inputs[2]],c=[{type:12,data:n},{type:12,data:s},{type:12,data:i},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],u=d=>{let h=ct("output_q",l[0].dataType,r),f=ct("output_k",l[0].dataType,r),p=ct("output_v",l[0].dataType,r),_=Oe("input",l[0].dataType,l[0].dims),w=Oe("weight",l[1].dataType,l[1].dims),y=Oe("bias",l[2].dataType,l[2].dims),g=_.type.storage,v=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${o}u;
  var<workgroup> tileInput: array<${g}, ${o*o}>;
  var<workgroup> tileWeightQ: array<${g}, ${o*o}>;
  var<workgroup> tileWeightK: array<${g}, ${o*o}>;
  var<workgroup> tileWeightV: array<${g}, ${o*o}>;
  ${d.registerUniforms(v).declareVariables(_,w,y,h,f,p)}
  ${d.mainStart([o,o,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${g}(0);
    var valueK = ${g}(0);
    var valueV = ${g}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:a,programUniforms:c}),getShaderSource:u},{inputs:l,outputs:[-1,-1,-1]})},k5=(e,t)=>{let r=Dj(e.inputs,t),[n,s,i]=Lj(e,r);return ep(e,n,s,i,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r)}}),Bj,zj,Vj,A5,Ele=He(()=>{so(),Et(),Rt(),Jr(),Ft(),Bj=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(n,s,i)=>{let o=s.length;if(o!==n.length)throw new Error(`${i}: num dimensions != ${o}`);s.forEach((a,l)=>{if(a!==n[l])throw new Error(`${i}: dim[${l}] do not match`)})};if(e[0].dims.length>1){let n=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,n,"Invalid input scale"),r(e[2].dims,n,"Invalid input B"),r(e[3].dims,n,"Invalid input mean"),r(e[4].dims,n,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},zj=(e,t)=>{let{epsilon:r,spatial:n,format:s}=t,i=e[0].dims,o=n?Vr(i[i.length-1]):1,a=s==="NHWC"&&i.length>1?o:1,l=Me.size(i)/o,c=n,u=c?i.length:i,d=Oe("x",e[0].dataType,e[0].dims,o),h=Oe("scale",e[1].dataType,e[1].dims,a),f=Oe("bias",e[2].dataType,e[2].dims,a),p=Oe("inputMean",e[3].dataType,e[3].dims,a),_=Oe("inputVar",e[4].dataType,e[4].dims,a),w=ct("y",e[0].dataType,u,o),y=()=>{let v="";if(n)v=`let cOffset = ${i.length===1?"0u":s==="NHWC"?`outputIndices[${i.length-1}] / ${o}`:"outputIndices[1]"};`;else if(s==="NCHW")v=`
            ${w.indicesSet("outputIndices","0","0")}
            let cOffset = ${w.indicesToOffset("outputIndices")};`;else{v=`var cIndices = ${h.type.indices}(0);
                       cIndices[0] = outputIndices[${i.length-1}];`;for(let b=1;b<h.rank;b++)v+=`cIndices[${b}] = outputIndices[${b}];`;v+=`let cOffset = ${h.indicesToOffset("cIndices")};`}return v},g=v=>`
  const epsilon = ${r};
  ${v.registerUniform("outputSize","u32").declareVariables(d,h,f,p,_,w)}
  ${v.mainStart()}
  ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${w.offsetToIndices(`global_idx * ${o}`)};
    ${y()}
    let scale = ${h.getByOffset("cOffset")};
    let bias = ${f.getByOffset("cOffset")};
    let inputMean = ${p.getByOffset("cOffset")};
    let inputVar = ${_.getByOffset("cOffset")};
    let x = ${d.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${w.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${n}_${o}`,inputDependencies:c?["rank","type","type","type","type"]:void 0},getShaderSource:g,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c?[{type:12,data:l},...gt(i)]:[{type:12,data:l}]})}},Vj=e=>lr(e),A5=(e,t)=>{let{inputs:r,outputCount:n}=e,s=Vj({...t,outputCount:n});if(Pr.webgpu.validateInputContent&&Bj(r,s),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(zj(r,s))}}),Uj,Wj,$5,Sle=He(()=>{Rt(),Ft(),Uj=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Wj=e=>{let t=e[0].dims,r=e[0].dims[2],n=Me.size(t)/4,s=e[0].dataType,i=Oe("input",s,t,4),o=Oe("bias",s,[r],4),a=Oe("residual",s,t,4),l=ct("output",s,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)}}),getShaderSource:c=>`
  const channels = ${r}u / 4;
  ${c.declareVariables(i,o,a,l)}

  ${c.mainStart()}
    ${c.guardAgainstOutOfBoundsWorkgroupSizes(n)}
    let value = ${i.getByOffset("global_idx")}
      + ${o.getByOffset("global_idx % channels")} + ${a.getByOffset("global_idx")};
    ${l.setByOffset("global_idx","value")}
  }`}},$5=e=>{Uj(e.inputs),e.compute(Wj(e.inputs))}}),Gj,nr,I5,O5,j5,D5,N5,R5,F5,L5,B5,Hj,z5,V5,U5,W5,Jh,G5,Bg,H5,K5,q5,Q5,Y5,X5,J5,Z5,e8,t8,r8,n8,s8,i8,o8,a8,$w,l8,T1,E1,c8,u8,d8,Kj,qj,h8,_E=He(()=>{Et(),Rt(),Jr(),Ft(),Gj=(e,t,r,n,s,i,o)=>{let a=Math.ceil(t/4),l="";typeof s=="string"?l=`${s}(a)`:l=s("a");let c=Oe("inputData",r,[a],4),u=ct("outputData",n,[a],4),d=[{name:"vec_size",type:"u32"}];return o&&d.push(...o),`
      ${e.registerUniforms(d).declareVariables(c,u)}

  ${i??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${c.getByOffset("global_idx")};
    ${u.setByOffset("global_idx",l)}
  }`},nr=(e,t,r,n,s,i=e.dataType,o,a)=>{let l=[{type:12,data:Math.ceil(Me.size(e.dims)/4)}];return o&&l.push(...o),{name:t,shaderCache:{hint:s,inputDependencies:["type"]},getShaderSource:c=>Gj(c,Me.size(e.dims),e.dataType,i,r,n,a),getRunData:c=>({outputs:[{dims:e.dims,dataType:i}],dispatchGroup:{x:Math.ceil(Me.size(c[0].dims)/64/4)},programUniforms:l})}},I5=e=>{e.compute(nr(e.inputs[0],"Abs","abs"))},O5=e=>{e.compute(nr(e.inputs[0],"Acos","acos"))},j5=e=>{e.compute(nr(e.inputs[0],"Acosh","acosh"))},D5=e=>{e.compute(nr(e.inputs[0],"Asin","asin"))},N5=e=>{e.compute(nr(e.inputs[0],"Asinh","asinh"))},R5=e=>{e.compute(nr(e.inputs[0],"Atan","atan"))},F5=e=>{e.compute(nr(e.inputs[0],"Atanh","atanh"))},L5=e=>lr(e),B5=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(nr(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},Hj=e=>{let t,r,n=e.length>=2&&e[1].data!==0,s=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:t=n?e[1].getFloat32Array()[0]:-34028234663852886e22,r=s?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=n?e[1].getUint16Array()[0]:64511,r=s?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return lr({min:t,max:r})},z5=(e,t)=>{let r=t||Hj(e.inputs),n=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"Clip",s=>`clamp(${s}, vec4<${n}>(uniforms.min), vec4<${n}>(uniforms.max))`,void 0,r.cacheKey,void 0,[{type:e.inputs[0].dataType,data:r.min},{type:e.inputs[0].dataType,data:r.max}],[{name:"min",type:n},{name:"max",type:n}]),{inputs:[0]})},V5=e=>{e.compute(nr(e.inputs[0],"Ceil","ceil"))},U5=e=>{e.compute(nr(e.inputs[0],"Cos","cos"))},W5=e=>{e.compute(nr(e.inputs[0],"Cosh","cosh"))},Jh=e=>lr(e),G5=(e,t)=>{let r=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"Elu",n=>`elu_vf32(${n})`,`
  const elu_alpha_ = ${r}(${t.alpha});

  fn elu_f32(a: ${r}) -> ${r} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,t.cacheKey))},Bg=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,H5=e=>{let t=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,Bg(t)))},K5=e=>{e.compute(nr(e.inputs[0],"Exp","exp"))},q5=e=>{e.compute(nr(e.inputs[0],"Floor","floor"))},Q5=e=>{let t=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,Bg(t)))},Y5=(e,t)=>{let r=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"LeakyRelu",n=>`select(leaky_relu_alpha_ * ${n}, ${n}, ${n} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},X5=e=>{e.compute(nr(e.inputs[0],"Not",t=>`!${t}`))},J5=e=>{e.compute(nr(e.inputs[0],"Neg",t=>`-${t}`))},Z5=e=>{e.compute(nr(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},e8=e=>{let t=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},t8=e=>{e.compute(nr(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},r8=e=>lr(e),n8=(e,t)=>{let r=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"HardSigmoid",n=>`max(vec4<${r}>(0.0), min(vec4<${r}>(1.0), ${t.alpha} * ${n} + vec4<${r}>(${t.beta})))`,void 0,t.cacheKey))},s8=e=>{e.compute(nr(e.inputs[0],"Sin","sin"))},i8=e=>{e.compute(nr(e.inputs[0],"Sinh","sinh"))},o8=e=>{e.compute(nr(e.inputs[0],"Sqrt","sqrt"))},a8=e=>{e.compute(nr(e.inputs[0],"Tan","tan"))},$w=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,l8=e=>{e.compute(nr(e.inputs[0],"Tanh",$w))},T1=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${$w("v")};
}
`,E1=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,c8=e=>{let t=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"FastGelu",E1,T1(t),void 0,e.inputs[0].dataType))},u8=(e,t)=>{let r=es(e.inputs[0].dataType);return e.compute(nr(e.inputs[0],"ThresholdedRelu",n=>`select(vec4<${r}>(0.0), ${n}, ${n} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},d8=e=>{e.compute(nr(e.inputs[0],"Log","log"))},Kj=(e,t)=>`
const alpha = vec4<${e}>(${t});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,qj=e=>`quick_gelu_impl(${e})`,h8=(e,t)=>{let r=es(e.inputs[0].dataType);e.compute(nr(e.inputs[0],"QuickGelu",qj,Kj(r,t.alpha),t.cacheKey,e.inputs[0].dataType))}}),Qj,Yj,f8,Ple=He(()=>{Rt(),Ft(),_E(),Qj=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Yj=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=Oe("input",e[0].dataType,e[0].dims,4),n=Oe("bias",e[0].dataType,[e[0].dims[2]],4),s=ct("output",e[0].dataType,t,4),i=Me.size(t)/4,o=$n(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)}}),getShaderSource:a=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${a.declareVariables(r,n,s)}

  ${Bg(o)}

  ${a.mainStart()}
    ${a.guardAgainstOutOfBoundsWorkgroupSizes(i)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${s.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},f8=e=>{Qj(e.inputs),e.compute(Yj(e.inputs))}}),Xj,Jj,$i,p8,m8,g8,_8,y8,v8,w8,b8,x8,M8,Cle=He(()=>{Et(),Rt(),Ft(),Xj=(e,t,r,n,s,i,o,a,l,c,u,d)=>{let h,f;typeof a=="string"?h=f=(g,v)=>`${a}((${g}),(${v}))`:typeof a=="function"?h=f=a:(h=a.scalar,f=a.vector);let p=ct("outputData",u,n.length,4),_=Oe("aData",l,t.length,4),w=Oe("bData",c,r.length,4),y;if(s)if(i){let g=Me.size(t)===1,v=Me.size(r)===1,b=t.length>0&&t[t.length-1]%4===0,x=r.length>0&&r[r.length-1]%4===0;g||v?y=p.setByOffset("global_idx",f(g?`${_.type.value}(${_.getByOffset("0")}.x)`:_.getByOffset("global_idx"),v?`${w.type.value}(${w.getByOffset("0")}.x)`:w.getByOffset("global_idx"))):y=`
            let outputIndices = ${p.offsetToIndices("global_idx * 4u")};
            let offsetA = ${_.broadcastedIndicesToOffset("outputIndices",p)};
            let offsetB = ${w.broadcastedIndicesToOffset("outputIndices",p)};
            ${p.setByOffset("global_idx",f(o||b?_.getByOffset("offsetA / 4u"):`${_.type.value}(${_.getByOffset("offsetA / 4u")}[offsetA % 4u])`,o||x?w.getByOffset("offsetB / 4u"):`${w.type.value}(${w.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else y=p.setByOffset("global_idx",f(_.getByOffset("global_idx"),w.getByOffset("global_idx")));else{if(!i)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let g=(v,b,x="")=>{let M=`aData[indexA${b}][componentA${b}]`,E=`bData[indexB${b}][componentB${b}]`;return`
            let outputIndices${b} = ${p.offsetToIndices(`global_idx * 4u + ${b}u`)};
            let offsetA${b} = ${_.broadcastedIndicesToOffset(`outputIndices${b}`,p)};
            let offsetB${b} = ${w.broadcastedIndicesToOffset(`outputIndices${b}`,p)};
            let indexA${b} = offsetA${b} / 4u;
            let indexB${b} = offsetB${b} / 4u;
            let componentA${b} = offsetA${b} % 4u;
            let componentB${b} = offsetB${b} % 4u;
            ${v}[${b}] = ${x}(${h(M,E)});
          `};u===9?y=`
            var data = vec4<u32>(0);
            ${g("data",0,"u32")}
            ${g("data",1,"u32")}
            ${g("data",2,"u32")}
            ${g("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:y=`
            ${g("outputData[global_idx]",0)}
            ${g("outputData[global_idx]",1)}
            ${g("outputData[global_idx]",2)}
            ${g("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(_,w,p)}

        ${d??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${y}
      }`},Jj=(e,t,r,n,s,i,o=r.dataType)=>{let a=r.dims.map(_=>Number(_)??1),l=n.dims.map(_=>Number(_)??1),c=!Me.areEqual(a,l),u=a,d=Me.size(a),h=!1,f=!1,p=[c];if(c){let _=wd.calcShape(a,l,!1);if(!_)throw new Error("Can't perform binary op on the given tensors");u=_.slice(),d=Me.size(u);let w=Me.size(a)===1,y=Me.size(l)===1,g=a.length>0&&a[a.length-1]%4===0,v=l.length>0&&l[l.length-1]%4===0;p.push(w),p.push(y),p.push(g),p.push(v);let b=1;for(let x=1;x<u.length;x++){let M=a[a.length-x],E=l[l.length-x];if(M===E)b*=M;else break}b%4===0?(f=!0,h=!0):(w||y||g||v)&&(h=!0)}else h=!0;return p.push(h),{name:e,shaderCache:{hint:t+p.map(_=>_.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:_=>Xj(_,a,l,u,h,c,f,s,r.dataType,n.dataType,o,i),getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:12,data:Math.ceil(Me.size(u)/4)},...gt(a,l,u)]})}},$i=(e,t,r,n,s,i)=>{e.compute(Jj(t,s??"",e.inputs[0],e.inputs[1],r,n,i))},p8=e=>{$i(e,"Add",(t,r)=>`${t}+${r}`)},m8=e=>{$i(e,"Div",(t,r)=>`${t}/${r}`)},g8=e=>{$i(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},_8=e=>{$i(e,"Mul",(t,r)=>`${t}*${r}`)},y8=e=>{let t=Oe("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;$i(e,"Pow",{scalar:(r,n)=>`pow_custom(${r},${n})`,vector:(r,n)=>`pow_vector_custom(${r},${n})`},`
    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {
      if (b == ${t}(0.0)) {
        return ${t}(1.0);
      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {
        return ${t}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {
      // TODO: implement vectorized pow
      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},v8=e=>{$i(e,"Sub",(t,r)=>`${t}-${r}`)},w8=e=>{$i(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},b8=e=>{$i(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},x8=e=>{$i(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},M8=e=>{$i(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}}),Zj,eD,tD,rD,T8,E8,kle=He(()=>{Et(),Rt(),Jr(),Ft(),Zj=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let r=0,n=e[r],s=n.dataType,i=n.dims.length;e.forEach((o,a)=>{if(a!==r){if(o.dataType!==s)throw new Error("input tensors should be one type");if(o.dims.length!==i)throw new Error("input tensors should have the same shape");o.dims.forEach((l,c)=>{if(c!==t&&l!==n.dims[c])throw new Error("non concat dimensions must match")})}})},eD=(e,t)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${t});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,tD=(e,t)=>{let r=e.length,n=[];for(let s=0;s<r;++s){let i=t.setByOffset("global_idx",e[s].getByIndices("indices"));r===1?n.push(i):s===0?n.push(`if (inputIndex == ${s}u) { ${i} }`):s===r-1?n.push(`else { ${i} }`):n.push(`else if (inputIndex == ${s}) { ${i} }`)}return n.join(`
`)},rD=(e,t,r,n)=>{let s=Me.size(r),i=new Array(e.length),o=new Array(e.length),a=0,l=[],c=[],u=[{type:12,data:s}];for(let _=0;_<e.length;++_)a+=e[_].dims[t],i[_]=a,c.push(e[_].dims.length),o[_]=Oe(`input${_}`,n,c[_]),l.push("rank"),u.push({type:12,data:i[_]});for(let _=0;_<e.length;++_)u.push(...gt(e[_].dims));u.push(...gt(r));let d=ct("output",n,r.length),h=d.indicesGet("indices",t),f=Array.from(Array(i.length).keys()).map(_=>`uniforms.sizeInConcatAxis${_}`).join(","),p=_=>`

  ${(()=>{_.registerUniform("outputSize","u32");for(let w=0;w<e.length;w++)_.registerUniform(`sizeInConcatAxis${w}`,"u32");return _.declareVariables(...o,d)})()}

  ${eD(i.length,f)}

  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${d.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${h});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${i.length}u>(${f});
      ${h} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${tD(o,d)}
  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:l},getRunData:()=>({outputs:[{dims:r,dataType:n}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:u}),getShaderSource:p}},T8=(e,t)=>{let r=e.inputs,n=r[0].dims,s=Me.normalizeAxis(t.axis,n.length);Zj(r,s);let i=n.slice();i[s]=r.reduce((a,l)=>a+(l.dims.length>s?l.dims[s]:0),0);let o=r.filter(a=>Me.size(a.dims)>0);e.compute(rD(o,s,i,r[0].dataType),{inputs:o})},E8=e=>lr({axis:e.axis})}),Cc,kc,Ac,yE,Lc=He(()=>{Et(),Rt(),Cc=(e,t,r="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${r}(uniforms.clip_min)), ${t}(${r}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${r}(uniforms.alpha) * value + ${r}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${r}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},kc=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},Ac=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},yE=e=>{let t=(e==null?void 0:e.activation)||"";if(t==="HardSigmoid"){let[r,n]=(e==null?void 0:e.activation_params)||[.2,.5];return{activation:t,alpha:r,beta:n}}else if(t==="Clip"){let[r,n]=(e==null?void 0:e.activation_params)||[XW,JW];return{activation:t,clipMax:n,clipMin:r}}else if(t==="LeakyRelu"){let[r]=(e==null?void 0:e.activation_params)||[.01];return{activation:t,alpha:r}}return{activation:t}}}),Dn,S8,vE=He(()=>{Dn=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},S8=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),P8,Ale=He(()=>{P8=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),vf,wE,bE=He(()=>{Et(),Rt(),Ft(),Lc(),vf=(e,t,r,n,s)=>{let i=n-r;return`
      ${Array.from({length:r}).map((o,a)=>`
      if (${ht(t.shape,a,t.rank)} != 1) {
        ${t.indicesSet(e,a,ht(s,a+i,n))}
      } else {
        ${t.indicesSet(e,a,0)}
      }`).join("")}
`},wE=(e,t,r,n,s=!1,i)=>{let o=e[0].dims,a=e[1].dims,l=o[o.length-2],c=a[a.length-1],u=o[o.length-1],d=Vr(c),h=Vr(u),f=Vr(l),p=Me.size(r)/d/f,_=e.length>2,w=n?n.slice(0,-2):r.slice(0,-2),y=[Me.size(w),l,c],g=[{type:12,data:p},{type:12,data:l},{type:12,data:c},{type:12,data:u}];kc(t,g),g.push(...gt(w,o,a)),_&&g.push(...gt(e[2].dims)),g.push(...gt(y));let v=b=>{let x=pE("batch_dims",e[0].dataType,w.length),M=Oe("a",e[0].dataType,o.length,h),E=Oe("b",e[1].dataType,a.length,d),P=ct("output",e[0].dataType,y.length,d),I=$n(P.type.tensor),O=Cc(t,P.type.value,I),V=[M,E],U="";if(_){let K=s?d:1;V.push(Oe("bias",e[2].dataType,e[2].dims.length,K)),U=`${s?`value += bias[col / ${K}];`:`value += ${P.type.value}(bias[row + i]);`}`}let B=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Ac(t,B);let Y=()=>{let K=`var a_data: ${M.type.value};`;for(let X=0;X<h;X++)K+=`
              let b_data${X} = b[(b_offset + (k + ${X}) * uniforms.N + col) / ${d}];`;for(let X=0;X<f;X++){K+=`a_data = a[(a_offset + (row + ${X}) * uniforms.K + k) / ${h}];`;for(let G=0;G<h;G++)K+=`
            values[${X}] = fma(${E.type.value}(a_data${h===1?"":`[${G}]`}), b_data${G}, values[${X}]);
`}return K};return`
  ${b.registerUniforms(B).registerInternalVariables(x).declareVariables(...V,P)}
  ${b.mainStart()}
    ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${d})) * ${d};
    var index1 = global_idx / (uniforms.N / ${d});
    let stride1 = uniforms.M / ${f};
    let row = (index1 % stride1) * ${f};
    let batch = index1 / stride1;

    ${r.length===2?"":`let batch_indices = ${x.offsetToIndices("batch")};`}

    var a_indices: ${M.type.indices};
    ${vf("a_indices",M,M.rank-2,x.rank,"batch_indices")}
    ${M.indicesSet("a_indices",M.rank-2,0)}
    ${M.indicesSet("a_indices",M.rank-1,0)}
    let a_offset = ${M.indicesToOffset("a_indices")};

    var b_indices: ${E.type.indices};
    ${vf("b_indices",E,E.rank-2,x.rank,"batch_indices")}
    ${E.indicesSet("b_indices",E.rank-2,0)}
    ${E.indicesSet("b_indices",E.rank-1,0)}
    let b_offset = ${E.indicesToOffset("b_indices")};
    var values: array<${P.type.value}, ${f}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${h}) {
      ${Y()}
    }
    for (var i = 0u; i < ${f}u; i++) {
      var value = values[i];
      ${U}
      ${O}
      let cur_indices = ${P.type.indices}(batch, row + i, col);
      let offset = ${P.indicesToOffset("cur_indices")};
      ${P.setByOffset(`offset / ${d}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${d};${h};${f};${s}`,inputDependencies:_?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:i?i(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:g}),getShaderSource:v}}}),nD,sD,S1,Iw,iD,P1,oD,F_,xE=He(()=>{Et(),Rt(),Ft(),Lc(),bE(),vE(),nD=(e,t)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${t?", batchIndices":""});
        `,sD=(e,t)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,S1=(e,t,r="f32",n,s=!1,i=32,o=!1,a=32)=>{let l=t[1]*e[1],c=t[0]*e[0],u=s?l:i,d=s?i:l,h=u/t[0],f=i/t[1];if(!((s&&h===4&&e[1]===4||!s&&(h===3||h===4))&&u%t[0]===0&&i%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${s} is true, innerElementSize ${h} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${h} must be 3 or 4.
  tileAWidth ${u} must be divisible by workgroupSize[0]${t[0]}. tileInner ${i} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${h}<${r}>, ${u/h}>, ${d}>;
var<workgroup> mm_Bsub: array<array<vec4<${r}>, ${c/e[0]}>, ${i}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${h};
const tileInner = ${i};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${o?"0":"i32(globalId.z)"};
  ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${l};

  let num_tiles = ${o?`${Math.ceil(a/i)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${o?`i32(globalId.z) * ${a}`:"0"};

  var acc: array<vec4<${r}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${f};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${nD(s,n)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${n?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${h===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${sD(s,h)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Iw=(e,t)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${t?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${t?", batchIndices":""});
            `,iD=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",P1=(e,t,r="f32",n,s=!1,i=32,o=!1,a=32,l=!1)=>{let c=e[1]*t[1],u=e[0]*t[0],d=s?c:i,h=s?i:c;if(!(h%t[1]===0&&d%t[0]===0&&i%t[1]===0))throw new Error(`tileAHight ${h} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${d} must be divisible by workgroupSize[0]${t[0]}, tileInner ${i} must be divisible by workgroupSize[1]${t[1]}`);let f=h/t[1],p=d/t[0],_=i/t[1],w=l?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${c};
    let globalColStart = i32(workgroupId.x) * ${u};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${t[1]}) {
        for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${t[0]}) {
          ${Iw(s,n)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${i}; inputRow = inputRow + ${t[1]}) {
            for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${t[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${n?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${r}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${s?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${t[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${t[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${c};

let tileRowA = i32(localId.y) * ${f};
let tileColA = i32(localId.x) * ${p};
let tileRowB = i32(localId.y) * ${_};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${p}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Iw(s,n)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${n?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${r}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${iD(s)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${r}, ${d}>, ${h}>;
  var<workgroup> mm_Bsub : array<array<${r}, ${u}>, ${i}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${i};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${o?"0":"i32(globalId.z)"};
    ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${o?`${Math.ceil(a/i)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${o?`i32(globalId.z) * ${a}`:"0"};

    var acc : array<array<${r}, colPerThread>, rowPerThread>;
    ${w}
  }
`},oD=(e,t,r,n,s=!1)=>{let[i,o,a,l]=n,c=$n(n[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${i.type.indices}) -> ${Dn(e,c)} {
      var value = ${Dn(e,c)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${o.type.indices};
        ${vf("aIndices",o,o.rank-2,i.rank,"batchIndices")}
        ${o.indicesSet("aIndices",o.rank-2,"u32(row)")}
        ${o.indicesSet("aIndices",o.rank-1,"u32(colIn)")}
        value = ${o.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${i.type.indices}) -> ${Dn(e,c)} {
      var value = ${Dn(e,c)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${a.type.indices};
        ${vf("bIndices",a,a.rank-2,i.rank,"batchIndices")}
        ${a.indicesSet("bIndices",a.rank-2,"u32(row)")}
        ${a.indicesSet("bIndices",a.rank-1,"u32(colIn)")}
        value = ${a.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Dn(e,c)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${t?`value = value + ${s?"bias[colIn]":`${Dn(e,c)}(bias[row])`};`:""}
        ${r}
        ${l.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},F_=(e,t,r,n,s=!1,i)=>{let o=e[0].dims,a=e[1].dims,l=o.slice(0,-2),c=a.slice(0,-2),u=n?n.slice(0,-2):r.slice(0,-2),d=Me.size(u),h=o[o.length-2],f=o[o.length-1],p=a[a.length-1],_=f%4===0&&p%4===0,w=h<=8?[4,1,1]:[4,4,1],y=[8,8,1],g=[Math.ceil(p/y[0]/w[0]),Math.ceil(h/y[1]/w[1]),Math.ceil(d/y[2]/w[2])],v=_?4:1,b=[...l,h,f/v],x=b.length,M=[...c,f,p/v],E=M.length,P=[d,h,p/v],I=[{type:6,data:h},{type:6,data:p},{type:6,data:f}];kc(t,I),I.push(...gt(u,b,M));let O=["rank","rank"],V=e.length>2;V&&(I.push(...gt(e[2].dims)),O.push("rank")),I.push(...gt(P));let U=B=>{let Y=u.length,K=pE("batchDims",e[0].dataType,Y,1),X=$n(e[0].dataType),G=Oe("a",e[0].dataType,x,v),R=Oe("b",e[1].dataType,E,v),te=ct("result",e[0].dataType,P.length,v),re=[G,R];if(V){let me=s?v:1;re.push(Oe("bias",e[2].dataType,e[2].dims.length,me))}let L=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Ac(t,L);let j=$n(te.type.tensor),q=Cc(t,te.type.value,j),ne=oD(v,V,q,[K,G,R,te],s);return`
  ${B.registerUniforms(L).registerInternalVariables(K).declareVariables(...re,te)}
  ${ne}
  ${_?S1(w,y,X,K):P1(w,y,X,K)}
                   `};return{name:"MatMul",shaderCache:{hint:`${w};${t.activation};${_};${s}`,inputDependencies:O},getRunData:()=>({outputs:[{dims:i?i(r):r,dataType:e[0].dataType}],dispatchGroup:{x:g[0],y:g[1],z:g[2]},programUniforms:I}),getShaderSource:U}}}),aD,C8,$le=He(()=>{Et(),ia(),Ft(),Lc(),vE(),Ale(),xE(),aD=(e,t,r,n,s=!1,i,o=4,a=4,l=4,c="f32")=>{let u=I=>{switch(I){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${c}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${I} is not supported.`)}},d=I=>{switch(I){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${I} is not supported.`)}},h=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,f=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,p=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",_=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",w=e?"row":"col",y=e?"col":"row",g=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${w} / outWidth;
    let outCol = ${w} % outWidth;

    let WRow = ${y} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${y} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${y} % inChannels;
    var resData = ${Dn(o,c)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${p} && xCol >= 0 && xCol < ${_}) {
      ${h}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${u(o)}
    }
    return resData;`,v=e?t&&n?`
    let col = colIn * ${o};
    ${g}`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${g}
    }
    return ${Dn(o,c)}(0.0);`:n&&r?`
    let col = colIn * ${o};
    ${g}`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${g}
    }
    return ${Dn(o,c)}(0.0);`,b=e?n&&r?d(a):`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${d(a)}
    }
    return ${Dn(a,c)}(0.0);`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${d(a)}
    }
    return ${Dn(a,c)}(0.0);`,x=Dn(l,c),M=Dn(e?o:a,c),E=Dn(e?a:o,c),P=Cc(i,x,c);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${M} {
      ${e?v:b}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${E} {
      ${e?b:v}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${x}) {
      let col = colIn * ${l};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${f}
      ${S8(s)}
      ${P}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},C8=(e,t,r,n,s,i,o,a,l)=>{let c=t.format==="NHWC",u=c?e[0].dims[3]:e[0].dims[1],d=r[0],h=c?r[2]:r[3],f=c?r[1]:r[2],p=c?r[3]:r[1],_=c&&(u%4===0||u%3===0)&&p%4===0,w=c?p:h*f,y=c?h*f:p,g=[8,8,1],v=n<=8?[4,1,1]:[4,4,1],b=[Math.ceil(w/g[0]/v[0]),Math.ceil(y/g[1]/v[1]),Math.ceil(d/g[2]/v[2])];Xt("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${b}`);let x=_?c&&u%4!==0?3:4:1,M=g[1]*v[1],E=g[0]*v[0],P=Math.max(g[0]*x,g[1]),I=n%M===0,O=s%E===0,V=i%P===0,U=_?[x,4,4]:[1,1,1],B=[{type:6,data:n},{type:6,data:s},{type:6,data:i},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];kc(t,B),B.push(...gt(e[0].dims,e[1].dims));let Y=["rank","rank"];o&&(B.push(...gt(e[2].dims)),Y.push("rank")),B.push(...gt(r));let K=X=>{let G=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Ac(t,G);let R=_?4:1,te=$n(e[0].dataType),re=`
      fn setOutputAtIndex(flatIndex : i32, value : ${_?`vec4<${te}>`:te}) {
        result[flatIndex] = ${_?`vec4<${te}>`:te}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${_?`vec4<${te}>`:te}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${_?"/ 4":""}, value);
      }`,L=Oe("x",e[0].dataType,e[0].dims.length,x===3?1:x),j=Oe("w",e[1].dataType,e[1].dims.length,R),q=[L,j],ne=ct("result",e[0].dataType,r.length,R);if(o){let me=Oe("bias",e[2].dataType,e[2].dims.length,R);q.push(me),re+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${_?`vec4<${te}>`:te} {
          return bias[coords.${c?"w":"y"}${_?"/ 4":""}];
        }`}return`
        ${P8("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${X.registerUniforms(G).declareVariables(...q,ne)}
        ${re}
        ${aD(c,I,O,V,o,t,U[0],U[1],U[2],te)}
        ${_?S1(v,g,te,void 0,!c,P):P1(v,g,te,void 0,!c,P,!1,void 0,a)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${x};${_};${I};${O};${V};${M};${E};${P}`,inputDependencies:Y},getRunData:()=>({outputs:[{dims:l?l(r):r,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:B}),getShaderSource:K}}}),lD,Ow,Dh,cD,jw,uD,k8,A8,Ile=He(()=>{Et(),ia(),Rt(),Ft(),Lc(),vE(),lD=e=>{let t=1;for(let r=0;r<e.length;r++)t*=e[r];return t},Ow=e=>typeof e=="number"?[e,e,e]:e,Dh=(e,t)=>t<=1?e:e+(e-1)*(t-1),cD=(e,t,r,n=1)=>{let s=Dh(t,n);return Math.floor((e[0]*(r-1)-r+s)/2)},jw=(e,t,r,n,s)=>{s==null&&(s=cD(e,t[0],n[0]));let i=[0,0,0,r];for(let o=0;o<3;o++)e[o]+2*s>=t[o]&&(i[o]=Math.trunc((e[o]-t[o]+2*s)/n[o]+1));return i},uD=(e,t,r,n,s,i,o,a,l,c)=>{let u,d,h,f;if(e==="VALID"&&(e=0),typeof e=="number"){u={top:e,bottom:e,left:e,right:e,front:e,back:e};let p=jw([t,r,n,1],[a,l,c],1,[s,i,o],e);d=p[0],h=p[1],f=p[2]}else if(Array.isArray(e)){if(!e.every((_,w,y)=>_===y[0]))throw Error(`Unsupported padding parameter: ${e}`);u={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let p=jw([t,r,n,1],[a,l,c],1,[s,i,o],e[0]);d=p[0],h=p[1],f=p[2]}else if(e==="SAME_UPPER"){d=Math.ceil(t/s),h=Math.ceil(r/i),f=Math.ceil(n/o);let p=(d-1)*s+a-t,_=(h-1)*i+l-r,w=(f-1)*o+c-n,y=Math.floor(p/2),g=p-y,v=Math.floor(_/2),b=_-v,x=Math.floor(w/2),M=w-x;u={top:v,bottom:b,left:x,right:M,front:y,back:g}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:u,outDepth:d,outHeight:h,outWidth:f}},k8=(e,t,r,n,s,i=!1,o="channelsLast")=>{let a,l,c,u,d;if(o==="channelsLast")[a,l,c,u,d]=e;else if(o==="channelsFirst")[a,d,l,c,u]=e;else throw new Error(`Unknown dataFormat ${o}`);let[h,,f,p,_]=t,[w,y,g]=Ow(r),[v,b,x]=Ow(n),M=Dh(f,v),E=Dh(p,b),P=Dh(_,x),{padInfo:I,outDepth:O,outHeight:V,outWidth:U}=uD(s,l,c,u,w,y,g,M,E,P),B=i?h*d:h,Y=[0,0,0,0,0];return o==="channelsFirst"?Y=[a,B,O,V,U]:o==="channelsLast"&&(Y=[a,O,V,U,B]),{batchSize:a,dataFormat:o,inDepth:l,inHeight:c,inWidth:u,inChannels:d,outDepth:O,outHeight:V,outWidth:U,outChannels:B,padInfo:I,strideDepth:w,strideHeight:y,strideWidth:g,filterDepth:f,filterHeight:p,filterWidth:_,effectiveFilterDepth:M,effectiveFilterHeight:E,effectiveFilterWidth:P,dilationDepth:v,dilationHeight:b,dilationWidth:x,inShape:e,outShape:Y,filterShape:t}},A8=(e,t,r,n,s,i)=>{let o=i==="channelsLast";o?e[0].dims[3]:e[0].dims[1];let a=[64,1,1],l={x:r.map((w,y)=>y)},c=[Math.ceil(lD(l.x.map(w=>r[w]))/a[0]),1,1];Xt("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${c}`);let u=1,d=Me.size(r),h=[{type:12,data:d},{type:12,data:n},{type:12,data:s},{type:12,data:t.strides},{type:12,data:t.dilations}];kc(t,h),h.push(...gt(e[0].dims,e[1].dims));let f=["rank","rank"],p=e.length===3;p&&(h.push(...gt(e[2].dims)),f.push("rank")),h.push(...gt(r));let _=w=>{let y=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:n.length},{name:"pads",type:"u32",length:s.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];Ac(t,y);let g=1,v=$n(e[0].dataType),b=Oe("x",e[0].dataType,e[0].dims.length,u),x=Oe("W",e[1].dataType,e[1].dims.length,g),M=[b,x],E=ct("result",e[0].dataType,r.length,g),P="";if(p){let V=Oe("bias",e[2].dataType,e[2].dims.length,g);M.push(V),P+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${v} {
          return bias[${o?ht("coords",4,5):ht("coords",1,5)}];
        }`}let I=Dn(u,v),O=Cc(t,I,v);return`
            ${P}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${b.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${x.getByIndices("aIndices")};
            }
          ${w.registerUniforms(y).declareVariables(...M,E)}
          ${w.mainStart()}
          ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${E.offsetToIndices("global_idx")};
              let batch = ${ht("coords",0,b.rank)};
              let d2 = ${o?ht("coords",b.rank-1,b.rank):ht("coords",1,b.rank)};
              let xFRCCorner = vec3<u32>(${o?ht("coords",1,b.rank):ht("coords",2,b.rank)},
              ${o?ht("coords",2,b.rank):ht("coords",3,b.rank)},
              ${o?ht("coords",3,b.rank):ht("coords",4,b.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${o?ht("uniforms.x_shape",1,b.rank):ht("uniforms.x_shape",2,b.rank)};
              let xShapeZ = ${o?ht("uniforms.x_shape",2,b.rank):ht("uniforms.x_shape",3,b.rank)};
              let xShapeW = ${o?ht("uniforms.x_shape",3,b.rank):ht("uniforms.x_shape",4,b.rank)};
              let xShapeU = ${o?ht("uniforms.x_shape",4,b.rank):ht("uniforms.x_shape",1,b.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${o?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${o?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${o?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${o?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${p?"value = value + getBiasByOutputCoords(coords)":""};
              ${O}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${t.cacheKey};${o};${u};${p}`,inputDependencies:f},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:c[0],y:c[1],z:c[2]},programUniforms:h}),getShaderSource:_}}}),$8,I8,Ole=He(()=>{Et(),Rt(),Ft(),Lc(),$8=(e,t,r,n)=>{let s=e.length>2,i=s?"value += b[output_channel];":"",o=e[0].dims,a=e[1].dims,l=t.format==="NHWC",c=l?r[3]:r[1],u=c/t.group,d=l&&u>=4?Vr(c):1,h=Me.size(r)/d,f=[{type:12,data:h},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:u}];kc(t,f),f.push(...gt(o,[a[0],a[1],a[2],a[3]/d]));let p=s?["rank","rank","rank"]:["rank","rank"];f.push(...gt([r[0],r[1],r[2],r[3]/d]));let _=w=>{let y=ct("output",e[0].dataType,r.length,d),g=$n(y.type.tensor),v=Cc(t,y.type.value,g),b=Oe("x",e[0].dataType,o.length),x=Oe("w",e[1].dataType,a.length,d),M=[b,x];s&&M.push(Oe("b",e[2].dataType,e[2].dims,d));let E=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];Ac(t,E);let P=l?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${b.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${x.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${b.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${x.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${w.registerUniforms(E).declareVariables(...M,y)}

  ${w.mainStart()}
    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${y.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${l?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${l?1:2}], outputIndices[${l?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${d} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${l?2:1}];

    var value: ${y.type.value} = ${y.type.value}(0);
    ${P}
    ${i}
    ${v}
    ${y.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${t.cacheKey}_${d}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:n?n(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:f}),getShaderSource:_}},I8=(e,t,r,n)=>{let s=e.length>2,i=Vr(r[3]),o=Vr(r[2]),a=Me.size(r)/i/o,l=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/i],c=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/i],u=[r[0],r[1],r[2],r[3]/i],d=[{type:12,data:a},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];kc(t,d),d.push(...gt(l,c,u));let h=(o-1)*t.strides[1]+c[1],f=p=>{let _=ct("output",e[0].dataType,u.length,i),w=$n(_.type.tensor),y=Cc(t,_.type.value,w),g=Oe("x",e[0].dataType,l.length,i),v=Oe("w",e[1].dataType,c.length,i),b=[g,v];s&&b.push(Oe("b",e[2].dataType,e[2].dims,i));let x=s?"value += b[output_channel];":"",M=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Ac(t,M),`
  ${p.registerUniforms(M).declareVariables(...b,_)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${o}u;
    let col = (index1 % width1) * ${o}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${g.type.value}, ${h}>;
    var values: array<${_.type.value}, ${o}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${c[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${h}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${g.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${g.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${c[1]}; w_width++) {
          let w_val = ${v.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${o}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${o}u; i++) {
      var value = values[i];
      ${x}
      ${y}
      ${_.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${i};${o};${h};${c[0]};${c[1]}`,inputDependencies:s?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:n?n(r):r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:d}),getShaderSource:f}}}),dD,ag,hD,lg,C1,Dw,fD,pD,k1,jle=He(()=>{Rt(),$le(),Ile(),xE(),Ole(),Lc(),bE(),fl(),dD=(e,t,r,n,s,i)=>{let o=e[0],a=e.slice(i?1:2,i?3:4),l=a.length,c=t[0],u=t.slice(2).map((h,f)=>h+(h-1)*(r[f]-1)),d=a.map((h,f)=>h+n[f]+n[f+l]).map((h,f)=>Math.floor((h-u[f]+s[f])/s[f]));return d.splice(0,0,o),d.splice(i?3:1,0,c),d},ag=[2,3,1,0],hD=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],n=e[1].dims[1]*t.group;if(r!==n)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},lg=(e,t)=>{let r=e.kernelShape.slice();r.length<t[1].dims.length-2&&r.push(...Array(t[1].dims.length-2-r.length).fill(0));for(let i=2;i<t[1].dims.length;++i)r[i-2]===0&&(r[i-2]=t[1].dims[i]);let n=e.pads.slice();N_.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.format==="NHWC",e.autoPad);let s=Object.assign({},e);return Object.assign(s,{kernelShape:r,pads:n}),s},C1=e=>{let t=yE(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],s=e.dilations,i=e.group,o=e.kernel_shape,a=e.pads,l=e.strides,c=e.w_is_const();return{autoPad:n,format:r,dilations:s,group:i,kernelShape:o,pads:a,strides:l,wIsConst:c,...t,cacheKey:`${e.format};${t.activation};`}},Dw=(e,t,r,n)=>{let s=r.format==="NHWC",i=dD(t[0].dims,t[1].dims,r.dilations,r.pads,r.strides,s);if(r.group!==1){let M=[t[0]];if(s){let E=e.kernelCustomData.wT??e.compute(Gs(t[1],ag),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=E),M.push(E)}else M.push(t[1]);t.length===3&&M.push(t[2]),!e.adapterInfo.isArchitecture("ampere")&&s&&t[1].dims[0]===r.group&&t[1].dims[1]===1&&r.dilations[0]===1&&r.dilations[1]===1?e.compute(I8(M,r,i,n),{inputs:M}):e.compute($8(M,r,i,n),{inputs:M});return}let o=t.length===3,a=t[0].dims[s?1:2],l=t[0].dims[s?2:3],c=t[0].dims[s?3:1],u=t[1].dims[2],d=t[1].dims[3],h=i[s?1:2],f=i[s?2:3],p=i[s?3:1],_=s&&u===a&&d===l&&r.pads[0]===0&&r.pads[1]===0;if(_||u===1&&d===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let M=i[0],E,P,I,O=[];if(s){let B=e.kernelCustomData.wT??e.compute(Gs(t[1],ag),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=B),_){let Y=a*l*c;E=t[0].reshape([1,M,Y]),P=B.reshape([1,Y,p]),I=[1,M,p]}else E=t[0].reshape([M,a*l,c]),P=B.reshape([1,c,p]),I=[M,h*f,p];O.push(E),O.push(P)}else E=t[0].reshape([M,c,a*l]),P=t[1].reshape([1,p,c]),I=[M,p,h*f],O.push(P),O.push(E);o&&O.push(t[2]);let V=I[2],U=O[0].dims[O[0].dims.length-1];V<8&&U<8?e.compute(wE(O,r,i,I,s,n),{inputs:O}):e.compute(F_(O,r,i,I,s,n),{inputs:O});return}let w=!0,y=e.kernelCustomData.wT??e.compute(Gs(t[1],ag),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=y);let g=[t[0],y];o&&g.push(t[2]);let v=s?h*f:p,b=s?p:h*f,x=u*d*c;e.compute(C8(g,r,i,v,b,x,o,w,n),{inputs:g})},fD=(e,t)=>{let r=t.format==="NHWC",n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&n.push(e.inputs[2]);let s=[0,t.pads[0],0,t.pads[1]],i=[1].concat(t.strides),o=[1].concat(t.dilations),a=[1].concat(t.kernelShape),l=lg({...t,pads:s,strides:i,dilations:o,kernelShape:a},n);Dw(e,n,l,c=>r?[c[0],c[2],c[3]]:[c[0],c[1],c[3]])},pD=(e,t,r)=>{let n=r.format==="NHWC"?"channelsLast":"channelsFirst",s=lg(r,t),i=r.autoPad==="NOTSET"?r.pads:r.autoPad,o=k8(t[0].dims,t[1].dims,r.strides,r.dilations,i,!1,n);e.compute(A8(t,s,o.outShape,[o.filterDepth,o.filterHeight,o.filterWidth],[o.padInfo.front,o.padInfo.top,o.padInfo.left],n))},k1=(e,t)=>{if(hD(e.inputs,t),e.inputs[0].dims.length===3)fD(e,t);else if(e.inputs[0].dims.length===5)pD(e,e.inputs,t);else{let r=lg(t,e.inputs);Dw(e,e.inputs,r)}}}),O8,Dle=He(()=>{Et(),ia(),Rt(),Ft(),O8=(e,t,r)=>{let n=e.length>2,s=t.outputShape,i=t.format==="NHWC",o=t.group,a=e[1].dims,l=a[2]/o,c=a[3],u=i?Vr(l):1,d=i&&c===1&&l>=4,h=d?Math.floor(l/4)*4:Math.floor(l/u)*u,f=l-h,p=i?Vr(c):1,_=i?c===1?u:p:1,w=Me.size(s)/p,y=[Math.ceil(w/64),1,1];Xt("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${y}`);let g=["rank","rank"],v=[t.strides[0],t.strides[1]],b=[t.kernelShape[i?1:2],t.kernelShape[i?2:3]],x=[t.dilations[0],t.dilations[1]],M=[b[0]+(t.dilations[0]<=1?0:(t.kernelShape[i?1:2]-1)*(t.dilations[0]-1)),b[1]+(t.dilations[1]<=1?0:(t.kernelShape[i?2:3]-1)*(t.dilations[1]-1))],E=[M[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),M[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],P=[{type:12,data:w},{type:12,data:v},{type:12,data:b},{type:12,data:x},{type:12,data:M},{type:6,data:E},{type:12,data:h},{type:12,data:l},{type:12,data:c},...gt(e[0].dims,e[1].dims)];n&&(P.push(...gt(e[2].dims)),g.push("rank")),P.push(...gt(s));let I=O=>{let V=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:v.length},{name:"filter_dims",type:"u32",length:b.length},{name:"dilations",type:"u32",length:b.length},{name:"effective_filter_dims",type:"u32",length:M.length},{name:"pads",type:"i32",length:E.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],U=$n(e[0].dataType),B=i?1:2,Y=i?2:3,K=i?3:1,X=Oe("W",e[1].dataType,e[1].dims.length,_),G=Oe("Dy",e[0].dataType,e[0].dims.length,u),R=[G,X];n&&R.push(Oe("bias",e[2].dataType,[s[K]].length,p));let te=ct("result",e[0].dataType,s.length,p),re=()=>{let q="";if(d)u===4?q+=`
        let xValue = ${G.getByOffset("x_offset")};
        let wValue = ${X.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:u===2?q+=`
          dotProd = dotProd + dot(vec4<${U}>(${G.getByOffset("x_offset")}, ${G.getByOffset("x_offset + 1u")}), vec4<${U}>(${X.getByOffset("w_offset")}, ${X.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:u===1&&(q+=`
          dotProd = dotProd + dot(vec4<${U}>(${G.getByOffset("x_offset")}, ${G.getByOffset("x_offset + 1u")}, ${G.getByOffset("x_offset + 2u")}, ${G.getByOffset("x_offset + 3u")}), vec4<${U}>(${X.getByOffset("w_offset")}, ${X.getByOffset("w_offset + 1u")}, ${X.getByOffset("w_offset + 2u")}, ${X.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(q+=`
                  let xValue = ${i?G.getByOffset(`${G.indicesToOffset(`${G.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${u}`):G.get("batch","inputChannel","idyR","idyC")};
        `,u===1)q+=`
          let w_offset = ${X.indicesToOffset(`${X.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${X.getByOffset(`w_offset / ${_}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let ne=0;ne<u;ne++)q+=`
            let wValue${ne} = ${X.getByOffset(`${X.indicesToOffset(`${X.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${ne}, wOutChannel)`)} / ${_}`)};
            dotProd = dotProd + xValue[${ne}] * wValue${ne};`;return q},L=()=>{if(f===0)return"";if(!d)throw new Error(`packInputAs4 ${d} is not true.`);let q="";if(u===1){q+="dotProd = dotProd";for(let ne=0;ne<f;ne++)q+=`
            + ${G.getByOffset(`x_offset + ${ne}`)} * ${X.getByOffset(`w_offset + ${ne}`)}`;q+=";"}else if(u===2){if(f!==2)throw new Error(`Invalid inputChannelsRemainder ${f}.`);q+=`
          let xValue = ${G.getByOffset("x_offset")};
          let wValue = ${X.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return q},j=`
            let outputIndices = ${te.offsetToIndices(`global_idx * ${p}`)};
            let batch = ${te.indicesGet("outputIndices",0)};
            let d1 = ${te.indicesGet("outputIndices",K)};
            let r = ${te.indicesGet("outputIndices",B)};
            let c = ${te.indicesGet("outputIndices",Y)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${te.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${U}(dyRCorner) + ${U}(wR)) / ${U}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${U}(uniforms.Dy_shape[${B}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${U}(dyCCorner) + ${U}(wC)) / ${U}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${U}(uniforms.Dy_shape[${Y}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${d?`
                var x_offset = ${G.indicesToOffset(`${G.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${u};
                var w_offset = ${X.indicesToOffset(`${X.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${_};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${d?4:u}) {
                  ${re()}
                  inputChannel = inputChannel + ${d?4:u};
                }
                ${L()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${n?` + bias[d1 / ${p}]`:""};
            ${te.setByOffset("global_idx","value")};
          `;return`
    ${O.registerUniforms(V).declareVariables(...R,te)}
      ${O.mainStart()}
      ${O.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${j}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};${u}${_}${p}${d}${f}`,inputDependencies:g},getRunData:()=>({dispatchGroup:{x:y[0],y:y[1],z:y[2]},outputs:[{dims:r?r(s):s,dataType:e[0].dataType}],programUniforms:P}),getShaderSource:I}}}),mD,gD,_D,Nw,j8,yD,Rw,vD,D8,Nle=He(()=>{Dle(),Lc(),fl(),mD=(e,t,r,n,s,i)=>(e-1)*t+r+(n-1)*s+1-i,gD=(e,t,r,n,s)=>{let i=Math.floor(e/2);t==="SAME_UPPER"?(r[n]=i,r[s]=e-i):t==="SAME_LOWER"&&(r[n]=e-i,r[s]=i)},_D=(e,t,r,n,s,i,o,a,l,c)=>{let u=e.length-2,d=c.length===0;l.length<u&&l.push(...Array(u-l.length).fill(0));let h=e[0],f=t[a?3:1]*s;for(let p=0,_=e.length-u-(a?1:0);p<u;++p,++_){let w=e[_],y=d?w*o[p]:c[p],g=mD(w,o[p],i[p],t[_],r[p],y);gD(g,n,i,p,p+u),d&&c.push(o[p]*(w-1)+l[p]+(t[_]-1)*r[p]+1-i[p]-i[p+u])}c.splice(0,0,h),c.splice(a?3:1,0,f)},Nw=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((d,h)=>d*h,1)===0){r.length=0;for(let d=2;d<t[1].dims.length;++d)r.push(t[1].dims[d])}let n=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(n?3:1,0,t[1].dims[1]);let s=e.pads.slice(),i=e.outputShape.slice(),o=e.outputPadding.slice(),a=t[0].dims,l=e.dilations.slice();if(l.reduce((d,h)=>d+h,0)===0){let d=t[0].dims.length-2;l=new Array(d).fill(1)}let c=e.strides.slice();if(c.reduce((d,h)=>d+h,0)===0){let d=t[0].dims.length-2;c=new Array(d).fill(1)}_D(a,r,l,e.autoPad,e.group,s,c,n,o,i);let u=Object.assign({},e);return Object.assign(u,{kernelShape:r,pads:s,outputPadding:o,outputShape:i,dilations:l,strides:c}),u},j8=e=>{let t=yE(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],s=e.dilations,i=e.group,o=e.kernelShape,a=e.pads,l=e.strides,c=e.wIsConst(),u=e.outputPadding,d=e.outputShape;return{autoPad:n,format:r,dilations:s,group:i,kernelShape:o,outputPadding:u,outputShape:d,pads:a,strides:l,wIsConst:c,...t,cacheKey:`${e.format};${t.activation};`}},yD=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],n=e[1].dims[0];if(r!==n)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let s=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==s))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.reduce((o,a)=>o+a,0)>0&&t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.reduce((o,a)=>o+a,0)>0&&t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.reduce((o,a)=>o+a,0)>0&&t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.outputPadding.length!==i&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${i}D`);if(t.kernelShape.reduce((o,a)=>o+a,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Rw=(e,t,r,n)=>{let s=e.kernelCustomData.wT??e.compute(Gs(t[1],[2,3,0,1]),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=s);let i=[t[0],s];t.length===3&&i.push(t[2]),e.compute(O8(i,r,n),{inputs:i})},vD=(e,t)=>{let r=t.format==="NHWC",n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&n.push(e.inputs[2]);let s=t.kernelShape;(s.length===0||s[0]===0)&&(s=[e.inputs[1].dims[2]]);let i=t.dilations;(i.length===0||i[0]===0)&&(i=[1]);let o=t.strides;(o.length===0||o[0]===0)&&(o=[1]);let a=t.pads;a.length===0&&(a=[0,0]),a=[0,a[0],0,a[1]],o=[1].concat(o),i=[1].concat(i),s=[1].concat(s);let l=t.outputPadding;l=[0].concat(l);let c=Nw({...t,pads:a,strides:o,dilations:i,kernelShape:s,outputPadding:l},n);Rw(e,n,c,u=>r?[u[0],u[2],u[3]]:[u[0],u[1],u[3]])},D8=(e,t)=>{if(yD(e.inputs,t),e.inputs[0].dims.length===3)vD(e,t);else{let r=Nw(t,e.inputs);Rw(e,e.inputs,r)}}}),wD,N8,R8,Rle=He(()=>{Et(),Rt(),Jr(),Ft(),wD=(e,t,r,n)=>{let s=Me.size(t),i=t.length,o=Oe("input",e,i),a=ct("output",e,i),l=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),c=Me.normalizeAxis(l,i),u=d=>{let h=` i32(${o.indicesGet("inputIndices","uniforms.axis")}) `,f=ht("uniforms.input_shape","uniforms.axis",i),p=n.reverse?h+(n.exclusive?" + 1":""):"0",_=n.reverse?f:h+(n.exclusive?"":" + 1");return`
                ${d.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(o,a)}
                ${d.mainStart()}
                  ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${a.offsetToIndices("global_idx")};
                  var sum = ${a.type.value}(0);
                  let first : i32 = ${p};
                  let last : i32 = ${_};
                  for (var i : i32 = first; i < last; i++) {
                    ${o.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${o.getByIndices("inputIndices")};
                  }
                  ${a.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:n.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:[{type:12,data:s},{type:12,data:c},...gt(t,t)]}),getShaderSource:u}},N8=(e,t)=>{let r=e.inputs[0].dims,n=e.inputs[0].dataType,s=e.inputs[1];e.compute(wD(n,r,s,t),{inputs:[0]})},R8=e=>{let t=e.exclusive===1,r=e.reverse===1;return lr({exclusive:t,reverse:r})}}),bD,xD,MD,F8,L8,Fle=He(()=>{Et(),Rt(),Jr(),Ft(),bD=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},xD=(e,t,r,n)=>{let s=[];s.push(`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {
    var a: ${r.type.indices};`);for(let i=0;i<t;++i)s.push(r.indicesSet("a",e[i],`i[${i}]`));return s.push("return a;}"),s.join(`
`)},MD=(e,t)=>{let r,n,s,i,o,a,l=t.format==="NHWC",c=t.blocksize,u=t.mode==="DCR";l?([r,n,s,i]=e.dims,o=u?[r,n,s,c,c,i/c**2]:[r,n,s,i/c**2,c,c],a=u?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([r,n,s,i]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],o=u?[r,c,c,i/c**2,n,s]:[r,i/c**2,c,c,n,s],a=u?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let d=e.reshape(o),h=d.dims.length,f=e.dataType,p=Oe("a",f,h),_=ct("output",f,h),w=y=>`
  ${y.registerUniform("output_size","u32").declareVariables(p,_)}

  ${xD(a,h,p,_)}

  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${_.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${_.setByOffset("global_idx",p.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:y=>{let g=l?[r,n*c,s*c,i/c**2]:[r,i/c**2,n*c,s*c],v=Me.size(g),b=d.dims,x=Me.sortBasedOnPerm(b,a);return{outputs:[{dims:g,dataType:y[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:[{type:12,data:v},...gt(b,x)]}},getShaderSource:w}},F8=(e,t)=>{bD(e.inputs),e.compute(MD(e.inputs[0],t))},L8=e=>lr({blocksize:e.blocksize,mode:e.mode,format:e.format})}),cg,Nh,Fw,TD,ED,SD,PD,Lw,CD,B8,z8,Lle=He(()=>{Et(),Rt(),Jr(),Ft(),cg="[a-zA-Z]|\\.\\.\\.",Nh="("+cg+")+",Fw="^"+Nh+"$",TD="("+Nh+",)*"+Nh,ED="^"+TD+"$",SD=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let r=this.symbolToIndices.get(e);r===void 0?r=[t]:r.push(t),this.symbolToIndices.set(e,r)}},PD=class{constructor(e,t){var s;this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[r,n]=t.includes("->")?t.split("->",2):[t,""];if(!r.match(RegExp(ED)))throw new Error("Invalid LHS term");if(r.split(",").forEach((i,o)=>{let a=e[o].dims.slice();if(!i.match(RegExp(Fw)))throw new Error("Invalid LHS term");let l=this.processTerm(i,!0,a,o);this.lhs.push(l)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([i,o])=>o.count===1||i==="...").map(([i])=>i).join("");else if(!n.match(RegExp(Nh)))throw new Error("Invalid RHS");(s=n.match(RegExp(cg,"g")))==null||s.forEach(i=>{if(i==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let o=this.symbolToInfo.get(i);if(o===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(o.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(e,t,r){let n=this.symbolToInfo.get(e);if(n!==void 0){if(n.dimValue!==t&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(r)}else n={count:1,dimValue:t,inputIndices:[r]};this.symbolToInfo.set(e,n)}processTerm(e,t,r,n=-1){let s=r.length,i=!1,o=[],a=0;if(!e.match(RegExp(Fw))&&!t&&e!=="")throw new Error("Invalid LHS term");let l=e.match(RegExp(cg,"g")),c=new SD(n);return l==null||l.forEach((u,d)=>{if(u==="..."){if(i)throw new Error("Only one ellipsis is allowed per input term");i=!0;let h=s-l.length+1;if(h<0)throw new Error("Ellipsis out of bounds");if(o=r.slice(a,a+h),this.hasEllipsis){if(this.ellipsisDims.length!==o.length||this.ellipsisDims.toString()!==o.toString())throw new Error("Ellipsis dimensions mismatch")}else if(t)this.hasEllipsis=!0,this.ellipsisDims=o;else throw new Error("Ellipsis must be specified in the LHS");for(let f=0;f<o.length;f++){let p=String.fromCharCode(48+f);c.addSymbol(p,d+f),this.addSymbol(p,r[a++],n)}}else c.addSymbol(u,d+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(u,r[a++],n)}),c}},Lw=e=>e+"_max",CD=(e,t,r,n)=>{let s=e.map(c=>c.length).map((c,u)=>Oe(`input${u}`,t,c)),i=Me.size(n),o=ct("output",t,n.length),a=[...r.symbolToInfo.keys()].filter(c=>!r.rhs.symbolToIndices.has(c)),l=c=>{let u=[],d="var prod = 1.0;",h="var sum = 0.0;",f="sum += prod;",p=[],_=[],w=[],y=[],g=r.symbolToInfo.size===r.rhs.symbolToIndices.size;r.symbolToInfo.forEach((b,x)=>{var M;if(r.rhs.symbolToIndices.has(x)){let E=(M=r.rhs.symbolToIndices.get(x))==null?void 0:M[0];E!==void 0&&r.lhs.forEach((P,I)=>{if(b.inputIndices.includes(I)){let O=P.symbolToIndices.get(x);if(O===void 0)throw new Error("Invalid symbol error");O.forEach(V=>{u.push(`${s[I].indicesSet(`input${I}Indices`,V,o.indicesGet("outputIndices",E))}`)})}})}else r.lhs.forEach((E,P)=>{if(b.inputIndices.includes(P)){let I=E.symbolToIndices.get(x);if(I===void 0)throw new Error("Invalid symbol error");I.forEach(O=>{p.push(`${s[P].indicesSet(`input${P}Indices`,O,`${x}`)}`)}),y.push(`prod *= ${s[P].getByIndices(`input${P}Indices`)};`)}}),_.push(`for(var ${x}: u32 = 0; ${x} < uniforms.${Lw(x)}; ${x}++) {`),w.push("}")});let v=g?[...u,`let sum = ${s.map((b,x)=>b.getByIndices(`input${x}Indices`)).join(" * ")};`]:[...u,h,..._,...p,d,...y,f,...w];return`
            ${c.registerUniforms(a.map(b=>({name:`${Lw(b)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...s,o)}

            ${c.mainStart()}
            ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${o.offsetToIndices("global_idx")};
            ${s.map((b,x)=>`var input${x}Indices: ${s[x].type.indices};`).join(`
`)}
            ${v.join(`
`)};
            ${o.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:r.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let c=a.filter(d=>r.symbolToInfo.has(d)).map(d=>{var h;return{type:12,data:((h=r.symbolToInfo.get(d))==null?void 0:h.dimValue)||0}});c.push({type:12,data:i});let u=e.map((d,h)=>[...gt(d)]).reduce((d,h)=>d.concat(h),c);return u.push(...gt(n)),{outputs:[{dims:n,dataType:t}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:u}},getShaderSource:l}},B8=(e,t)=>{let r=new PD(e.inputs,t.equation),n=r.outputDims,s=e.inputs.map((i,o)=>i.dims);e.compute(CD(s,e.inputs[0].dataType,r,n))},z8=e=>{let t=e.equation.replace(/\s+/g,"");return lr({equation:t})}}),kD,Bw,AD,$D,V8,Ble=He(()=>{Et(),Rt(),Ft(),kD=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=r.length<t.length?0:r.length-t.length,s=t.length<r.length?0:t.length-r.length;for(;n<r.length&&s<t.length;++n,++s)if(r[n]!==t[s]&&r[n]!==1&&t[s]!==1)throw new Error("Expand requires shape to be broadcastable to input")},Bw=(e,t)=>{let r=e.length-t.length,n=[];for(let s=0;s<r;++s)n.push(e[s]);for(let s=0;s<t.length;++s)n.push(t[s]===1?e[s+r]:t[s]);return n},AD=(e,t)=>e.length>t.length?Bw(e,t):Bw(t,e),$D=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=AD(t,r),s=e[0].dataType,i=s===9||Me.size(t)===1,o=s===9||t.length>0&&t[t.length-1]%4===0?4:1,a=i||n.length>0&&n[n.length-1]%4===0?4:1,l=Math.ceil(Me.size(n)/a),c=d=>{let h=Oe("input",s,t.length,o),f=ct("output",s,n.length,a),p;if(s===9){let _=(w,y,g="")=>`
          let outputIndices${y} = ${f.offsetToIndices(`outputOffset + ${y}u`)};
          let offset${y} = ${h.broadcastedIndicesToOffset(`outputIndices${y}`,f)};
          let index${y} = offset${y} / 4u;
          let component${y} = offset${y} % 4u;
          ${w}[${y}] = ${g}(${h.getByOffset(`index${y}`)}[component${y}]);
        `;p=`
        let outputOffset = global_idx * ${a};
        var data = vec4<u32>(0);
        ${_("data",0,"u32")}
        ${_("data",1,"u32")}
        ${_("data",2,"u32")}
        ${_("data",3,"u32")}
        ${f.setByOffset("global_idx","data")}
      }`}else p=`
        let outputIndices = ${f.offsetToIndices(`global_idx * ${a}`)};
        let inputOffset = ${h.broadcastedIndicesToOffset("outputIndices",f)};
        let data = ${f.type.value}(${h.getByOffset(`inputOffset / ${o}`)});
        ${f.setByOffset("global_idx","data")}
      }`;return`
    ${d.registerUniform("vec_size","u32").declareVariables(h,f)}
    ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${p}`},u=[{type:12,data:l},...gt(t,n)];return{name:"Expand",shaderCache:{hint:`${n.length};${o}${a}`,inputDependencies:["rank"]},getShaderSource:c,getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:u})}},V8=e=>{kD(e.inputs),e.compute($D(e.inputs),{inputs:[0]})}}),ID,U8,zle=He(()=>{Et(),Rt(),Ft(),_E(),ID=e=>{let t=e[0].dataType,r=Me.size(e[0].dims),n=Me.size(e[1].dims),s=n%4===0,i=o=>{let a=Oe("x",t,[1],4),l=Oe("bias",t,[1],4),c=ct("y",t,[1],4),u=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],d=f=>`
      let bias${f}_offset: u32 = (global_idx * 4 + ${f}) % uniforms.bias_size;
      let bias${f} = ${l.getByOffset(`bias${f}_offset / 4`)}[bias${f}_offset % 4];`,h=s?`
      let bias = ${l.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${d(0)}${d(1)}${d(2)}${d(3)}
      let bias = ${a.type.value}(bias0, bias1, bias2, bias3);`;return`${o.registerUniforms(u).declareVariables(a,l,c)}

    ${T1(es(t))}

    ${o.mainStart(bd)}
      ${o.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${a.getByOffset("global_idx")};
      ${h}
      let x_in = x + bias;
      ${c.setByOffset("global_idx",E1("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${s}`,inputDependencies:["type","type"]},getShaderSource:i,getRunData:o=>({outputs:[{dims:o[0].dims,dataType:o[0].dataType}],programUniforms:[{type:12,data:Math.ceil(r/4)},{type:12,data:n}],dispatchGroup:{x:Math.ceil(r/bd/4)}})}},U8=e=>{e.inputs.length<2||Me.size(e.inputs[1].dims)===0?c8(e):e.compute(ID(e.inputs))}}),OD,jD,W8,G8,Vle=He(()=>{Et(),Rt(),Jr(),Ft(),OD=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},jD=(e,t)=>{let r=e[0].dims,n=e[1].dims,s=r.length,i=Me.normalizeAxis(t.axis,s),o=r.slice(0);o.splice(i,1,...n);let a=r[i],l=e[0].dataType===9?4:1,c=Math.ceil(Me.size(o)/l),u=[{type:12,data:c},{type:6,data:a},{type:12,data:i},...gt(e[0].dims,e[1].dims,o)],d=h=>{let f=Oe("data",e[0].dataType,e[0].dims.length,l),p=Oe("inputIndices",e[1].dataType,e[1].dims.length),_=ct("output",e[0].dataType,o.length,l),w=g=>{let v=n.length,b=`var indicesIndices${g}  = ${p.type.indices}(0);`;for(let x=0;x<v;x++)b+=`${v>1?`indicesIndices${g}[${x}]`:`indicesIndices${g}`} = ${o.length>1?`outputIndices${g}[uniforms.axis + ${x}]`:`outputIndices${g}`};`;b+=`
          var idx${g} = ${p.getByIndices(`indicesIndices${g}`)};
          if (idx${g} < 0) {
            idx${g} = idx${g} + uniforms.axisDimLimit;
          }
          var dataIndices${g} : ${f.type.indices};
        `;for(let x=0,M=0;x<s;x++)x===i?(b+=`${s>1?`dataIndices${g}[${x}]`:`dataIndices${g}`} = u32(idx${g});`,M+=v):(b+=`${s>1?`dataIndices${g}[${x}]`:`dataIndices${g}`} = ${o.length>1?`outputIndices${g}[${M}]`:`outputIndices${g}`};`,M++);return b},y;if(e[0].dataType===9){let g=(v,b,x="")=>`
          let outputIndices${b} = ${_.offsetToIndices(`outputOffset + ${b}u`)};
          ${w(b)};
          let offset${b} = ${f.indicesToOffset(`dataIndices${b}`)};
          let index${b} = offset${b} / 4u;
          let component${b} = offset${b} % 4u;
          ${v}[${b}] = ${x}(${f.getByOffset(`index${b}`)}[component${b}]);
        `;y=`
        let outputOffset = global_idx * ${l};
        var value = vec4<u32>(0);
        ${g("value",0,"u32")}
        ${g("value",1,"u32")}
        ${g("value",2,"u32")}
        ${g("value",3,"u32")}
        ${_.setByOffset("global_idx","value")}
      `}else y=`
      let outputIndices = ${_.offsetToIndices("global_idx")};
      ${w("")};
      let value = ${f.getByIndices("dataIndices")};
      ${_.setByOffset("global_idx","value")};
      `;return`
      ${h.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(f,p,_)}
      ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${y}
      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:d}},W8=e=>lr({axis:e.axis}),G8=(e,t)=>{let r=e.inputs;OD(r),e.compute(jD(e.inputs,t))}}),DD,H8,K8,Ule=He(()=>{Et(),Rt(),Ft(),DD=(e,t,r,n,s,i,o,a,l)=>{let c=[{type:12,data:i},{type:12,data:n},{type:12,data:s},{type:12,data:r},{type:12,data:o},{type:12,data:a},{type:12,data:l}],u=[i];c.push(...gt(t.dims,u));let d=h=>{let f=Oe("indices_data",t.dataType,t.dims.length),p=ct("input_slice_offsets_data",12,1,1),_=[f,p],w=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:s.length},{name:"sizes_from_slice_dims_data",type:"u32",length:r.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${h.registerUniforms(w).declareVariables(..._)}
  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${s.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${r.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${s.length}_${r.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:u,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:c}),getShaderSource:d},{inputs:[t],outputs:[-1]})[0]},H8=(e,t)=>{let r=e.inputs,n=r[0].dims,s=r[0].dataType,i=r[1].dims,o=i[i.length-1],a=Me.sizeToDimension(i,i.length-1),l=Me.sizeFromDimension(n,t.batchDims+o),c=Me.sizeToDimension(n,t.batchDims),u=Me.sizeFromDimension(n,t.batchDims),d=a/c,h=new Array(o),f=l;for(let b=0;b<o;++b)h[o-1-b]=f,f*=n[t.batchDims+o-1-b];let p=DD(e,r[1],h,t.batchDims,n,a,d,u,o),_=t.batchDims+o;if(_>n.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let w=i.slice(0,-1).concat(n.slice(_)),y=Me.size(w),g=[{type:12,data:y},{type:12,data:l},...gt(r[0].dims,p.dims,w)],v=b=>{let x=Oe("data",r[0].dataType,r[0].dims.length),M=Oe("slice_offsets",12,p.dims.length),E=ct("output",r[0].dataType,w.length);return`
          ${b.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(x,M,E)}
            ${b.mainStart()}
            ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:w,dataType:s}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:g}),getShaderSource:v},{inputs:[r[0],p]})},K8=e=>({batchDims:e.batch_dims,cacheKey:""})}),ND,RD,q8,Q8,Wle=He(()=>{Et(),Rt(),Jr(),Ft(),ND=(e,t)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let r=Me.normalizeAxis(t.quantizeAxis,e[0].dims.length),n=t.blockSize,s=e[0],i=e[2],o=e.length===4?e[3]:void 0;if(i.dims.length!==s.dims.length||!s.dims.map((a,l)=>l===r?Math.ceil(a/n)===i.dims[l]:a===i.dims[l]).reduce((a,l)=>a&&l,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(o){if(o.dataType!==s.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(o.dims.length!==i.dims.length||!o.dims.map((a,l)=>a===i.dims[l]).reduce((a,l)=>a&&l,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},RD=(e,t)=>{let r=e[0].dims,n=e[1].dims,s=r.length,i=Me.normalizeAxis(t.gatherAxis,s),o=Me.normalizeAxis(t.quantizeAxis,s),a=r.slice(0);a.splice(i,1,...n);let l=Me.size(a),c=e[2].dataType,u=e[0].dataType===22,d=[{type:12,data:l},{type:12,data:o},{type:12,data:i},{type:12,data:t.blockSize},...gt(...e.map((f,p)=>f.dims),a)],h=f=>{let p=Oe("data",e[0].dataType,e[0].dims.length),_=Oe("inputIndices",e[1].dataType,e[1].dims.length),w=Oe("scales",e[2].dataType,e[2].dims.length),y=e.length>3?Oe("zeroPoint",e[3].dataType,e[3].dims.length):void 0,g=ct("output",c,a.length),v=[p,_,w];y&&v.push(y);let b=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${f.registerUniforms(b).declareVariables(...v,g)}
        ${f.mainStart()}
        let output_indices = ${g.offsetToIndices("global_idx")};
        var indices_indices = ${_.type.indices}(0);
        ${n.length>1?`
          for (var i: u32 = 0; i < ${n.length}; i++) {
            let index = ${g.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${_.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${g.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${p.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${g.indicesGet("output_indices","i")};
          ${p.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${_.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${r[i]};
        }
        ${p.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${a.length}; i++) {
          let index = ${g.indicesGet("output_indices",`i + ${n.length} - 1`)};
          ${p.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${p.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${p.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${u?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${w.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${w.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${w.getByIndices("scale_indices")};
        ${y?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${y.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${y.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${u?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${es(c)}(quantized_data - zero_point) * scale;
        ${g.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${t.cacheKey};${e.filter((f,p)=>p!==1).map(f=>f.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(f,p)=>"rank")},getRunData:()=>({outputs:[{dims:a,dataType:c}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:d}),getShaderSource:h}},q8=(e,t)=>{let r=e.inputs;ND(r,t),e.compute(RD(e.inputs,t))},Q8=e=>lr({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),FD,LD,Y8,X8,Gle=He(()=>{Et(),Rt(),Jr(),Ft(),FD=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},LD=(e,t)=>{let r=e[0].dims,n=e[0].dataType,s=r.length,i=e[1].dims,o=e[1].dataType,a=Me.normalizeAxis(t.axis,s),l=r[a],c=i.slice(0),u=Me.size(c),d=Oe("input",n,s),h=Oe("indicesInput",o,i.length),f=ct("output",n,c.length),p=[{type:12,data:u},{type:6,data:l},{type:12,data:a}];return p.push(...gt(r,i,c)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:p}),getShaderSource:_=>`
      ${_.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(d,h,f)}
      ${_.mainStart()}
      ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${f.offsetToIndices("global_idx")};

      var idx = ${h.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${d.type.indices}(outputIndices);
      ${d.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${d.getByIndices("inputIndices")};

      ${f.setByOffset("global_idx","value")};
  }`}},Y8=e=>lr({axis:e.axis}),X8=(e,t)=>{let r=e.inputs;FD(r),e.compute(LD(e.inputs,t))}}),BD,zD,J8,Z8,Hle=He(()=>{Et(),Rt(),Ft(),BD=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},zD=(e,t)=>{let r=e[0].dims.slice(),n=e[1].dims.slice(),[s,i,o]=YW.getShapeOfGemmResult(r,t.transA,n,t.transB,e.length===3?e[2].dims:void 0),a=[s,i];if(!a)throw new Error("Can't use gemm on the given tensors");let l=16,c=Math.ceil(i/l),u=Math.ceil(s/l),d=!0,h=Me.size(a),f=[{type:12,data:d?c:h},{type:12,data:s},{type:12,data:i},{type:12,data:o},{type:1,data:t.alpha},{type:1,data:t.beta}],p=["type","type"];e.length===3&&(f.push(...gt(e[2].dims)),p.push("rank")),f.push(...gt(a));let _=y=>{let g="";t.transA&&t.transB?g="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?g="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?g="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(g="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let v=t.alpha===1?"":"value *= uniforms.alpha;",b=Oe("a",e[0].dataType,e[0].dims),x=Oe("b",e[1].dataType,e[1].dims),M=b.type.value,E=null,P=[b,x];e.length===3&&(E=Oe("c",e[2].dataType,e[2].dims.length),P.push(E));let I=ct("output",e[0].dataType,a.length);P.push(I);let O=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${y.registerUniforms(O).declareVariables(...P)}

  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${M}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${g}
    }

    ${v}
    ${E!=null?`let cOffset = ${E.broadcastedIndicesToOffset("vec2(m, n)",I)}; value += ${M}(uniforms.beta) * ${E.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},w=y=>{let g=Oe("a",e[0].dataType,e[0].dims),v=Oe("b",e[1].dataType,e[1].dims),b=null,x=[g,v];e.length===3&&(b=Oe("c",e[2].dataType,e[2].dims.length),x.push(b));let M=ct("output",e[0].dataType,a.length);x.push(M);let E=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],P="",I="";t.transA&&t.transB?(I=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,P="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(I=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,P="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(I=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,P="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!t.transA&&!t.transB&&(I=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${g.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,P="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let O=t.alpha===1?"":"value *= uniforms.alpha;";return`
  ${y.registerUniforms(E).declareVariables(...x)}
  var<workgroup> tile_a: array<array<${g.type.storage}, ${l}>, ${l}>;
  var<workgroup> tile_b: array<array<${v.type.storage}, ${l}>, ${l}>;
  ${y.mainStart([l,l,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${l};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${l};
    let num_tiles = (uniforms.K - 1) / ${l} + 1;
    var k_start = 0u;
    var value = ${M.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${I}
      k_start = k_start + ${l};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${l}; k++) {
        ${P}
      }
      workgroupBarrier();
    }

    ${O}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${b!=null?`let cOffset = ${b.broadcastedIndicesToOffset("vec2(m, n)",M)}; value += ${M.type.value}(uniforms.beta) * ${b.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return d?{name:"GemmShared",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:c*u},programUniforms:f}),getShaderSource:w}:{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:f}),getShaderSource:_}},J8=e=>{let t=e.transA,r=e.transB,n=e.alpha,s=e.beta;return{transA:t,transB:r,alpha:n,beta:s,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Z8=(e,t)=>{BD(e.inputs),e.compute(zD(e.inputs,t))}}),mo,Fo,Bl,zl,VD,UD,WD,GD,HD,KD,qD,QD,e6,t6,Kle=He(()=>{Et(),Rt(),Jr(),Ft(),[mo,Fo,Bl,zl]=[0,1,2,3],VD=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},UD=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,WD=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,GD=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,HD=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,KD=(e,t,r)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${t} {
     var pixel = ${t}(0);
     var indices = vec4<u32>(0);
     indices[${mo}] = batch;
     indices[${Fo}] = channel;`+(()=>{switch(r.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Bl}] = u32(r);
            indices[${zl}] = u32(c);
          } else {
            return ${t}(0);
          }
        `;case"border":return`
          indices[${Bl}] = u32(clamp(r, 0, H - 1));
          indices[${zl}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Bl}] = gs_reflect(r, border[1], border[3]);
          indices[${zl}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${r.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,qD=(e,t,r)=>(()=>{switch(r.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${mo}], indices[${Fo}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${mo}], indices[${Fo}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${mo}], indices[${Fo}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${mo}], indices[${Fo}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${mo}], indices[${Fo}], border);

          let dx2 = ${t}(f32(x2) - x);
          let dx1 = ${t}(x - f32(x1));
          let dy2 = ${t}(f32(y2) - y);
          let dy1 = ${t}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${t}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${mo}], indices[${Fo}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${r.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,QD=(e,t)=>{let r=Oe("x",e[0].dataType,e[0].dims.length),n=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],s=Oe("grid",e[1].dataType,n.length,2),i=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];t.format==="NHWC"&&(i=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[mo,Fo,Bl,zl]=[0,3,1,2]);let o=ct("output",e[0].dataType,i.length),a=r.type.value,l=Me.size(i),c=[{type:12,data:l},...gt(e[0].dims,n,i)],u=d=>`
  ${d.registerUniform("output_size","u32").declareVariables(r,s,o)}
  ${UD}
  ${WD(a)}
  ${GD(t)}
  ${HD(t)}
  ${KD(r,a,t)}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Bl}]);
      let W_in = i32(uniforms.x_shape[${zl}]);

      ${t.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${o.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${mo}], indices[${Bl}], indices[${zl}]);
      let nxy = ${s.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${qD(o,a,t)}
  }`;return{name:"GridSample",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:["type","type"]},getRunData:d=>{let h=Me.size(i);return{outputs:[{dims:i,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:c}},getShaderSource:u}},e6=(e,t)=>{VD(e.inputs),e.compute(QD(e.inputs,t))},t6=e=>lr({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),os,YD,r6,zw,XD,Zh,n6,s6=He(()=>{Et(),Rt(),Jr(),fE(),gE(),Ft(),fl(),os=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,YD=(e,t)=>{let r=e[0],n=os(e,1),s=os(e,2),i=os(e,3),o=os(e,4),a=os(e,5),l=os(e,6),c=os(e,7);if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let u=r.dims[0],d=r.dims[1],h=r.dims.length===3?r.dims[2]:t.numHeads*r.dims[4],f=d,p=0,_=0,w=Math.floor(h/t.numHeads);if(l&&c&&Me.size(l.dims)&&Me.size(c.dims)){if(l.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(l.dims[0]!==u||l.dims[1]!==t.numHeads||l.dims[3]!==w)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(c.dims[0]!==u||c.dims[1]!==t.numHeads||c.dims[3]!==w)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(l.dims[2]!==c.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(c.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');p=l.dims[2],_=l.dims[2]}else if(l&&Me.size(l.dims)||c&&Me.size(c.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let y;if(n&&Me.size(n.dims)>0){if(r.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(n.dims.length===3){if(n.dims[2]!==r.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');y=2,f=n.dims[1]}else if(n.dims.length===5){if(n.dims[2]!==t.numHeads||n.dims[3]!==2||n.dims[4]!==w)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(s)throw new Error('Expect "value" be none when "key" has packed kv format.');y=5,f=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==w)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');y=0,f=n.dims[2]}}else{if(r.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(r.dims[2]!==t.numHeads||r.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');y=3}if(i&&Me.size(i.dims)>0){if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(n&&n.dims.length===5&&n.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let g=p+f,v=0;if(o&&Me.size(o.dims)>0){v=8;let E=o.dims;throw E.length===1?E[0]===u?v=1:E[0]===3*u+2&&(v=3):E.length===2&&E[0]===u&&E[1]===g&&(v=5),v===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let b=!1,x=h;if(s&&Me.size(s.dims)>0){if(s.dims.length!==3&&s.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==s.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(s.dims.length===3){if(f!==s.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');x=s.dims[2]}else{if(f!==s.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');x=s.dims[1]*s.dims[3],b=!0}}let M=!1;if(o&&Me.size(o.dims)>0)throw new Error("Key padding mask is not supported");if(a&&Me.size(a.dims)>0){if(a.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(a.dims[0]!==u||a.dims[1]!==t.numHeads||a.dims[2]!==d||a.dims[3]!==g)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:u,sequenceLength:d,pastSequenceLength:p,kvSequenceLength:f,totalSequenceLength:g,maxSequenceLength:_,inputHiddenSize:0,hiddenSize:h,vHiddenSize:x,headSize:w,vHeadSize:Math.floor(x/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:v,scale:t.scale,broadcastResPosBias:M,passPastInKv:b,qkvFormat:y}},r6=e=>lr({...e}),zw=lr({perm:[0,2,1,3]}),XD=(e,t,r,n,s,i,o)=>{let a=[n,s,i],l=Me.size(a),c=[{type:12,data:l},{type:12,data:o},{type:12,data:i}],u=d=>{let h=ct("qkv_with_bias",t.dataType,a),f=Oe("qkv",t.dataType,a),p=Oe("bias",r.dataType,a),_=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${d.registerUniforms(_).declareVariables(f,p,h)}
  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c}),getShaderSource:u},{inputs:[t,r],outputs:[-1]})[0]},Zh=(e,t,r,n,s,i,o,a)=>{let l=i;if(o&&Me.size(o.dims)>0){if(n===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return l=XD(e,i,o,t,n,r*s,a),l=l.reshape([t,n,r,s]),r===1||n===1?l:e.compute(Gs(l,zw.perm),{inputs:[l],outputs:[-1]})[0]}else return i.dims.length===3&&(l=i.reshape([t,n,r,s])),r===1||n===1?l:e.compute(Gs(l,zw.perm),{inputs:[l],outputs:[-1]})[0]},n6=(e,t)=>{let r=YD(e.inputs,t),n=e.inputs[0],s=os(e.inputs,1),i=os(e.inputs,2),o=os(e.inputs,3),a=os(e.inputs,4),l=os(e.inputs,5),c=os(e.inputs,6),u=os(e.inputs,7);if(n.dims.length===5)throw new Error("Packed QKV is not implemented");if((s==null?void 0:s.dims.length)===5)throw new Error("Packed KV is not implemented");let d=s&&i&&s.dims.length===4&&i.dims.length===4,h=Zh(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,n,o,0);if(d)return ep(e,h,s,i,a,void 0,c,u,l,r);if(!s||!i)throw new Error("key and value must be provided");let f=Zh(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,s,o,r.hiddenSize),p=Zh(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,i,o,2*r.hiddenSize);ep(e,h,f,p,a,void 0,c,u,l,r)}}),JD,ZD,eN,tN,A1,i6,o6,a6=He(()=>{Et(),Rt(),Jr(),Ft(),JD=e=>{if(!e||e.length<1)throw new Error("too few inputs")},ZD=(e,t)=>{let r=[],n=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(s=>r.push(Number(s))),n=r.length),lr({numOutputs:n,axis:t.axis,splitSizes:r})},eN=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${ht("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,tN=e=>{let t=e.length,r=[];for(let n=0;n<t;++n){let s=e[n].setByIndices("indices","input[global_idx]");t===1?r.push(s):n===0?r.push(`if (output_number == ${n}u) { ${s} }`):n===t-1?r.push(`else { ${s} }`):r.push(`else if (output_number == ${n}) { ${s} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${r.join(`
`)}
      }`},A1=(e,t)=>{let r=e[0].dims,n=Me.size(r),s=e[0].dataType,i=Me.normalizeAxis(t.axis,r.length),o=new Array(t.numOutputs),a=Oe("input",s,r.length),l=new Array(t.numOutputs),c=[],u=[],d=0,h=[{type:12,data:n}];for(let p=0;p<t.numOutputs;p++){d+=t.splitSizes[p],l[p]=d;let _=r.slice();_[i]=t.splitSizes[p],u.push(_),o[p]=ct(`output${p}`,s,_.length),c.push({dims:u[p],dataType:e[0].dataType})}h.push({type:12,data:l},...gt(r,...u));let f=p=>`
  ${p.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",l.length).declareVariables(a,...o)}
  ${eN(l.length)}
  ${tN(o)}

  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${a.offsetToIndices("global_idx")};
    var index = ${a.indicesGet("indices",i)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${ht("uniforms.size_in_split_axis","output_number - 1u",l.length)};
      ${a.indicesSet("indices",i,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:f,getRunData:()=>({outputs:c,dispatchGroup:{x:Math.ceil(n/64)},programUniforms:h})}},i6=(e,t)=>{JD(e.inputs);let r=e.inputs.length===1?t:ZD(e.inputs,t);e.compute(A1(e.inputs,r),{inputs:[0]})},o6=e=>{let t=e.axis,r=e.splitSizes,n=e.numOutputs<0?r.length:e.numOutputs;if(n!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return lr({axis:t,numOutputs:n,splitSizes:r})}}),rN,L_,l6,c6=He(()=>{Et(),Rt(),Jr(),Ft(),rN=(e,t)=>{let[r,n,s,i]=e,{numHeads:o,rotaryEmbeddingDim:a}=t;if(r.dims.length!==3&&r.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${r.dims.length}`);if(!Me.areEqual(n.dims,[])&&!Me.areEqual(n.dims,[1])&&n.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${n.dims.length}`);if(s.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${s.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(!Me.areEqual(s.dims,i.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(a>0&&o===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let l=r.dims[0],c=r.dims[r.dims.length-2],u=s.dims[0],d=Me.sizeFromDimension(r.dims,1)/c,h=a===0?s.dims[1]*2:d/o;if(a>h)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(n.dims.length===2){if(l!==n.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${n.dims[0]}`);if(c!==n.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${n.dims[1]}`)}if(h/2!==s.dims[1]&&a/2!==s.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${s.dims[1]}`);if(c>u)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},L_=(e,t)=>{let{interleaved:r,numHeads:n,rotaryEmbeddingDim:s,scale:i}=t,o=e[0].dims[0],a=Me.sizeFromDimension(e[0].dims,1),l=e[0].dims[e[0].dims.length-2],c=a/l,u=e[2].dims[1],d=s===0?u*2:c/n,h=new Array(o,l,c/d,d-u),f=Me.computeStrides(h),p=[{type:1,data:i},{type:12,data:h},{type:12,data:f},...e[0].dims.length===3?new Array({type:12,data:[a,c,d,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[a,d,l*d,1]}):[],...gt(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],_=w=>{let y=Oe("input",e[0].dataType,e[0].dims.length),g=Oe("position_ids",e[1].dataType,e[1].dims.length),v=Oe("cos_cache",e[2].dataType,e[2].dims.length),b=Oe("sin_cache",e[3].dataType,e[3].dims.length),x=ct("output",e[0].dataType,e[0].dims.length);return w.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:h.length},{name:"global_strides",type:"u32",length:f.length},{name:"input_output_strides",type:"u32",length:f.length}]),`
        ${w.declareVariables(y,g,v,b,x)}

        ${w.mainStart(bd)}
          let half_rotary_emb_dim = uniforms.${v.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${w.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${g.broadcastedIndicesToOffset("bsnh.xy",ct("",g.type.tensor,2))};
            let position_id =
                u32(${g.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${r});
            let j = i + select(half_rotary_emb_dim, 1, ${r});
            let re = ${y.getByOffset("i")} * ${v.get("position_id","bsnh[3]")} -
                ${y.getByOffset("j")} * ${b.get("position_id","bsnh[3]")};
            ${x.setByOffset("i","re")}
            let im = ${y.getByOffset("i")} * ${b.get("position_id","bsnh[3]")} +
                ${y.getByOffset("j")} * ${v.get("position_id","bsnh[3]")};
            ${x.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${x.setByOffset("k",y.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:lr({interleaved:r}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:_,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(Me.size(h)/bd)},programUniforms:p})}},l6=(e,t)=>{rN(e.inputs,t),e.compute(L_(e.inputs,t))}}),nN,sN,Vw,iN,u6,qle=He(()=>{Jr(),Et(),gE(),s6(),a6(),fl(),c6(),Ft(),nN=(e,t)=>{if(t.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let r=e[0],n=e[1],s=e[2],i=e[3],o=e[4];if(t.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(t.localWindowSize!==-1)throw new Error("Local attention is not supported");if(t.softcap!==0)throw new Error("Softcap is not supported");if(t.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let a=!1,l=r.dims[0],c=r.dims[1],u=r.dims.length===3?a?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],d=c,h=0,f=!n||n.dims.length===0,p=Math.floor(f?u/(t.numHeads+2*t.kvNumHeads):u/t.numHeads);f&&(u=p*t.numHeads);let _=i&&i.dims.length!==0,w=o&&o.dims.length!==0;if(_&&i.dims.length===4&&i.dims[0]===l&&i.dims[1]!==t.kvNumHeads&&i.dims[2]===t.kvNumHeads&&i.dims[3]===p)throw new Error("BSNH pastKey/pastValue is not supported");if(_&&w){if(i.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(o.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');h=i.dims[2]}else if(_||w)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let y=1;if(n&&n.dims.length>0){if(r.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(n.dims.length===3){if(r.dims[2]%n.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');d=n.dims[1]}else if(n.dims.length===5){if(n.dims[2]!==t.numHeads||n.dims[3]!==2||n.dims[4]!==p)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(s)throw new Error('Expect "value" be none when "key" has packed kv format.');d=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==p)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');d=n.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');y=3}let g=0,v=!1,b=t.kvNumHeads?p*t.kvNumHeads:u;if(s&&s.dims.length>0){if(s.dims.length!==3&&s.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==s.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(s.dims.length===3){if(d!==s.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');b=s.dims[2]}else{if(d!==s.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');b=s.dims[1]*s.dims[3],v=!0}}let x=e.length>4?e[5]:void 0;if(x&&x.dims.length!==1&&x.dims[0]!==l)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:l,sequenceLength:c,pastSequenceLength:h,kvSequenceLength:d,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:u,vHiddenSize:b,headSize:p,vHeadSize:Math.floor(b/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:g,scale:t.scale,broadcastResPosBias:!1,passPastInKv:v,qkvFormat:y}},sN=lr({perm:[0,2,1,3]}),Vw=(e,t,r)=>{let n=t,s=r.kvNumHeads;return t.dims.length===3&&r.kvSequenceLength!==0&&(n=t.reshape([r.batchSize,r.kvSequenceLength,s,r.headSize]),n=e.compute(Gs(n,sN.perm),{inputs:[n],outputs:[-1]})[0]),n},iN=(e,t,r,n)=>{let s=7,i=["type","type"],o=[e*t],a=e*t,l=[{type:12,data:a},{type:12,data:t},{type:12,data:e}],c=u=>{let d=Oe("seq_lens",r.dataType,r.dims),h=Oe("total_seq_lens",n.dataType,n.dims),f=ct("pos_ids",s,o),p=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${u.registerUniforms(p).declareVariables(d,h,f)}
  ${u.mainStart()}
    ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${h.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${d.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${f.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${f.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${f.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${t}`,inputDependencies:i},getRunData:()=>({outputs:[{dims:o,dataType:s}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:l}),getShaderSource:c}},u6=(e,t)=>{var b;let r=nN(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(((b=e.inputs[1])==null?void 0:b.dims.length)===5)throw new Error("Packed KV is not implemented");let n=e.inputs[0],s=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,i=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,o=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,a=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,l=e.inputs.length>4?e.inputs[5]:void 0,c=e.inputs.length>5?e.inputs[6]:void 0,u=r.kvNumHeads?r.kvNumHeads:r.numHeads,d=lr({axis:2,numOutputs:3,splitSizes:[r.numHeads*r.headSize,u*r.headSize,u*r.headSize]}),[h,f,p]=!s&&!i?e.compute(A1([n],d),{inputs:[n],outputs:[-1,-1,-1]}):[n,s,i],_,w;if(t.doRotary){let x=e.compute(iN(r.batchSize,r.sequenceLength,l,c),{inputs:[l,c],outputs:[-1]})[0],M=e.inputs[7],E=e.inputs[8],P=lr({interleaved:t.rotaryInterleaved!==0,numHeads:r.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),I=[h,x,M,E],O=[-1];_=e.compute(L_(I,P),{inputs:I,outputs:O})[0],I.splice(0,1,f);let V=lr({interleaved:t.rotaryInterleaved!==0,numHeads:r.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});w=e.compute(L_(I,V),{inputs:I,outputs:O})[0]}let y=Zh(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,t.doRotary?_:h,void 0,0),g=Vw(e,t.doRotary?w:f,r),v=Vw(e,p,r);ep(e,y,g,v,void 0,void 0,o,a,void 0,r,l,c)}}),Uw,oN,aN,d6,Qle=He(()=>{Et(),Rt(),fl(),Ft(),Uw=(e,t,r,n,s,i,o,a)=>{let l=Vr(i),c=l===1?"f32":`vec${l}f`,u=l===1?"vec2f":`mat2x${l}f`,d=s*o,h=64;d===1&&(h=256);let f=[s,o,i/l],p=[s,o,2],_=["rank","type","type"],w=[];w.push(...gt(f,p));let y=g=>{let v=Oe("x",t.dataType,3,l),b=Oe("scale",r.dataType,r.dims),x=Oe("bias",n.dataType,n.dims),M=ct("output",1,3,2),E=[v,b,x,M];return`
  var<workgroup> workgroup_shared : array<${u}, ${h}>;
  const workgroup_size = ${h}u;
  ${g.declareVariables(...E)}
  ${g.mainStart(h)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${c}(0);
    var squared_sum = ${c}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${c}(${v.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${u}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${nl("workgroup_shared[0][0]",l)} / f32(hight * ${l});
      let squared_sum_final = ${nl("workgroup_shared[0][1]",l)} / f32(hight * ${l});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${a}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${l};${a};${h}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:p,dataType:1}],dispatchGroup:{x:d},programUniforms:w}),getShaderSource:y},{inputs:[t,r,n],outputs:[-1]})[0]},oN=(e,t,r)=>{let n=t[0].dims,s=n,i=2,o=n[0],a=n[1],l=Me.sizeFromDimension(n,i),c=Vr(l),u=Me.size(s)/c,d=Uw(e,t[0],t[1],t[2],o,l,a,r.epsilon),h=[o,a,l/c],f=[o,a],p=["type","none"],_=w=>{let y=Oe("x",t[0].dataType,h.length,c),g=Oe("scale_shift",1,f.length,2),v=ct("output",t[0].dataType,h.length,c),b=[y,g,v];return`
  ${w.registerUniform("output_size","u32").declareVariables(...b)}
  ${w.mainStart()}
  ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${v.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${g.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${y.getByOffset("global_idx")} * ${v.type.value}(scale_shift.x) + ${v.type.value}(scale_shift.y);
      ${v.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${c}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:s,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:[{type:12,data:u},...gt(h,f,h)]}),getShaderSource:_},{inputs:[t[0],d]})},aN=(e,t,r)=>{let n=t[0].dims,s=n,i=n[0],o=n[n.length-1],a=Me.sizeFromDimension(n,1)/o,l=Vr(o),c=Me.size(s)/l,u=[{type:12,data:a},{type:12,data:Math.floor(o/l)}],d=["type","type"],h=!1,f=[0,n.length-1];for(let y=0;y<n.length-2;y++)h=h||n[y+1]!==1,f.push(y+1);h=h&&n[n.length-1]!==1;let p=h?e.compute(Gs(e.inputs[0],f),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:n.length},(y,g)=>n[f[g]])),_=Uw(e,p,t[1],t[2],i,a,o,r.epsilon),w=y=>{let g=$n(t[0].dataType),v=l===1?"vec2f":`mat${l}x2f`,b=E=>{let P=E===0?"x":"y",I=l===1?"f32":`vec${l}f`;switch(l){case 1:return`${g}(${I}(scale.${P}))`;case 2:return`vec2<${g}>(${I}(scale[0].${P}, scale[1].${P}))`;case 4:return`vec4<${g}>(${I}(scale[0].${P}, scale[1].${P}, scale[2].${P}, scale[3].${P}))`;default:throw new Error(`Not supported compoents ${l}`)}},x=Oe("input",t[0].dataType,t[0].dims,l),M=ct("output",t[0].dataType,s,l);return`
  @group(0) @binding(0) var<storage, read> input : array<${x.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${v}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${M.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${y.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${b(0)}, ${b(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${l}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:s,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:w},{inputs:[t[0],_]})},d6=(e,t)=>{t.format==="NHWC"?aN(e,e.inputs,t):oN(e,e.inputs,t)}}),lN,cN,h6,Yle=He(()=>{Et(),Rt(),Ft(),lN=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},cN=(e,t,r)=>{let n=t.simplified,s=e[0].dims,i=e[1],o=!n&&e[2],a=s,l=Me.normalizeAxis(t.axis,s.length),c=Me.sizeToDimension(s,l),u=Me.sizeFromDimension(s,l),d=Me.size(i.dims),h=o?Me.size(o.dims):0;if(d!==u||o&&h!==u)throw new Error(`Size of X.shape()[axis:] == ${u}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${d} and bias size of ${h}`);let f=[];for(let x=0;x<s.length;++x)x<l?f.push(s[x]):f.push(1);let p=Vr(u),_=["type","type"],w=[{type:12,data:c},{type:1,data:u},{type:12,data:Math.floor(u/p)},{type:1,data:t.epsilon}];o&&_.push("type");let y=r>1,g=r>2,v=x=>{let M=$n(e[0].dataType),E=[Oe("x",e[0].dataType,e[0].dims,p),Oe("scale",i.dataType,i.dims,p)];o&&E.push(Oe("bias",o.dataType,o.dims,p)),E.push(ct("output",e[0].dataType,a,p)),y&&E.push(ct("mean_data_output",1,f)),g&&E.push(ct("inv_std_output",1,f));let P=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${x.registerUniforms(P).declareVariables(...E)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${b1("f32",p)};
    var mean_square_vector = ${b1("f32",p)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Fu(M,p,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${nl("mean_vector",p)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${nl("mean_square_vector",p)} / uniforms.norm_size ${n?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Fu(M,p,"x[j + offset]")};
      let f32scale = ${Fu(M,p,"scale[j]")};
      output[j + offset] = ${E[0].type.value}((f32input ${n?"":"- mean"}) * inv_std_dev * f32scale
        ${o?`+ ${Fu(M,p,"bias[j]")}`:""}
      );
    }

    ${y?"mean_data_output[global_idx] = mean":""};
    ${g?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},b=[{dims:a,dataType:e[0].dataType}];return y&&b.push({dims:f,dataType:1}),g&&b.push({dims:f,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${p};${r};${n}`,inputDependencies:_},getRunData:()=>({outputs:b,dispatchGroup:{x:Math.ceil(c/64)},programUniforms:w}),getShaderSource:v}},h6=(e,t)=>{lN(e.inputs),e.compute(cN(e.inputs,t,e.outputCount))}}),uN,f6,Xle=He(()=>{Rt(),bE(),xE(),uN=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},f6=e=>{uN(e.inputs);let t=wd.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let r=t[t.length-1],n=e.inputs[0].dims[e.inputs[0].dims.length-1];if(r<8&&n<8)e.compute(wE(e.inputs,{activation:""},t));else{let s=t[t.length-2],i=Me.size(e.inputs[0].dims.slice(0,-2)),o=Me.size(e.inputs[1].dims.slice(0,-2));if(i!==1&&s===1&&o===1){let a=e.inputs[0].reshape([1,i,n]),l=e.inputs[1].reshape([1,n,r]),c=[1,i,r],u=[a,l];e.compute(F_(u,{activation:""},t,c),{inputs:u})}else e.compute(F_(e.inputs,{activation:""},t))}}}),dN,hN,fN,p6,m6,Jle=He(()=>{Et(),Rt(),Jr(),Ft(),dN=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let r=e[0],n=r.dims.length;if(r.dims[n-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let s=Math.floor((t.k+t.blockSize-1)/t.blockSize),i=t.blockSize/8*t.bits,o=e[1];if(!Me.areEqual(o.dims,[t.n,s,i]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let a=e[2].dims;if(Me.size(a)!==t.n*s)throw new Error("scales input size error.");if(e.length===4){let l=e[3].dims,c=t.bits>4?t.n*s:t.n*Math.floor((s+1)/2);if(Me.size(l)!==c)throw new Error("zeroPoints input size error.")}},hN=(e,t)=>{let r=e[0].dims,n=r.length,s=r[n-2],i=t.k,o=t.n,a=r.slice(0,n-2),l=Me.size(a),c=e[1].dims[2]/4,u=e[0].dataType,d=Vr(t.k),h=Vr(c),f=Vr(o),p=a.concat([s,o]),_=s>1&&o/f%2===0?2:1,w=Me.size(p)/f/_,y=64,g=[],v=[l,s,i/d],b=Me.convertShape(e[1].dims).slice();b.splice(-1,1,c/h),g.push(...gt(v)),g.push(...gt(b)),g.push(...gt(e[2].dims)),e.length===4&&g.push(...gt(Me.convertShape(e[3].dims)));let x=[l,s,o/f];g.push(...gt(x));let M=E=>{let P=v.length,I=Oe("a",e[0].dataType,P,d),O=Oe("b",12,b.length,h),V=Oe("scales",e[2].dataType,e[2].dims.length),U=[I,O,V],B=e.length===4?Oe("zero_points",12,e[3].dims.length):void 0;B&&U.push(B);let Y=x.length,K=ct("output",e[0].dataType,Y,f),X=$n(e[0].dataType),G=(()=>{switch(d){case 1:return`array<${X}, 8>`;case 2:return`mat4x2<${X}>`;case 4:return`mat2x4<${X}>`;default:throw new Error(`${d}-component is not supported.`)}})(),R=()=>{let L=`
          // reuse a data
            var input_offset = ${I.indicesToOffset(`${I.type.indices}(batch, row, word_offset)`)};
            var a_data: ${G};
            for (var j: u32 = 0; j < ${8/d}; j++) {
              a_data[j] = ${I.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let j=0;j<f*_;j++)L+=`
            b_value = ${h===1?`b${j}_data`:`b${j}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${G}(${Array.from({length:4},(q,ne)=>`${X}(b_value_lower[${ne}]), ${X}(b_value_upper[${ne}])`).join(", ")});
            b_dequantized_values = ${d===1?`${G}(${Array.from({length:8},(q,ne)=>`(b_quantized_values[${ne}] - ${B?`zero_point${j}`:"zero_point"}) * scale${j}`).join(", ")});`:`(b_quantized_values - ${G}(${Array(8).fill(`${B?`zero_point${j}`:"zero_point"}`).join(",")})) * scale${j};`};
            workgroup_shared[local_id.x * ${_} + ${Math.floor(j/f)}]${f>1?`[${j%f}]`:""} += ${Array.from({length:8/d},(q,ne)=>`${d===1?`a_data[${ne}] * b_dequantized_values[${ne}]`:`dot(a_data[${ne}], b_dequantized_values[${ne}])`}`).join(" + ")};
          `;return L},te=()=>{let L=`
            var col_index = col * ${f};
            ${B?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${X}(8);`}
            `;for(let j=0;j<f*_;j++)L+=`
            let scale${j} = ${V.getByOffset("col_index * nBlocksPerCol + block")};
            ${B?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${B.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${j} = ${X}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return L},re=()=>{let L=`col_index = col * ${f};`;for(let j=0;j<f*_;j++)L+=`
            let b${j}_data = ${O.getByIndices(`${O.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return L+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${G};
            var b_dequantized_values: ${G};`,L};return`
        var<workgroup> workgroup_shared: array<${K.type.value}, ${_*y}>;
        ${E.declareVariables(...U,K)}
        ${E.mainStart([y,1,1])}
          let output_indices = ${K.offsetToIndices(`(global_idx / ${y}) * ${_}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${y}) {
            //process one block
            var word_offset: u32 = block * ${t.blockSize/d};
            ${te()}
            for (var word: u32 = 0; word < ${c}; word += ${h}) {
              ${re()}
              for (var i: u32 = 0; i < ${h}; i++) {
                ${R()}
                word_offset += ${8/d};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${_}) {
            var output_value: ${K.type.value} = ${K.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${y}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${_};
            }
            ${K.setByIndices(`${K.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${t.blockSize};${t.bits};${d};${h};${f};${_};${y}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:p,dataType:u}],dispatchGroup:{x:w},programUniforms:g}),getShaderSource:M}},fN=(e,t)=>{let r=e[0].dims,n=r.length,s=r[n-2],i=t.k,o=t.n,a=r.slice(0,n-2),l=Me.size(a),c=e[1].dims[2]/4,u=e[0].dataType,d=Vr(t.k),h=Vr(c),f=a.concat([s,o]),p=128,_=o%8===0?8:o%4===0?4:1,w=p/_,y=w*h*8,g=y/d,v=y/t.blockSize,b=Me.size(f)/_,x=[],M=[l,s,i/d],E=Me.convertShape(e[1].dims).slice();E.splice(-1,1,c/h),x.push(...gt(M)),x.push(...gt(E)),x.push(...gt(e[2].dims)),e.length===4&&x.push(...gt(Me.convertShape(e[3].dims)));let P=[l,s,o];x.push(...gt(P));let I=O=>{let V=M.length,U=Oe("a",e[0].dataType,V,d),B=Oe("b",12,E.length,h),Y=Oe("scales",e[2].dataType,e[2].dims.length),K=[U,B,Y],X=e.length===4?Oe("zero_points",12,e[3].dims.length):void 0;X&&K.push(X);let G=P.length,R=ct("output",e[0].dataType,G),te=$n(e[0].dataType),re=()=>{switch(d){case 1:return`
          let a_data0 = vec4<${te}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${te}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${te}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${te}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${d}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${U.type.value}, ${g}>;
        var<workgroup> inter_results: array<array<${R.type.value}, ${w}>, ${_}>;
        ${O.declareVariables(...K,R)}
        ${O.mainStart([w,_,1])}
          let output_indices = ${R.offsetToIndices(`workgroup_index * ${_}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${v} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${g};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${g}; a_offset += ${p})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${U.getByIndices(`${U.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${U.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${v} + local_id.x;
            ${X?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${X.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${te}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${te}(8);`}
            let scale = ${Y.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${B.getByIndices(`${B.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${t.blockSize/d};
            for (var i: u32 = 0; i < ${h}; i++) {
              ${re()}
              let b_value = ${h===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${te}>(${Array.from({length:4},(L,j)=>`${te}(b_value_lower[${j}]), ${te}(b_value_upper[${j}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${te}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(L,j)=>`${`dot(a_data${j}, b_dequantized_values[${j}])`}`).join(" + ")};
              word_offset += ${8/d};
            }
            workgroupBarrier();
          }

          if (local_idx < ${_}) {
            var output_value: ${R.type.value} = ${R.type.value}(0);
            for (var b = 0u; b < ${w}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${R.setByIndices(`${R.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${t.blockSize};${d};${h};${w};${_}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:f,dataType:u}],dispatchGroup:{x:b},programUniforms:x}),getShaderSource:I}},p6=(e,t)=>{dN(e.inputs,t),t.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(fN(e.inputs,t)):e.compute(hN(e.inputs,t))},m6=e=>lr(e)}),pN,mN,gN,_N,yN,vN,wN,bN,g6,Zle=He(()=>{Et(),Rt(),Ft(),pN=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},mN=(e,t,r)=>{let n="";for(let s=t-1;s>=0;--s)n+=`
            k = i32(${e.indicesGet("indices",s)}) - ${ht("uniforms.pads",s,r)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${ht("uniforms.x_shape",s,t)})) {
              break;
            }
            offset += k * i32(${ht("uniforms.x_strides",s,t)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${n}
            value = x[offset];
          }
      `},gN=(e,t,r)=>{let n="";for(let s=t-1;s>=0;--s)n+=`
                k = i32(${e.indicesGet("indices",s)}) - ${ht("uniforms.pads",s,r)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${ht("uniforms.x_shape",s,t)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${ht("uniforms.x_shape",s,t)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${ht("uniforms.x_strides",s,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},_N=(e,t,r)=>{let n="";for(let s=t-1;s>=0;--s)n+=`
                k = i32(${e.indicesGet("indices",s)}) - ${ht("uniforms.pads",s,r)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${ht("uniforms.x_shape",s,t)})) {
                  k = i32(${ht("uniforms.x_shape",s,t)}) - 1;
                }
                offset += k * i32(${ht("uniforms.x_strides",s,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},yN=(e,t,r)=>{let n="";for(let s=t-1;s>=0;--s)n+=`
                k = i32(${e.indicesGet("indices",s)}) - ${ht("uniforms.pads",s,r)};
                if (k < 0)  {
                  k += i32(${ht("uniforms.x_shape",s,t)}]);
                }
                if (k >= i32(${ht("uniforms.x_shape",s,t)})) {
                  k -= i32(${ht("uniforms.x_shape",s,t)});
                }
                offset += k * i32(${ht("uniforms.x_strides",s,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${n}
              value = x[offset];
          `},vN=(e,t,r)=>{switch(r.mode){case 0:return mN(e,t,r.pads.length);case 1:return gN(e,t,r.pads.length);case 2:return _N(e,t,r.pads.length);case 3:return yN(e,t,r.pads.length);default:throw new Error("Invalid mode")}},wN=(e,t)=>{let r=Me.padShape(e[0].dims.slice(),t.pads),n=e[0].dims,s=Me.size(r),i=[{type:12,data:s},{type:6,data:t.pads}],o=e.length>=3&&e[2].data;t.mode===0&&i.push({type:o?e[2].dataType:1,data:t.value}),i.push(...gt(e[0].dims,r));let a=["rank"],l=c=>{let u=ct("output",e[0].dataType,r.length),d=Oe("x",e[0].dataType,n.length),h=d.type.value,f=vN(u,n.length,t),p=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&p.push({name:"constant_value",type:o?h:"f32"}),`
            ${c.registerUniforms(p).declareVariables(d,u)}
            ${c.mainStart()}
            ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${u.offsetToIndices("global_idx")};

            var value = ${h}(0);
            ${f}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}${o}`,inputDependencies:a},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(Me.size(r)/64)},programUniforms:i}),getShaderSource:l}},bN=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),n=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,s=e[0].dims.length,i=new Int32Array(2*s).fill(0);if(e.length>=4){let a=e[3].getBigInt64Array();for(let l=0;l<a.length;l++)i[Number(a[l])]=Number(r[l]),i[Number(a[l])+s]=Number(r[l+a.length])}else r.forEach((a,l)=>i[Number(l)]=Number(a));let o=[];return i.forEach(a=>o.push(a)),{mode:t.mode,value:n,pads:o}}else return t},g6=(e,t)=>{pN(e.inputs);let r=bN(e.inputs,t);e.compute(wN(e.inputs,r),{inputs:[0]})}}),Rh,Ww,Gw,Hw,Kw,xN,MN,qw,Qw,_6,y6,Yw,v6,w6,Xw,b6,x6,M6,T6,ece=He(()=>{so(),Et(),Rt(),Ft(),Rh=e=>{if(Pr.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Ww=(e,t,r)=>{let n=t.format==="NHWC",s=e.dims.slice();n&&s.splice(1,0,s.pop());let i=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),a=t.strides.slice(),l=i?t.dilations.slice():[],c=t.pads.slice();N_.adjustPoolAttributes(r,s,o,a,l,c);let u=N_.computePoolOutputShape(r,s,a,l,o,c,t.autoPad),d=Object.assign({},t);i?Object.assign(d,{kernelShape:o,strides:a,pads:c,dilations:l,cacheKey:t.cacheKey}):Object.assign(d,{kernelShape:o,strides:a,pads:c,cacheKey:t.cacheKey});let h=u.slice();return h.push(h.splice(1,1)[0]),[d,n?h:u]},Gw=(e,t)=>{let r=t.format==="NHWC",n=Me.size(e),s=Me.size(t.kernelShape),i=[{type:12,data:n},{type:12,data:s}],o=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let a=t.kernelShape[t.kernelShape.length-1],l=t.strides[t.strides.length-1],c=t.pads[t.pads.length/2-1],u=t.pads[t.pads.length-1],d=!!(c+u);i.push({type:12,data:a},{type:12,data:l},{type:12,data:c},{type:12,data:u}),o.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let h=!1;if(t.kernelShape.length===2){let f=t.kernelShape[t.kernelShape.length-2],p=t.strides[t.strides.length-2],_=t.pads[t.pads.length/2-2],w=t.pads[t.pads.length-2];h=!!(_+w),i.push({type:12,data:f},{type:12,data:p},{type:12,data:_},{type:12,data:w}),o.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[i,o,!0,d,h]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let a=Me.computeStrides(t.kernelShape);i.push({type:12,data:a},{type:12,data:t.pads},{type:12,data:t.strides}),o.push({name:"kernelStrides",type:"u32",length:a.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let l=t.pads.reduce((c,u)=>c+u);return[i,o,!!l,!1,!1]}},Hw=(e,t,r,n,s,i,o,a,l,c,u,d)=>{let h=s.format==="NHWC",f=t.type.value,p=ct("output",t.type.tensor,n);if(s.kernelShape.length<=2){let _="",w="",y="",g=r-(h?2:1);if(u?_=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${g}] = indices[${g}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${g}] < 0 || xIndices[${g}]
                      >= uniforms.x_shape[${g}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${i}
                }`:_=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${g}] = indices[${g}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${i}
                }`,s.kernelShape.length===2){let v=r-(h?3:2);d?w=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${v}] = indices[${v}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${v}] < 0 || xIndices[${v}] >= uniforms.x_shape[${v}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:w=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${v}] = indices[${v}] * uniforms.sh - uniforms.phStart + j;
                `,y=`
              }
            `}return`
            ${e.registerUniforms(l).declareVariables(t,p)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${p.offsetToIndices("global_idx")};
              var xIndices = ${p.offsetToIndices("global_idx")};

              var value = ${f}(${a});
              var pad = 0;
              ${w}
              ${_}
              ${y}
              ${o}

              output[global_idx] = value;
            }`}else{if(h)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let _=s.kernelShape.length,w=s.pads.length,y="";return c?y=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${t.indicesToOffset("xIndices")}];
                ${i}
              }`:y=`
              }
              let x_val = x[${t.indicesToOffset("xIndices")}];
              ${i}
            `,`
            ${e.registerUniforms(l).declareVariables(t,p)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${p.offsetToIndices("global_idx")};
              var xIndices = ${p.offsetToIndices("global_idx")};

              var offsets: array<u32, ${_}>;

              var value = ${f}(${a});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${_-1}u; j++) {
                  offsets[j] = offset / ${ht("uniforms.kernelStrides","j",_)};
                  offset -= offsets[j] * ${ht("uniforms.kernelStrides","j",_)};
                }
                offsets[${_-1}] = offset;

                isPad = false;
                for (var j = ${r-_}u; j < ${r}u; j++) {
                  xIndices[j] = indices[j] * ${ht("uniforms.strides",`j - ${r-_}u`,_)}
                    + offsets[j - ${r-_}u] - ${ht("uniforms.pads","j - 2u",w)};
                  ${y}
              }
              ${o}

              output[global_idx] = value;
            }`}},Kw=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,xN=e=>`${Kw(e)};${e.countIncludePad}`,MN=e=>`${Kw(e)};${e.storageOrder};${e.dilations}`,qw=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Qw=(e,t,r,n)=>{let[s,i]=Ww(t,n,r),o=Oe("x",t.dataType,t.dims.length),a=o.type.value,l="value += x_val;",c="";s.countIncludePad?c+=`value /= ${a}(uniforms.kernelSize);`:c+=`value /= ${a}(i32(uniforms.kernelSize) - pad);`;let[u,d,h,f,p]=Gw(i,s);u.push(...gt(t.dims,i));let _=["rank"];return{name:e,shaderCache:{hint:`${n.cacheKey};${h};${f};${p}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(Me.size(i)/64)},programUniforms:u}),getShaderSource:w=>Hw(w,o,t.dims.length,i.length,s,l,c,0,d,h,f,p)}},_6=e=>{let t=e.count_include_pad!==0,r=qw(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let n={countIncludePad:t,...r,cacheKey:""};return{...n,cacheKey:xN(n)}},y6=(e,t)=>{Rh(e.inputs),e.compute(Qw("AveragePool",e.inputs[0],!1,t))},Yw={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},v6=e=>{let t=e.format;return{format:t,...Yw,cacheKey:t}},w6=(e,t)=>{Rh(e.inputs),e.compute(Qw("GlobalAveragePool",e.inputs[0],!0,t))},Xw=(e,t,r,n)=>{let[s,i]=Ww(t,n,r),o=`
      value = max(x_val, value);
    `,a="",l=Oe("x",t.dataType,t.dims.length),c=["rank"],[u,d,h,f,p]=Gw(i,s);return u.push(...gt(t.dims,i)),{name:e,shaderCache:{hint:`${n.cacheKey};${h};${f};${p}`,inputDependencies:c},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(Me.size(i)/64)},programUniforms:u}),getShaderSource:_=>Hw(_,l,t.dims.length,i.length,s,o,a,t.dataType===10?-65504:-1e5,d,h,f,p)}},b6=(e,t)=>{Rh(e.inputs),e.compute(Xw("MaxPool",e.inputs[0],!1,t))},x6=e=>{let t=e.storage_order,r=e.dilations,n=qw(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(n.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let s={storageOrder:t,dilations:r,...n,cacheKey:""};return{...s,cacheKey:MN(s)}},M6=e=>{let t=e.format;return{format:t,...Yw,cacheKey:t}},T6=(e,t)=>{Rh(e.inputs),e.compute(Xw("GlobalMaxPool",e.inputs[0],!0,t))}}),TN,EN,E6,S6,tce=He(()=>{Et(),Rt(),Jr(),Ft(),TN=(e,t)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((r,n)=>r===e[2].dims[n]).reduce((r,n)=>r&&n,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((s,i)=>i===t.axis||s===e[0].dims[i]).reduce((s,i)=>s&&i,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let r=e[0].dims[t.axis],n=e[1].dims[t.axis];if(t.blockSize<Math.ceil(r/n)||t.blockSize>Math.ceil(r/(n-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},EN=(e,t)=>{let r=Me.normalizeAxis(t.axis,e[0].dims.length),n=e[0].dataType,s=n===3,i=e[0].dims,o=e[1].dataType,a=Me.size(i),l=n===3||n===2,c=l?[Math.ceil(Me.size(e[0].dims)/4)]:e[0].dims,u=e[1].dims,d=e.length>2?e[2]:void 0,h=d?l?[Math.ceil(Me.size(d.dims)/4)]:d.dims:void 0,f=u.length===0||u.length===1&&u[0]===1,p=f===!1&&u.length===1,_=Vr(a),w=f&&(!l||_===4),y=w?_:1,g=w&&!l?_:1,v=Oe("input",l?12:n,c.length,g),b=Oe("scale",o,u.length),x=d?Oe("zero_point",l?12:n,h.length):void 0,M=ct("output",o,i.length,y),E=[v,b];x&&E.push(x);let P=[c,u];d&&P.push(h);let I=[{type:12,data:a/y},{type:12,data:r},{type:12,data:t.blockSize},...gt(...P,i)],O=V=>{let U=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${V.registerUniforms(U).declareVariables(...E,M)}
      ${V.mainStart()}
          ${V.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${M.offsetToIndices("global_idx")};

          // Set input x
          ${l?`
            let input = ${v.getByOffset("global_idx / 4")};
            let x_vec = ${s?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${y===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${v.getByOffset("global_idx")};`};

          // Set scale input
          ${f?`let scale_value= ${b.getByOffset("0")}`:p?`
            let scale_index = ${M.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${b.getByOffset("scale_index")};`:`
            var scale_indices: ${b.type.indices} = output_indices;
            let index = ${b.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${b.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${b.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${x?f?l?`
                let zero_point_input = ${x.getByOffset("0")};
                let zero_point_vec =  ${s?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${x.getByOffset("0")}`:p?l?`
                let zero_point_index = ${M.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${x.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${s?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${M.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${x.getByOffset("zero_point_index")};`:l?`
                let zero_point_offset = ${b.indicesToOffset("scale_indices")};
                let zero_point_input = ${x.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${s?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${x.getByIndices("scale_indices")};`:`let zero_point_value = ${l?s?"i32":"u32":v.type.value}(0);`};
      // Compute and write output
      ${M.setByOffset("global_idx",`${M.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:x?["rank","rank","rank"]:["rank","rank"]},getShaderSource:O,getRunData:()=>({outputs:[{dims:i,dataType:o}],dispatchGroup:{x:Math.ceil(a/y/64),y:1,z:1},programUniforms:I})}},E6=(e,t)=>{TN(e.inputs,t),e.compute(EN(e.inputs,t))},S6=e=>lr({axis:e.axis,blockSize:e.blockSize})}),SN,PN,P6,rce=He(()=>{so(),Et(),Ft(),SN=(e,t,r)=>{let n=e===t,s=e<t&&r<0,i=e>t&&r>0;if(n||s||i)throw new Error("Range these inputs' contents are invalid.")},PN=(e,t,r,n)=>{let s=Math.abs(Math.ceil((t-e)/r)),i=[s],o=s,a=[{type:12,data:o},{type:n,data:e},{type:n,data:r},...gt(i)],l=c=>{let u=ct("output",n,i.length),d=u.type.value,h=[{name:"outputSize",type:"u32"},{name:"start",type:d},{name:"delta",type:d}];return`
        ${c.registerUniforms(h).declareVariables(u)}
        ${c.mainStart()}
        ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${d}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${n}`},getShaderSource:l,getRunData:()=>({outputs:[{dims:i,dataType:n}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:a})}},P6=e=>{let t=0,r=0,n=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],n=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],n=e.inputs[2].getFloat32Array()[0]),Pr.webgpu.validateInputContent&&SN(t,r,n),e.compute(PN(t,r,n,e.inputs[0].dataType),{inputs:[]})}}),CN,Jw,Zw,kN,C6,k6,nce=He(()=>{Et(),Rt(),Jr(),Ft(),CN=(e,t,r,n)=>{if(e!=="none"&&n!=="i32"&&n!=="u32"&&n!=="f32")throw new Error(`Input ${n} is not supported with reduction ${e}.`);let s=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,i=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${t}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${t}=${r};`;case"add":return n==="i32"||n==="u32"?`atomicAdd(&${t}, bitcast<${n}>(${r}));`:`
              ${s}bitcast<${n}>(oldValue) + (${r})${i}`;case"max":return n==="i32"||n==="u32"?`atomicMax(&${t}, bitcast<${n}>(${r}));`:`
                ${s}max(bitcast<f32>(oldValue), (${r}))${i}`;case"min":return n==="i32"||n==="u32"?`atomicMin(&${t}, bitcast<${n}>(${r}));`:`${s}min(bitcast<${n}>(oldValue), (${r}))${i}`;case"mul":return`${s}(bitcast<${n}>(oldValue) * (${r}))${i}`;default:throw new Error(`Reduction ${e} is not supported.`)}},Jw=(e,t)=>`${e===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[${t?"i - indices_start":"i"}];
    let dim_value = uniforms.output_shape[${t?"i - indices_start":"i"} + uniforms.last_index_dimension];`}
    
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));`,Zw=(e,t,r)=>`for (var i = 0u; i < uniforms.num_updates_elements; i++) {
        let value = updates[uniforms.num_updates_elements * ${r?"global_idx":"idx"} + i];
        ${CN(e.reduction,"output[data_offset + i]","value",t)}
      }`,kN=(e,t)=>{let r=e[0].dims,n=e[1].dims,s=r,i=1,o=Math.ceil(Me.size(n)/i),a=n[n.length-1],l=Me.sizeFromDimension(r,a),c=Me.sizeFromDimension(n,0)/a,u=[{type:12,data:o},{type:12,data:a},{type:12,data:l},...gt(e[1].dims,e[2].dims,s)],d=h=>{let f=Oe("indices",e[1].dataType,e[1].dims.length),p=Oe("updates",e[2].dataType,e[2].dims.length,i),_=t.reduction!=="none"&&t.reduction!==""?n5("output",e[0].dataType,s.length):ct("output",e[0].dataType,s.length,i);return`
      ${h.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(f,p,_)}
      ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${t.reduction==="none"}) {
    for (var i = 0; i < ${c}; i = i + 1) {
      for (var j = i + 1; j < ${c}; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  if (${t.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    // Process each index-update pair individually when duplicates exist
    for (var idx = 0u; idx < ${c}u; idx++) {
      var data_offset = 0u;
      for (var i = 0u; i < uniforms.last_index_dimension; i++) {
        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);
        ${Jw(r.length,!1)}
      }
      ${Zw(t,_.type.value,!1)}
    }
    return;
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  var indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${Jw(r.length,!0)}
  }
  ${Zw(t,_.type.value,!0)}
  }`};return{name:"ScatterND",shaderCache:{hint:`${t.cacheKey}_${t.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:u}),getShaderSource:d}},C6=e=>lr({reduction:e.reduction}),k6=(e,t)=>{e.compute(kN(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),AN,$N,IN,eb,ON,jN,DN,NN,RN,FN,LN,BN,tb,zN,VN,UN,WN,GN,A6,$6,sce=He(()=>{Et(),Rt(),Jr(),Ft(),AN=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},$N=(e,t,r)=>{t.every(s=>s>=0&&s<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let n=new Array(r).fill(1);return t.forEach((s,i)=>n[s]=e[i]),n},IN=(e,t,r,n,s,i)=>{let[o,a,l]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],c=e[0].dims.length;if(o>0&&e.length>o&&e[o].dims.length>0)e[o].getFloat32Array().forEach(u=>i.push(u));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(a>0&&e.length>a&&e[a].dims.length===1&&e[a].dims[0]>0){if(e[a].getFloat32Array().forEach(u=>n.push(u)),n.length!==0&&n.length!==c&&r>=18&&n.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");AN(n,t),t.axes.length>0&&$N(n,t.axes,c).forEach((u,d)=>n[d]=u)}if(l>0&&e.length>l&&e[l].dims.length===1&&e[l].dims[0]>0&&(e[l].getBigInt64Array().forEach(u=>s.push(Number(u))),s.length!==0&&s.length!==c&&r>=18&&s.length!==t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(n.length!==0&&n.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(s.length!==0&&s.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof n<"u"&&typeof s<"u"&&n.length>0&&s.length>c)throw new Error("Resize requires only of scales or sizes to be specified")},eb=(e,t,r,n)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${t});
  let whole = ${n}(big / (${r}));
  let fract = ${n}(big % (${r})) / ${n}(${r});
  return whole + fract;
`,ON=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${t}(xResized) / ${t}(xScale);
          } else {
            ${eb("xResized","lengthOriginal","lengthResized",t)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${eb("xResized","lengthOriginal - 1","lengthResized - 1",t)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +
                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /
                        ${t}(lengthResized - 1);
                  } else {
                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);
                  const adjustment = ${t}(lengthResized) / outputWidth;
                  const center = ${t}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",jN=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",DN=(e,t,r)=>{let n=new Array(r).fill(0).concat(new Array(r).fill(1)),s=e.length===0?n:e.slice();return t.length>0?(t.forEach((i,o)=>{n[i]=s[o],n[o+r]=s[t.length+o]}),n):s},NN=(e,t,r,n)=>{let s=[];if(r.length>0)if(n.length>0){if(e.forEach(i=>s.push(i)),Math.max(...n)>e.length)throw new Error("axes is out of bound");n.forEach((i,o)=>s[i]=r[o])}else r.forEach(i=>s.push(i));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");s=e.map((i,o)=>Math.round(i*t[o]))}return s},RN=(e,t,r)=>{let n=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(i=>t[i]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(i=>t[i]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let s=e.slice();return r.axes.length>0?(r.axes.forEach(i=>t[i]=n),r.axes.forEach(i=>s[i]=Math.round(e[i]*t[i]))):(t.fill(n,0,t.length),s.forEach((i,o)=>s[o]=Math.round(i*t[o]))),s},FN=(e,t,r,n,s)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {
      var original_indices: array<${e.type.value}, ${r.length}>;
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${ht("uniforms.scales","i",n)};
        var roi_low = ${ht("uniforms.roi","i",s)};
        var roi_hi = ${ht("uniforms.roi",`i + ${t.length}`,s)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${ht("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${ht("uniforms.output_shape","i",r.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,LN=(e,t,r,n,s,i,o)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${ht("uniforms.scales","i",s)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${ht("uniforms.roi","i",i)};
          var roi_hi = ${ht("uniforms.roi",`i + ${r.length}`,i)};
          var input_shape_i = ${ht("uniforms.input_shape","i",r.length)};
          var output_shape_i = ${ht("uniforms.output_shape","i",n.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${o} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,BN=(e,t)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${ht("uniforms.input_shape","i",t.length)}) {
          return false;
        }
      }
      return true;
    }`,tb=(e,t,r,n)=>e.rank>n?`
    ${e.indicesSet("input_indices",t,"channel")};
    ${e.indicesSet("input_indices",r,"batch")};
`:"",zN=(e,t,r,n,s)=>{let[i,o,a,l]=r.length===2?[-1,0,1,-1]:[0,2,3,1],c=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${c} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",o,`max(0, min(row, ${r[o]} - 1))`)};
      ${e.indicesSet("input_indices",a,`max(0, min(col, ${r[a]} - 1))`)};
      ${tb(e,l,i,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${c} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${c} = originalIndices[${o}];
      var col:${c} = originalIndices[${a}];
      ${n?`if (row < 0 || row > (${r[o]} - 1) || col < 0 || col > (${r[a]} - 1)) {
        return ${s};
      }`:""};
      row = max(0, min(row, ${r[o]} - 1));
      col = max(0, min(col, ${r[a]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${r.length>2?`u32(originalIndices[${l}])`:"0"};
      var batch: u32 =  ${r.length>2?`u32(originalIndices[${i}])`:"0"};
      var x11: ${c} = getInputValue(batch, channel, row1, col1);
      var x12: ${c} = getInputValue(batch, channel, row1, col2);
      var x21: ${c} = getInputValue(batch, channel, row2, col1);
      var x22: ${c} = getInputValue(batch, channel, row2, col2);
      var dx1: ${c} = abs(row - ${c}(row1));
      var dx2: ${c} = abs(${c}(row2) - row);
      var dy1: ${c} = abs(col - ${c}(col1));
      var dy2: ${c} = abs(${c}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},VN=(e,t,r,n,s,i,o,a,l,c)=>{let u=r.length===2,[d,h]=u?[0,1]:[2,3],f=e.type.value,p=_=>{let w=_===d?"row":"col";return`
      fn ${w}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${f} {
        var output_index = ${t.indicesGet("output_indices",_)};
        var originalIdx: ${f} = getOriginalCoordinateFromResizedCoordinate(output_index, ${s[_]},
        ${n[_]}, ${r[_]}, ${i[_]}, ${i[_]} + ${r.length});
        var fractOriginalIdx: ${f} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${a} && (originalIdx < 0 || originalIdx > (${r[_]} - 1))) {
          return ${l};
        }
        var data: array<${f}, 4> = array<${f}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${w}: ${f} = originalIdx + ${f}(i);
          if (${w} < 0 || ${w} >= ${r[_]}) {
            ${c?`coefs[i + 1] = 0.0;
                        continue;`:a?`return ${l};`:`${w} = max(0, min(${w}, ${r[_]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",_,`u32(${w})`)};
          data[i + 1] = ${_===d?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${p(d)};
    ${p(h)};
  fn getCubicInterpolationCoefs(s: ${f}) -> array<${f}, 4> {
    var absS = abs(s);
    var coeffs: array<${f}, 4> = array<${f}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${f} = 1.0 - absS;
    var twoMinusAbsS: ${f} = 2.0 - absS;
    var onePlusAbsS: ${f} = 1.0 + absS;
    coeffs[0] = ((${o} * onePlusAbsS - 5 * ${o}) * onePlusAbsS + 8 * ${o}) * onePlusAbsS - 4 * ${o};
    coeffs[1] = ((${o} + 2) * absS - (${o} + 3)) * absS * absS + 1;
    coeffs[2] = ((${o} + 2) * oneMinusAbsS - (${o} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${o} * twoMinusAbsS - 5 * ${o}) * twoMinusAbsS + 8 * ${o}) * twoMinusAbsS - 4 * ${o};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${f}, 4>, coefs: array<${f}, 4>) -> ${f} {
    var coefsSum: ${f} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${f} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},UN=(e,t,r,n,s)=>{let[i,o,a,l,c]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],u=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${u} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",o,`max(0, min(depth, ${r[o]} - 1))`)};
      ${e.indicesSet("input_indices",a,`max(0, min(height, ${r[a]} - 1))`)};
      ${e.indicesSet("input_indices",l,`max(0, min(width, ${r[l]} - 1))`)};
      ${tb(e,c,i,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${u} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${u} = originalIndices[${o}];
      var height:${u} = originalIndices[${a}];
      var width:${u} = originalIndices[${l}];
      ${n?`if (depth < 0 || depth > (${r[o]} - 1) || height < 0 || height > (${r[a]} - 1) || width < 0 || (width > ${r[l]} - 1)) {
      return ${s};
        }`:""};

    depth = max(0, min(depth, ${r[o]} - 1));
      height = max(0, min(height, ${r[a]} - 1));
      width = max(0, min(width, ${r[l]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${r.length>3?`u32(originalIndices[${c}])`:"0"};
      var batch: u32 =  ${r.length>3?`u32(originalIndices[${i}])`:"0"};

      var x111: ${u} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${u} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${u} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${u} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${u} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${u} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${u} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${u} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${u} = abs(depth - ${u}(depth1));
      var dx2: ${u} = abs(${u}(depth2) - depth);
      var dy1: ${u} = abs(height - ${u}(height1));
      var dy2: ${u} = abs(${u}(height2) - height);
      var dz1: ${u} = abs(width - ${u}(width1));
      var dz2: ${u} = abs(${u}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},WN=(e,t,r,n,s,i)=>{let o=e.dims,a=DN(i,t.axes,o.length),l=NN(o,n,s,t.axes),c=n.slice();n.length===0&&(c=o.map((g,v)=>g===0?1:l[v]/g),t.keepAspectRatioPolicy!=="stretch"&&(l=RN(o,c,t)));let u=ct("output",e.dataType,l.length),d=Oe("input",e.dataType,o.length),h=Me.size(l),f=o.length===l.length&&o.every((g,v)=>g===l[v]),p=t.coordinateTransformMode==="tf_crop_and_resize",_=t.extrapolationValue,w=d.type.value,y=g=>`
      ${f?"":`
      ${ON(t.coordinateTransformMode,w)};
      ${(()=>{switch(t.mode){case"nearest":return`
              ${BN(d,o)};
              ${jN(t.nearestMode,r,w)};
              ${LN(d,u,o,l,c.length,a.length,p)};
              `;case"linear":return`
              ${FN(u,o,l,c.length,a.length)};
              ${(()=>{if(o.length===2||o.length===4)return`${zN(d,u,o,p,_)}`;if(o.length===3||o.length===5)return`${UN(d,u,o,p,_)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(o.length===2||o.length===4)return`${VN(d,u,o,l,c,a,t.cubicCoeffA,p,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${g.registerUniform("output_size","u32").registerUniform("scales","f32",c.length).registerUniform("roi","f32",a.length).declareVariables(d,u)}
      ${g.mainStart()}
        ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${f?"output[global_idx] = input[global_idx];":`
        let output_indices = ${u.offsetToIndices("global_idx")};
        var input_indices: ${d.type.indices};
        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${d.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${t.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${o.length===2||o.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${c.length>0?t.mode==="cubic"?c:c.length:""}|${s.length>0?s:""}|${a.length>0?a:""}|${f}|${t.mode==="nearest"?o.length:o}`,inputDependencies:["rank"]},getShaderSource:y,getRunData:()=>({outputs:[{dims:l,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},{type:1,data:c},{type:1,data:a},...gt(o,l)]})}},GN=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},A6=(e,t)=>{let r=[],n=[],s=[],i=GN(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");IN(e.inputs,t,i,r,n,s),e.compute(WN(e.inputs[0],t,i,r,n,s),{inputs:[0]})},$6=e=>{let t=e.antialias,r=e.axes,n=e.coordinateTransformMode,s=e.cubicCoeffA,i=e.excludeOutside!==0,o=e.extrapolationValue,a=e.keepAspectRatioPolicy,l=e.mode,c=e.nearestMode===""?"simple":e.nearestMode;return lr({antialias:t,axes:r,coordinateTransformMode:n,cubicCoeffA:s,excludeOutside:i,extrapolationValue:o,keepAspectRatioPolicy:a,mode:l,nearestMode:c})}}),HN,KN,I6,ice=He(()=>{Et(),Rt(),Ft(),HN=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dataType!==r.dataType||t.dataType!==n.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let s=t.dims[t.dims.length-1],i=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==s)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==i)throw new Error("Skip must have the same sequence length as input");if(n.dims.length!==1)throw new Error("Gamma must be 1D");if(n.dims[n.dims.length-1]!==s)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let o=e[3];if(o.dims.length!==1)throw new Error("Beta must be 1D");if(o.dims[o.dims.length-1]!==s)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let o=e[4];if(o.dims.length!==1)throw new Error("Bias must be 1D");if(o.dims[o.dims.length-1]!==s)throw new Error("Bias must have the same hidden size as input")}},KN=(e,t,r,n)=>{let s=t.simplified,i=e[0].dims,o=Me.size(i),a=i,l=o,c=i.slice(-1)[0],u=n?i.slice(0,-1).concat(1):[],d=!s&&e.length>3,h=e.length>4,f=n&&r>1,p=n&&r>2,_=r>3,w=64,y=Vr(c),g=[{type:12,data:l},{type:12,data:y},{type:12,data:c},{type:1,data:t.epsilon}],v=x=>{let M=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],E=[Oe("x",e[0].dataType,e[0].dims,y),Oe("skip",e[1].dataType,e[1].dims,y),Oe("gamma",e[2].dataType,e[2].dims,y)];d&&E.push(Oe("beta",e[3].dataType,e[3].dims,y)),h&&E.push(Oe("bias",e[4].dataType,e[4].dims,y)),E.push(ct("output",e[0].dataType,a,y)),f&&E.push(ct("mean_output",1,u)),p&&E.push(ct("inv_std_output",1,u)),_&&E.push(ct("input_skip_bias_sum",e[0].dataType,a,y));let P=$n(e[0].dataType),I=$n(1,y);return`

      ${x.registerUniforms(M).declareVariables(...E)}
      var<workgroup> sum_shared : array<${I}, ${w}>;
      var<workgroup> sum_squared_shared : array<${I}, ${w}>;

      ${x.mainStart([w,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${w};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${w};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${w-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${h?"bias[offset1d + i]":P+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${_?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Fu(P,y,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${w};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${nl("sum",y)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${nl("square_sum",y)} / f32(uniforms.hidden_size) ${s?"":"- mean * mean"} + uniforms.epsilon);
        ${f?"mean_output[global_idx] = mean;":""}
        ${p?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${s?"":`- ${P}(mean)`}) *
            ${P}(inv_std_dev) * gamma[offset1d + i]
            ${d?"+ beta[offset1d + i]":""};
        }
      }`},b=[{dims:a,dataType:e[0].dataType}];return r>1&&b.push({dims:u,dataType:1}),r>2&&b.push({dims:u,dataType:1}),r>3&&b.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${y};${f};${p};${_}`,inputDependencies:e.map((x,M)=>"type")},getShaderSource:v,getRunData:()=>({outputs:b,dispatchGroup:{x:Math.ceil(l/c)},programUniforms:g})}},I6=(e,t)=>{HN(e.inputs);let r=[0];e.outputCount>1&&r.push(-3),e.outputCount>2&&r.push(-3),e.outputCount>3&&r.push(3),e.compute(KN(e.inputs,t,e.outputCount,!1),{outputs:r})}}),qN,Fh,QN,rb,YN,XN,O6,j6,oce=He(()=>{Et(),Rt(),Jr(),Ft(),qN=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,n)=>{if(e[n+1].dataType!==6&&e[n+1].dataType!==7)throw new Error(`Input ${n} must be an array of int32 or int64`)})},Fh=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(n=>r.push(Number(n)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(n=>r.push(Number(n)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},QN=(e,t)=>{if(e.length>1){let r=Fh(e,1),n=Fh(e,2),s=Fh(e,3);return s.length===0&&(s=[...Array(e[0].dims.length).keys()]),lr({starts:r,ends:n,axes:s})}else return t},rb=(e,t,r,n,s)=>{let i=e;return e<0&&(i+=r[n[t]]),s[t]<0?Math.max(0,Math.min(i,r[n[t]]-1)):Math.max(0,Math.min(i,r[n[t]]))},YN=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${r.length}; i >= 0; i--) {
            let input_shape_i = ${ht("uniforms.input_shape","i",r.length)};
            let steps_i = ${ht("uniforms.steps","i",r.length)};
            let signs_i = ${ht("uniforms.signs","i",r.length)};
            let starts_i = ${ht("uniforms.starts","i",r.length)};
            var output_index = ${t.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,XN=(e,t)=>{let r=e[0].dims,n=Me.size(r),s=t.axes.length>0?Me.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],i=Fh(e,4);i.forEach(y=>y!==0||(()=>{throw new Error("step cannot be 0")})),i.length===0&&(i=Array(s.length).fill(1));let o=t.starts.map((y,g)=>rb(y,g,r,s,i)),a=t.ends.map((y,g)=>rb(y,g,r,s,i));if(s.length!==o.length||s.length!==a.length)throw new Error("start, ends and axes should have the same number of elements");if(s.length!==r.length)for(let y=0;y<r.length;++y)s.includes(y)||(o.splice(y,0,0),a.splice(y,0,r[y]),i.splice(y,0,1));let l=i.map(y=>Math.sign(y));i.forEach((y,g,v)=>{if(y<0){let b=(a[g]-o[g])/y,x=o[g],M=x+b*i[g];o[g]=M,a[g]=x,v[g]=-y}});let c=r.slice(0);s.forEach((y,g)=>{c[y]=Math.ceil((a[y]-o[y])/i[y])});let u={dims:c,dataType:e[0].dataType},d=ct("output",e[0].dataType,c.length),h=Oe("input",e[0].dataType,e[0].dims.length),f=Me.size(c),p=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:o.length},{name:"signs",type:"i32",length:l.length},{name:"steps",type:"u32",length:i.length}],_=[{type:12,data:f},{type:12,data:o},{type:6,data:l},{type:12,data:i},...gt(e[0].dims,c)],w=y=>`
      ${y.registerUniforms(p).declareVariables(h,d)}
        ${YN(h,d,r)}
        ${y.mainStart()}
          ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${d.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${d.setByOffset("global_idx",h.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${l.length}_${o.length}_${i.length}`,inputDependencies:["rank"]},getShaderSource:w,getRunData:()=>({outputs:[u],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:_})}},O6=(e,t)=>{qN(e.inputs,t);let r=QN(e.inputs,t);e.compute(XN(e.inputs,r),{inputs:[0]})},j6=e=>{let t=e.starts,r=e.ends,n=e.axes;return lr({starts:t,ends:r,axes:n})}}),JN,ZN,D6,N6,ace=He(()=>{Et(),Rt(),Jr(),fl(),Ft(),JN=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},ZN=(e,t)=>{let r=e.inputs[0],n=r.dims,s=Me.size(n),i=n.length,o=Me.normalizeAxis(t.axis,i),a=o<n.length-1,l,c=[];a?(c=Array.from({length:i},(E,P)=>P),c[o]=i-1,c[i-1]=o,l=e.compute(Gs(r,c),{inputs:[r],outputs:[-1]})[0]):l=r;let u=l.dims,d=u[i-1],h=s/d,f=Vr(d),p=d/f,_=64;h===1&&(_=256);let w=(E,P)=>P===4?`max(max(${E}.x, ${E}.y), max(${E}.z, ${E}.w))`:P===2?`max(${E}.x, ${E}.y)`:P===3?`max(max(${E}.x, ${E}.y), ${E}.z)`:E,y=Oe("x",l.dataType,l.dims,f),g=ct("result",l.dataType,l.dims,f),v=y.type.value,b=$n(l.dataType)==="f32"?`var threadMax = ${v}(-3.402823e+38f);`:`var threadMax = ${v}(-65504.0h);`,x=E=>`
      var<workgroup> rowMaxShared : ${v};
      var<workgroup> rowSumShared : ${v};
      var<workgroup> threadShared : array<${v}, ${_}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${v} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${v}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${E.registerUniform("packedCols","i32").declareVariables(y,g)}
      ${E.mainStart(_)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${_};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${b}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${v}(${w("threadShared[0]",f)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${v}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${v}(${nl("threadShared[0]",f)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,M=e.compute({name:"Softmax",shaderCache:{hint:`${f};${_}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:u,dataType:l.dataType}],dispatchGroup:{x:h},programUniforms:[{type:6,data:p}]}),getShaderSource:x},{inputs:[l],outputs:[a?-1:0]})[0];a&&e.compute(Gs(M,c),{inputs:[M]})},D6=(e,t)=>{JN(e.inputs),ZN(e,t)},N6=e=>lr({axis:e.axis})}),nb,eR,tR,rR,R6,lce=He(()=>{Et(),Rt(),Ft(),nb=e=>Array.from(e.getBigInt64Array(),Number),eR=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(nb(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},tR=(e,t)=>{let r=[];for(let n=0;n<e.length;++n)r.push(e[n]*t[n]);return r},rR=(e,t)=>{let r=e[0].dims,n=t??nb(e[1]),s=tR(r,n),i=Me.size(s),o=e[0].dataType,a=Oe("input",o,r.length),l=ct("output",o,s.length),c=u=>`
      const inputShape = ${a.indices(...r)};
      ${u.registerUniform("output_size","u32").declareVariables(a,l)}
      ${u.mainStart()}
      ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${l.offsetToIndices("global_idx")};
      var input_indices: ${a.type.indices};
      for (var i = 0; i < ${r.length}; i++) {
        let input_dim_i = ${a.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${l.indicesGet("output_indices","i")}  % input_dim_i;

        ${a.indicesSet("input_indices","i","input_dim_value")}
      }
      ${l.setByOffset("global_idx",a.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${n}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},...gt(e[0].dims,s)]}),getShaderSource:c}},R6=e=>{eR(e.inputs),e.compute(rR(e.inputs),{inputs:[0]})}}),nR,sR,F6,cce=He(()=>{Et(),Rt(),Ft(),nR=(e,t,r,n,s)=>{let i=ct("output_data",s,r.length,4),o=Oe("a_data",t[1].dataType,t[1].dims.length,4),a=Oe("b_data",t[2].dataType,t[2].dims.length,4),l=Oe("c_data",t[0].dataType,t[0].dims.length,4),c,u=(d,h,f)=>`select(${h}, ${d}, ${f})`;if(!n)c=i.setByOffset("global_idx",u(o.getByOffset("global_idx"),a.getByOffset("global_idx"),l.getByOffset("global_idx")));else{let d=(h,f,p="")=>{let _=`a_data[index_a${f}][component_a${f}]`,w=`b_data[index_b${f}][component_b${f}]`,y=`bool(c_data[index_c${f}] & (0xffu << (component_c${f} * 8)))`;return`
            let output_indices${f} = ${i.offsetToIndices(`global_idx * 4u + ${f}u`)};
            let offset_a${f} = ${o.broadcastedIndicesToOffset(`output_indices${f}`,i)};
            let offset_b${f} = ${a.broadcastedIndicesToOffset(`output_indices${f}`,i)};
            let offset_c${f} = ${l.broadcastedIndicesToOffset(`output_indices${f}`,i)};
            let index_a${f} = offset_a${f} / 4u;
            let index_b${f} = offset_b${f} / 4u;
            let index_c${f} = offset_c${f} / 4u;
            let component_a${f} = offset_a${f} % 4u;
            let component_b${f} = offset_b${f} % 4u;
            let component_c${f} = offset_c${f} % 4u;
            ${h}[${f}] = ${p}(${u(_,w,y)});
          `};s===9?c=`
            var data = vec4<u32>(0);
            ${d("data",0,"u32")}
            ${d("data",1,"u32")}
            ${d("data",2,"u32")}
            ${d("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:c=`
            ${d("output_data[global_idx]",0)}
            ${d("output_data[global_idx]",1)}
            ${d("output_data[global_idx]",2)}
            ${d("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(l,o,a,i)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${c}
      }`},sR=e=>{let t=e[1].dims,r=e[2].dims,n=e[0].dims,s=e[1].dataType,i=!(Me.areEqual(t,r)&&Me.areEqual(r,n)),o=t,a=Me.size(t);if(i){let c=wd.calcShape(wd.calcShape(t,r,!1),n,!1);if(!c)throw new Error("Can't perform where op on the given tensors");o=c,a=Me.size(o)}let l=Math.ceil(a/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:c=>nR(c,e,o,i,s),getRunData:()=>({outputs:[{dims:o,dataType:s}],dispatchGroup:{x:Math.ceil(a/64/4)},programUniforms:[{type:12,data:l},...gt(n,t,r,o)]})}},F6=e=>{e.compute(sR(e.inputs))}}),L6,uce=He(()=>{Tle(),gE(),Ele(),Sle(),Ple(),Cle(),kle(),jle(),Nle(),Rle(),Fle(),Lle(),Ble(),zle(),Vle(),Ule(),Wle(),Gle(),Hle(),Kle(),qle(),Qle(),Yle(),Xle(),Jle(),s6(),Zle(),ece(),tce(),rce(),nce(),mE(),sce(),c6(),ice(),oce(),ace(),a6(),lce(),fl(),_E(),cce(),L6=new Map([["Abs",[I5]],["Acos",[O5]],["Acosh",[j5]],["Add",[p8]],["ArgMax",[C5,M1]],["ArgMin",[P5,M1]],["Asin",[D5]],["Asinh",[N5]],["Atan",[R5]],["Atanh",[F5]],["Attention",[k5]],["AveragePool",[y6,_6]],["BatchNormalization",[A5]],["BiasAdd",[$5]],["BiasSplitGelu",[f8]],["Cast",[B5,L5]],["Ceil",[V5]],["Clip",[z5]],["Concat",[T8,E8]],["Conv",[k1,C1]],["ConvTranspose",[D8,j8]],["Cos",[U5]],["Cosh",[W5]],["CumSum",[N8,R8]],["DepthToSpace",[F8,L8]],["DequantizeLinear",[E6,S6]],["Div",[m8]],["Einsum",[B8,z8]],["Elu",[G5,Jh]],["Equal",[g8]],["Erf",[H5]],["Exp",[K5]],["Expand",[V8]],["FastGelu",[U8]],["Floor",[q5]],["FusedConv",[k1,C1]],["Gather",[G8,W8]],["GatherElements",[X8,Y8]],["GatherBlockQuantized",[q8,Q8]],["GatherND",[H8,K8]],["Gelu",[Q5]],["Gemm",[Z8,J8]],["GlobalAveragePool",[w6,v6]],["GlobalMaxPool",[T6,M6]],["Greater",[w8]],["GreaterOrEqual",[x8]],["GridSample",[e6,t6]],["GroupQueryAttention",[u6]],["HardSigmoid",[n8,r8]],["InstanceNormalization",[d6]],["LayerNormalization",[h6]],["LeakyRelu",[Y5,Jh]],["Less",[b8]],["LessOrEqual",[M8]],["Log",[d8]],["MatMul",[f6]],["MatMulNBits",[p6,m6]],["MaxPool",[b6,x6]],["Mul",[_8]],["MultiHeadAttention",[n6,r6]],["Neg",[J5]],["Not",[X5]],["Pad",[g6]],["Pow",[y8]],["QuickGelu",[h8,Jh]],["Range",[P6]],["Reciprocal",[Z5]],["ReduceMin",[x5]],["ReduceMean",[_5]],["ReduceMax",[b5]],["ReduceSum",[T5]],["ReduceProd",[M5]],["ReduceL1",[y5]],["ReduceL2",[v5]],["ReduceLogSum",[S5]],["ReduceLogSumExp",[w5]],["ReduceSumSquare",[E5]],["Relu",[e8]],["Resize",[A6,$6]],["RotaryEmbedding",[l6]],["ScatterND",[k6,C6]],["Sigmoid",[t8]],["Sin",[s8]],["Sinh",[i8]],["Slice",[O6,j6]],["SkipLayerNormalization",[I6]],["Split",[i6,o6]],["Sqrt",[o8]],["Softmax",[D6,N6]],["Sub",[v8]],["Tan",[a8]],["Tanh",[l8]],["ThresholdedRelu",[u8,Jh]],["Tile",[R6]],["Transpose",[i5,o5]],["Where",[F6]]])}),B6,dce=He(()=>{so(),ia(),Ft(),B6=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r,n,s){eo(e.programInfo.name);let i=this.backend.device,o=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let a=[];for(let c of t)a.push({binding:a.length,resource:{buffer:c.buffer}});for(let c of r)a.push({binding:a.length,resource:{buffer:c.buffer}});s&&a.push({binding:a.length,resource:s});let l=i.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:a,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let c={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:l,dispatchGroup:n};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(c)}o.setPipeline(e.computePipeline),o.setBindGroup(0,l),o.dispatchWorkgroups(...n),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),gi(e.programInfo.name)}dispose(){}build(e,t){eo(e.name);let r=this.backend.device,n=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(c=>{r.features.has(c.feature)&&n.push(`enable ${c.extension};`)});let s=s5(t,this.backend.device.limits),i=e.getShaderSource(s),o=`${n.join(`
`)}
${s.additionalImplementations}
${i}`,a=r.createShaderModule({code:o,label:e.name});Xt("verbose",()=>`[WebGPU] ${e.name} shader code: ${o}`);let l=r.createComputePipeline({compute:{module:a,entryPoint:"main"},layout:"auto",label:e.name});return gi(e.name),{programInfo:e,computePipeline:l,uniformVariablesInfo:s.variablesInfo}}normalizeDispatchGroupSize(e){let t=typeof e=="number"?e:e.x,r=typeof e=="number"?1:e.y||1,n=typeof e=="number"?1:e.z||1,s=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=s&&r<=s&&n<=s)return[t,r,n];let i=t*r*n,o=Math.ceil(Math.sqrt(i));if(o>s){if(o=Math.ceil(Math.cbrt(i)),o>s)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[o,o,o]}else return[o,o,1]}}}),z6={};Bd(z6,{WebGpuBackend:()=>V6});var iR,oR,aR,V6,hce=He(()=>{so(),Et(),ia(),ZW(),xle(),uce(),dce(),iR=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let n=0;n<e.length;++n){let s=e[n].dataType;switch(t[n]){case"none":{r.push("");break}case"type":{r.push(`${s}`);break}case"rank":{let i=e[n].dims.length;r.push(`${s};${i}`);break}case"dims":{let i=e[n].dims.join(",");r.push(`${s};${i}`);break}default:throw new Error(`unsupported input dependency: ${t[n]}`)}}return r.join("|")},oR=(e,t,r)=>{var s,i;let n=e.name;return(s=e.shaderCache)!=null&&s.hint&&(n+="["+e.shaderCache.hint+"]"),n+=":"+r+`:${iR(t,((i=e.shaderCache)==null?void 0:i.inputDependencies)??new Array(t.length).fill("dims"))}`,n},aR=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},V6=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let r=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r},s=i=>t.features.has(i)&&r.push(i)&&!0;s("chromium-experimental-timestamp-query-inside-passes")||s("timestamp-query"),s("shader-f16"),s("subgroups"),this.device=await t.requestDevice(n),this.adapterInfo=new aR(t.info||await t.requestAdapterInfo()),this.gpuDataManager=r5(this),this.programManager=new B6(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,dE(e.logLevel,!!e.debug),this.device.onuncapturederror=i=>{i.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${i.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;eo(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{var n;let t=new BigUint64Array(e.getMappedRange()),r=this.pendingQueries.get(e);for(let s=0;s<t.length/2;s++){let i=r[s],o=i.kernelId,a=this.kernels.get(o),l=a.kernelType,c=a.kernelName,u=i.programName,d=i.inputTensorViews,h=i.outputTensorViews,f=t[s*2],p=t[s*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=f);let _=Number(f-this.queryTimeBase),w=Number(p-this.queryTimeBase);if(!Number.isSafeInteger(_)||!Number.isSafeInteger(w))throw new RangeError("incorrect timestamp range");if((n=this.env.webgpu.profiling)!=null&&n.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:d.map(y=>({dims:y.dims,dataType:Go(y.dataType)})),outputsMetadata:h.map(y=>({dims:y.dims,dataType:Go(y.dataType)})),kernelId:o,kernelType:l,kernelName:c,programName:u,startTime:_,endTime:w});else{let y="";d.forEach((v,b)=>{y+=`input[${b}]: [${v.dims}] | ${Go(v.dataType)}, `});let g="";h.forEach((v,b)=>{g+=`output[${b}]: [${v.dims}] | ${Go(v.dataType)}, `}),console.log(`[profiling] kernel "${o}|${l}|${c}|${u}" ${y}${g}execution time: ${w-_} ns`)}Zf("GPU",`${u}::${f}::${p}`)}e.unmap(),this.pendingQueries.delete(e)}),gi()}run(e,t,r,n,s,i){eo(e.name);let o=[];for(let g=0;g<t.length;++g){let v=t[g].data;if(v===0)continue;let b=this.gpuDataManager.get(v);if(!b)throw new Error(`no GPU data for input: ${v}`);o.push(b)}let{outputs:a,dispatchGroup:l,programUniforms:c}=e.getRunData(t),u=r.length===0?a.map((g,v)=>v):r;if(u.length!==a.length)throw new Error(`Output size ${u.length} must be equal to ${a.length}.`);let d=[],h=[];for(let g=0;g<a.length;++g){if(!Number.isInteger(u[g])||u[g]<-3||u[g]>=i)throw new Error(`Invalid output index: ${u[g]}`);if(u[g]===-3)continue;let v=u[g]===-1,b=u[g]===-2,x=v||b?s(a[g].dataType,a[g].dims):n(u[g],a[g].dataType,a[g].dims);if(d.push(x),x.data===0)continue;let M=this.gpuDataManager.get(x.data);if(!M)throw new Error(`no GPU data for output: ${x.data}`);if(v&&this.temporaryData.push(M),b){let E=this.kernelPersistentData.get(this.currentKernelId);E||(E=[],this.kernelPersistentData.set(this.currentKernelId,E)),E.push(M)}h.push(M)}if(o.length!==t.length||h.length!==d.length){if(h.length===0)return gi(e.name),d;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let f;if(c){let g=0,v=[];c.forEach(E=>{let P=typeof E.data=="number"?[E.data]:E.data;if(P.length===0)return;let I=E.type===10?2:4,O,V;E.type===10?(V=P.length>4?16:P.length>2?8:P.length*I,O=P.length>4?16:I*P.length):(V=P.length<=2?P.length*I:16,O=16),g=Math.ceil(g/V)*V,v.push(g);let U=E.type===10?8:4;g+=P.length>4?Math.ceil(P.length/U)*O:P.length*I});let b=16;g=Math.ceil(g/b)*b;let x=new ArrayBuffer(g);c.forEach((E,P)=>{let I=v[P],O=typeof E.data=="number"?[E.data]:E.data;if(E.type===6)new Int32Array(x,I,O.length).set(O);else if(E.type===12)new Uint32Array(x,I,O.length).set(O);else if(E.type===10)new Uint16Array(x,I,O.length).set(O);else if(E.type===1)new Float32Array(x,I,O.length).set(O);else throw new Error(`Unsupported uniform type: ${Go(E.type)}`)});let M=this.gpuDataManager.create(g,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(M.buffer,0,x,0,g),this.gpuDataManager.release(M.id),f={offset:0,size:g,buffer:M.buffer}}let p=this.programManager.normalizeDispatchGroupSize(l),_=p[1]===1&&p[2]===1,w=oR(e,t,_),y=this.programManager.getArtifact(w);if(y||(y=this.programManager.build(e,p),this.programManager.setArtifact(w,y),Xt("info",()=>`[artifact] key: ${w}, programName: ${e.name}`)),c&&y.uniformVariablesInfo){if(c.length!==y.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${y.uniformVariablesInfo.length}, got ${c.length} in program "${y.programInfo.name}".`);for(let g=0;g<c.length;g++){let v=c[g],b=v.type,x=typeof v.data=="number"?1:v.data.length,[M,E]=y.uniformVariablesInfo[g];if(b!==M||x!==E)throw new Error(`Uniform variable ${g} mismatch: expect type ${M} with size ${E}, got type ${b} with size ${x} in program "${y.programInfo.name}".`)}}if(Xt("info",()=>`[ProgramManager] run "${e.name}" (key=${w}) with ${p[0]}x${p[1]}x${p[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let g={kernelId:this.currentKernelId,programName:y.programInfo.name,inputTensorViews:t,outputTensorViews:d};this.pendingKernels.push(g),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(g)}return this.programManager.run(y,o,h,p,f),gi(e.name),d}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,r,n){let s=L6.get(e);if(!s)throw new Error(`kernel not implemented: ${e}`);let i={kernelType:e,kernelName:n,kernelEntry:s[0],attributes:[s[1],r]};this.kernels.set(t,i)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let r of t)this.gpuDataManager.release(r.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,r){let n=this.kernels.get(e);if(!n)throw new Error(`kernel not created: ${e}`);let s=n.kernelType,i=n.kernelName,o=n.kernelEntry,a=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${s}] ${i}" is not allowed to be called recursively`);this.currentKernelId=e,a[0]&&(a[1]=a[0](a[1]),a[0]=void 0),Xt("info",()=>`[WebGPU] Start to run kernel "[${s}] ${i}"...`);let l=this.env.debug;this.temporaryData=[];try{return l&&this.device.pushErrorScope("validation"),o(t,a[1]),0}catch(c){return r.push(Promise.resolve(`[WebGPU] Kernel "[${s}] ${i}" failed. ${c}`)),1}finally{l&&r.push(this.device.popErrorScope().then(c=>c?`GPU validation error for kernel "[${s}] ${i}": ${c.message}`:null));for(let c of this.temporaryData)this.gpuDataManager.release(c.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,r,n){let s=this.sessionExternalDataMapping.get(e);s||(s=new Map,this.sessionExternalDataMapping.set(e,s));let i=s.get(t),o=this.gpuDataManager.registerExternalBuffer(r,n,i);return s.set(t,[o,r]),o}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(r=>this.gpuDataManager.unregisterExternalBuffer(r[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,r){return async()=>{let n=await w1(this,e,t);return hE(n.buffer,r)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){var e;this.queryType="none",(((e=this.env.webgpu.profiling)==null?void 0:e.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Xt("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Xt("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Xt("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),r=e.length;this.pendingKernels=[];for(let n=0;n<r;n++){let s=this.getComputePassEncoder(),i=e[n];this.writeTimestamp(this.pendingDispatchNumber*2),s.setPipeline(i.computePipeline),s.setBindGroup(0,i.bindGroup),s.dispatchWorkgroups(...i.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(t[n]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),U6={};Bd(U6,{init:()=>W6});var ug,lR,W6,fce=He(()=>{Et(),ia(),Rt(),ble(),ug=class G6{constructor(t,r,n,s){this.module=t,this.dataType=r,this.data=n,this.dims=s}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=Me.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=Me.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=Me.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let t=Me.size(this.dims);return t===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(Me.size(t)!==Me.size(this.dims))throw new Error("Invalid new shape");return new G6(this.module,this.dataType,this.data,t)}},lR=class{constructor(e,t,r){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let n=e.PTR_SIZE,s=r/e.PTR_SIZE,i=n===4?"i32":"i64";this.opKernelContext=Number(e.getValue(n*s++,i));let o=Number(e.getValue(n*s++,i));this.outputCount=Number(e.getValue(n*s++,i)),this.customDataOffset=Number(e.getValue(n*s++,"*")),this.customDataSize=Number(e.getValue(n*s++,i));let a=[];for(let l=0;l<o;l++){let c=Number(e.getValue(n*s++,i)),u=Number(e.getValue(n*s++,"*")),d=Number(e.getValue(n*s++,i)),h=[];for(let f=0;f<d;f++)h.push(Number(e.getValue(n*s++,i)));a.push(new ug(e,c,u,h))}this.inputs=a}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){var o;let r=((o=t==null?void 0:t.inputs)==null?void 0:o.map(a=>typeof a=="number"?this.inputs[a]:a))??this.inputs,n=(t==null?void 0:t.outputs)??[],s=(a,l,c)=>new ug(this.module,l,this.output(a,c),c),i=(a,l)=>{let c=Zl(a,l);if(!c)throw new Error(`Unsupported data type: ${a}`);let u=c>0?this.backend.gpuDataManager.create(c).id:0;return new ug(this.module,a,u,l)};return this.backend.run(e,r,n,s,i,this.outputCount)}output(e,t){let r=this.module.stackSave();try{let n=this.module.PTR_SIZE,s=n===4?"i32":"i64",i=this.module.stackAlloc((1+t.length)*n);this.module.setValue(i,t.length,s);for(let o=0;o<t.length;o++)this.module.setValue(i+n*(o+1),t[o],s);return this.module._JsepOutput(this.opKernelContext,e,i)}catch(n){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(r)}}},W6=async(e,t,r,n)=>{let s=t.jsepInit;if(!s)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let i=(hce(),Jf(z6)).WebGpuBackend,o=new i;await o.initialize(r,n),s("webgpu",[o,a=>o.alloc(Number(a)),a=>o.free(a),(a,l,c,u=!1)=>{if(u)Xt("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(a)}, dst=${Number(l)}, size=${Number(c)}`),o.memcpy(Number(a),Number(l));else{Xt("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(a)}, gpuDataId=${Number(l)}, size=${Number(c)}`);let d=t.HEAPU8.subarray(Number(a>>>0),Number(a>>>0)+Number(c));o.upload(Number(l),d)}},async(a,l,c)=>{Xt("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${a}, dataOffset=${l}, size=${c}`),await o.download(Number(a),()=>t.HEAPU8.subarray(Number(l)>>>0,Number(l+c)>>>0))},(a,l,c)=>o.createKernel(a,Number(l),c,t.UTF8ToString(t._JsepGetNodeName(Number(l)))),a=>o.releaseKernel(a),(a,l,c,u)=>{Xt("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${c}, kernel=${a}, contextDataOffset=${l}`);let d=new lR(t,o,Number(l));return o.computeKernel(Number(a),d,u)},()=>o.captureBegin(),()=>o.captureEnd(),()=>o.replay()])}else{let i=new t5(r);s("webnn",[i,()=>i.reserveTensorId(),o=>i.releaseTensorId(o),async(o,a,l,c,u)=>i.ensureTensor(o,a,l,c,u),(o,a)=>{i.uploadTensor(o,a)},async(o,a)=>i.downloadTensor(o,a)])}}}),cR,ME,TE,_a,uR,sb,B_,EE,SE,ib,PE,CE,kE,H6=He(()=>{yle(),vle(),Et(),Fc(),oE(),QW(),cR=(e,t)=>{Tr()._OrtInit(e,t)!==0&&gr("Can't initialize onnxruntime.")},ME=async e=>{cR(e.wasm.numThreads,D_(e.logLevel))},TE=async(e,t)=>{var r,n;(n=(r=Tr()).asyncInit)==null||n.call(r);{let s=(fce(),Jf(U6)).init;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let i=e.webgpu.adapter;if(i){if(typeof i.limits!="object"||typeof i.features!="object"||typeof i.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let o=e.webgpu.powerPreference;if(o!==void 0&&o!=="low-power"&&o!=="high-performance")throw new Error(`Invalid powerPreference setting: "${o}"`);let a=e.webgpu.forceFallbackAdapter;if(a!==void 0&&typeof a!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${a}"`);if(i=await navigator.gpu.requestAdapter({powerPreference:o,forceFallbackAdapter:a}),!i)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await s("webgpu",Tr(),e,i)}if(t==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await s("webnn",Tr(),e)}}},_a=new Map,uR=e=>{let t=Tr(),r=t.stackSave();try{let n=t.PTR_SIZE,s=t.stackAlloc(2*n);t._OrtGetInputOutputCount(e,s,s+n)!==0&&gr("Can't get session input/output count.");let i=n===4?"i32":"i64";return[Number(t.getValue(s,i)),Number(t.getValue(s+n,i))]}finally{t.stackRestore(r)}},sb=(e,t)=>{let r=Tr(),n=r.stackSave(),s=0;try{let i=r.PTR_SIZE,o=r.stackAlloc(2*i);r._OrtGetInputOutputMetadata(e,t,o,o+i)!==0&&gr("Can't get session input/output metadata.");let a=Number(r.getValue(o,"*"));s=Number(r.getValue(o+i,"*"));let l=r.HEAP32[s/4];if(l===0)return[a,0];let c=r.HEAPU32[s/4+1],u=[];for(let d=0;d<c;d++){let h=Number(r.getValue(s+8+d*i,"*"));u.push(h!==0?r.UTF8ToString(h):Number(r.getValue(s+8+(d+c)*i,"*")))}return[a,l,u]}finally{r.stackRestore(n),s!==0&&r._OrtFree(s)}},B_=e=>{let t=Tr(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},EE=async(e,t)=>{var d,h,f,p;let r,n,s=Tr();Array.isArray(e)?[r,n]=e:e.buffer===s.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=B_(e);let i=0,o=0,a=0,l=[],c=[],u=[];try{if([o,l]=await qW(t),(t==null?void 0:t.externalData)&&s.mountExternalData){let P=[];for(let I of t.externalData){let O=typeof I=="string"?I:I.path;P.push(uE(typeof I=="string"?I:I.data).then(V=>{s.mountExternalData(O,V)}))}await Promise.all(P)}for(let P of(t==null?void 0:t.executionProviders)??[])if((typeof P=="string"?P:P.name)==="webnn"){if(s.shouldTransferToMLTensor=!1,typeof P!="string"){let I=P,O=I==null?void 0:I.context,V=I==null?void 0:I.gpuDevice,U=I==null?void 0:I.deviceType,B=I==null?void 0:I.powerPreference;O?s.currentContext=O:V?s.currentContext=await s.webnnCreateMLContext(V):s.currentContext=await s.webnnCreateMLContext({deviceType:U,powerPreference:B})}else s.currentContext=await s.webnnCreateMLContext();break}i=await s._OrtCreateSession(r,n,o),(d=s.webgpuOnCreateSession)==null||d.call(s,i),i===0&&gr("Can't create a session."),(h=s.jsepOnCreateSession)==null||h.call(s),s.currentContext&&(s.webnnRegisterMLContext(i,s.currentContext),s.currentContext=void 0,s.shouldTransferToMLTensor=!0);let[_,w]=uR(i),y=!!(t!=null&&t.enableGraphCapture),g=[],v=[],b=[],x=[],M=[];for(let P=0;P<_;P++){let[I,O,V]=sb(i,P);I===0&&gr("Can't get an input name."),c.push(I);let U=s.UTF8ToString(I);g.push(U),b.push(O===0?{name:U,isTensor:!1}:{name:U,isTensor:!0,type:Go(O),shape:V})}for(let P=0;P<w;P++){let[I,O,V]=sb(i,P+_);I===0&&gr("Can't get an output name."),u.push(I);let U=s.UTF8ToString(I);v.push(U),x.push(O===0?{name:U,isTensor:!1}:{name:U,isTensor:!0,type:Go(O),shape:V});{if(y&&(t==null?void 0:t.preferredOutputLocation)===void 0){M.push("gpu-buffer");continue}let B=typeof(t==null?void 0:t.preferredOutputLocation)=="string"?t.preferredOutputLocation:((f=t==null?void 0:t.preferredOutputLocation)==null?void 0:f[U])??"cpu";if(B!=="cpu"&&B!=="cpu-pinned"&&B!=="gpu-buffer"&&B!=="ml-tensor")throw new Error(`Not supported preferred output location: ${B}.`);if(y&&B!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${B}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);M.push(B)}}let E=null;return M.some(P=>P==="gpu-buffer"||P==="ml-tensor")&&(a=s._OrtCreateBinding(i),a===0&&gr("Can't create IO binding."),E={handle:a,outputPreferredLocations:M,outputPreferredLocationsEncoded:M.map(P=>y1(P))}),_a.set(i,[i,c,u,E,y,!1]),[i,g,v,b,x]}catch(_){throw c.forEach(w=>s._OrtFree(w)),u.forEach(w=>s._OrtFree(w)),a!==0&&s._OrtReleaseBinding(a)!==0&&gr("Can't release IO binding."),i!==0&&s._OrtReleaseSession(i)!==0&&gr("Can't release session."),_}finally{s._free(r),o!==0&&s._OrtReleaseSessionOptions(o)!==0&&gr("Can't release session options."),l.forEach(_=>s._free(_)),(p=s.unmountExternalData)==null||p.call(s)}},SE=e=>{var l,c,u;let t=Tr(),r=_a.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,s,i,o,a]=r;o&&(a&&t._OrtClearBoundOutputs(o.handle)!==0&&gr("Can't clear bound outputs."),t._OrtReleaseBinding(o.handle)!==0&&gr("Can't release IO binding.")),(l=t.jsepOnReleaseSession)==null||l.call(t,e),(c=t.webnnOnReleaseSession)==null||c.call(t,e),(u=t.webgpuOnReleaseSession)==null||u.call(t,e),s.forEach(d=>t._OrtFree(d)),i.forEach(d=>t._OrtFree(d)),t._OrtReleaseSession(n)!==0&&gr("Can't release session."),_a.delete(e)},ib=async(e,t,r,n,s,i,o=!1)=>{if(!e){t.push(0);return}let a=Tr(),l=a.PTR_SIZE,c=e[0],u=e[1],d=e[3],h=d,f,p;if(c==="string"&&(d==="gpu-buffer"||d==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(o&&d!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(d==="gpu-buffer"){let y=e[2].gpuBuffer;p=Zl(yu(c),u);{let g=a.jsepRegisterBuffer;if(!g)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');f=g(n,i,y,p)}}else if(d==="ml-tensor"){let y=e[2].mlTensor;p=Zl(yu(c),u);let g=a.webnnRegisterMLTensor;if(!g)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');f=g(n,y,yu(c),u)}else{let y=e[2];if(Array.isArray(y)){p=l*y.length,f=a._malloc(p),r.push(f);for(let g=0;g<y.length;g++){if(typeof y[g]!="string")throw new TypeError(`tensor data at index ${g} is not a string`);a.setValue(f+g*l,Vi(y[g],r),"*")}}else{let g=a.webnnIsGraphInput;if(c!=="string"&&g){let v=a.UTF8ToString(s);if(g(n,v)){let b=yu(c);p=Zl(b,u),h="ml-tensor";let x=a.webnnCreateTemporaryTensor,M=a.webnnUploadTensor;if(!x||!M)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let E=await x(n,b,u);M(E,new Uint8Array(y.buffer,y.byteOffset,y.byteLength)),f=E}else p=y.byteLength,f=a._malloc(p),r.push(f),a.HEAPU8.set(new Uint8Array(y.buffer,y.byteOffset,p),f)}else p=y.byteLength,f=a._malloc(p),r.push(f),a.HEAPU8.set(new Uint8Array(y.buffer,y.byteOffset,p),f)}}let _=a.stackSave(),w=a.stackAlloc(4*u.length);try{u.forEach((g,v)=>a.setValue(w+v*l,g,l===4?"i32":"i64"));let y=a._OrtCreateTensor(yu(c),f,p,w,u.length,y1(h));y===0&&gr(`Can't create tensor for input/output. session=${n}, index=${i}.`),t.push(y)}finally{a.stackRestore(_)}},PE=async(e,t,r,n,s,i)=>{var V,U,B,Y;let o=Tr(),a=o.PTR_SIZE,l=_a.get(e);if(!l)throw new Error(`cannot run inference. invalid session id: ${e}`);let c=l[0],u=l[1],d=l[2],h=l[3],f=l[4],p=l[5],_=t.length,w=n.length,y=0,g=[],v=[],b=[],x=[],M=o.stackSave(),E=o.stackAlloc(_*a),P=o.stackAlloc(_*a),I=o.stackAlloc(w*a),O=o.stackAlloc(w*a);try{[y,g]=KW(i);for(let G=0;G<_;G++)await ib(r[G],v,x,e,u[t[G]],t[G],f);for(let G=0;G<w;G++)await ib(s[G],b,x,e,d[n[G]],_+n[G],f);for(let G=0;G<_;G++)o.setValue(E+G*a,v[G],"*"),o.setValue(P+G*a,u[t[G]],"*");for(let G=0;G<w;G++)o.setValue(I+G*a,b[G],"*"),o.setValue(O+G*a,d[n[G]],"*");if(h&&!p){let{handle:G,outputPreferredLocations:R,outputPreferredLocationsEncoded:te}=h;if(u.length!==_)throw new Error(`input count from feeds (${_}) is expected to be always equal to model's input count (${u.length}).`);for(let re=0;re<_;re++){let L=t[re];await o._OrtBindInput(G,u[L],v[re])!==0&&gr(`Can't bind input[${re}] for session=${e}.`)}for(let re=0;re<w;re++){let L=n[re];(V=s[re])!=null&&V[3]?o._OrtBindOutput(G,d[L],b[re],0)!==0&&gr(`Can't bind pre-allocated output[${re}] for session=${e}.`):o._OrtBindOutput(G,d[L],0,te[L])!==0&&gr(`Can't bind output[${re}] to ${R[re]} for session=${e}.`)}_a.set(e,[c,u,d,h,f,!0])}(U=o.jsepOnRunStart)==null||U.call(o,c),(B=o.webnnOnRunStart)==null||B.call(o,c);let K;h?K=await o._OrtRunWithBinding(c,h.handle,w,I,y):K=await o._OrtRun(c,P,E,_,O,w,I,y),K!==0&&gr("failed to call OrtRun().");let X=[];for(let G=0;G<w;G++){let R=Number(o.getValue(I+G*a,"*"));if(R===b[G]){X.push(s[G]);continue}let te=o.stackSave(),re=o.stackAlloc(4*a),L=!1,j,q=0;try{o._OrtGetTensorData(R,re,re+a,re+2*a,re+3*a)!==0&&gr(`Can't access output tensor data on index ${G}.`);let ne=a===4?"i32":"i64",me=Number(o.getValue(re,ne));q=o.getValue(re+a,"*");let ae=o.getValue(re+a*2,"*"),fe=Number(o.getValue(re+a*3,ne)),Pe=[];for(let Q=0;Q<fe;Q++)Pe.push(Number(o.getValue(ae+Q*a,ne)));o._OrtFree(ae)!==0&&gr("Can't free memory for tensor dims.");let Ne=Pe.reduce((Q,se)=>Q*se,1);j=Go(me);let de=h==null?void 0:h.outputPreferredLocations[n[G]];if(j==="string"){if(de==="gpu-buffer"||de==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let Q=[];for(let se=0;se<Ne;se++){let J=o.getValue(q+se*a,"*"),be=o.getValue(q+(se+1)*a,"*"),xe=se===Ne-1?void 0:be-J;Q.push(o.UTF8ToString(J,xe))}X.push([j,Pe,Q,"cpu"])}else if(de==="gpu-buffer"&&Ne>0){let Q=o.jsepGetBuffer;if(!Q)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let se=Q(q),J=Zl(me,Ne);if(J===void 0||!lE(j))throw new Error(`Unsupported data type: ${j}`);L=!0,X.push([j,Pe,{gpuBuffer:se,download:o.jsepCreateDownloader(se,J,j),dispose:()=>{o._OrtReleaseTensor(R)!==0&&gr("Can't release tensor.")}},"gpu-buffer"])}else if(de==="ml-tensor"&&Ne>0){let Q=o.webnnEnsureTensor,se=o.webnnIsInt64Supported;if(!Q||!se)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Zl(me,Ne)===void 0||!cE(j))throw new Error(`Unsupported data type: ${j}`);if(j==="int64"&&!se(e))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let J=await Q(e,q,me,Pe,!1);L=!0,X.push([j,Pe,{mlTensor:J,download:o.webnnCreateMLTensorDownloader(q,j),dispose:()=>{o.webnnReleaseTensorId(q),o._OrtReleaseTensor(R)}},"ml-tensor"])}else{let Q=aE(j),se=new Q(Ne);new Uint8Array(se.buffer,se.byteOffset,se.byteLength).set(o.HEAPU8.subarray(q,q+se.byteLength)),X.push([j,Pe,se,"cpu"])}}finally{o.stackRestore(te),j==="string"&&q&&o._free(q),L||o._OrtReleaseTensor(R),(Y=o.webnnOnRunEnd)==null||Y.call(o,c)}}return h&&!f&&(o._OrtClearBoundOutputs(h.handle)!==0&&gr("Can't clear bound outputs."),_a.set(e,[c,u,d,h,f,!1])),X}finally{o.stackRestore(M),v.forEach(K=>o._OrtReleaseTensor(K)),b.forEach(K=>o._OrtReleaseTensor(K)),x.forEach(K=>o._free(K)),y!==0&&o._OrtReleaseRunOptions(y),g.forEach(K=>o._free(K))}},CE=e=>{let t=Tr(),r=_a.get(e);if(!r)throw new Error("invalid session id");let n=r[0],s=t._OrtEndProfiling(n);s===0&&gr("Can't get an profile file name."),t._OrtFree(s)},kE=e=>{let t=[];for(let r of e){let n=r[2];!Array.isArray(n)&&"buffer"in n&&t.push(n.buffer)}return t}}),ya,vs,hu,Lh,Bh,dg,ob,hg,Vl,Ul,dR,K6,q6,Q6,Y6,X6,J6,Z6,eG=He(()=>{so(),H6(),Fc(),sE(),ya=()=>!!Pr.wasm.proxy&&typeof document<"u",hu=!1,Lh=!1,Bh=!1,hg=new Map,Vl=(e,t)=>{let r=hg.get(e);r?r.push(t):hg.set(e,[t])},Ul=()=>{if(hu||!Lh||Bh||!vs)throw new Error("worker not ready")},dR=e=>{switch(e.data.type){case"init-wasm":hu=!1,e.data.err?(Bh=!0,ob[1](e.data.err)):(Lh=!0,ob[0]()),dg&&(URL.revokeObjectURL(dg),dg=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=hg.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},K6=async()=>{if(!Lh){if(hu)throw new Error("multiple calls to 'initWasm()' detected.");if(Bh)throw new Error("previous call to 'initWasm()' failed.");if(hu=!0,ya())return new Promise((e,t)=>{vs==null||vs.terminate(),GW().then(([r,n])=>{try{vs=n,vs.onerror=i=>t(i),vs.onmessage=dR,ob=[e,t];let s={type:"init-wasm",in:Pr};!s.in.wasm.wasmPaths&&(r||_1)&&(s.in.wasm.wasmPaths={wasm:new URL("/assets/ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href}),vs.postMessage(s),dg=r}catch(s){t(s)}},t)});try{await iE(Pr.wasm),await ME(Pr),Lh=!0}catch(e){throw Bh=!0,e}finally{hu=!1}}},q6=async e=>{if(ya())return Ul(),new Promise((t,r)=>{Vl("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:Pr}};vs.postMessage(n)});await TE(Pr,e)},Q6=async e=>ya()?(Ul(),new Promise((t,r)=>{Vl("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};vs.postMessage(n,[e.buffer])})):B_(e),Y6=async(e,t)=>{if(ya()){if(t!=null&&t.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Ul(),new Promise((r,n)=>{Vl("create",[r,n]);let s={type:"create",in:{model:e,options:{...t}}},i=[];e instanceof Uint8Array&&i.push(e.buffer),vs.postMessage(s,i)})}else return EE(e,t)},X6=async e=>{if(ya())return Ul(),new Promise((t,r)=>{Vl("release",[t,r]);let n={type:"release",in:e};vs.postMessage(n)});SE(e)},J6=async(e,t,r,n,s,i)=>{if(ya()){if(r.some(o=>o[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(s.some(o=>o))throw new Error("pre-allocated output tensor is not supported for proxy.");return Ul(),new Promise((o,a)=>{Vl("run",[o,a]);let l=r,c={type:"run",in:{sessionId:e,inputIndices:t,inputs:l,outputIndices:n,options:i}};vs.postMessage(c,kE(l))})}else return PE(e,t,r,n,s,i)},Z6=async e=>{if(ya())return Ul(),new Promise((t,r)=>{Vl("end-profiling",[t,r]);let n={type:"end-profiling",in:e};vs.postMessage(n)});CE(e)}}),ab,hR,tG,pce=He(()=>{so(),eG(),Et(),nE(),QW(),ab=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},hR=e=>{switch(e[3]){case"cpu":return new Ui(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!lE(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:s}=e[2];return Ui.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:s})}case"ml-tensor":{let t=e[0];if(!cE(t))throw new Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:r,download:n,dispose:s}=e[2];return Ui.fromMLTensor(r,{dataType:t,dims:e[1],download:n,dispose:s})}default:throw new Error(`invalid data location: ${e[3]}`)}},tG=class{async fetchModelAndCopyToWasmMemory(e){return Q6(await uE(e))}async loadModel(e,t){eo();let r;typeof e=="string"?r=await this.fetchModelAndCopyToWasmMemory(e):r=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await Y6(r,t),gi()}async dispose(){return X6(this.sessionId)}async run(e,t,r){eo();let n=[],s=[];Object.entries(e).forEach(d=>{let h=d[0],f=d[1],p=this.inputNames.indexOf(h);if(p===-1)throw new Error(`invalid input '${h}'`);n.push(f),s.push(p)});let i=[],o=[];Object.entries(t).forEach(d=>{let h=d[0],f=d[1],p=this.outputNames.indexOf(h);if(p===-1)throw new Error(`invalid output '${h}'`);i.push(f),o.push(p)});let a=n.map((d,h)=>ab(d,()=>`input "${this.inputNames[s[h]]}"`)),l=i.map((d,h)=>d?ab(d,()=>`output "${this.outputNames[o[h]]}"`):null),c=await J6(this.sessionId,s,a,o,l,r),u={};for(let d=0;d<c.length;d++)u[this.outputNames[o[d]]]=i[d]??hR(c[d]);return gi(),u}startProfiling(){}endProfiling(){Z6(this.sessionId)}}}),rG={};Bd(rG,{OnnxruntimeWebAssemblyBackend:()=>I1,initializeFlags:()=>$1,wasmBackend:()=>nG});var $1,I1,nG,mce=He(()=>{so(),eG(),pce(),$1=()=>{(typeof Pr.wasm.initTimeout!="number"||Pr.wasm.initTimeout<0)&&(Pr.wasm.initTimeout=0);let e=Pr.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),Pr.wasm.simd=!1),typeof Pr.wasm.proxy!="boolean"&&(Pr.wasm.proxy=!1),typeof Pr.wasm.trace!="boolean"&&(Pr.wasm.trace=!1),typeof Pr.wasm.numThreads!="number"||!Number.isInteger(Pr.wasm.numThreads)||Pr.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)Pr.wasm.numThreads=1;else{let t=typeof navigator>"u"?tle("node:os").cpus().length:navigator.hardwareConcurrency;Pr.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},I1=class{async init(e){$1(),await K6(),await q6(e)}async createInferenceSessionHandler(e,t){let r=new tG;return await r.loadModel(e,t),r}},nG=new I1});so();so();so();var gce="1.22.0-dev.20250409-89f8206ba4",_ce=LW;{let e=(mce(),Jf(rG)).wasmBackend;oc("webgpu",e,5),oc("webnn",e,5),oc("cpu",e,10),oc("wasm",e,10)}Object.defineProperty(Pr.versions,"web",{value:gce,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yce=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return rE},get TRACE(){return Zf},get TRACE_FUNC_BEGIN(){return eo},get TRACE_FUNC_END(){return gi},get Tensor(){return Ui},default:_ce,get env(){return Pr},get registerBackend(){return oc}},Symbol.toStringTag,{value:"Module"}));var Lo={},vce={"onnxruntime-common":e=>{e.exports=Xae},"onnxruntime-web":e=>{e.exports=yce},"?2ce3":()=>{},"?7992":()=>{},"?5af5":()=>{},"?2b25":()=>{},"?db59":()=>{},"?383f":()=>{},"?fa4b":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(e,t,r)=>{r.r(t),r.d(t,{Environment:()=>Ue,Interpreter:()=>Ke,Template:()=>Kn,parse:()=>q,tokenize:()=>d});var n=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",BooleanLiteral:"BooleanLiteral",NullLiteral:"NullLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Set:"Set",If:"If",For:"For",In:"In",Is:"Is",NotIn:"NotIn",Else:"Else",EndSet:"EndSet",EndIf:"EndIf",ElseIf:"ElseIf",EndFor:"EndFor",And:"And",Or:"Or",Not:"UnaryOperator",Macro:"Macro",EndMacro:"EndMacro",Break:"Break",Continue:"Continue"}),s=Object.freeze({set:n.Set,for:n.For,in:n.In,is:n.Is,if:n.If,else:n.Else,endset:n.EndSet,endif:n.EndIf,elif:n.ElseIf,endfor:n.EndFor,and:n.And,or:n.Or,not:n.Not,"not in":n.NotIn,macro:n.Macro,endmacro:n.EndMacro,break:n.Break,continue:n.Continue,true:n.BooleanLiteral,false:n.BooleanLiteral,none:n.NullLiteral,True:n.BooleanLiteral,False:n.BooleanLiteral,None:n.NullLiteral}),i=class{constructor(F,ce){this.value=F,this.type=ce}};function o(F){return/\w/.test(F)}function a(F){return/[0-9]/.test(F)}var l=[["{%",n.OpenStatement],["%}",n.CloseStatement],["{{",n.OpenExpression],["}}",n.CloseExpression],["(",n.OpenParen],[")",n.CloseParen],["{",n.OpenCurlyBracket],["}",n.CloseCurlyBracket],["[",n.OpenSquareBracket],["]",n.CloseSquareBracket],[",",n.Comma],[".",n.Dot],[":",n.Colon],["|",n.Pipe],["<=",n.ComparisonBinaryOperator],[">=",n.ComparisonBinaryOperator],["==",n.ComparisonBinaryOperator],["!=",n.ComparisonBinaryOperator],["<",n.ComparisonBinaryOperator],[">",n.ComparisonBinaryOperator],["+",n.AdditiveBinaryOperator],["-",n.AdditiveBinaryOperator],["*",n.MultiplicativeBinaryOperator],["/",n.MultiplicativeBinaryOperator],["%",n.MultiplicativeBinaryOperator],["=",n.Equals]],c=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function u(F,ce={}){return F.endsWith(`
`)&&(F=F.slice(0,-1)),F=F.replace(/{#.*?#}/gs,"{##}"),ce.lstrip_blocks&&(F=F.replace(/^[ \t]*({[#%])/gm,"$1")),ce.trim_blocks&&(F=F.replace(/([#%]})\n/g,"$1")),F.replace(/{##}/g,"").replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{")}function d(F,ce={}){var Se,jt,er;const W=[],le=u(F,ce);let ye=0;const Re=bt=>{let mt="";for(;bt(le[ye]);){if(le[ye]==="\\"){if(++ye,ye>=le.length)throw new SyntaxError("Unexpected end of input");const ut=le[ye++],sr=c.get(ut);if(sr===void 0)throw new SyntaxError(`Unexpected escaped character: ${ut}`);mt+=sr;continue}if(mt+=le[ye++],ye>=le.length)throw new SyntaxError("Unexpected end of input")}return mt};e:for(;ye<le.length;){const bt=(Se=W.at(-1))==null?void 0:Se.type;if(bt===void 0||bt===n.CloseStatement||bt===n.CloseExpression){let ut="";for(;ye<le.length&&!(le[ye]==="{"&&(le[ye+1]==="%"||le[ye+1]==="{"));)ut+=le[ye++];if(ut.length>0){W.push(new i(ut,n.Text));continue}}Re(ut=>/\s/.test(ut));const mt=le[ye];if(mt==="-"||mt==="+"){const ut=(jt=W.at(-1))==null?void 0:jt.type;if(ut===n.Text||ut===void 0)throw new SyntaxError(`Unexpected character: ${mt}`);switch(ut){case n.Identifier:case n.NumericLiteral:case n.BooleanLiteral:case n.NullLiteral:case n.StringLiteral:case n.CloseParen:case n.CloseSquareBracket:break;default:{++ye;const sr=Re(a);W.push(new i(`${mt}${sr}`,sr.length>0?n.NumericLiteral:n.UnaryOperator));continue}}}for(const[ut,sr]of l)if(le.slice(ye,ye+ut.length)===ut){W.push(new i(ut,sr)),ye+=ut.length;continue e}if(mt==="'"||mt==='"'){++ye;const ut=Re(sr=>sr!==mt);W.push(new i(ut,n.StringLiteral)),++ye;continue}if(a(mt)){const ut=Re(a);W.push(new i(ut,n.NumericLiteral));continue}if(o(mt)){const ut=Re(o),sr=Object.hasOwn(s,ut)?s[ut]:n.Identifier;sr===n.In&&((er=W.at(-1))==null?void 0:er.type)===n.Not?(W.pop(),W.push(new i("not in",n.NotIn))):W.push(new i(ut,sr));continue}throw new SyntaxError(`Unexpected character: ${mt}`)}return W}var h=class{constructor(){oe(this,"type","Statement")}},f=class extends h{constructor(ce){super();oe(this,"type","Program");this.body=ce}},p=class extends h{constructor(ce,W,le){super();oe(this,"type","If");this.test=ce,this.body=W,this.alternate=le}},_=class extends h{constructor(ce,W,le,ye){super();oe(this,"type","For");this.loopvar=ce,this.iterable=W,this.body=le,this.defaultBlock=ye}},w=class extends h{constructor(){super(...arguments);oe(this,"type","Break")}},y=class extends h{constructor(){super(...arguments);oe(this,"type","Continue")}},g=class extends h{constructor(ce,W,le){super();oe(this,"type","Set");this.assignee=ce,this.value=W,this.body=le}},v=class extends h{constructor(ce,W,le){super();oe(this,"type","Macro");this.name=ce,this.args=W,this.body=le}},b=class extends h{constructor(){super(...arguments);oe(this,"type","Expression")}},x=class extends b{constructor(ce,W,le){super();oe(this,"type","MemberExpression");this.object=ce,this.property=W,this.computed=le}},M=class extends b{constructor(ce,W){super();oe(this,"type","CallExpression");this.callee=ce,this.args=W}},E=class extends b{constructor(ce){super();oe(this,"type","Identifier");this.value=ce}},P=class extends b{constructor(ce){super();oe(this,"type","Literal");this.value=ce}},I=class extends P{constructor(){super(...arguments);oe(this,"type","NumericLiteral")}},O=class extends P{constructor(){super(...arguments);oe(this,"type","StringLiteral")}},V=class extends P{constructor(){super(...arguments);oe(this,"type","BooleanLiteral")}},U=class extends P{constructor(){super(...arguments);oe(this,"type","NullLiteral")}},B=class extends P{constructor(){super(...arguments);oe(this,"type","ArrayLiteral")}},Y=class extends P{constructor(){super(...arguments);oe(this,"type","TupleLiteral")}},K=class extends P{constructor(){super(...arguments);oe(this,"type","ObjectLiteral")}},X=class extends b{constructor(ce,W,le){super();oe(this,"type","BinaryExpression");this.operator=ce,this.left=W,this.right=le}},G=class extends b{constructor(ce,W){super();oe(this,"type","FilterExpression");this.operand=ce,this.filter=W}},R=class extends b{constructor(ce,W){super();oe(this,"type","SelectExpression");this.iterable=ce,this.test=W}},te=class extends b{constructor(ce,W,le){super();oe(this,"type","TestExpression");this.operand=ce,this.negate=W,this.test=le}},re=class extends b{constructor(ce,W){super();oe(this,"type","UnaryExpression");this.operator=ce,this.argument=W}},L=class extends b{constructor(ce=void 0,W=void 0,le=void 0){super();oe(this,"type","SliceExpression");this.start=ce,this.stop=W,this.step=le}},j=class extends b{constructor(ce,W){super();oe(this,"type","KeywordArgumentExpression");this.key=ce,this.value=W}};function q(F){const ce=new f([]);let W=0;function le(Fe,nt){const pt=F[W++];if(!pt||pt.type!==Fe)throw new Error(`Parser Error: ${nt}. ${pt.type} !== ${Fe}.`);return pt}function ye(){switch(F[W].type){case n.Text:return jt();case n.OpenStatement:return er();case n.OpenExpression:return bt();default:throw new SyntaxError(`Unexpected token type: ${F[W].type}`)}}function Re(...Fe){return W+Fe.length<=F.length&&Fe.some((nt,pt)=>nt!==F[W+pt].type)}function Se(...Fe){return W+Fe.length<=F.length&&Fe.every((nt,pt)=>nt===F[W+pt].type)}function jt(){return new O(le(n.Text,"Expected text token").value)}function er(){le(n.OpenStatement,"Expected opening statement token");let Fe;switch(F[W].type){case n.Set:++W,Fe=mt(),le(n.CloseStatement,"Expected closing statement token");break;case n.If:++W,Fe=ut(),le(n.OpenStatement,"Expected {% token"),le(n.EndIf,"Expected endif token"),le(n.CloseStatement,"Expected %} token");break;case n.Macro:++W,Fe=sr(),le(n.OpenStatement,"Expected {% token"),le(n.EndMacro,"Expected endmacro token"),le(n.CloseStatement,"Expected %} token");break;case n.For:++W,Fe=fn(),le(n.OpenStatement,"Expected {% token"),le(n.EndFor,"Expected endfor token"),le(n.CloseStatement,"Expected %} token");break;case n.Break:++W,le(n.CloseStatement,"Expected closing statement token"),Fe=new w;break;case n.Continue:++W,le(n.CloseStatement,"Expected closing statement token"),Fe=new y;break;default:throw new SyntaxError(`Unknown statement type: ${F[W].type}`)}return Fe}function bt(){le(n.OpenExpression,"Expected opening expression token");const Fe=Er();return le(n.CloseExpression,"Expected closing expression token"),Fe}function mt(){var nt,pt;const Fe=Er();if(Se(n.Equals)){++W;const ir=Er();return new g(Fe,ir,[])}else{const ir=[];for(le(n.CloseStatement,"Expected %} token");!(((nt=F[W])==null?void 0:nt.type)===n.OpenStatement&&((pt=F[W+1])==null?void 0:pt.type)===n.EndSet);){const Zs=ye();ir.push(Zs)}return le(n.OpenStatement,"Expected {% token"),le(n.EndSet,"Expected endset token"),new g(Fe,null,ir)}}function ut(){var ir,Zs,ei,Zr,ti,en,an,ri;const Fe=Er();le(n.CloseStatement,"Expected closing statement token");const nt=[],pt=[];for(;!(((ir=F[W])==null?void 0:ir.type)===n.OpenStatement&&(((Zs=F[W+1])==null?void 0:Zs.type)===n.ElseIf||((ei=F[W+1])==null?void 0:ei.type)===n.Else||((Zr=F[W+1])==null?void 0:Zr.type)===n.EndIf));)nt.push(ye());if(((ti=F[W])==null?void 0:ti.type)===n.OpenStatement&&((en=F[W+1])==null?void 0:en.type)!==n.EndIf)if(++W,Se(n.ElseIf))le(n.ElseIf,"Expected elseif token"),pt.push(ut());else for(le(n.Else,"Expected else token"),le(n.CloseStatement,"Expected closing statement token");!(((an=F[W])==null?void 0:an.type)===n.OpenStatement&&((ri=F[W+1])==null?void 0:ri.type)===n.EndIf);)pt.push(ye());return new p(Fe,nt,pt)}function sr(){const Fe=qn();if(Fe.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const nt=bi();le(n.CloseStatement,"Expected closing statement token");const pt=[];for(;Re(n.OpenStatement,n.EndMacro);)pt.push(ye());return new v(Fe,nt,pt)}function wr(Fe=!1){const nt=Fe?qn:Er,pt=[nt()],ir=Se(n.Comma);for(;ir&&(++W,pt.push(nt()),!!Se(n.Comma)););return ir?new Y(pt):pt[0]}function fn(){const Fe=wr(!0);if(!(Fe instanceof E||Fe instanceof Y))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${Fe.type} instead`);le(n.In,"Expected `in` keyword following loop variable");const nt=Er();le(n.CloseStatement,"Expected closing statement token");const pt=[];for(;Re(n.OpenStatement,n.EndFor)&&Re(n.OpenStatement,n.Else);)pt.push(ye());const ir=[];if(Se(n.OpenStatement,n.Else))for(++W,++W,le(n.CloseStatement,"Expected closing statement token");Re(n.OpenStatement,n.EndFor);)ir.push(ye());return new _(Fe,nt,pt,ir)}function Er(){return Ln()}function Ln(){const Fe=Xs();if(Se(n.If)){++W;const nt=Xs();if(Se(n.Else)){++W;const pt=Xs();return new p(nt,[Fe],[pt])}else return new R(Fe,nt)}return Fe}function Xs(){let Fe=wi();for(;Se(n.Or);){const nt=F[W];++W;const pt=wi();Fe=new X(nt,Fe,pt)}return Fe}function wi(){let Fe=Js();for(;Se(n.And);){const nt=F[W];++W;const pt=Js();Fe=new X(nt,Fe,pt)}return Fe}function Js(){let Fe;for(;Se(n.Not);){const nt=F[W];++W;const pt=Js();Fe=new re(nt,pt)}return Fe??io()}function io(){let Fe=ss();for(;Se(n.ComparisonBinaryOperator)||Se(n.In)||Se(n.NotIn);){const nt=F[W];++W;const pt=ss();Fe=new X(nt,Fe,pt)}return Fe}function ss(){let Fe=co();for(;Se(n.AdditiveBinaryOperator);){const nt=F[W];++W;const pt=co();Fe=new X(nt,Fe,pt)}return Fe}function oo(){const Fe=Wr(qn());return Se(n.OpenParen)?ks(Fe):Fe}function ks(Fe){let nt=new M(Fe,bi());return nt=Wr(nt),Se(n.OpenParen)&&(nt=ks(nt)),nt}function bi(){le(n.OpenParen,"Expected opening parenthesis for arguments list");const Fe=ao();return le(n.CloseParen,"Expected closing parenthesis for arguments list"),Fe}function ao(){const Fe=[];for(;!Se(n.CloseParen);){let nt=Er();if(Se(n.Equals)){if(++W,!(nt instanceof E))throw new SyntaxError("Expected identifier for keyword argument");const pt=Er();nt=new j(nt,pt)}Fe.push(nt),Se(n.Comma)&&++W}return Fe}function lo(){const Fe=[];let nt=!1;for(;!Se(n.CloseSquareBracket);)Se(n.Colon)?(Fe.push(void 0),++W,nt=!0):(Fe.push(Er()),Se(n.Colon)&&(++W,nt=!0));if(Fe.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(nt){if(Fe.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new L(...Fe)}return Fe[0]}function Wr(Fe){for(;Se(n.Dot)||Se(n.OpenSquareBracket);){const nt=F[W];++W;let pt;const ir=nt.type!==n.Dot;if(ir)pt=lo(),le(n.CloseSquareBracket,"Expected closing square bracket");else if(pt=qn(),pt.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");Fe=new x(Fe,pt,ir)}return Fe}function co(){let Fe=xn();for(;Se(n.MultiplicativeBinaryOperator);){const nt=F[W];++W;const pt=xn();Fe=new X(nt,Fe,pt)}return Fe}function xn(){let Fe=xi();for(;Se(n.Is);){++W;const nt=Se(n.Not);nt&&++W;let pt=qn();if(pt instanceof V?pt=new E(pt.value.toString()):pt instanceof U&&(pt=new E("none")),!(pt instanceof E))throw new SyntaxError("Expected identifier for the test");Fe=new te(Fe,nt,pt)}return Fe}function xi(){let Fe=oo();for(;Se(n.Pipe);){++W;let nt=qn();if(!(nt instanceof E))throw new SyntaxError("Expected identifier for the filter");Se(n.OpenParen)&&(nt=ks(nt)),Fe=new G(Fe,nt)}return Fe}function qn(){const Fe=F[W];switch(Fe.type){case n.NumericLiteral:return++W,new I(Number(Fe.value));case n.StringLiteral:return++W,new O(Fe.value);case n.BooleanLiteral:return++W,new V(Fe.value.toLowerCase()==="true");case n.NullLiteral:return++W,new U(null);case n.Identifier:return++W,new E(Fe.value);case n.OpenParen:{++W;const nt=wr();if(F[W].type!==n.CloseParen)throw new SyntaxError(`Expected closing parenthesis, got ${F[W].type} instead`);return++W,nt}case n.OpenSquareBracket:{++W;const nt=[];for(;!Se(n.CloseSquareBracket);)nt.push(Er()),Se(n.Comma)&&++W;return++W,new B(nt)}case n.OpenCurlyBracket:{++W;const nt=new Map;for(;!Se(n.CloseCurlyBracket);){const pt=Er();le(n.Colon,"Expected colon between key and value in object literal");const ir=Er();nt.set(pt,ir),Se(n.Comma)&&++W}return++W,new K(nt)}default:throw new SyntaxError(`Unexpected token: ${Fe.type}`)}}for(;W<F.length;)ce.body.push(ye());return ce}function ne(F,ce,W=1){ce===void 0&&(ce=F,F=0);const le=[];for(let ye=F;ye<ce;ye+=W)le.push(ye);return le}function me(F,ce,W,le=1){const ye=Math.sign(le);ye>=0?(ce=(ce??(ce=0))<0?Math.max(F.length+ce,0):Math.min(ce,F.length),W=(W??(W=F.length))<0?Math.max(F.length+W,0):Math.min(W,F.length)):(ce=(ce??(ce=F.length-1))<0?Math.max(F.length+ce,-1):Math.min(ce,F.length-1),W=(W??(W=-1))<-1?Math.max(F.length+W,-1):Math.min(W,F.length-1));const Re=[];for(let Se=ce;ye*Se<ye*W;Se+=le)Re.push(F[Se]);return Re}function ae(F){return F.replace(/\b\w/g,ce=>ce.toUpperCase())}var fe=class extends Error{},Pe=class extends Error{},Ne=class{constructor(F=void 0){oe(this,"type","RuntimeValue");oe(this,"value");oe(this,"builtins",new Map);this.value=F}__bool__(){return new se(!!this.value)}},de=class extends Ne{constructor(){super(...arguments);oe(this,"type","NumericValue")}},Q=class extends Ne{constructor(){super(...arguments);oe(this,"type","StringValue");oe(this,"builtins",new Map([["upper",new Ee(()=>new Q(this.value.toUpperCase()))],["lower",new Ee(()=>new Q(this.value.toLowerCase()))],["strip",new Ee(()=>new Q(this.value.trim()))],["title",new Ee(()=>new Q(ae(this.value)))],["length",new de(this.value.length)],["rstrip",new Ee(()=>new Q(this.value.trimEnd()))],["lstrip",new Ee(()=>new Q(this.value.trimStart()))],["startswith",new Ee(ce=>{if(ce.length===0)throw new Error("startswith() requires at least one argument");const W=ce[0];if(!(W instanceof Q))throw new Error("startswith() argument must be a string");return new se(this.value.startsWith(W.value))})],["endswith",new Ee(ce=>{if(ce.length===0)throw new Error("endswith() requires at least one argument");const W=ce[0];if(!(W instanceof Q))throw new Error("endswith() argument must be a string");return new se(this.value.endsWith(W.value))})],["split",new Ee(ce=>{const W=ce[0]??new $e;if(!(W instanceof Q||W instanceof $e))throw new Error("sep argument must be a string or null");const le=ce[1]??new de(-1);if(!(le instanceof de))throw new Error("maxsplit argument must be a number");let ye=[];if(W instanceof $e){const Re=this.value.trimStart();for(const{0:Se,index:jt}of Re.matchAll(/\S+/g)){if(le.value!==-1&&ye.length>=le.value&&jt!==void 0){ye.push(Se+Re.slice(jt+Se.length));break}ye.push(Se)}}else{if(W.value==="")throw new Error("empty separator");ye=this.value.split(W.value),le.value!==-1&&ye.length>le.value&&ye.push(ye.splice(le.value).join(W.value))}return new xe(ye.map(Re=>new Q(Re)))})]]))}},se=class extends Ne{constructor(){super(...arguments);oe(this,"type","BooleanValue")}},J=class extends Ne{constructor(){super(...arguments);oe(this,"type","ObjectValue");oe(this,"builtins",new Map([["get",new Ee(([ce,W])=>{if(!(ce instanceof Q))throw new Error(`Object key must be a string: got ${ce.type}`);return this.value.get(ce.value)??W??new $e})],["items",new Ee(()=>new xe(Array.from(this.value.entries()).map(([ce,W])=>new xe([new Q(ce),W]))))]]))}__bool__(){return new se(this.value.size>0)}},be=class extends J{constructor(){super(...arguments);oe(this,"type","KeywordArgumentsValue")}},xe=class extends Ne{constructor(){super(...arguments);oe(this,"type","ArrayValue");oe(this,"builtins",new Map([["length",new de(this.value.length)]]))}__bool__(){return new se(this.value.length>0)}},Te=class extends xe{constructor(){super(...arguments);oe(this,"type","TupleValue")}},Ee=class extends Ne{constructor(){super(...arguments);oe(this,"type","FunctionValue")}},$e=class extends Ne{constructor(){super(...arguments);oe(this,"type","NullValue")}},Ie=class extends Ne{constructor(){super(...arguments);oe(this,"type","UndefinedValue")}},Ue=class{constructor(F){oe(this,"variables",new Map([["namespace",new Ee(F=>{if(F.length===0)return new J(new Map);if(F.length!==1||!(F[0]instanceof J))throw new Error("`namespace` expects either zero arguments or a single object argument");return F[0]})]]));oe(this,"tests",new Map([["boolean",F=>F.type==="BooleanValue"],["callable",F=>F instanceof Ee],["odd",F=>{if(F.type!=="NumericValue")throw new Error(`Cannot apply test "odd" to type: ${F.type}`);return F.value%2!==0}],["even",F=>{if(F.type!=="NumericValue")throw new Error(`Cannot apply test "even" to type: ${F.type}`);return F.value%2===0}],["false",F=>F.type==="BooleanValue"&&!F.value],["true",F=>F.type==="BooleanValue"&&F.value],["none",F=>F.type==="NullValue"],["string",F=>F.type==="StringValue"],["number",F=>F.type==="NumericValue"],["integer",F=>F.type==="NumericValue"&&Number.isInteger(F.value)],["iterable",F=>F.type==="ArrayValue"||F.type==="StringValue"],["mapping",F=>F.type==="ObjectValue"],["lower",F=>{const ce=F.value;return F.type==="StringValue"&&ce===ce.toLowerCase()}],["upper",F=>{const ce=F.value;return F.type==="StringValue"&&ce===ce.toUpperCase()}],["none",F=>F.type==="NullValue"],["defined",F=>F.type!=="UndefinedValue"],["undefined",F=>F.type==="UndefinedValue"],["equalto",(F,ce)=>F.value===ce.value],["eq",(F,ce)=>F.value===ce.value]]));this.parent=F}set(F,ce){return this.declareVariable(F,Je(ce))}declareVariable(F,ce){if(this.variables.has(F))throw new SyntaxError(`Variable already declared: ${F}`);return this.variables.set(F,ce),ce}setVariable(F,ce){return this.variables.set(F,ce),ce}resolve(F){if(this.variables.has(F))return this;if(this.parent)return this.parent.resolve(F);throw new Error(`Unknown variable: ${F}`)}lookupVariable(F){try{return this.resolve(F).variables.get(F)??new Ie}catch{return new Ie}}},Ke=class{constructor(F){oe(this,"global");this.global=F??new Ue}run(F){return this.evaluate(F,this.global)}evaluateBinaryExpression(F,ce){const W=this.evaluate(F.left,ce);switch(F.operator.value){case"and":return W.__bool__().value?this.evaluate(F.right,ce):W;case"or":return W.__bool__().value?W:this.evaluate(F.right,ce)}const le=this.evaluate(F.right,ce);switch(F.operator.value){case"==":return new se(W.value==le.value);case"!=":return new se(W.value!=le.value)}if(W instanceof Ie||le instanceof Ie)throw new Error("Cannot perform operation on undefined values");if(W instanceof $e||le instanceof $e)throw new Error("Cannot perform operation on null values");if(W instanceof de&&le instanceof de)switch(F.operator.value){case"+":return new de(W.value+le.value);case"-":return new de(W.value-le.value);case"*":return new de(W.value*le.value);case"/":return new de(W.value/le.value);case"%":return new de(W.value%le.value);case"<":return new se(W.value<le.value);case">":return new se(W.value>le.value);case">=":return new se(W.value>=le.value);case"<=":return new se(W.value<=le.value)}else if(W instanceof xe&&le instanceof xe)switch(F.operator.value){case"+":return new xe(W.value.concat(le.value))}else if(le instanceof xe){const ye=le.value.find(Re=>Re.value===W.value)!==void 0;switch(F.operator.value){case"in":return new se(ye);case"not in":return new se(!ye)}}if(W instanceof Q||le instanceof Q)switch(F.operator.value){case"+":return new Q(W.value.toString()+le.value.toString())}if(W instanceof Q&&le instanceof Q)switch(F.operator.value){case"in":return new se(le.value.includes(W.value));case"not in":return new se(!le.value.includes(W.value))}if(W instanceof Q&&le instanceof J)switch(F.operator.value){case"in":return new se(le.value.has(W.value));case"not in":return new se(!le.value.has(W.value))}throw new SyntaxError(`Unknown operator "${F.operator.value}" between ${W.type} and ${le.type}`)}evaluateArguments(F,ce){const W=[],le=new Map;for(const ye of F)if(ye.type==="KeywordArgumentExpression"){const Re=ye;le.set(Re.key.value,this.evaluate(Re.value,ce))}else{if(le.size>0)throw new Error("Positional arguments must come before keyword arguments");W.push(this.evaluate(ye,ce))}return[W,le]}evaluateFilterExpression(F,ce){const W=this.evaluate(F.operand,ce);if(F.filter.type==="Identifier"){const le=F.filter;if(le.value==="tojson")return new Q(je(W));if(W instanceof xe)switch(le.value){case"list":return W;case"first":return W.value[0];case"last":return W.value[W.value.length-1];case"length":return new de(W.value.length);case"reverse":return new xe(W.value.reverse());case"sort":return new xe(W.value.sort((ye,Re)=>{if(ye.type!==Re.type)throw new Error(`Cannot compare different types: ${ye.type} and ${Re.type}`);switch(ye.type){case"NumericValue":return ye.value-Re.value;case"StringValue":return ye.value.localeCompare(Re.value);default:throw new Error(`Cannot compare type: ${ye.type}`)}}));case"join":return new Q(W.value.map(ye=>ye.value).join(""));case"string":return new Q(je(W));default:throw new Error(`Unknown ArrayValue filter: ${le.value}`)}else if(W instanceof Q)switch(le.value){case"length":return new de(W.value.length);case"upper":return new Q(W.value.toUpperCase());case"lower":return new Q(W.value.toLowerCase());case"title":return new Q(ae(W.value));case"capitalize":return new Q(W.value.charAt(0).toUpperCase()+W.value.slice(1));case"trim":return new Q(W.value.trim());case"indent":return new Q(W.value.split(`
`).map((ye,Re)=>Re===0||ye.length===0?ye:"    "+ye).join(`
`));case"join":case"string":return W;default:throw new Error(`Unknown StringValue filter: ${le.value}`)}else if(W instanceof de)switch(le.value){case"abs":return new de(Math.abs(W.value));default:throw new Error(`Unknown NumericValue filter: ${le.value}`)}else if(W instanceof J)switch(le.value){case"items":return new xe(Array.from(W.value.entries()).map(([ye,Re])=>new xe([new Q(ye),Re])));case"length":return new de(W.value.size);default:throw new Error(`Unknown ObjectValue filter: ${le.value}`)}throw new Error(`Cannot apply filter "${le.value}" to type: ${W.type}`)}else if(F.filter.type==="CallExpression"){const le=F.filter;if(le.callee.type!=="Identifier")throw new Error(`Unknown filter: ${le.callee.type}`);const ye=le.callee.value;if(ye==="tojson"){const[,Re]=this.evaluateArguments(le.args,ce),Se=Re.get("indent")??new $e;if(!(Se instanceof de||Se instanceof $e))throw new Error("If set, indent must be a number");return new Q(je(W,Se.value))}else if(ye==="join"){let Re;if(W instanceof Q)Re=Array.from(W.value);else if(W instanceof xe)Re=W.value.map(bt=>bt.value);else throw new Error(`Cannot apply filter "${ye}" to type: ${W.type}`);const[Se,jt]=this.evaluateArguments(le.args,ce),er=Se.at(0)??jt.get("separator")??new Q("");if(!(er instanceof Q))throw new Error("separator must be a string");return new Q(Re.join(er.value))}if(W instanceof xe){switch(ye){case"selectattr":case"rejectattr":{const Re=ye==="selectattr";if(W.value.some(ut=>!(ut instanceof J)))throw new Error(`\`${ye}\` can only be applied to array of objects`);if(le.args.some(ut=>ut.type!=="StringLiteral"))throw new Error(`arguments of \`${ye}\` must be strings`);const[Se,jt,er]=le.args.map(ut=>this.evaluate(ut,ce));let bt;if(jt){const ut=ce.tests.get(jt.value);if(!ut)throw new Error(`Unknown test: ${jt.value}`);bt=ut}else bt=(...ut)=>ut[0].__bool__().value;const mt=W.value.filter(ut=>{const sr=ut.value.get(Se.value),wr=sr?bt(sr,er):!1;return Re?wr:!wr});return new xe(mt)}case"map":{const[,Re]=this.evaluateArguments(le.args,ce);if(Re.has("attribute")){const Se=Re.get("attribute");if(!(Se instanceof Q))throw new Error("attribute must be a string");const jt=Re.get("default"),er=W.value.map(bt=>{if(!(bt instanceof J))throw new Error("items in map must be an object");return bt.value.get(Se.value)??jt??new Ie});return new xe(er)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${ye}`)}else if(W instanceof Q){switch(ye){case"indent":{const[Re,Se]=this.evaluateArguments(le.args,ce),jt=Re.at(0)??Se.get("width")??new de(4);if(!(jt instanceof de))throw new Error("width must be a number");const er=Re.at(1)??Se.get("first")??new se(!1),bt=Re.at(2)??Se.get("blank")??new se(!1),mt=W.value.split(`
`),ut=" ".repeat(jt.value),sr=mt.map((wr,fn)=>!er.value&&fn===0||!bt.value&&wr.length===0?wr:ut+wr);return new Q(sr.join(`
`))}}throw new Error(`Unknown StringValue filter: ${ye}`)}else throw new Error(`Cannot apply filter "${ye}" to type: ${W.type}`)}throw new Error(`Unknown filter: ${F.filter.type}`)}evaluateTestExpression(F,ce){const W=this.evaluate(F.operand,ce),le=ce.tests.get(F.test.value);if(!le)throw new Error(`Unknown test: ${F.test.value}`);const ye=le(W);return new se(F.negate?!ye:ye)}evaluateUnaryExpression(F,ce){const W=this.evaluate(F.argument,ce);switch(F.operator.value){case"not":return new se(!W.value);default:throw new SyntaxError(`Unknown operator: ${F.operator.value}`)}}evalProgram(F,ce){return this.evaluateBlock(F.body,ce)}evaluateBlock(F,ce){let W="";for(const le of F){const ye=this.evaluate(le,ce);ye.type!=="NullValue"&&ye.type!=="UndefinedValue"&&(W+=ye.value)}return new Q(W)}evaluateIdentifier(F,ce){return ce.lookupVariable(F.value)}evaluateCallExpression(F,ce){const[W,le]=this.evaluateArguments(F.args,ce);le.size>0&&W.push(new be(le));const ye=this.evaluate(F.callee,ce);if(ye.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${ye.type}`);return ye.value(W,ce)}evaluateSliceExpression(F,ce,W){if(!(F instanceof xe||F instanceof Q))throw new Error("Slice object must be an array or string");const le=this.evaluate(ce.start,W),ye=this.evaluate(ce.stop,W),Re=this.evaluate(ce.step,W);if(!(le instanceof de||le instanceof Ie))throw new Error("Slice start must be numeric or undefined");if(!(ye instanceof de||ye instanceof Ie))throw new Error("Slice stop must be numeric or undefined");if(!(Re instanceof de||Re instanceof Ie))throw new Error("Slice step must be numeric or undefined");return F instanceof xe?new xe(me(F.value,le.value,ye.value,Re.value)):new Q(me(Array.from(F.value),le.value,ye.value,Re.value).join(""))}evaluateMemberExpression(F,ce){const W=this.evaluate(F.object,ce);let le;if(F.computed){if(F.property.type==="SliceExpression")return this.evaluateSliceExpression(W,F.property,ce);le=this.evaluate(F.property,ce)}else le=new Q(F.property.value);let ye;if(W instanceof J){if(!(le instanceof Q))throw new Error(`Cannot access property with non-string: got ${le.type}`);ye=W.value.get(le.value)??W.builtins.get(le.value)}else if(W instanceof xe||W instanceof Q)if(le instanceof de)ye=W.value.at(le.value),W instanceof Q&&(ye=new Q(W.value.at(le.value)));else if(le instanceof Q)ye=W.builtins.get(le.value);else throw new Error(`Cannot access property with non-string/non-number: got ${le.type}`);else{if(!(le instanceof Q))throw new Error(`Cannot access property with non-string: got ${le.type}`);ye=W.builtins.get(le.value)}return ye instanceof Ne?ye:new Ie}evaluateSet(F,ce){const W=F.value?this.evaluate(F.value,ce):this.evaluateBlock(F.body,ce);if(F.assignee.type==="Identifier"){const le=F.assignee.value;ce.setVariable(le,W)}else if(F.assignee.type==="MemberExpression"){const le=F.assignee,ye=this.evaluate(le.object,ce);if(!(ye instanceof J))throw new Error("Cannot assign to member of non-object");if(le.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");ye.value.set(le.property.value,W)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(F.assignee)}`);return new $e}evaluateIf(F,ce){const W=this.evaluate(F.test,ce);return this.evaluateBlock(W.__bool__().value?F.body:F.alternate,ce)}evaluateFor(F,ce){const W=new Ue(ce);let le,ye;if(F.iterable.type==="SelectExpression"){const bt=F.iterable;ye=this.evaluate(bt.iterable,W),le=bt.test}else ye=this.evaluate(F.iterable,W);if(!(ye instanceof xe))throw new Error(`Expected iterable type in for loop: got ${ye.type}`);const Re=[],Se=[];for(let bt=0;bt<ye.value.length;++bt){const mt=new Ue(W),ut=ye.value[bt];let sr;if(F.loopvar.type==="Identifier")sr=wr=>wr.setVariable(F.loopvar.value,ut);else if(F.loopvar.type==="TupleLiteral"){const wr=F.loopvar;if(ut.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${ut.type}`);const fn=ut;if(wr.value.length!==fn.value.length)throw new Error(`Too ${wr.value.length>fn.value.length?"few":"many"} items to unpack`);sr=Er=>{for(let Ln=0;Ln<wr.value.length;++Ln){if(wr.value[Ln].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${wr.value[Ln].type}`);Er.setVariable(wr.value[Ln].value,fn.value[Ln])}}}else throw new Error(`Invalid loop variable(s): ${F.loopvar.type}`);le&&(sr(mt),!this.evaluate(le,mt).__bool__().value)||(Re.push(ut),Se.push(sr))}let jt="",er=!0;for(let bt=0;bt<Re.length;++bt){const mt=new Map([["index",new de(bt+1)],["index0",new de(bt)],["revindex",new de(Re.length-bt)],["revindex0",new de(Re.length-bt-1)],["first",new se(bt===0)],["last",new se(bt===Re.length-1)],["length",new de(Re.length)],["previtem",bt>0?Re[bt-1]:new Ie],["nextitem",bt<Re.length-1?Re[bt+1]:new Ie]]);W.setVariable("loop",new J(mt)),Se[bt](W);try{const ut=this.evaluateBlock(F.body,W);jt+=ut.value}catch(ut){if(ut instanceof Pe)continue;if(ut instanceof fe)break;throw ut}er=!1}if(er){const bt=this.evaluateBlock(F.defaultBlock,W);jt+=bt.value}return new Q(jt)}evaluateMacro(F,ce){return ce.setVariable(F.name.value,new Ee((W,le)=>{var Se;const ye=new Ue(le);W=W.slice();let Re;((Se=W.at(-1))==null?void 0:Se.type)==="KeywordArgumentsValue"&&(Re=W.pop());for(let jt=0;jt<F.args.length;++jt){const er=F.args[jt],bt=W[jt];if(er.type==="Identifier"){const mt=er;if(!bt)throw new Error(`Missing positional argument: ${mt.value}`);ye.setVariable(mt.value,bt)}else if(er.type==="KeywordArgumentExpression"){const mt=er,ut=bt??(Re==null?void 0:Re.value.get(mt.key.value))??this.evaluate(mt.value,ye);ye.setVariable(mt.key.value,ut)}else throw new Error(`Unknown argument type: ${er.type}`)}return this.evaluateBlock(F.body,ye)})),new $e}evaluate(F,ce){if(F===void 0)return new Ie;switch(F.type){case"Program":return this.evalProgram(F,ce);case"Set":return this.evaluateSet(F,ce);case"If":return this.evaluateIf(F,ce);case"For":return this.evaluateFor(F,ce);case"Macro":return this.evaluateMacro(F,ce);case"Break":throw new fe;case"Continue":throw new Pe;case"NumericLiteral":return new de(Number(F.value));case"StringLiteral":return new Q(F.value);case"BooleanLiteral":return new se(F.value);case"NullLiteral":return new $e(F.value);case"ArrayLiteral":return new xe(F.value.map(W=>this.evaluate(W,ce)));case"TupleLiteral":return new Te(F.value.map(W=>this.evaluate(W,ce)));case"ObjectLiteral":{const W=new Map;for(const[le,ye]of F.value){const Re=this.evaluate(le,ce);if(!(Re instanceof Q))throw new Error(`Object keys must be strings: got ${Re.type}`);W.set(Re.value,this.evaluate(ye,ce))}return new J(W)}case"Identifier":return this.evaluateIdentifier(F,ce);case"CallExpression":return this.evaluateCallExpression(F,ce);case"MemberExpression":return this.evaluateMemberExpression(F,ce);case"UnaryExpression":return this.evaluateUnaryExpression(F,ce);case"BinaryExpression":return this.evaluateBinaryExpression(F,ce);case"FilterExpression":return this.evaluateFilterExpression(F,ce);case"TestExpression":return this.evaluateTestExpression(F,ce);default:throw new SyntaxError(`Unknown node type: ${F.type}`)}}};function Je(F){switch(typeof F){case"number":return new de(F);case"string":return new Q(F);case"boolean":return new se(F);case"undefined":return new Ie;case"object":return F===null?new $e:Array.isArray(F)?new xe(F.map(Je)):new J(new Map(Object.entries(F).map(([ce,W])=>[ce,Je(W)])));case"function":return new Ee((ce,W)=>{const le=F(...ce.map(ye=>ye.value))??null;return Je(le)});default:throw new Error(`Cannot convert to runtime value: ${F}`)}}function je(F,ce,W){const le=W??0;switch(F.type){case"NullValue":case"UndefinedValue":return"null";case"NumericValue":case"StringValue":case"BooleanValue":return JSON.stringify(F.value);case"ArrayValue":case"ObjectValue":{const ye=ce?" ".repeat(ce):"",Re=`
`+ye.repeat(le),Se=Re+ye;if(F.type==="ArrayValue"){const jt=F.value.map(er=>je(er,ce,le+1));return ce?`[${Se}${jt.join(`,${Se}`)}${Re}]`:`[${jt.join(", ")}]`}else{const jt=Array.from(F.value.entries()).map(([er,bt])=>{const mt=`"${er}": ${je(bt,ce,le+1)}`;return ce?`${Se}${mt}`:mt});return ce?`{${jt.join(",")}${Re}}`:`{${jt.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${F.type}`)}}var qe=`
`,ot="{%- ",ft=" -%}",it={MultiplicativeBinaryOperator:2,AdditiveBinaryOperator:1,ComparisonBinaryOperator:0};function We(F,ce="	"){const W=typeof ce=="number"?" ".repeat(ce):ce;return De(F.body,0,W).replace(/\n$/,"")}function Be(...F){return ot+F.join(" ")+ft}function De(F,ce,W){return F.map(le=>yt(le,ce,W)).join(qe)}function yt(F,ce,W){const le=W.repeat(ce);switch(F.type){case"Program":return De(F.body,ce,W);case"If":return Mt(F,ce,W);case"For":return Lt(F,ce,W);case"Set":return dr(F,ce,W);case"Macro":return pr(F,ce,W);case"Break":return le+Be("break");case"Continue":return le+Be("continue");default:return le+"{{- "+at(F)+" -}}"}}function Mt(F,ce,W){const le=W.repeat(ce),ye=[];let Re=F;for(;Re&&(ye.push({test:Re.test,body:Re.body}),Re.alternate.length===1&&Re.alternate[0].type==="If");)Re=Re.alternate[0];let Se=le+Be("if",at(ye[0].test))+qe+De(ye[0].body,ce+1,W);for(let jt=1;jt<ye.length;jt++)Se+=qe+le+Be("elif",at(ye[jt].test))+qe+De(ye[jt].body,ce+1,W);return Re&&Re.alternate.length>0&&(Se+=qe+le+Be("else")+qe+De(Re.alternate,ce+1,W)),Se+=qe+le+Be("endif"),Se}function Lt(F,ce,W){const le=W.repeat(ce);let ye="";if(F.iterable.type==="SelectExpression"){const Se=F.iterable;ye=`${at(Se.iterable)} if ${at(Se.test)}`}else ye=at(F.iterable);let Re=le+Be("for",at(F.loopvar),"in",ye)+qe+De(F.body,ce+1,W);return F.defaultBlock.length>0&&(Re+=qe+le+Be("else")+qe+De(F.defaultBlock,ce+1,W)),Re+=qe+le+Be("endfor"),Re}function dr(F,ce,W){const le=W.repeat(ce),ye=at(F.assignee),Re=F.value?at(F.value):"",Se=le+Be("set",`${ye}${F.value?" = "+Re:""}`);return F.body.length===0?Se:Se+qe+De(F.body,ce+1,W)+qe+le+Be("endset")}function pr(F,ce,W){const le=W.repeat(ce),ye=F.args.map(at).join(", ");return le+Be("macro",`${F.name.value}(${ye})`)+qe+De(F.body,ce+1,W)+qe+le+Be("endmacro")}function at(F,ce=-1){switch(F.type){case"Identifier":return F.value;case"NullLiteral":return"none";case"NumericLiteral":case"BooleanLiteral":return`${F.value}`;case"StringLiteral":return JSON.stringify(F.value);case"BinaryExpression":{const W=F,le=it[W.operator.type]??0,ye=at(W.left,le),Re=at(W.right,le+1),Se=`${ye} ${W.operator.value} ${Re}`;return le<ce?`(${Se})`:Se}case"UnaryExpression":{const W=F;return W.operator.value+(W.operator.value==="not"?" ":"")+at(W.argument,1/0)}case"LogicalNegationExpression":return`not ${at(F.argument,1/0)}`;case"CallExpression":{const W=F,le=W.args.map(ye=>at(ye,-1)).join(", ");return`${at(W.callee,-1)}(${le})`}case"MemberExpression":{const W=F;let le=at(W.object,-1);W.object.type!=="Identifier"&&(le=`(${le})`);let ye=at(W.property,-1);return!W.computed&&W.property.type!=="Identifier"&&(ye=`(${ye})`),W.computed?`${le}[${ye}]`:`${le}.${ye}`}case"FilterExpression":{const W=F,le=at(W.operand,1/0);return W.filter.type==="CallExpression"?`${le} | ${at(W.filter,-1)}`:`${le} | ${W.filter.value}`}case"SelectExpression":{const W=F;return`${at(W.iterable,-1)} | select(${at(W.test,-1)})`}case"TestExpression":{const W=F;return`${at(W.operand,-1)} is${W.negate?" not":""} ${W.test.value}`}case"ArrayLiteral":case"TupleLiteral":{const W=F.value.map(ye=>at(ye,-1)),le=F.type==="ArrayLiteral"?"[]":"()";return`${le[0]}${W.join(", ")}${le[1]}`}case"ObjectLiteral":return`{ ${Array.from(F.value.entries()).map(([le,ye])=>`${at(le,-1)}: ${at(ye,-1)}`).join(", ")} }`;case"SliceExpression":{const W=F,le=W.start?at(W.start,-1):"",ye=W.stop?at(W.stop,-1):"",Re=W.step?`:${at(W.step,-1)}`:"";return`${le}:${ye}${Re}`}case"KeywordArgumentExpression":{const W=F;return`${W.key.value}=${at(W.value,-1)}`}case"If":{const W=F,le=at(W.test,-1),ye=at(W.body[0],0),Re=at(W.alternate[0],-1);return`${ye} if ${le} else ${Re}`}default:throw new Error(`Unknown expression type: ${F.type}`)}}var Kn=class{constructor(F){oe(this,"parsed");const ce=d(F,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=q(ce)}render(F){const ce=new Ue;if(ce.set("false",!1),ce.set("true",!0),ce.set("raise_exception",ye=>{throw new Error(ye)}),ce.set("range",ne),F)for(const[ye,Re]of Object.entries(F))ce.set(ye,Re);return new Ke(ce).run(this.parsed).value}format(F){return We(this.parsed,(F==null?void 0:F.indent)||"	")}}},"./src/backends/onnx.js":(e,t,r)=>{var n;r.r(t),r.d(t,{Tensor:()=>a.Tensor,createInferenceSession:()=>w,deviceToExecutionProviders:()=>p,isONNXProxy:()=>v,isONNXTensor:()=>y});var s=r("./src/env.js"),i=r("?2ce3"),o=r("onnxruntime-web"),a=r("onnxruntime-common");const l=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),c=[];let u,d;const h=Symbol.for("onnxruntime");if(h in globalThis)d=globalThis[h];else if(s.apis.IS_NODE_ENV){switch(d=i??(n||(n=r.t(i,2))),process.platform){case"win32":c.push("dml");break;case"linux":process.arch==="x64"&&c.push("cuda");break}c.push("cpu"),u=["cpu"]}else d=o,s.apis.IS_WEBNN_AVAILABLE&&c.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),s.apis.IS_WEBGPU_AVAILABLE&&c.push("webgpu"),c.push("wasm"),u=["wasm"];const f=d.InferenceSession;function p(b=null){if(!b)return u;switch(b){case"auto":return c;case"gpu":return c.filter(x=>["webgpu","cuda","dml","webnn-gpu"].includes(x))}if(c.includes(b))return[l[b]??b];throw new Error(`Unsupported device: "${b}". Should be one of: ${c.join(", ")}.`)}let _=null;async function w(b,x,M){_&&await _;const E=f.create(b,x);_??(_=E);const P=await E;return P.config=M,P}function y(b){return b instanceof d.Tensor}const g=d==null?void 0:d.env;g!=null&&g.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!g.wasm.wasmPaths&&(g.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${s.env.version}/dist/`),g.wasm.proxy=!1),g!=null&&g.webgpu&&(g.webgpu.powerPreference="high-performance");function v(){var b;return(b=g==null?void 0:g.wasm)==null?void 0:b.proxy}s.env.backends.onnx=g},"./src/base/feature_extraction_utils.js":(e,t,r)=>{r.r(t),r.d(t,{FeatureExtractor:()=>o,validate_audio_inputs:()=>a});var n=r("./src/utils/constants.js"),s=r("./src/utils/generic.js"),i=r("./src/utils/hub.js");class o extends s.Callable{constructor(c){super(),this.config=c}static async from_pretrained(c,u){const d=await(0,i.getModelJSON)(c,n.FEATURE_EXTRACTOR_NAME,!0,u);return new this(d)}}function a(l,c){var u;if(!(l instanceof Float32Array||l instanceof Float64Array))throw new Error(`${c} expects input to be a Float32Array or a Float64Array, but got ${((u=l==null?void 0:l.constructor)==null?void 0:u.name)??typeof l} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}},"./src/base/image_processors_utils.js":(e,t,r)=>{r.r(t),r.d(t,{ImageProcessor:()=>b,center_to_corners_format:()=>d,post_process_instance_segmentation:()=>v,post_process_object_detection:()=>h,post_process_panoptic_segmentation:()=>g,post_process_semantic_segmentation:()=>f});var n=r("./src/utils/generic.js"),s=r("./src/utils/tensor.js"),i=r("./src/utils/maths.js");r("./src/utils/image.js");var o=r("./src/utils/core.js"),a=r("./src/utils/hub.js"),l=r("./src/utils/constants.js");function c(x,M,E=0,P=null){const I=x/M;let O=(0,i.bankers_round)(I)*M;return P!==null&&O>P&&(O=Math.floor(I)*M),O<E&&(O=Math.ceil(I)*M),O}function u([x,M],E){return[Math.max(Math.floor(x/E),1)*E,Math.max(Math.floor(M/E),1)*E]}function d([x,M,E,P]){return[x-E/2,M-P/2,x+E/2,M+P/2]}function h(x,M=.5,E=null,P=!1){const I=x.logits,O=x.pred_boxes,[V,U,B]=I.dims;if(E!==null&&E.length!==V)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let Y=[];for(let K=0;K<V;++K){let X=E!==null?E[K]:null,G={boxes:[],classes:[],scores:[]},R=I[K],te=O[K];for(let re=0;re<U;++re){let L=R[re],j=[],q;if(P){q=L.sigmoid().data;for(let ne=0;ne<q.length;++ne)q[ne]>M&&j.push(ne)}else{let ne=(0,i.max)(L.data)[1];if(ne===B-1||(q=(0,i.softmax)(L.data),q[ne]<M))continue;j.push(ne)}for(const ne of j){let me=te[re].data;me=d(me),X!==null&&(me=me.map((ae,fe)=>ae*X[(fe+1)%2])),G.boxes.push(me),G.classes.push(ne),G.scores.push(q[ne])}}Y.push(G)}return Y}function f(x,M=null){const E=x.logits,P=E.dims[0];if(M!==null&&M.length!==P)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const I=[];for(let O=0;O<P;++O){const V=M!==null?M[O]:null;let U=E[O];V!==null&&(U=(0,s.interpolate)(U,V,"bilinear",!1));const[B,Y]=V??U.dims.slice(-2),K=new s.Tensor("int32",new Int32Array(B*Y),[B,Y]),X=U[0].data,G=K.data;for(let re=1;re<U.dims[0];++re){const L=U[re].data;for(let j=0;j<L.length;++j)L[j]>X[j]&&(X[j]=L[j],G[j]=re)}const R=new Array(U.dims[0]);for(let re=0;re<G.length;++re){const L=G[re];R[L]=L}const te=R.filter(re=>re!==void 0);I.push({segmentation:K,labels:te})}return I}function p(x,M,E,P){const I=[],O=[],V=[];for(let U=0;U<x.dims[0];++U){const B=x[U],Y=M[U],K=(0,i.max)(B.data)[1];if(K===P)continue;const G=(0,i.softmax)(B.data)[K];G>E&&(I.push(Y),O.push(G),V.push(K))}return[I,O,V]}function _(x,M,E,P=.5,I=.8){const O=[];let V=0,U=0;const B=M[E].data;for(let K=0;K<x.length;++K)x[K]===E&&(O.push(K),++V),B[K]>=P&&++U;let Y=V>0&&U>0;return Y&&(Y=V/U>I),[Y,O]}function w(x,M,E,P,I,O=null,V=null){const[U,B]=V??x[0].dims,Y=new s.Tensor("int32",new Int32Array(U*B),[U,B]),K=[];if(V!==null)for(let re=0;re<x.length;++re)x[re]=(0,s.interpolate)(x[re],V,"bilinear",!1);const X=new Int32Array(x[0].data.length),G=new Float32Array(x[0].data.length);for(let re=0;re<x.length;++re){let L=M[re];const j=x[re].data;for(let q=0;q<j.length;++q)j[q]*=L,j[q]>G[q]&&(X[q]=re,G[q]=j[q])}let R=0;const te=Y.data;for(let re=0;re<E.length;++re){const L=E[re],[j,q]=_(X,x,re,P,I);if(j){++R;for(const ne of q)te[ne]=R;K.push({id:R,label_id:L,score:M[re]})}}return[Y,K]}function y(x,M,E=28,P=56*56,I=14*14*4*1280){if(x<E||M<E)throw new Error(`height:${x} or width:${M} must be larger than factor:${E}`);if(Math.max(x,M)/Math.min(x,M)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(x,M)/Math.min(x,M)}`);let O=Math.round(x/E)*E,V=Math.round(M/E)*E;if(O*V>I){const U=Math.sqrt(x*M/I);O=Math.floor(x/U/E)*E,V=Math.floor(M/U/E)*E}else if(O*V<P){const U=Math.sqrt(P/(x*M));O=Math.ceil(x*U/E)*E,V=Math.ceil(M*U/E)*E}return[O,V]}function g(x,M=.5,E=.5,P=.8,I=null,O=null){I===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),I=new Set);const V=x.class_queries_logits??x.logits,B=(x.masks_queries_logits??x.pred_masks).sigmoid();let[Y,K,X]=V.dims;if(X-=1,O!==null&&O.length!==Y)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let G=[];for(let R=0;R<Y;++R){let te=O!==null?O[R]:null,re=V[R],L=B[R],[j,q,ne]=p(re,L,M,X);if(ne.length===0){let[fe,Pe]=te??L.dims.slice(-2),Ne=new s.Tensor("int32",new Int32Array(fe*Pe).fill(-1),[fe,Pe]);G.push({segmentation:Ne,segments_info:[]});continue}let[me,ae]=w(j,q,ne,E,P,I,te);G.push({segmentation:me,segments_info:ae})}return G}function v(x,M=.5,E=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class b extends n.Callable{constructor(M){super(),this.image_mean=M.image_mean??M.mean,this.image_std=M.image_std??M.std,this.resample=M.resample??2,this.do_rescale=M.do_rescale??!0,this.rescale_factor=M.rescale_factor??1/255,this.do_normalize=M.do_normalize,this.do_thumbnail=M.do_thumbnail,this.size=M.size??M.image_size,this.do_resize=M.do_resize??this.size!==void 0,this.size_divisibility=M.size_divisibility??M.size_divisor,this.do_center_crop=M.do_center_crop,this.crop_size=M.crop_size,this.do_convert_rgb=M.do_convert_rgb??!0,this.do_crop_margin=M.do_crop_margin,this.pad_size=M.pad_size,this.do_pad=M.do_pad,this.min_pixels=M.min_pixels,this.max_pixels=M.max_pixels,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=M.do_flip_channel_order??!1,this.config=M}async thumbnail(M,E,P=2){const I=M.height,O=M.width,V=E.height,U=E.width;let B=Math.min(I,V),Y=Math.min(O,U);return B===I&&Y===O?M:(I>O?Y=Math.floor(O*B/I):O>I&&(B=Math.floor(I*Y/O)),await M.resize(Y,B,{resample:P}))}async crop_margin(M,E=200){const P=M.clone().grayscale(),I=(0,i.min)(P.data)[0],V=(0,i.max)(P.data)[0]-I;if(V===0)return M;const U=E/255;let B=P.width,Y=P.height,K=0,X=0;const G=P.data;for(let R=0;R<P.height;++R){const te=R*P.width;for(let re=0;re<P.width;++re)(G[te+re]-I)/V<U&&(B=Math.min(B,re),Y=Math.min(Y,R),K=Math.max(K,re),X=Math.max(X,R))}return M=await M.crop([B,Y,K,X]),M}pad_image(M,E,P,{mode:I="constant",center:O=!1,constant_values:V=0}={}){const[U,B,Y]=E;let K,X;if(typeof P=="number"?(K=P,X=P):P==="square"?K=X=Math.max(U,B):(K=P.width,X=P.height),K!==B||X!==U){const G=new Float32Array(K*X*Y);if(Array.isArray(V))for(let re=0;re<G.length;++re)G[re]=V[re%Y];else V!==0&&G.fill(V);const[R,te]=O?[Math.floor((K-B)/2),Math.floor((X-U)/2)]:[0,0];for(let re=0;re<U;++re){const L=(re+te)*K,j=re*B;for(let q=0;q<B;++q){const ne=(L+q+R)*Y,me=(j+q)*Y;for(let ae=0;ae<Y;++ae)G[ne+ae]=M[me+ae]}}if(I==="symmetric"){if(O)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const re=U-1,L=B-1;for(let j=0;j<X;++j){const q=j*K,ne=(0,o.calculateReflectOffset)(j,re)*B;for(let me=0;me<K;++me){if(j<U&&me<B)continue;const ae=(q+me)*Y,fe=(ne+(0,o.calculateReflectOffset)(me,L))*Y;for(let Pe=0;Pe<Y;++Pe)G[ae+Pe]=M[fe+Pe]}}}M=G,E=[X,K,Y]}return[M,E]}rescale(M){for(let E=0;E<M.length;++E)M[E]=this.rescale_factor*M[E]}get_resize_output_image_size(M,E){const[P,I]=M.size;let O,V;if(this.do_thumbnail){const{height:U,width:B}=E;O=Math.min(U,B)}else Number.isInteger(E)?(O=E,V=this.config.max_size??O):E!==void 0&&(O=E.shortest_edge,V=E.longest_edge);if(O!==void 0||V!==void 0){const U=O===void 0?1:Math.max(O/P,O/I),B=P*U,Y=I*U,K=V===void 0?1:Math.min(V/B,V/Y);let X=Math.floor(Number((B*K).toFixed(2))),G=Math.floor(Number((Y*K).toFixed(2)));return this.size_divisibility!==void 0&&([X,G]=u([X,G],this.size_divisibility)),[X,G]}else if(E!==void 0&&E.width!==void 0&&E.height!==void 0){let U=E.width,B=E.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let Y=B/I,K=U/P;Math.abs(1-K)<Math.abs(1-Y)?Y=K:K=Y,B=c(Y*I,this.config.ensure_multiple_of),U=c(K*P,this.config.ensure_multiple_of)}return[U,B]}else{if(this.size_divisibility!==void 0)return u([P,I],this.size_divisibility);if(this.min_pixels!==void 0&&this.max_pixels!==void 0){const U=this.config.patch_size*this.config.merge_size;return y(I,P,U,this.min_pixels,this.max_pixels)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(E)}`)}}async resize(M){const[E,P]=this.get_resize_output_image_size(M,this.size);return await M.resize(E,P,{resample:this.resample})}async preprocess(M,{do_normalize:E=null,do_pad:P=null,do_convert_rgb:I=null,do_convert_grayscale:O=null,do_flip_channel_order:V=null}={}){this.do_crop_margin&&(M=await this.crop_margin(M));const[U,B]=M.size;if(I??this.do_convert_rgb?M=M.rgb():O&&(M=M.grayscale()),this.do_resize&&(M=await this.resize(M)),this.do_thumbnail&&(M=await this.thumbnail(M,this.size,this.resample)),this.do_center_crop){let R,te;Number.isInteger(this.crop_size)?(R=this.crop_size,te=this.crop_size):(R=this.crop_size.width,te=this.crop_size.height),M=await M.center_crop(R,te)}const Y=[M.height,M.width];let K=Float32Array.from(M.data),X=[M.height,M.width,M.channels];if(this.do_rescale&&this.rescale(K),E??this.do_normalize){let R=this.image_mean;Array.isArray(this.image_mean)||(R=new Array(M.channels).fill(R));let te=this.image_std;if(Array.isArray(this.image_std)||(te=new Array(M.channels).fill(R)),R.length!==M.channels||te.length!==M.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${R.length}) and \`image_std\` (${te.length}) must match the number of channels in the image (${M.channels}).`);for(let re=0;re<K.length;re+=M.channels)for(let L=0;L<M.channels;++L)K[re+L]=(K[re+L]-R[L])/te[L]}if(P??this.do_pad){if(this.pad_size)[K,X]=this.pad_image(K,[M.height,M.width,M.channels],this.pad_size);else if(this.size_divisibility){const[R,te]=u([X[1],X[0]],this.size_divisibility);[K,X]=this.pad_image(K,X,{width:R,height:te})}}if(V??this.do_flip_channel_order){if(X[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let R=0;R<K.length;R+=3){const te=K[R];K[R]=K[R+2],K[R+2]=te}}const G=new s.Tensor("float32",K,X).permute(2,0,1);return{original_size:[B,U],reshaped_input_size:Y,pixel_values:G}}async _call(M,...E){Array.isArray(M)||(M=[M]);const P=await Promise.all(M.map(O=>this.preprocess(O)));return{pixel_values:(0,s.stack)(P.map(O=>O.pixel_values),0),original_sizes:P.map(O=>O.original_size),reshaped_input_sizes:P.map(O=>O.reshaped_input_size)}}static async from_pretrained(M,E){const P=await(0,a.getModelJSON)(M,l.IMAGE_PROCESSOR_NAME,!0,E);return new this(P)}}},"./src/base/processing_utils.js":(e,t,r)=>{r.r(t),r.d(t,{Processor:()=>o});var n=r("./src/utils/constants.js"),s=r("./src/utils/generic.js"),i=r("./src/utils/hub.js");class o extends s.Callable{constructor(l,c,u){super(),this.config=l,this.components=c,this.chat_template=u}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(l,c={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(l,{tokenize:!1,chat_template:this.chat_template??void 0,...c})}batch_decode(...l){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...l)}decode(...l){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...l)}async _call(l,...c){for(const u of[this.image_processor,this.feature_extractor,this.tokenizer])if(u)return u(l,...c);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(l,c){const[u,d,h]=await Promise.all([this.uses_processor_config?(0,i.getModelJSON)(l,n.PROCESSOR_NAME,!0,c):{},Promise.all(this.classes.filter(f=>f in this).map(async f=>{const p=await this[f].from_pretrained(l,c);return[f.replace(/_class$/,""),p]})).then(Object.fromEntries),this.uses_chat_template_file?(0,i.getModelText)(l,n.CHAT_TEMPLATE_NAME,!0,c):null]);return new this(u,d,h)}}oe(o,"classes",["image_processor_class","tokenizer_class","feature_extractor_class"]),oe(o,"uses_processor_config",!1),oe(o,"uses_chat_template_file",!1)},"./src/configs.js":(e,t,r)=>{r.r(t),r.d(t,{AutoConfig:()=>c,PretrainedConfig:()=>l,getKeyValueShapes:()=>a});var n=r("./src/utils/core.js"),s=r("./src/utils/hub.js");async function i(u,d){return await(0,s.getModelJSON)(u,"config.json",!0,d)}function o(u){const d={};let h={};switch(u.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"smolvlm":case"gemma3n":h=o(u.text_config);break;case"moondream1":h=o(u.phi_config);break;case"musicgen":h=o(u.decoder);break;case"multi_modality":h=o(u.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":d.num_heads="n_head",d.num_layers="n_layer",d.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":d.num_heads="num_attention_heads",d.num_layers="num_hidden_layers",d.hidden_size="hidden_size";break;case"llama":case"olmo":case"olmo2":case"mobilellm":case"granite":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":d.num_heads="num_key_value_heads",d.num_layers="num_hidden_layers",d.hidden_size="hidden_size",d.num_attention_heads="num_attention_heads";break;case"qwen3":case"gemma":case"gemma2":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":d.num_heads="num_key_value_heads",d.num_layers="num_hidden_layers",d.dim_kv="head_dim";break;case"openelm":d.num_heads="num_kv_heads",d.num_layers="num_transformer_layers",d.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":d.num_heads="num_heads",d.num_layers="num_layers",d.hidden_size="hidden_size";break;case"bloom":d.num_heads="n_head",d.num_layers="n_layer",d.hidden_size="hidden_size";break;case"mpt":d.num_heads="n_heads",d.num_layers="n_layers",d.hidden_size="d_model";break;case"exaone":d.num_heads="num_key_value_heads",d.num_layers="num_layers",d.dim_kv="head_dim",d.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":d.num_decoder_layers="num_decoder_layers",d.num_decoder_heads="num_heads",d.decoder_dim_kv="d_kv",d.num_encoder_layers="num_layers",d.num_encoder_heads="num_heads",d.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":d.num_decoder_layers="decoder_layers",d.num_decoder_heads="decoder_attention_heads",d.decoder_hidden_size="d_model",d.num_encoder_layers="encoder_layers",d.num_encoder_heads="encoder_attention_heads",d.encoder_hidden_size="d_model";break;case"speecht5":d.num_decoder_layers="decoder_layers",d.num_decoder_heads="decoder_attention_heads",d.decoder_hidden_size="hidden_size",d.num_encoder_layers="encoder_layers",d.num_encoder_heads="encoder_attention_heads",d.encoder_hidden_size="hidden_size";break;case"trocr":d.num_encoder_layers=d.num_decoder_layers="decoder_layers",d.num_encoder_heads=d.num_decoder_heads="decoder_attention_heads",d.encoder_hidden_size=d.decoder_hidden_size="d_model";break;case"musicgen_decoder":d.num_encoder_layers=d.num_decoder_layers="num_hidden_layers",d.num_encoder_heads=d.num_decoder_heads="num_attention_heads",d.encoder_hidden_size=d.decoder_hidden_size="hidden_size";break;case"moonshine":d.num_decoder_layers="decoder_num_hidden_layers",d.num_decoder_heads="decoder_num_key_value_heads",d.num_encoder_layers="encoder_num_hidden_layers",d.num_encoder_heads="encoder_num_key_value_heads",d.encoder_hidden_size=d.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const p=o(u.decoder),_="num_decoder_layers"in p,w=(0,n.pick)(u,["model_type","is_encoder_decoder"]);return _?(w.num_decoder_layers=p.num_decoder_layers,w.num_decoder_heads=p.num_decoder_heads,w.decoder_hidden_size=p.decoder_hidden_size,w.num_encoder_layers=p.num_encoder_layers,w.num_encoder_heads=p.num_encoder_heads,w.encoder_hidden_size=p.encoder_hidden_size):(w.num_layers=p.num_layers,w.num_heads=p.num_heads,w.hidden_size=p.hidden_size),w}const f={...h,...(0,n.pick)(u,["model_type","multi_query","is_encoder_decoder"])};for(const p in d)f[p]=u[d[p]];return f}function a(u,{prefix:d="past_key_values",batch_size:h=1}={}){const f={},p=u.normalized_config;if(p.is_encoder_decoder&&"num_encoder_heads"in p&&"num_decoder_heads"in p){const _=p.encoder_dim_kv??p.encoder_hidden_size/p.num_encoder_heads,w=p.decoder_dim_kv??p.decoder_hidden_size/p.num_decoder_heads,y=[h,p.num_encoder_heads,0,_],g=[h,p.num_decoder_heads,0,w];for(let v=0;v<p.num_decoder_layers;++v)f[`${d}.${v}.encoder.key`]=y,f[`${d}.${v}.encoder.value`]=y,f[`${d}.${v}.decoder.key`]=g,f[`${d}.${v}.decoder.value`]=g}else{const _=p.num_heads,w=p.num_layers,y=p.dim_kv??p.hidden_size/(p.num_attention_heads??_);if(p.model_type==="falcon"){const g=[h*_,0,y];for(let v=0;v<w;++v)f[`${d}.${v}.key`]=g,f[`${d}.${v}.value`]=g}else if(p.multi_query){const g=[h*_,0,2*y];for(let v=0;v<w;++v)f[`${d}.${v}.key_value`]=g}else if(p.model_type==="bloom"){const g=[h*_,y,0],v=[h*_,0,y];for(let b=0;b<w;++b)f[`${d}.${b}.key`]=g,f[`${d}.${b}.value`]=v}else if(p.model_type==="openelm")for(let g=0;g<w;++g){const v=[h,_[g],0,y];f[`${d}.${g}.key`]=v,f[`${d}.${g}.value`]=v}else{const g=[h,_,0,y];for(let v=0;v<w;++v)f[`${d}.${v}.key`]=g,f[`${d}.${v}.value`]=g}}return f}class l{constructor(d){oe(this,"model_type",null);oe(this,"is_encoder_decoder",!1);oe(this,"max_position_embeddings");oe(this,"transformers.js_config");Object.assign(this,d),this.normalized_config=o(this)}static async from_pretrained(d,{progress_callback:h=null,config:f=null,cache_dir:p=null,local_files_only:_=!1,revision:w="main"}={}){f&&!(f instanceof l)&&(f=new l(f));const y=f??await i(d,{progress_callback:h,config:f,cache_dir:p,local_files_only:_,revision:w});return new this(y)}}class c{static async from_pretrained(...d){return l.from_pretrained(...d)}}},"./src/env.js":(e,t,r)=>{var I,O;r.r(t),r.d(t,{apis:()=>y,env:()=>E});var n=r("?db59"),s=r("?383f"),i=r("?fa4b");const o="3.6.0",a=typeof window<"u"&&typeof window.document<"u",l=typeof self<"u"&&((I=self.constructor)==null?void 0:I.name)==="DedicatedWorkerGlobalScope",c=typeof self<"u"&&"caches"in self,u=typeof navigator<"u"&&"gpu"in navigator,d=typeof navigator<"u"&&"ml"in navigator,h=typeof process<"u",f=h&&((O=process==null?void 0:process.release)==null?void 0:O.name)==="node",p=!P(n),_=!P(s),w=typeof globalThis.Deno<"u",y=Object.freeze({IS_BROWSER_ENV:a,IS_WEBWORKER_ENV:l,IS_WEB_CACHE_AVAILABLE:c,IS_WEBGPU_AVAILABLE:u,IS_WEBNN_AVAILABLE:d,IS_PROCESS_AVAILABLE:h,IS_NODE_ENV:f,IS_FS_AVAILABLE:p,IS_PATH_AVAILABLE:_}),g=p&&_;let v="./";if(g){const V=Object(import.meta).url;V?v=s.dirname(s.dirname(i.fileURLToPath(V))):typeof __dirname<"u"&&(v=s.dirname(__dirname))}const b=g?s.join(v,"/.cache/"):null,x="/models/",M=g?s.join(v,x):x,E={version:o,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(a||l),localModelPath:M,useFS:p,useBrowserCache:c&&!w,useFSCache:p,cacheDir:b,useCustomCache:!1,customCache:null};function P(V){return Object.keys(V).length===0}},"./src/generation/configuration_utils.js":(e,t,r)=>{r.r(t),r.d(t,{GenerationConfig:()=>s});var n=r("./src/utils/core.js");class s{constructor(o){oe(this,"max_length",20);oe(this,"max_new_tokens",null);oe(this,"min_length",0);oe(this,"min_new_tokens",null);oe(this,"early_stopping",!1);oe(this,"max_time",null);oe(this,"do_sample",!1);oe(this,"num_beams",1);oe(this,"num_beam_groups",1);oe(this,"penalty_alpha",null);oe(this,"use_cache",!0);oe(this,"temperature",1);oe(this,"top_k",50);oe(this,"top_p",1);oe(this,"typical_p",1);oe(this,"epsilon_cutoff",0);oe(this,"eta_cutoff",0);oe(this,"diversity_penalty",0);oe(this,"repetition_penalty",1);oe(this,"encoder_repetition_penalty",1);oe(this,"length_penalty",1);oe(this,"no_repeat_ngram_size",0);oe(this,"bad_words_ids",null);oe(this,"force_words_ids",null);oe(this,"renormalize_logits",!1);oe(this,"constraints",null);oe(this,"forced_bos_token_id",null);oe(this,"forced_eos_token_id",null);oe(this,"remove_invalid_values",!1);oe(this,"exponential_decay_length_penalty",null);oe(this,"suppress_tokens",null);oe(this,"streamer",null);oe(this,"begin_suppress_tokens",null);oe(this,"forced_decoder_ids",null);oe(this,"guidance_scale",null);oe(this,"num_return_sequences",1);oe(this,"output_attentions",!1);oe(this,"output_hidden_states",!1);oe(this,"output_scores",!1);oe(this,"return_dict_in_generate",!1);oe(this,"pad_token_id",null);oe(this,"bos_token_id",null);oe(this,"eos_token_id",null);oe(this,"encoder_no_repeat_ngram_size",0);oe(this,"decoder_start_token_id",null);oe(this,"generation_kwargs",{});Object.assign(this,(0,n.pick)(o,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(e,t,r)=>{r.r(t),r.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>y,ForcedBOSTokenLogitsProcessor:()=>l,ForcedEOSTokenLogitsProcessor:()=>c,LogitsProcessor:()=>i,LogitsProcessorList:()=>a,LogitsWarper:()=>o,MinLengthLogitsProcessor:()=>p,MinNewTokensLengthLogitsProcessor:()=>_,NoBadWordsLogitsProcessor:()=>w,NoRepeatNGramLogitsProcessor:()=>h,RepetitionPenaltyLogitsProcessor:()=>f,SuppressTokensAtBeginLogitsProcessor:()=>u,TemperatureLogitsWarper:()=>g,TopKLogitsWarper:()=>b,TopPLogitsWarper:()=>v,WhisperTimeStampLogitsProcessor:()=>d});var n=r("./src/utils/generic.js");r("./src/utils/tensor.js");var s=r("./src/utils/maths.js");class i extends n.Callable{_call(M,E){throw Error("`_call` should be implemented in a subclass")}}class o extends n.Callable{_call(M,E){throw Error("`_call` should be implemented in a subclass")}}class a extends n.Callable{constructor(){super(),this.processors=[]}push(M){this.processors.push(M)}extend(M){this.processors.push(...M)}_call(M,E){let P=E;for(const I of this.processors)P=I(M,P);return P}[Symbol.iterator](){return this.processors.values()}}class l extends i{constructor(M){super(),this.bos_token_id=M}_call(M,E){for(let P=0;P<M.length;++P)if(M[P].length===1){const I=E[P].data;I.fill(-1/0),I[this.bos_token_id]=0}return E}}class c extends i{constructor(M,E){super(),this.max_length=M,this.eos_token_id=Array.isArray(E)?E:[E]}_call(M,E){for(let P=0;P<M.length;++P)if(M[P].length===this.max_length-1){const I=E[P].data;I.fill(-1/0);for(const O of this.eos_token_id)I[O]=0}return E}}class u extends i{constructor(M,E){super(),this.begin_suppress_tokens=M,this.begin_index=E}_call(M,E){for(let P=0;P<M.length;++P)if(M[P].length===this.begin_index){const I=E[P].data;for(const O of this.begin_suppress_tokens)I[O]=-1/0}return E}}class d extends i{constructor(M,E){super(),this.eos_token_id=Array.isArray(M.eos_token_id)?M.eos_token_id[0]:M.eos_token_id,this.no_timestamps_token_id=M.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=E.length,E.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=M.max_initial_timestamp_index}_call(M,E){for(let P=0;P<M.length;++P){const I=E[P].data;if(I[this.no_timestamps_token_id]=-1/0,M[P].length===this.begin_index-1){I.fill(-1/0),I[this.timestamp_begin]=0;continue}const O=M[P].slice(this.begin_index),V=O.length>=1&&O[O.length-1]>=this.timestamp_begin,U=O.length<2||O[O.length-2]>=this.timestamp_begin;if(V&&(U?I.subarray(this.timestamp_begin).fill(-1/0):I.subarray(0,this.eos_token_id).fill(-1/0)),M[P].length===this.begin_index&&this.max_initial_timestamp_index!==null){const X=this.timestamp_begin+this.max_initial_timestamp_index;I.subarray(X+1).fill(-1/0)}const B=(0,s.log_softmax)(I),Y=Math.log(B.subarray(this.timestamp_begin).map(Math.exp).reduce((X,G)=>X+G)),K=(0,s.max)(B.subarray(0,this.timestamp_begin))[0];Y>K&&I.subarray(0,this.timestamp_begin).fill(-1/0)}return E}}class h extends i{constructor(M){super(),this.no_repeat_ngram_size=M}getNgrams(M){const E=M.length,P=[];for(let O=0;O<E+1-this.no_repeat_ngram_size;++O){const V=[];for(let U=0;U<this.no_repeat_ngram_size;++U)V.push(M[O+U]);P.push(V.map(Number))}const I=new Map;for(const O of P){const V=O.slice(0,O.length-1),U=JSON.stringify(V),B=I.get(U)??[];B.push(O[O.length-1]),I.set(U,B)}return I}getGeneratedNgrams(M,E){const P=E.slice(E.length+1-this.no_repeat_ngram_size,E.length);return M.get(JSON.stringify(P.map(Number)))??[]}calcBannedNgramTokens(M){const E=[];if(M.length+1<this.no_repeat_ngram_size)return E;{const P=this.getNgrams(M);return this.getGeneratedNgrams(P,M)}}_call(M,E){for(let P=0;P<M.length;++P){const I=E[P].data,O=this.calcBannedNgramTokens(M[P]);for(const V of O)I[V]=-1/0}return E}}class f extends i{constructor(M){super(),this.penalty=M}_call(M,E){for(let P=0;P<M.length;++P){const I=E[P].data;for(const O of new Set(M[P])){const V=Number(O);I[V]<0?I[V]*=this.penalty:I[V]/=this.penalty}}return E}}class p extends i{constructor(M,E){super(),this.min_length=M,this.eos_token_id=Array.isArray(E)?E:[E]}_call(M,E){for(let P=0;P<M.length;++P)if(M[P].length<this.min_length){const I=E[P].data;for(const O of this.eos_token_id)I[O]=-1/0}return E}}class _ extends i{constructor(M,E,P){super(),this.prompt_length_to_skip=M,this.min_new_tokens=E,this.eos_token_id=Array.isArray(P)?P:[P]}_call(M,E){for(let P=0;P<M.length;++P)if(M[P].length-this.prompt_length_to_skip<this.min_new_tokens){const O=E[P].data;for(const V of this.eos_token_id)O[V]=-1/0}return E}}class w extends i{constructor(M,E){super(),this.bad_words_ids=M,this.eos_token_id=Array.isArray(E)?E:[E]}_call(M,E){for(let P=0;P<M.length;++P){const I=E[P].data,O=M[P];for(const V of this.bad_words_ids){if(O.length<V.length-1)continue;let U=!0;for(let B=1;B<=V.length-1;++B)if(V.at(-B-1)!=O.at(-B)){U=!1;break}U&&(I[V.at(-1)]=-1/0)}}return E}}class y extends i{constructor(M){if(super(),M<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${M}.`);this.guidance_scale=M}_call(M,E){if(E.dims[0]!==2*M.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${E.dims[0]} for the logits and ${M.length} for the input ids.`);const P=M.length,I=E.slice([0,P],null),O=E.slice([P,E.dims[0]],null);for(let V=0;V<O.data.length;++V)O.data[V]+=(I.data[V]-O.data[V])*this.guidance_scale;return O}}class g extends o{constructor(M){super(),this.temperature=M}_call(M,E){const P=E.data;for(let I=0;I<P.length;++I)P[I]/=this.temperature;return E}}class v extends o{constructor(M,{filter_value:E=-1/0,min_tokens_to_keep:P=1}={}){if(super(),M<0||M>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${M}`);if(!Number.isInteger(P)||P<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${P}`);this.top_p=M,this.filter_value=E,this.min_tokens_to_keep=P}}class b extends o{constructor(M,{filter_value:E=-1/0,min_tokens_to_keep:P=1}={}){if(super(),!Number.isInteger(M)||M<0)throw new Error(`\`top_k\` must be a positive integer, but is ${M}`);this.top_k=Math.max(M,P),this.filter_value=E}}},"./src/generation/logits_sampler.js":(e,t,r)=>{r.r(t),r.d(t,{LogitsSampler:()=>o});var n=r("./src/utils/generic.js"),s=r("./src/utils/tensor.js"),i=r("./src/utils/maths.js");r("./src/generation/configuration_utils.js");class o extends n.Callable{constructor(d){super(),this.generation_config=d}async _call(d){return this.sample(d)}async sample(d){throw Error("sample should be implemented in subclasses.")}getLogits(d,h){let f=d.dims.at(-1),p=d.data;if(h===-1)p=p.slice(-f);else{let _=h*f;p=p.slice(_,_+f)}return p}randomSelect(d){let h=0;for(let p=0;p<d.length;++p)h+=d[p];let f=Math.random()*h;for(let p=0;p<d.length;++p)if(f-=d[p],f<=0)return p;return 0}static getSampler(d){if(d.do_sample)return new l(d);if(d.num_beams>1)return new c(d);if(d.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${d.num_return_sequences}.`);return new a(d)}}class a extends o{async sample(d){const h=(0,i.max)(d.data)[1];return[[BigInt(h),0]]}}class l extends o{async sample(d){let h=d.dims.at(-1);this.generation_config.top_k>0&&(h=Math.min(this.generation_config.top_k,h));const[f,p]=await(0,s.topk)(d,h),_=(0,i.softmax)(f.data);return Array.from({length:this.generation_config.num_beams},()=>{const w=this.randomSelect(_);return[p.data[w],Math.log(_[w])]})}}class c extends o{async sample(d){let h=d.dims.at(-1);this.generation_config.top_k>0&&(h=Math.min(this.generation_config.top_k,h));const[f,p]=await(0,s.topk)(d,h),_=(0,i.softmax)(f.data);return Array.from({length:this.generation_config.num_beams},(w,y)=>[p.data[y],Math.log(_[y])])}}},"./src/generation/stopping_criteria.js":(e,t,r)=>{r.r(t),r.d(t,{EosTokenCriteria:()=>a,InterruptableStoppingCriteria:()=>l,MaxLengthCriteria:()=>o,StoppingCriteria:()=>s,StoppingCriteriaList:()=>i});var n=r("./src/utils/generic.js");class s extends n.Callable{_call(u,d){throw Error("StoppingCriteria needs to be subclassed")}}class i extends n.Callable{constructor(){super(),this.criteria=[]}push(u){this.criteria.push(u)}extend(u){u instanceof i?u=u.criteria:u instanceof s&&(u=[u]),this.criteria.push(...u)}_call(u,d){const h=new Array(u.length).fill(!1);for(const f of this.criteria){const p=f(u,d);for(let _=0;_<h.length;++_)h[_]||(h[_]=p[_])}return h}[Symbol.iterator](){return this.criteria.values()}}class o extends s{constructor(u,d=null){super(),this.max_length=u,this.max_position_embeddings=d}_call(u){return u.map(d=>d.length>=this.max_length)}}class a extends s{constructor(u){super(),Array.isArray(u)||(u=[u]),this.eos_token_id=u}_call(u,d){return u.map(h=>{const f=h.at(-1);return this.eos_token_id.some(p=>f==p)})}}class l extends s{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(u,d){return new Array(u.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(e,t,r)=>{r.r(t),r.d(t,{BaseStreamer:()=>o,TextStreamer:()=>l,WhisperTextStreamer:()=>c});var n=r("./src/utils/core.js"),s=r("./src/tokenizers.js"),i=r("./src/env.js");class o{put(d){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const a=i.apis.IS_PROCESS_AVAILABLE?u=>process.stdout.write(u):u=>console.log(u);class l extends o{constructor(d,{skip_prompt:h=!1,callback_function:f=null,token_callback_function:p=null,skip_special_tokens:_=!0,decode_kwargs:w={},...y}={}){super(),this.tokenizer=d,this.skip_prompt=h,this.callback_function=f??a,this.token_callback_function=p,this.decode_kwargs={skip_special_tokens:_,...w,...y},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(d){var w;if(d.length>1)throw Error("TextStreamer only supports batch size of 1");const h=this.next_tokens_are_prompt;if(h&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const f=d[0];(w=this.token_callback_function)==null||w.call(this,f),this.token_cache=(0,n.mergeArrays)(this.token_cache,f);const p=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let _;h||p.endsWith(`
`)?(_=p.slice(this.print_len),this.token_cache=[],this.print_len=0):p.length>0&&(0,s.is_chinese_char)(p.charCodeAt(p.length-1))?(_=p.slice(this.print_len),this.print_len+=_.length):(_=p.slice(this.print_len,p.lastIndexOf(" ")+1),this.print_len+=_.length),this.on_finalized_text(_,!1)}end(){let d;this.token_cache.length>0?(d=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):d="",this.next_tokens_are_prompt=!0,this.on_finalized_text(d,!0)}on_finalized_text(d,h){var f,p;d.length>0&&((f=this.callback_function)==null||f.call(this,d)),h&&this.callback_function===a&&i.apis.IS_PROCESS_AVAILABLE&&((p=this.callback_function)==null||p.call(this,`
`))}}class c extends l{constructor(d,{skip_prompt:h=!1,callback_function:f=null,token_callback_function:p=null,on_chunk_start:_=null,on_chunk_end:w=null,on_finalize:y=null,time_precision:g=.02,skip_special_tokens:v=!0,decode_kwargs:b={}}={}){super(d,{skip_prompt:h,skip_special_tokens:v,callback_function:f,token_callback_function:p,decode_kwargs:b}),this.timestamp_begin=d.timestamp_begin,this.on_chunk_start=_,this.on_chunk_end=w,this.on_finalize=y,this.time_precision=g,this.waiting_for_timestamp=!1}put(d){var f,p,_;if(d.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const h=d[0];if(h.length===1){const w=Number(h[0])-this.timestamp_begin;if(w>=0){const y=w*this.time_precision;this.waiting_for_timestamp?(f=this.on_chunk_end)==null||f.call(this,y):(p=this.on_chunk_start)==null||p.call(this,y),this.waiting_for_timestamp=!this.waiting_for_timestamp,(_=this.token_callback_function)==null||_.call(this,h);return}}return super.put(d)}end(){var d;super.end(),(d=this.on_finalize)==null||d.call(this)}}},"./src/models.js":(e,t,r)=>{r.r(t),r.d(t,{ASTForAudioClassification:()=>Ip,ASTModel:()=>$p,ASTPreTrainedModel:()=>Vd,AlbertForMaskedLM:()=>ie,AlbertForQuestionAnswering:()=>Z,AlbertForSequenceClassification:()=>D,AlbertModel:()=>_e,AlbertPreTrainedModel:()=>ho,AutoModel:()=>Vv,AutoModelForAudioClassification:()=>C2,AutoModelForAudioFrameClassification:()=>A2,AutoModelForAudioTextToText:()=>L2,AutoModelForCTC:()=>P2,AutoModelForCausalLM:()=>g2,AutoModelForDepthEstimation:()=>j2,AutoModelForDocumentQuestionAnswering:()=>$2,AutoModelForImageClassification:()=>w2,AutoModelForImageFeatureExtraction:()=>R2,AutoModelForImageMatting:()=>I2,AutoModelForImageSegmentation:()=>b2,AutoModelForImageTextToText:()=>F2,AutoModelForImageToImage:()=>O2,AutoModelForMaskGeneration:()=>S2,AutoModelForMaskedLM:()=>_2,AutoModelForNormalEstimation:()=>D2,AutoModelForObjectDetection:()=>T2,AutoModelForPoseEstimation:()=>N2,AutoModelForQuestionAnswering:()=>y2,AutoModelForSemanticSegmentation:()=>x2,AutoModelForSeq2SeqLM:()=>h2,AutoModelForSequenceClassification:()=>u2,AutoModelForSpeechSeq2Seq:()=>f2,AutoModelForTextToSpectrogram:()=>p2,AutoModelForTextToWaveform:()=>m2,AutoModelForTokenClassification:()=>d2,AutoModelForUniversalSegmentation:()=>M2,AutoModelForVision2Seq:()=>v2,AutoModelForXVector:()=>k2,AutoModelForZeroShotObjectDetection:()=>E2,BartForConditionalGeneration:()=>hr,BartForSequenceClassification:()=>ln,BartModel:()=>Sr,BartPretrainedModel:()=>Zt,BaseModelOutput:()=>xe,BeitForImageClassification:()=>HS,BeitModel:()=>GS,BeitPreTrainedModel:()=>iv,BertForMaskedLM:()=>$e,BertForQuestionAnswering:()=>Ke,BertForSequenceClassification:()=>Ie,BertForTokenClassification:()=>Ue,BertModel:()=>Ee,BertPreTrainedModel:()=>Te,BlenderbotForConditionalGeneration:()=>Bn,BlenderbotModel:()=>cn,BlenderbotPreTrainedModel:()=>_r,BlenderbotSmallForConditionalGeneration:()=>In,BlenderbotSmallModel:()=>$s,BlenderbotSmallPreTrainedModel:()=>As,BloomForCausalLM:()=>pS,BloomModel:()=>fS,BloomPreTrainedModel:()=>Ky,CLIPModel:()=>Vp,CLIPPreTrainedModel:()=>No,CLIPSegForImageSegmentation:()=>ah,CLIPSegModel:()=>oh,CLIPSegPreTrainedModel:()=>ih,CLIPTextModel:()=>Ny,CLIPTextModelWithProjection:()=>Tl,CLIPVisionModel:()=>El,CLIPVisionModelWithProjection:()=>Jd,CamembertForMaskedLM:()=>ut,CamembertForQuestionAnswering:()=>fn,CamembertForSequenceClassification:()=>sr,CamembertForTokenClassification:()=>wr,CamembertModel:()=>mt,CamembertPreTrainedModel:()=>bt,CausalLMOutput:()=>Il,CausalLMOutputWithPast:()=>QG,ChineseCLIPModel:()=>th,ChineseCLIPPreTrainedModel:()=>eh,ClapAudioModelWithProjection:()=>HC,ClapModel:()=>WC,ClapPreTrainedModel:()=>Jp,ClapTextModelWithProjection:()=>GC,CodeGenForCausalLM:()=>ph,CodeGenModel:()=>fh,CodeGenPreTrainedModel:()=>$l,CohereForCausalLM:()=>qE,CohereModel:()=>KE,CoherePreTrainedModel:()=>Fy,ConvBertForMaskedLM:()=>Kn,ConvBertForQuestionAnswering:()=>W,ConvBertForSequenceClassification:()=>F,ConvBertForTokenClassification:()=>ce,ConvBertModel:()=>at,ConvBertPreTrainedModel:()=>pr,ConvNextForImageClassification:()=>BP,ConvNextModel:()=>LP,ConvNextPreTrainedModel:()=>wv,ConvNextV2ForImageClassification:()=>VP,ConvNextV2Model:()=>zP,ConvNextV2PreTrainedModel:()=>bv,DFineForObjectDetection:()=>iP,DFineModel:()=>sP,DFinePreTrainedModel:()=>dv,DPTForDepthEstimation:()=>bP,DPTModel:()=>wP,DPTPreTrainedModel:()=>_v,DacDecoderModel:()=>jk,DacDecoderOutput:()=>$k,DacEncoderModel:()=>Ok,DacEncoderOutput:()=>Ak,DacModel:()=>Ik,DacPreTrainedModel:()=>im,DebertaForMaskedLM:()=>Xs,DebertaForQuestionAnswering:()=>io,DebertaForSequenceClassification:()=>wi,DebertaForTokenClassification:()=>Js,DebertaModel:()=>Ln,DebertaPreTrainedModel:()=>Er,DebertaV2ForMaskedLM:()=>ks,DebertaV2ForQuestionAnswering:()=>lo,DebertaV2ForSequenceClassification:()=>bi,DebertaV2ForTokenClassification:()=>ao,DebertaV2Model:()=>oo,DebertaV2PreTrainedModel:()=>ss,DecisionTransformerModel:()=>fk,DecisionTransformerPreTrainedModel:()=>hk,DeiTForImageClassification:()=>uP,DeiTModel:()=>cP,DeiTPreTrainedModel:()=>fv,DepthAnythingForDepthEstimation:()=>MP,DepthAnythingPreTrainedModel:()=>xP,DepthProForDepthEstimation:()=>CP,DepthProPreTrainedModel:()=>PP,DetrForObjectDetection:()=>qS,DetrForSegmentation:()=>ov,DetrModel:()=>KS,DetrObjectDetectionOutput:()=>av,DetrPreTrainedModel:()=>Hp,DetrSegmentationOutput:()=>QS,Dinov2ForImageClassification:()=>WP,Dinov2Model:()=>UP,Dinov2PreTrainedModel:()=>xv,Dinov2WithRegistersForImageClassification:()=>HP,Dinov2WithRegistersModel:()=>GP,Dinov2WithRegistersPreTrainedModel:()=>Mv,DistilBertForMaskedLM:()=>Fe,DistilBertForQuestionAnswering:()=>qn,DistilBertForSequenceClassification:()=>xn,DistilBertForTokenClassification:()=>xi,DistilBertModel:()=>co,DistilBertPreTrainedModel:()=>Wr,DonutSwinModel:()=>FP,DonutSwinPreTrainedModel:()=>RP,EfficientNetForImageClassification:()=>ZC,EfficientNetModel:()=>JC,EfficientNetPreTrainedModel:()=>Ov,ElectraForMaskedLM:()=>Re,ElectraForQuestionAnswering:()=>er,ElectraForSequenceClassification:()=>Se,ElectraForTokenClassification:()=>jt,ElectraModel:()=>ye,ElectraPreTrainedModel:()=>le,EsmForMaskedLM:()=>ir,EsmForSequenceClassification:()=>Zs,EsmForTokenClassification:()=>ei,EsmModel:()=>pt,EsmPreTrainedModel:()=>nt,ExaoneForCausalLM:()=>ze,ExaoneModel:()=>ke,ExaonePreTrainedModel:()=>pe,FalconForCausalLM:()=>UC,FalconModel:()=>VC,FalconPreTrainedModel:()=>Av,FastViTForImageClassification:()=>jS,FastViTModel:()=>OS,FastViTPreTrainedModel:()=>ev,Florence2ForConditionalGeneration:()=>Rp,Florence2PreTrainedModel:()=>Kd,GLPNForDepthEstimation:()=>NP,GLPNModel:()=>DP,GLPNPreTrainedModel:()=>vv,GPT2LMHeadModel:()=>Wp,GPT2Model:()=>vt,GPT2PreTrainedModel:()=>ca,GPTBigCodeForCausalLM:()=>Xc,GPTBigCodeModel:()=>Al,GPTBigCodePreTrainedModel:()=>Yc,GPTJForCausalLM:()=>hh,GPTJModel:()=>dh,GPTJPreTrainedModel:()=>kl,GPTNeoForCausalLM:()=>qc,GPTNeoModel:()=>Cl,GPTNeoPreTrainedModel:()=>ys,GPTNeoXForCausalLM:()=>uh,GPTNeoXModel:()=>ch,GPTNeoXPreTrainedModel:()=>Qc,Gemma2ForCausalLM:()=>JE,Gemma2Model:()=>XE,Gemma2PreTrainedModel:()=>By,Gemma3ForCausalLM:()=>eS,Gemma3Model:()=>ZE,Gemma3PreTrainedModel:()=>zy,Gemma3nForConditionalGeneration:()=>Qd,Gemma3nPreTrainedModel:()=>qd,GemmaForCausalLM:()=>YE,GemmaModel:()=>QE,GemmaPreTrainedModel:()=>Ly,GlmForCausalLM:()=>ee,GlmModel:()=>H,GlmPreTrainedModel:()=>N,GraniteForCausalLM:()=>HE,GraniteModel:()=>GE,GranitePreTrainedModel:()=>Ry,GroundingDinoForObjectDetection:()=>qP,GroundingDinoPreTrainedModel:()=>KP,GroupViTModel:()=>IS,GroupViTPreTrainedModel:()=>$S,HeliumForCausalLM:()=>A,HeliumModel:()=>T,HeliumPreTrainedModel:()=>Zc,HieraForImageClassification:()=>hP,HieraModel:()=>dP,HieraPreTrainedModel:()=>pv,HubertForCTC:()=>TC,HubertForSequenceClassification:()=>EC,HubertModel:()=>MC,HubertPreTrainedModel:()=>DG,IJepaForImageClassification:()=>xS,IJepaModel:()=>bS,IJepaPreTrainedModel:()=>Xy,Idefics3ForConditionalGeneration:()=>Wc,Idefics3PreTrainedModel:()=>Bp,ImageMattingOutput:()=>z2,JAISLMHeadModel:()=>Pl,JAISModel:()=>lh,JAISPreTrainedModel:()=>Kc,JinaCLIPModel:()=>rh,JinaCLIPPreTrainedModel:()=>Sl,JinaCLIPTextModel:()=>nh,JinaCLIPVisionModel:()=>sh,LiteWhisperForConditionalGeneration:()=>Gd,LlamaForCausalLM:()=>gh,LlamaModel:()=>mh,LlamaPreTrainedModel:()=>Jc,LlavaForConditionalGeneration:()=>Ml,LlavaOnevisionForConditionalGeneration:()=>la,LlavaPreTrainedModel:()=>Vc,LlavaQwen2ForCausalLM:()=>Uc,LongT5ForConditionalGeneration:()=>Xe,LongT5Model:()=>tt,LongT5PreTrainedModel:()=>Ge,M2M100ForConditionalGeneration:()=>sC,M2M100Model:()=>nC,M2M100PreTrainedModel:()=>Sv,MBartForCausalLM:()=>Ti,MBartForConditionalGeneration:()=>Tn,MBartForSequenceClassification:()=>Ar,MBartModel:()=>Mn,MBartPreTrainedModel:()=>pn,MPNetForMaskedLM:()=>ml,MPNetForQuestionAnswering:()=>yl,MPNetForSequenceClassification:()=>gl,MPNetForTokenClassification:()=>_l,MPNetModel:()=>pl,MPNetPreTrainedModel:()=>Mi,MT5ForConditionalGeneration:()=>tr,MT5Model:()=>St,MT5PreTrainedModel:()=>st,MarianMTModel:()=>rC,MarianModel:()=>tC,MarianPreTrainedModel:()=>Ev,MaskFormerForInstanceSegmentation:()=>jP,MaskFormerModel:()=>OP,MaskFormerPreTrainedModel:()=>yv,MaskedLMOutput:()=>jn,Metric3DForDepthEstimation:()=>AP,Metric3DPreTrainedModel:()=>kP,Metric3Dv2ForDepthEstimation:()=>IP,Metric3Dv2PreTrainedModel:()=>$P,MgpstrForSceneTextRecognition:()=>yk,MgpstrModelOutput:()=>gk,MgpstrPreTrainedModel:()=>_k,MimiDecoderModel:()=>kk,MimiDecoderOutput:()=>Sk,MimiEncoderModel:()=>Ck,MimiEncoderOutput:()=>Ek,MimiModel:()=>Pk,MimiPreTrainedModel:()=>sm,MistralForCausalLM:()=>LC,MistralModel:()=>FC,MistralPreTrainedModel:()=>Cv,MobileBertForMaskedLM:()=>en,MobileBertForQuestionAnswering:()=>ri,MobileBertForSequenceClassification:()=>an,MobileBertModel:()=>ti,MobileBertPreTrainedModel:()=>Zr,MobileLLMForCausalLM:()=>$t,MobileLLMModel:()=>lt,MobileLLMPreTrainedModel:()=>Ze,MobileNetV1ForImageClassification:()=>tk,MobileNetV1ForSemanticSegmentation:()=>rk,MobileNetV1Model:()=>ek,MobileNetV1PreTrainedModel:()=>em,MobileNetV2ForImageClassification:()=>sk,MobileNetV2ForSemanticSegmentation:()=>ik,MobileNetV2Model:()=>nk,MobileNetV2PreTrainedModel:()=>tm,MobileNetV3ForImageClassification:()=>ak,MobileNetV3ForSemanticSegmentation:()=>lk,MobileNetV3Model:()=>ok,MobileNetV3PreTrainedModel:()=>rm,MobileNetV4ForImageClassification:()=>uk,MobileNetV4ForSemanticSegmentation:()=>dk,MobileNetV4Model:()=>ck,MobileNetV4PreTrainedModel:()=>nm,MobileViTForImageClassification:()=>FS,MobileViTModel:()=>RS,MobileViTPreTrainedModel:()=>tv,MobileViTV2ForImageClassification:()=>BS,MobileViTV2Model:()=>LS,MobileViTV2PreTrainedModel:()=>rv,ModelOutput:()=>be,ModernBertForMaskedLM:()=>qe,ModernBertForSequenceClassification:()=>ot,ModernBertForTokenClassification:()=>ft,ModernBertModel:()=>je,ModernBertPreTrainedModel:()=>Je,Moondream1ForConditionalGeneration:()=>Np,MoonshineForConditionalGeneration:()=>Dp,MoonshineModel:()=>jp,MoonshinePreTrainedModel:()=>zc,MptForCausalLM:()=>gS,MptModel:()=>mS,MptPreTrainedModel:()=>qy,MultiModalityCausalLM:()=>mk,MultiModalityPreTrainedModel:()=>pk,MusicgenForCausalLM:()=>LG,MusicgenForConditionalGeneration:()=>Dv,MusicgenModel:()=>FG,MusicgenPreTrainedModel:()=>jv,NomicBertModel:()=>We,NomicBertPreTrainedModel:()=>it,OPTForCausalLM:()=>yS,OPTModel:()=>_S,OPTPreTrainedModel:()=>Qy,Olmo2ForCausalLM:()=>WE,Olmo2Model:()=>Gp,Olmo2PreTrainedModel:()=>fo,OlmoForCausalLM:()=>gn,OlmoModel:()=>fr,OlmoPreTrainedModel:()=>Qt,OpenELMForCausalLM:()=>rS,OpenELMModel:()=>tS,OpenELMPreTrainedModel:()=>Vy,OwlViTForObjectDetection:()=>VS,OwlViTModel:()=>zS,OwlViTPreTrainedModel:()=>nv,Owlv2ForObjectDetection:()=>WS,Owlv2Model:()=>US,Owlv2PreTrainedModel:()=>sv,PaliGemmaForConditionalGeneration:()=>Lp,PaliGemmaPreTrainedModel:()=>Fp,PatchTSMixerForPrediction:()=>xk,PatchTSMixerModel:()=>bk,PatchTSMixerPreTrainedModel:()=>Rv,PatchTSTForPrediction:()=>wk,PatchTSTModel:()=>vk,PatchTSTPreTrainedModel:()=>Nv,Phi3ForCausalLM:()=>hS,Phi3Model:()=>dS,Phi3PreTrainedModel:()=>Hy,Phi3VForCausalLM:()=>Xd,Phi3VPreTrainedModel:()=>zp,PhiForCausalLM:()=>uS,PhiModel:()=>cS,PhiPreTrainedModel:()=>Gy,PreTrainedModel:()=>J,PretrainedMixin:()=>rr,PvtForImageClassification:()=>SS,PvtModel:()=>ES,PvtPreTrainedModel:()=>Jy,PyAnnoteForAudioFrameClassification:()=>uC,PyAnnoteModel:()=>cC,PyAnnotePreTrainedModel:()=>Pv,QuestionAnsweringModelOutput:()=>Qn,Qwen2ForCausalLM:()=>sS,Qwen2Model:()=>nS,Qwen2PreTrainedModel:()=>Uy,Qwen2VLForConditionalGeneration:()=>lS,Qwen2VLPreTrainedModel:()=>aS,Qwen3ForCausalLM:()=>oS,Qwen3Model:()=>iS,Qwen3PreTrainedModel:()=>Wy,RFDetrForObjectDetection:()=>rP,RFDetrModel:()=>tP,RFDetrObjectDetectionOutput:()=>nP,RFDetrPreTrainedModel:()=>uv,RTDetrForObjectDetection:()=>XS,RTDetrModel:()=>YS,RTDetrObjectDetectionOutput:()=>_h,RTDetrPreTrainedModel:()=>lv,RTDetrV2ForObjectDetection:()=>ZS,RTDetrV2Model:()=>JS,RTDetrV2ObjectDetectionOutput:()=>eP,RTDetrV2PreTrainedModel:()=>cv,ResNetForImageClassification:()=>pP,ResNetModel:()=>fP,ResNetPreTrainedModel:()=>mv,RoFormerForMaskedLM:()=>yt,RoFormerForQuestionAnswering:()=>dr,RoFormerForSequenceClassification:()=>Mt,RoFormerForTokenClassification:()=>Lt,RoFormerModel:()=>De,RoFormerPreTrainedModel:()=>Be,RobertaForMaskedLM:()=>$r,RobertaForQuestionAnswering:()=>On,RobertaForSequenceClassification:()=>tn,RobertaForTokenClassification:()=>rn,RobertaModel:()=>mn,RobertaPreTrainedModel:()=>zn,SamImageSegmentationOutput:()=>eC,SamModel:()=>ZP,SamPreTrainedModel:()=>JP,SapiensForDepthEstimation:()=>EP,SapiensForNormalEstimation:()=>SP,SapiensForSemanticSegmentation:()=>TP,SapiensPreTrainedModel:()=>qp,SegformerForImageClassification:()=>qC,SegformerForSemanticSegmentation:()=>QC,SegformerModel:()=>RG,SegformerPreTrainedModel:()=>Zp,Seq2SeqLMOutput:()=>qG,SequenceClassifierOutput:()=>Dt,SiglipModel:()=>Up,SiglipPreTrainedModel:()=>Zd,SiglipTextModel:()=>Gc,SiglipVisionModel:()=>Hc,SmolVLMForConditionalGeneration:()=>Yd,SnacDecoderModel:()=>Rk,SnacEncoderModel:()=>Nk,SnacModel:()=>Dk,SnacPreTrainedModel:()=>om,SpeechT5ForSpeechToText:()=>OC,SpeechT5ForTextToSpeech:()=>jC,SpeechT5HifiGan:()=>DC,SpeechT5Model:()=>NG,SpeechT5PreTrainedModel:()=>Xp,SqueezeBertForMaskedLM:()=>vl,SqueezeBertForQuestionAnswering:()=>bl,SqueezeBertForSequenceClassification:()=>wl,SqueezeBertModel:()=>oa,SqueezeBertPreTrainedModel:()=>uo,StableLmForCausalLM:()=>XC,StableLmModel:()=>YC,StableLmPreTrainedModel:()=>Iv,Starcoder2ForCausalLM:()=>zC,Starcoder2Model:()=>BC,Starcoder2PreTrainedModel:()=>kv,StyleTextToSpeech2Model:()=>IC,StyleTextToSpeech2PreTrainedModel:()=>$C,Swin2SRForImageSuperResolution:()=>vP,Swin2SRModel:()=>yP,Swin2SRPreTrainedModel:()=>gv,SwinForImageClassification:()=>gP,SwinForSemanticSegmentation:()=>_P,SwinModel:()=>mP,SwinPreTrainedModel:()=>Kp,T5ForConditionalGeneration:()=>Ce,T5Model:()=>ge,T5PreTrainedModel:()=>he,TableTransformerForObjectDetection:()=>aP,TableTransformerModel:()=>oP,TableTransformerObjectDetectionOutput:()=>lP,TableTransformerPreTrainedModel:()=>hv,TokenClassifierOutput:()=>En,TrOCRForCausalLM:()=>RC,TrOCRPreTrainedModel:()=>NC,UltravoxModel:()=>Tk,UltravoxPreTrainedModel:()=>Mk,UniSpeechForCTC:()=>pC,UniSpeechForSequenceClassification:()=>mC,UniSpeechModel:()=>fC,UniSpeechPreTrainedModel:()=>Qp,UniSpeechSatForAudioFrameClassification:()=>vC,UniSpeechSatForCTC:()=>_C,UniSpeechSatForSequenceClassification:()=>yC,UniSpeechSatModel:()=>gC,UniSpeechSatPreTrainedModel:()=>yh,ViTForImageClassification:()=>wS,ViTMAEModel:()=>CS,ViTMAEPreTrainedModel:()=>PS,ViTMSNForImageClassification:()=>AS,ViTMSNModel:()=>kS,ViTMSNPreTrainedModel:()=>Zy,ViTModel:()=>vS,ViTPreTrainedModel:()=>Yy,VisionEncoderDecoderModel:()=>Hd,VitMatteForImageMatting:()=>NS,VitMattePreTrainedModel:()=>DS,VitPoseForPoseEstimation:()=>TS,VitPosePreTrainedModel:()=>MS,VitsModel:()=>$v,VitsModelOutput:()=>V2,VitsPreTrainedModel:()=>KC,Wav2Vec2BertForCTC:()=>bC,Wav2Vec2BertForSequenceClassification:()=>xC,Wav2Vec2BertModel:()=>wC,Wav2Vec2BertPreTrainedModel:()=>Yp,Wav2Vec2ForAudioFrameClassification:()=>lC,Wav2Vec2ForCTC:()=>oC,Wav2Vec2ForSequenceClassification:()=>aC,Wav2Vec2Model:()=>iC,Wav2Vec2PreTrainedModel:()=>ua,WavLMForAudioFrameClassification:()=>AC,WavLMForCTC:()=>PC,WavLMForSequenceClassification:()=>CC,WavLMForXVector:()=>kC,WavLMModel:()=>SC,WavLMPreTrainedModel:()=>eu,WeSpeakerResNetModel:()=>hC,WeSpeakerResNetPreTrainedModel:()=>dC,WhisperForConditionalGeneration:()=>Wd,WhisperModel:()=>Op,WhisperPreTrainedModel:()=>Ud,XLMForQuestionAnswering:()=>zd,XLMForSequenceClassification:()=>Tp,XLMForTokenClassification:()=>Ep,XLMModel:()=>xl,XLMPreTrainedModel:()=>ni,XLMRobertaForMaskedLM:()=>Pp,XLMRobertaForQuestionAnswering:()=>Ap,XLMRobertaForSequenceClassification:()=>Cp,XLMRobertaForTokenClassification:()=>kp,XLMRobertaModel:()=>Sp,XLMRobertaPreTrainedModel:()=>aa,XLMWithLMHeadModel:()=>Mp,XVectorOutput:()=>B2,YolosForObjectDetection:()=>YP,YolosModel:()=>QP,YolosObjectDetectionOutput:()=>XP,YolosPreTrainedModel:()=>Tv});var n=r("./src/configs.js"),s=r("./src/backends/onnx.js"),i=r("./src/utils/dtypes.js"),o=r("./src/utils/generic.js"),a=r("./src/utils/core.js"),l=r("./src/utils/hub.js"),c=r("./src/utils/constants.js"),u=r("./src/generation/logits_process.js"),d=r("./src/generation/configuration_utils.js"),h=r("./src/utils/tensor.js"),f=r("./src/utils/image.js"),p=r("./src/utils/maths.js"),_=r("./src/generation/stopping_criteria.js"),w=r("./src/generation/logits_sampler.js"),y=r("./src/env.js"),g=r("./src/models/whisper/generation_whisper.js"),v=r("./src/models/whisper/common_whisper.js");const b={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12},x=new Map,M=new Map,E=new Map;async function P(k,$,z){var Sn;let ue=((Sn=z.config)==null?void 0:Sn["transformers.js_config"])??{},we=z.device??ue.device;we&&typeof we!="string"&&(we.hasOwnProperty($)?we=we[$]:(console.warn(`device not specified for "${$}". Using the default device.`),we=null));const ve=we??(y.apis.IS_NODE_ENV?"cpu":"wasm"),Ae=(0,s.deviceToExecutionProviders)(ve),Ve=ue.device_config??{};Ve.hasOwnProperty(ve)&&(ue={...ue,...Ve[ve]});let Qe=z.dtype??ue.dtype;if(typeof Qe!="string"&&(Qe&&Qe.hasOwnProperty($)?Qe=Qe[$]:(Qe=i.DEFAULT_DEVICE_DTYPE_MAPPING[ve]??i.DATA_TYPES.fp32,console.warn(`dtype not specified for "${$}". Using the default dtype (${Qe}) for this device (${ve}).`))),Qe===i.DATA_TYPES.auto){let Ut=ue.dtype;typeof Ut!="string"&&(Ut=Ut==null?void 0:Ut[$]),Ut&&Ut!==i.DATA_TYPES.auto&&i.DATA_TYPES.hasOwnProperty(Ut)?Qe=Ut:Qe=i.DEFAULT_DEVICE_DTYPE_MAPPING[ve]??i.DATA_TYPES.fp32}const rt=Qe;if(i.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(rt)){if(rt===i.DATA_TYPES.fp16&&ve==="webgpu"&&!await(0,i.isWebGpuFp16Supported)())throw new Error(`The device (${ve}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${rt}. Should be one of: ${Object.keys(i.DATA_TYPES).join(", ")}`);const xt=ue.kv_cache_dtype,kt=xt?typeof xt=="string"?xt:xt[rt]??"float32":void 0;if(kt&&!["float32","float16"].includes(kt))throw new Error(`Invalid kv_cache_dtype: ${kt}. Should be one of: float32, float16`);const At={dtype:rt,kv_cache_dtype:kt,device:ve},Yt=i.DEFAULT_DTYPE_SUFFIX_MAPPING[rt],Tt=`${$}${Yt}.onnx`,Wt=`${z.subfolder??""}/${Tt}`,_t={...z.session_options};_t.executionProviders??(_t.executionProviders=Ae);const Ht=ue.free_dimension_overrides;Ht?_t.freeDimensionOverrides??(_t.freeDimensionOverrides=Ht):ve.startsWith("webnn")&&!_t.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${ve}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);const mr=y.apis.IS_NODE_ENV&&y.env.useFSCache,Ir=(0,l.getModelFile)(k,Wt,!0,z,mr),Gr=z.use_external_data_format??ue.use_external_data_format;let Br=[];if(Gr){let Ut;typeof Gr=="object"?Gr.hasOwnProperty(Tt)?Ut=Gr[Tt]:Gr.hasOwnProperty($)?Ut=Gr[$]:Ut=!1:Ut=Gr;const _n=+Ut;if(_n>l.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${_n}) exceeds the maximum allowed value (${l.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let Is=0;Is<_n;++Is){const Ol=`${Tt}_data${Is===0?"":"_"+Is}`,is=`${z.subfolder??""}/${Ol}`;Br.push(new Promise(async(si,am)=>{const jl=await(0,l.getModelFile)(k,is,!0,z,mr);si(jl instanceof Uint8Array?{path:Ol,data:jl}:Ol)}))}}else _t.externalData!==void 0&&(Br=_t.externalData.map(async Ut=>{if(typeof Ut.data=="string"){const _n=await(0,l.getModelFile)(k,Ut.data,!0,z);return{...Ut,data:_n}}return Ut}));if(Br.length>0){const Ut=await Promise.all(Br);y.apis.IS_NODE_ENV||(_t.externalData=Ut)}if(ve==="webgpu"){const Ut=(0,n.getKeyValueShapes)(z.config,{prefix:"present"});if(Object.keys(Ut).length>0&&!(0,s.isONNXProxy)()){const _n={};for(const Is in Ut)_n[Is]="gpu-buffer";_t.preferredOutputLocation=_n}}return{buffer_or_path:await Ir,session_options:_t,session_config:At}}async function I(k,$,z){return Object.fromEntries(await Promise.all(Object.keys($).map(async ue=>{const{buffer_or_path:we,session_options:ve,session_config:Ae}=await P(k,$[ue],z),Ve=await(0,s.createInferenceSession)(we,ve,Ae);return[ue,Ve]})))}async function O(k,$,z){return Object.fromEntries(await Promise.all(Object.keys($).map(async ue=>{const we=await(0,l.getModelJSON)(k,$[ue],!1,z);return[ue,we]})))}function V(k,$){const z=Object.create(null),ue=[];for(const Ae of k.inputNames){const Ve=$[Ae];if(!(Ve instanceof h.Tensor)){ue.push(Ae);continue}z[Ae]=(0,s.isONNXProxy)()?Ve.clone():Ve}if(ue.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${ue.join(", ")}.`);const we=Object.keys($).length,ve=k.inputNames.length;if(we>ve){let Ae=Object.keys($).filter(Ve=>!k.inputNames.includes(Ve));console.warn(`WARNING: Too many inputs were provided (${we} > ${ve}). The following inputs will be ignored: "${Ae.join(", ")}".`)}return z}let U=Promise.resolve();async function B(k,$){const z=V(k,$);try{const ue=Object.fromEntries(Object.entries(z).map(([Ae,Ve])=>[Ae,Ve.ort_tensor])),we=()=>k.run(ue),ve=await(y.apis.IS_BROWSER_ENV||y.apis.IS_WEBWORKER_ENV?U=U.then(we):we());return Y(ve)}catch(ue){const we=Object.fromEntries(Object.entries(z).map(([ve,Ae])=>{const Ve={type:Ae.type,dims:Ae.dims,location:Ae.location};return Ve.location!=="gpu-buffer"&&(Ve.data=Ae.data),[ve,Ve]}));throw console.error(`An error occurred during model execution: "${ue}".`),console.error("Inputs given to model:",we),ue}}function Y(k){for(let $ in k)(0,s.isONNXTensor)(k[$])?k[$]=new h.Tensor(k[$]):typeof k[$]=="object"&&Y(k[$]);return k}function K(k){if(k instanceof h.Tensor)return k;if(k.length===0)throw Error("items must be non-empty");if(Array.isArray(k[0])){if(k.some($=>$.length!==k[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new h.Tensor("int64",BigInt64Array.from(k.flat().map($=>BigInt($))),[k.length,k[0].length])}else return new h.Tensor("int64",BigInt64Array.from(k.map($=>BigInt($))),[1,k.length])}function X(k){return new h.Tensor("bool",[k],[1])}async function G(k,$){let{encoder_outputs:z,input_ids:ue,decoder_input_ids:we,...ve}=$;if(!z){const Ve=(0,a.pick)($,k.sessions.model.inputNames);z=(await R(k,Ve)).last_hidden_state}return ve.input_ids=we,ve.encoder_hidden_states=z,k.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(ve.encoder_attention_mask=$.attention_mask),await re(k,ve,!0)}async function R(k,$){const z=k.sessions.model,ue=(0,a.pick)($,z.inputNames);if(z.inputNames.includes("inputs_embeds")&&!ue.inputs_embeds){if(!$.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");ue.inputs_embeds=await k.encode_text({input_ids:$.input_ids})}if(z.inputNames.includes("token_type_ids")&&!ue.token_type_ids){if(!ue.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");ue.token_type_ids=(0,h.zeros_like)(ue.input_ids)}if(z.inputNames.includes("pixel_mask")&&!ue.pixel_mask){if(!ue.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const we=ue.pixel_values.dims;ue.pixel_mask=(0,h.ones)([we[0],we[2],we[3]])}return await B(z,ue)}async function te(k,$){const z=await k.encode($);return await k.decode(z)}async function re(k,$,z=!1){const ue=k.sessions[z?"decoder_model_merged":"model"],{past_key_values:we,...ve}=$;if(ue.inputNames.includes("use_cache_branch")&&(ve.use_cache_branch=X(!!we)),ue.inputNames.includes("position_ids")&&ve.attention_mask&&!ve.position_ids){const Ve=["paligemma","gemma3_text","gemma3"].includes(k.config.model_type)?1:0;ve.position_ids=Pe(ve,we,Ve)}k.addPastKeyValues(ve,we);const Ae=(0,a.pick)(ve,ue.inputNames);return await B(ue,Ae)}function L({modality_token_id:k,inputs_embeds:$,modality_features:z,input_ids:ue,attention_mask:we}){const ve=ue.tolist().map(rt=>rt.reduce((xt,kt,At)=>(kt==k&&xt.push(At),xt),[])),Ae=ve.reduce((rt,xt)=>rt+xt.length,0),Ve=z.dims[0];if(Ae!==Ve)throw new Error(`Number of tokens and features do not match: tokens: ${Ae}, features ${Ve}`);let Qe=0;for(let rt=0;rt<ve.length;++rt){const xt=ve[rt],kt=$[rt];for(let At=0;At<xt.length;++At)kt[xt[At]].data.set(z[Qe++].data)}return{inputs_embeds:$,attention_mask:we}}function j({image_token_id:k,inputs_embeds:$,image_features:z,input_ids:ue,attention_mask:we}){return L({modality_token_id:k,inputs_embeds:$,modality_features:z,input_ids:ue,attention_mask:we})}function q({audio_token_id:k,inputs_embeds:$,audio_features:z,input_ids:ue,attention_mask:we}){return L({modality_token_id:k,inputs_embeds:$,modality_features:z,input_ids:ue,attention_mask:we})}async function ne(k,{encode_function:$,merge_function:z,modality_input_name:ue,modality_output_name:we,input_ids:ve=null,attention_mask:Ae=null,position_ids:Ve=null,inputs_embeds:Qe=null,past_key_values:rt=null,generation_config:xt=null,logits_processor:kt=null,...At}){const Yt=At[ue];if(!Qe){if(Qe=await k.encode_text({input_ids:ve,...At}),Yt&&ve.dims[1]!==1){const Wt=await $({[ue]:Yt,...At});({inputs_embeds:Qe,attention_mask:Ae}=z({[we]:Wt,inputs_embeds:Qe,input_ids:ve,attention_mask:Ae}))}else if(rt&&Yt&&ve.dims[1]===1){const Wt=ve.dims[1],_t=Object.values(rt)[0].dims.at(-2);Ae=(0,h.cat)([(0,h.ones)([ve.dims[0],_t]),Ae.slice(null,[Ae.dims[1]-Wt,Ae.dims[1]])],1)}}if(!Ve&&k.config.model_type==="qwen2_vl"){const{image_grid_thw:Wt,video_grid_thw:_t}=At;[Ve]=k.get_rope_index(ve,Wt,_t,Ae)}return await re(k,{inputs_embeds:Qe,past_key_values:rt,attention_mask:Ae,position_ids:Ve,generation_config:xt,logits_processor:kt},!0)}async function me(k,$){return await ne(k,{...$,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:k.encode_audio.bind(k),merge_function:k._merge_input_ids_with_audio_features.bind(k)})}async function ae(k,$){return await ne(k,{...$,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:k.encode_image.bind(k),merge_function:k._merge_input_ids_with_image_features.bind(k)})}function fe(k,$=0){const[z,ue]=k.dims,we=k.data,ve=new BigInt64Array(we.length);for(let Ae=0;Ae<z;++Ae){const Ve=Ae*ue;let Qe=BigInt($);for(let rt=0;rt<ue;++rt){const xt=Ve+rt;we[xt]===0n?ve[xt]=BigInt(1):(ve[xt]=Qe,Qe+=we[xt])}}return{data:ve,dims:k.dims}}function Pe(k,$=null,z=0){const{input_ids:ue,inputs_embeds:we,attention_mask:ve}=k,{data:Ae,dims:Ve}=fe(ve,z);let Qe=new h.Tensor("int64",Ae,Ve);if($){const rt=-(ue??we).dims.at(1);Qe=Qe.slice(null,[rt,null])}return Qe}function Ne(k,$,z,ue){const we=z.past_key_values?Object.values(z.past_key_values)[0].dims.at(-2):0;if(!z.attention_mask){let ve;for(const Ae of["input_ids","inputs_embeds","position_ids"])if(z[Ae]){ve=z[Ae].dims;break}if(!ve)throw new Error("attention_mask is not provided, and unable to infer its shape from model inputs.");z.attention_mask=(0,h.ones)([ve[0],we+ve[1]])}if(z.past_key_values){const{input_ids:ve,attention_mask:Ae}=z;Ae&&Ae.dims[1]>ve.dims[1]||we<ve.dims[1]&&(z.input_ids=ve.slice(null,[we,null]))}return z}function de(k,$,z,ue){return z.past_key_values&&($=$.map(we=>[we.at(-1)])),{...z,decoder_input_ids:K($)}}function Q(k,...$){return k.config.is_encoder_decoder?de(k,...$):Ne(k,...$)}function se(k,$,z,ue){const we=!!z.past_key_values;return ue.guidance_scale!==null&&ue.guidance_scale>1&&(we?z.input_ids=(0,h.cat)([z.input_ids,z.input_ids],0):(z.input_ids=(0,h.cat)([z.input_ids,(0,h.full_like)(z.input_ids,BigInt(ue.pad_token_id))],0),z.attention_mask=(0,h.cat)([z.attention_mask,(0,h.full_like)(z.attention_mask,0n)],0))),(we||!z.pixel_values)&&(z.pixel_values=(0,h.full)([0,0,3,384,384],1)),we&&(z.images_seq_mask=new h.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),z.images_emb_mask=new h.Tensor("bool",new Array(0).fill(!1),[1,1,0])),z}class J extends o.Callable{constructor(z,ue,we){super();oe(this,"main_input_name","input_ids");oe(this,"forward_params",["input_ids","attention_mask"]);this.config=z,this.sessions=ue,this.configs=we;const ve=E.get(this.constructor),Ae=x.get(ve);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,Ae){case b.DecoderOnly:this.can_generate=!0,this._forward=re,this._prepare_inputs_for_generation=Ne;break;case b.Seq2Seq:case b.Vision2Seq:case b.Musicgen:this.can_generate=!0,this._forward=G,this._prepare_inputs_for_generation=de;break;case b.EncoderDecoder:this._forward=G;break;case b.ImageTextToText:this.can_generate=!0,this._forward=ae,this._prepare_inputs_for_generation=Q;break;case b.AudioTextToText:this.can_generate=!0,this._forward=me,this._prepare_inputs_for_generation=Q;break;case b.Phi3V:case b.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=Q;break;case b.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=se;break;case b.AutoEncoder:this._forward=te;break;default:this._forward=R;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){var ue;const z=[];for(const we of Object.values(this.sessions))(ue=we==null?void 0:we.handler)!=null&&ue.dispose&&z.push(we.handler.dispose());return await Promise.all(z)}static async from_pretrained(z,{progress_callback:ue=null,config:we=null,cache_dir:ve=null,local_files_only:Ae=!1,revision:Ve="main",model_file_name:Qe=null,subfolder:rt="onnx",device:xt=null,dtype:kt=null,use_external_data_format:At=null,session_options:Yt={}}={}){let Tt={progress_callback:ue,config:we,cache_dir:ve,local_files_only:Ae,revision:Ve,model_file_name:Qe,subfolder:rt,device:xt,dtype:kt,use_external_data_format:At,session_options:Yt};const Wt=E.get(this),_t=x.get(Wt);we=Tt.config=await n.AutoConfig.from_pretrained(z,Tt);let Ht;if(_t===b.DecoderOnly)Ht=await Promise.all([I(z,{model:Tt.model_file_name??"model"},Tt),O(z,{generation_config:"generation_config.json"},Tt)]);else if(_t===b.Seq2Seq||_t===b.Vision2Seq)Ht=await Promise.all([I(z,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},Tt),O(z,{generation_config:"generation_config.json"},Tt)]);else if(_t===b.MaskGeneration)Ht=await Promise.all([I(z,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},Tt)]);else if(_t===b.EncoderDecoder)Ht=await Promise.all([I(z,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},Tt)]);else if(_t===b.ImageTextToText){const mr={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};we.is_encoder_decoder&&(mr.model="encoder_model"),Ht=await Promise.all([I(z,mr,Tt),O(z,{generation_config:"generation_config.json"},Tt)])}else if(_t===b.AudioTextToText){const mr={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};Ht=await Promise.all([I(z,mr,Tt),O(z,{generation_config:"generation_config.json"},Tt)])}else if(_t===b.ImageAudioTextToText){const mr={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};Ht=await Promise.all([I(z,mr,Tt),O(z,{generation_config:"generation_config.json"},Tt)])}else if(_t===b.Musicgen)Ht=await Promise.all([I(z,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},Tt),O(z,{generation_config:"generation_config.json"},Tt)]);else if(_t===b.MultiModality)Ht=await Promise.all([I(z,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},Tt),O(z,{generation_config:"generation_config.json"},Tt)]);else if(_t===b.Phi3V)Ht=await Promise.all([I(z,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},Tt),O(z,{generation_config:"generation_config.json"},Tt)]);else if(_t===b.AutoEncoder)Ht=await Promise.all([I(z,{encoder_model:"encoder_model",decoder_model:"decoder_model"},Tt)]);else{if(_t!==b.EncoderOnly){const mr=Wt??(we==null?void 0:we.model_type);mr!=="custom"&&console.warn(`Model type for '${mr}' not found, assuming encoder-only architecture. Please report this at ${c.GITHUB_ISSUE_URL}.`)}Ht=await Promise.all([I(z,{model:Tt.model_file_name??"model"},Tt)])}return new this(we,...Ht)}async _call(z){return await this.forward(z)}async forward(z){return await this._forward(this,z)}get generation_config(){var z;return((z=this.configs)==null?void 0:z.generation_config)??null}_get_logits_warper(z){const ue=new u.LogitsProcessorList;return z.temperature!==null&&z.temperature!==1&&ue.push(new u.TemperatureLogitsWarper(z.temperature)),z.top_k!==null&&z.top_k!==0&&ue.push(new u.TopKLogitsWarper(z.top_k)),z.top_p!==null&&z.top_p<1&&ue.push(new u.TopPLogitsWarper(z.top_p)),ue}_get_logits_processor(z,ue,we=null){const ve=new u.LogitsProcessorList;if(z.repetition_penalty!==null&&z.repetition_penalty!==1&&ve.push(new u.RepetitionPenaltyLogitsProcessor(z.repetition_penalty)),z.no_repeat_ngram_size!==null&&z.no_repeat_ngram_size>0&&ve.push(new u.NoRepeatNGramLogitsProcessor(z.no_repeat_ngram_size)),z.bad_words_ids!==null&&ve.push(new u.NoBadWordsLogitsProcessor(z.bad_words_ids,z.eos_token_id)),z.min_length!==null&&z.eos_token_id!==null&&z.min_length>0&&ve.push(new u.MinLengthLogitsProcessor(z.min_length,z.eos_token_id)),z.min_new_tokens!==null&&z.eos_token_id!==null&&z.min_new_tokens>0&&ve.push(new u.MinNewTokensLengthLogitsProcessor(ue,z.min_new_tokens,z.eos_token_id)),z.forced_bos_token_id!==null&&ve.push(new u.ForcedBOSTokenLogitsProcessor(z.forced_bos_token_id)),z.forced_eos_token_id!==null&&ve.push(new u.ForcedEOSTokenLogitsProcessor(z.max_length,z.forced_eos_token_id)),z.begin_suppress_tokens!==null){const Ae=ue>1||z.forced_bos_token_id===null?ue:ue+1;ve.push(new u.SuppressTokensAtBeginLogitsProcessor(z.begin_suppress_tokens,Ae))}return z.guidance_scale!==null&&z.guidance_scale>1&&ve.push(new u.ClassifierFreeGuidanceLogitsProcessor(z.guidance_scale)),we!==null&&ve.extend(we),ve}_prepare_generation_config(z,ue,we=d.GenerationConfig){const ve={...this.config};for(const Ve of["decoder","generator","text_config"])Ve in ve&&Object.assign(ve,ve[Ve]);const Ae=new we(ve);return Object.assign(Ae,this.generation_config??{}),z&&Object.assign(Ae,z),ue&&Object.assign(Ae,(0,a.pick)(ue,Object.getOwnPropertyNames(Ae))),Ae}_get_stopping_criteria(z,ue=null){const we=new _.StoppingCriteriaList;return z.max_length!==null&&we.push(new _.MaxLengthCriteria(z.max_length,this.config.max_position_embeddings??null)),z.eos_token_id!==null&&we.push(new _.EosTokenCriteria(z.eos_token_id)),ue&&we.extend(ue),we}_validate_model_class(){if(!this.can_generate){const z=[Bv,zv,Lv,Fv],ue=E.get(this.constructor),we=new Set,ve=this.config.model_type;for(const Ve of z){const Qe=Ve.get(ve);Qe&&we.add(Qe[0])}let Ae=`The current model class (${ue}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw we.size>0&&(Ae+=` Please use the following class instead: ${[...we].join(", ")}`),Error(Ae)}}prepare_inputs_for_generation(...z){return this._prepare_inputs_for_generation(this,...z)}_update_model_kwargs_for_generation({generated_input_ids:z,outputs:ue,model_inputs:we,is_encoder_decoder:ve}){return we.past_key_values=this.getPastKeyValues(ue,we.past_key_values),we.input_ids=new h.Tensor("int64",z.flat(),[z.length,1]),ve||(we.attention_mask=(0,h.cat)([we.attention_mask,(0,h.ones)([we.attention_mask.dims[0],1])],1)),we.position_ids=null,we}_prepare_model_inputs({inputs:z,bos_token_id:ue,model_kwargs:we}){const ve=(0,a.pick)(we,this.forward_params),Ae=this.main_input_name;if(Ae in ve){if(z)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else ve[Ae]=z;return{inputs_tensor:ve[Ae],model_inputs:ve,model_input_name:Ae}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:z,model_inputs:ue,model_input_name:we,generation_config:ve}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!ue.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:Ve,pixel_values:Qe,attention_mask:rt,...xt}=ue,kt=await this._prepare_inputs_embeds(ue);ue={...xt,...(0,a.pick)(kt,["inputs_embeds","attention_mask"])}}let{last_hidden_state:Ae}=await R(this,ue);if(ve.guidance_scale!==null&&ve.guidance_scale>1)Ae=(0,h.cat)([Ae,(0,h.full_like)(Ae,0)],0),"attention_mask"in ue&&(ue.attention_mask=(0,h.cat)([ue.attention_mask,(0,h.zeros_like)(ue.attention_mask)],0));else if(ue.decoder_input_ids){const Ve=K(ue.decoder_input_ids).dims[0];if(Ve!==Ae.dims[0]){if(Ae.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${Ae.dims[0]}) than the decoder inputs (${Ve}).`);Ae=(0,h.cat)(Array.from({length:Ve},()=>Ae),0)}}return ue.encoder_outputs=Ae,ue}_prepare_decoder_input_ids_for_generation({batch_size:z,model_input_name:ue,model_kwargs:we,decoder_start_token_id:ve,bos_token_id:Ae,generation_config:Ve}){let{decoder_input_ids:Qe,...rt}=we;if(!(Qe instanceof h.Tensor)){if(Qe)Array.isArray(Qe[0])||(Qe=Array.from({length:z},()=>Qe));else if(ve??(ve=Ae),this.config.model_type==="musicgen")Qe=Array.from({length:z*this.config.decoder.num_codebooks},()=>[ve]);else if(Array.isArray(ve)){if(ve.length!==z)throw new Error(`\`decoder_start_token_id\` expcted to have length ${z} but got ${ve.length}`);Qe=ve}else Qe=Array.from({length:z},()=>[ve]);Qe=K(Qe)}return we.decoder_attention_mask=(0,h.ones_like)(Qe),{input_ids:Qe,model_inputs:rt}}async generate({inputs:z=null,generation_config:ue=null,logits_processor:we=null,stopping_criteria:ve=null,streamer:Ae=null,...Ve}){this._validate_model_class(),ue=this._prepare_generation_config(ue,Ve);let{inputs_tensor:Qe,model_inputs:rt,model_input_name:xt}=this._prepare_model_inputs({inputs:z,model_kwargs:Ve});const kt=this.config.is_encoder_decoder;kt&&("encoder_outputs"in rt||(rt=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:Qe,model_inputs:rt,model_input_name:xt,generation_config:ue})));let At;kt?{input_ids:At,model_inputs:rt}=this._prepare_decoder_input_ids_for_generation({batch_size:rt[xt].dims.at(0),model_input_name:xt,model_kwargs:rt,decoder_start_token_id:ue.decoder_start_token_id,bos_token_id:ue.bos_token_id,generation_config:ue}):At=rt[xt];let Yt=At.dims.at(-1);ue.max_new_tokens!==null&&(ue.max_length=Yt+ue.max_new_tokens);const Tt=this._get_logits_processor(ue,Yt,we),Wt=this._get_stopping_criteria(ue,ve),_t=rt[xt].dims.at(0),Ht=w.LogitsSampler.getSampler(ue),mr=new Array(_t).fill(0),Ir=At.tolist();Ae&&Ae.put(Ir);let Gr,Br={};for(;;){if(rt=this.prepare_inputs_for_generation(Ir,rt,ue),Gr=await this.forward(rt),ue.output_attentions&&ue.return_dict_in_generate){const is=this.getAttentions(Gr);for(const si in is)si in Br||(Br[si]=[]),Br[si].push(is[si])}const Ut=Gr.logits.slice(null,-1,null),_n=Tt(Ir,Ut),Is=[];for(let is=0;is<_n.dims.at(0);++is){const si=_n[is],am=await Ht(si);for(const[jl,lm]of am){const cm=BigInt(jl);mr[is]+=lm,Ir[is].push(cm),Is.push([cm]);break}}if(Ae&&Ae.put(Is),Wt(Ir).every(is=>is))break;rt=this._update_model_kwargs_for_generation({generated_input_ids:Is,outputs:Gr,model_inputs:rt,is_encoder_decoder:kt})}Ae&&Ae.end();const un=this.getPastKeyValues(Gr,rt.past_key_values,!0),Sn=new h.Tensor("int64",Ir.flat(),[Ir.length,Ir[0].length]);if(ue.return_dict_in_generate)return{sequences:Sn,past_key_values:un,...Br};for(const Ut of Object.values(Gr))Ut.location==="gpu-buffer"&&Ut.dispose();return Sn}getPastKeyValues(z,ue,we=!1){const ve=Object.create(null);for(const Ae in z)if(Ae.startsWith("present")){const Ve=Ae.replace("present","past_key_values"),Qe=Ae.includes("encoder");if(Qe&&ue?ve[Ve]=ue[Ve]:ve[Ve]=z[Ae],ue&&(!Qe||we)){const rt=ue[Ve];rt.location==="gpu-buffer"&&rt.dispose()}}return ve}getAttentions(z){const ue={};for(const we of["cross_attentions","encoder_attentions","decoder_attentions"])for(const ve in z)ve.startsWith(we)&&(we in ue||(ue[we]=[]),ue[we].push(z[ve]));return ue}addPastKeyValues(z,ue){var we,ve,Ae;if(ue)Object.assign(z,ue);else{const Ve=this.sessions.decoder_model_merged??this.sessions.model,Qe=((we=Ve==null?void 0:Ve.config)==null?void 0:we.kv_cache_dtype)??"float32",rt=Qe==="float16"?new h.DataTypeMap.float16:[],xt=((Ae=(ve=z[this.main_input_name]??z.attention_mask)==null?void 0:ve.dims)==null?void 0:Ae[0])??1,kt=(0,n.getKeyValueShapes)(this.config,{batch_size:xt});for(const At in kt)z[At]=new h.Tensor(Qe,rt,kt[At])}}async encode_image({pixel_values:z}){return(await B(this.sessions.vision_encoder,{pixel_values:z})).image_features}async encode_text({input_ids:z}){return(await B(this.sessions.embed_tokens,{input_ids:z})).inputs_embeds}async encode_audio({audio_values:z}){return(await B(this.sessions.audio_encoder,{audio_values:z})).audio_features}}class be{}class xe extends be{constructor({last_hidden_state:$,hidden_states:z=null,attentions:ue=null}){super(),this.last_hidden_state=$,this.hidden_states=z,this.attentions=ue}}class Te extends J{}class Ee extends Te{}class $e extends Te{async _call($){return new jn(await super._call($))}}class Ie extends Te{async _call($){return new Dt(await super._call($))}}class Ue extends Te{async _call($){return new En(await super._call($))}}class Ke extends Te{async _call($){return new Qn(await super._call($))}}class Je extends J{}class je extends Je{}class qe extends Je{async _call($){return new jn(await super._call($))}}class ot extends Je{async _call($){return new Dt(await super._call($))}}class ft extends Je{async _call($){return new En(await super._call($))}}class it extends J{}class We extends it{}class Be extends J{}class De extends Be{}class yt extends Be{async _call($){return new jn(await super._call($))}}class Mt extends Be{async _call($){return new Dt(await super._call($))}}class Lt extends Be{async _call($){return new En(await super._call($))}}class dr extends Be{async _call($){return new Qn(await super._call($))}}class pr extends J{}class at extends pr{}class Kn extends pr{async _call($){return new jn(await super._call($))}}class F extends pr{async _call($){return new Dt(await super._call($))}}class ce extends pr{async _call($){return new En(await super._call($))}}class W extends pr{async _call($){return new Qn(await super._call($))}}class le extends J{}class ye extends le{}class Re extends le{async _call($){return new jn(await super._call($))}}class Se extends le{async _call($){return new Dt(await super._call($))}}class jt extends le{async _call($){return new En(await super._call($))}}class er extends le{async _call($){return new Qn(await super._call($))}}class bt extends J{}class mt extends bt{}class ut extends bt{async _call($){return new jn(await super._call($))}}class sr extends bt{async _call($){return new Dt(await super._call($))}}class wr extends bt{async _call($){return new En(await super._call($))}}class fn extends bt{async _call($){return new Qn(await super._call($))}}class Er extends J{}class Ln extends Er{}class Xs extends Er{async _call($){return new jn(await super._call($))}}class wi extends Er{async _call($){return new Dt(await super._call($))}}class Js extends Er{async _call($){return new En(await super._call($))}}class io extends Er{async _call($){return new Qn(await super._call($))}}class ss extends J{}class oo extends ss{}class ks extends ss{async _call($){return new jn(await super._call($))}}class bi extends ss{async _call($){return new Dt(await super._call($))}}class ao extends ss{async _call($){return new En(await super._call($))}}class lo extends ss{async _call($){return new Qn(await super._call($))}}class Wr extends J{}class co extends Wr{}class xn extends Wr{async _call($){return new Dt(await super._call($))}}class xi extends Wr{async _call($){return new En(await super._call($))}}class qn extends Wr{async _call($){return new Qn(await super._call($))}}class Fe extends Wr{async _call($){return new jn(await super._call($))}}class nt extends J{}class pt extends nt{}class ir extends nt{async _call($){return new jn(await super._call($))}}class Zs extends nt{async _call($){return new Dt(await super._call($))}}class ei extends nt{async _call($){return new En(await super._call($))}}class Zr extends J{}class ti extends Zr{}class en extends Zr{async _call($){return new jn(await super._call($))}}class an extends Zr{async _call($){return new Dt(await super._call($))}}class ri extends Zr{async _call($){return new Qn(await super._call($))}}class Mi extends J{}class pl extends Mi{}class ml extends Mi{async _call($){return new jn(await super._call($))}}class gl extends Mi{async _call($){return new Dt(await super._call($))}}class _l extends Mi{async _call($){return new En(await super._call($))}}class yl extends Mi{async _call($){return new Qn(await super._call($))}}class uo extends J{}class oa extends uo{}class vl extends uo{async _call($){return new jn(await super._call($))}}class wl extends uo{async _call($){return new Dt(await super._call($))}}class bl extends uo{async _call($){return new Qn(await super._call($))}}class ho extends J{}class _e extends ho{}class D extends ho{async _call($){return new Dt(await super._call($))}}class Z extends ho{async _call($){return new Qn(await super._call($))}}class ie extends ho{async _call($){return new jn(await super._call($))}}class he extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class ge extends he{}class Ce extends he{}class Ge extends J{}class tt extends Ge{}class Xe extends Ge{}class st extends J{}class St extends st{}class tr extends st{}class Zt extends J{}class Sr extends Zt{}class hr extends Zt{}class ln extends Zt{async _call($){return new Dt(await super._call($))}}class pn extends J{}class Mn extends pn{}class Tn extends pn{}class Ar extends pn{async _call($){return new Dt(await super._call($))}}class Ti extends pn{}class _r extends J{}class cn extends _r{}class Bn extends _r{}class As extends J{}class $s extends As{}class In extends As{}class zn extends J{}class mn extends zn{}class $r extends zn{async _call($){return new jn(await super._call($))}}class tn extends zn{async _call($){return new Dt(await super._call($))}}class rn extends zn{async _call($){return new En(await super._call($))}}class On extends zn{async _call($){return new Qn(await super._call($))}}class ni extends J{}class xl extends ni{}class Mp extends ni{async _call($){return new jn(await super._call($))}}class Tp extends ni{async _call($){return new Dt(await super._call($))}}class Ep extends ni{async _call($){return new En(await super._call($))}}class zd extends ni{async _call($){return new Qn(await super._call($))}}class aa extends J{}class Sp extends aa{}class Pp extends aa{async _call($){return new jn(await super._call($))}}class Cp extends aa{async _call($){return new Dt(await super._call($))}}class kp extends aa{async _call($){return new En(await super._call($))}}class Ap extends aa{async _call($){return new Qn(await super._call($))}}class Vd extends J{}class $p extends Vd{}class Ip extends Vd{}class Ud extends J{constructor(){super(...arguments);oe(this,"requires_attention_mask",!1);oe(this,"main_input_name","input_features");oe(this,"forward_params",["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class Op extends Ud{}class Wd extends Ud{_prepare_generation_config($,z){return super._prepare_generation_config($,z,g.WhisperGenerationConfig)}_retrieve_init_tokens($){const z=[$.decoder_start_token_id];let ue=$.language;const we=$.task;if($.is_multilingual){ue||(console.warn("No language specified - defaulting to English (en)."),ue="en");const Ae=`<|${(0,v.whisper_language_to_code)(ue)}|>`;z.push($.lang_to_id[Ae]),z.push($.task_to_id[we??"transcribe"])}else if(ue||we)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!$.return_timestamps&&$.no_timestamps_token_id&&z.at(-1)!==$.no_timestamps_token_id?z.push($.no_timestamps_token_id):$.return_timestamps&&z.at(-1)===$.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),z.pop()),z.filter(ve=>ve!=null)}async generate({inputs:$=null,generation_config:z=null,logits_processor:ue=null,stopping_criteria:we=null,...ve}){z=this._prepare_generation_config(z,ve);const Ae=ve.decoder_input_ids??this._retrieve_init_tokens(z);if(z.return_timestamps&&(ue??(ue=new u.LogitsProcessorList),ue.push(new u.WhisperTimeStampLogitsProcessor(z,Ae))),z.begin_suppress_tokens&&(ue??(ue=new u.LogitsProcessorList),ue.push(new u.SuppressTokensAtBeginLogitsProcessor(z.begin_suppress_tokens,Ae.length))),z.return_token_timestamps){if(!z.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");z.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),z.output_attentions=!0,z.return_dict_in_generate=!0}const Ve=await super.generate({inputs:$,generation_config:z,logits_processor:ue,decoder_input_ids:Ae,...ve});return z.return_token_timestamps&&(Ve.token_timestamps=this._extract_token_timestamps(Ve,z.alignment_heads,z.num_frames)),Ve}_extract_token_timestamps($,z,ue=null,we=.02){if(!$.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");ue==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let ve=this.config.median_filter_width;ve===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),ve=7);const Ae=$.cross_attentions,Ve=Array.from({length:this.config.decoder_layers},(Wt,_t)=>(0,h.cat)(Ae.map(Ht=>Ht[_t]),2)),Qe=(0,h.stack)(z.map(([Wt,_t])=>{if(Wt>=Ve.length)throw new Error(`Layer index ${Wt} is out of bounds for cross attentions (length ${Ve.length}).`);return ue?Ve[Wt].slice(null,_t,null,[0,ue]):Ve[Wt].slice(null,_t)})).transpose(1,0,2,3),[rt,xt]=(0,h.std_mean)(Qe,-2,0,!0),kt=Qe.clone();for(let Wt=0;Wt<kt.dims[0];++Wt){const _t=kt[Wt];for(let Ht=0;Ht<_t.dims[0];++Ht){const mr=_t[Ht],Ir=rt[Wt][Ht][0].data,Gr=xt[Wt][Ht][0].data;for(let Br=0;Br<mr.dims[0];++Br){let un=mr[Br].data;for(let Sn=0;Sn<un.length;++Sn)un[Sn]=(un[Sn]-Gr[Sn])/Ir[Sn];un.set((0,p.medianFilter)(un,ve))}}}const At=[(0,h.mean)(kt,1)],Yt=$.sequences.dims,Tt=new h.Tensor("float32",new Float32Array(Yt[0]*Yt[1]),Yt);for(let Wt=0;Wt<Yt[0];++Wt){const _t=At[Wt].neg().squeeze_(0),[Ht,mr]=(0,p.dynamic_time_warping)(_t.tolist()),Ir=Array.from({length:Ht.length-1},(un,Sn)=>Ht[Sn+1]-Ht[Sn]),Gr=(0,a.mergeArrays)([1],Ir).map(un=>!!un),Br=[];for(let un=0;un<Gr.length;++un)Gr[un]&&Br.push(mr[un]*we);Tt[Wt].data.set(Br,1)}return Tt}}class Gd extends Wd{}class zc extends J{constructor(){super(...arguments);oe(this,"requires_attention_mask",!1);oe(this,"main_input_name","input_values");oe(this,"forward_params",["input_values","decoder_input_ids","past_key_values"])}}class jp extends zc{}class Dp extends zc{}class Hd extends J{constructor(){super(...arguments);oe(this,"main_input_name","pixel_values");oe(this,"forward_params",["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"])}}class Vc extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class Ml extends Vc{_merge_input_ids_with_image_features($){const z=$.image_features.dims.at(-1),ue=$.image_features.view(-1,z);return j({image_token_id:this.config.image_token_index,...$,image_features:ue})}}class la extends Ml{}class Np extends Ml{}class Kd extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"]);oe(this,"main_input_name","inputs_embeds")}}class Rp extends Kd{_merge_input_ids_with_image_features({inputs_embeds:$,image_features:z,input_ids:ue,attention_mask:we}){return{inputs_embeds:(0,h.cat)([z,$],1),attention_mask:(0,h.cat)([(0,h.ones)(z.dims.slice(0,2)),we],1)}}async _prepare_inputs_embeds({input_ids:$,pixel_values:z,inputs_embeds:ue,attention_mask:we}){if(!$&&!z)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let ve,Ae;return $&&(ve=await this.encode_text({input_ids:$})),z&&(Ae=await this.encode_image({pixel_values:z})),ve&&Ae?{inputs_embeds:ue,attention_mask:we}=this._merge_input_ids_with_image_features({inputs_embeds:ve,image_features:Ae,input_ids:$,attention_mask:we}):ue=ve||Ae,{inputs_embeds:ue,attention_mask:we}}async forward({input_ids:$,pixel_values:z,attention_mask:ue,decoder_input_ids:we,decoder_attention_mask:ve,encoder_outputs:Ae,past_key_values:Ve,inputs_embeds:Qe,decoder_inputs_embeds:rt}){if(Qe||({inputs_embeds:Qe,attention_mask:ue}=await this._prepare_inputs_embeds({input_ids:$,pixel_values:z,inputs_embeds:Qe,attention_mask:ue})),!Ae){let{last_hidden_state:At}=await R(this,{inputs_embeds:Qe,attention_mask:ue});Ae=At}if(!rt){if(!we)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");rt=await this.encode_text({input_ids:we})}return await re(this,{inputs_embeds:rt,attention_mask:ve,encoder_attention_mask:ue,encoder_hidden_states:Ae,past_key_values:Ve},!0)}}class Fp extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class Lp extends Fp{_merge_input_ids_with_image_features($){const z=$.image_features.dims.at(-1),ue=$.image_features.view(-1,z);return j({image_token_id:this.config.image_token_index,...$,image_features:ue})}}class Uc extends Vc{_merge_input_ids_with_image_features($){const z=$.image_features.dims.at(-1),ue=$.image_features.view(-1,z);return j({image_token_id:this.config.image_token_index,...$,image_features:ue})}}class qd extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"])}}class Qd extends qd{async forward({input_ids:$=null,attention_mask:z=null,pixel_values:ue=null,input_features:we=null,input_features_mask:ve=null,position_ids:Ae=null,inputs_embeds:Ve=null,per_layer_inputs:Qe=null,past_key_values:rt=null,generation_config:xt=null,logits_processor:kt=null,...At}){if((!Ve||!Qe)&&({inputs_embeds:Ve,per_layer_inputs:Qe}=await B(this.sessions.embed_tokens,{input_ids:$}),$.dims[1]!==1)){if(ue){const{image_features:Tt}=await B(this.sessions.vision_encoder,{pixel_values:ue});({inputs_embeds:Ve,attention_mask:z}=this._merge_input_ids_with_image_features({image_features:Tt,inputs_embeds:Ve,input_ids:$,attention_mask:z}))}if(we){const{audio_features:Tt}=await B(this.sessions.audio_encoder,{input_features:we,input_features_mask:ve});({inputs_embeds:Ve,attention_mask:z}=this._merge_input_ids_with_audio_features({audio_features:Tt,inputs_embeds:Ve,input_ids:$,attention_mask:z}))}}return await re(this,{inputs_embeds:Ve,per_layer_inputs:Qe,past_key_values:rt,attention_mask:z,position_ids:Ae,generation_config:xt,logits_processor:kt},!0)}_merge_input_ids_with_image_features($){const z=$.image_features.dims.at(-1),ue=$.image_features.view(-1,z);return j({image_token_id:this.config.image_token_id,...$,image_features:ue})}_merge_input_ids_with_audio_features($){const z=$.audio_features.dims.at(-1),ue=$.audio_features.view(-1,z);return q({audio_token_id:this.config.audio_token_id,...$,audio_features:ue})}}class Bp extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"])}}class Wc extends Bp{async encode_image({pixel_values:$,pixel_attention_mask:z}){return(await B(this.sessions.vision_encoder,{pixel_values:$,pixel_attention_mask:z})).image_features}_merge_input_ids_with_image_features($){const z=$.image_features.dims.at(-1),ue=$.image_features.view(-1,z);return j({image_token_id:this.config.image_token_id,...$,image_features:ue})}}class Yd extends Wc{}class zp extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"])}}class Xd extends zp{async forward({input_ids:$=null,attention_mask:z=null,pixel_values:ue=null,image_sizes:we=null,position_ids:ve=null,inputs_embeds:Ae=null,past_key_values:Ve=null,generation_config:Qe=null,logits_processor:rt=null,...xt}){if(!Ae){let At;if(ue&&$.dims[1]!==1){if(!we)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:At}=await B(this.sessions.vision_encoder,{pixel_values:ue,image_sizes:we}))}else{const Yt=this.config.normalized_config.hidden_size;At=new h.Tensor("float32",[],[0,Yt])}({inputs_embeds:Ae}=await B(this.sessions.prepare_inputs_embeds,{input_ids:$,image_features:At}))}return await re(this,{inputs_embeds:Ae,past_key_values:Ve,attention_mask:z,position_ids:ve,generation_config:Qe,logits_processor:rt},!1)}}class No extends J{}class Vp extends No{}class Ny extends No{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"text_model"})}}class Tl extends No{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"text_model"})}}class El extends No{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"vision_model"})}}class Jd extends No{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"vision_model"})}}class Zd extends J{}class Up extends Zd{}class Gc extends Zd{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"text_model"})}}class Hc extends No{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"vision_model"})}}class eh extends J{}class th extends eh{}class Sl extends J{}class rh extends Sl{async forward($){const z=!$.input_ids,ue=!$.pixel_values;if(z&&ue)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(z&&($.input_ids=(0,h.ones)([$.pixel_values.dims[0],1])),ue){const{image_size:rt}=this.config.vision_config;$.pixel_values=(0,h.full)([0,3,rt,rt],0)}const{text_embeddings:we,image_embeddings:ve,l2norm_text_embeddings:Ae,l2norm_image_embeddings:Ve}=await super.forward($),Qe={};return z||(Qe.text_embeddings=we,Qe.l2norm_text_embeddings=Ae),ue||(Qe.image_embeddings=ve,Qe.l2norm_image_embeddings=Ve),Qe}}class nh extends Sl{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"text_model"})}}class sh extends Sl{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"vision_model"})}}class ih extends J{}class oh extends ih{}class ah extends ih{}class ca extends J{}class vt extends ca{}class Wp extends ca{}class Kc extends J{}class lh extends Kc{}class Pl extends Kc{}class ys extends J{}class Cl extends ys{}class qc extends ys{}class Qc extends J{}class ch extends Qc{}class uh extends Qc{}class kl extends J{}class dh extends kl{}class hh extends kl{}class Yc extends J{}class Al extends Yc{}class Xc extends Yc{}class $l extends J{}class fh extends $l{}class ph extends $l{}class Jc extends J{}class mh extends Jc{}class gh extends Jc{}class Zc extends J{}class T extends Zc{}class A extends Zc{}class N extends J{}class H extends N{}class ee extends N{}class pe extends J{}class ke extends pe{}class ze extends pe{}class Ze extends J{}class lt extends Ze{}class $t extends Ze{}class Qt extends J{}class fr extends Qt{}class gn extends Qt{}class fo extends J{}class Gp extends fo{}class WE extends fo{}class Ry extends J{}class GE extends Ry{}class HE extends Ry{}class Fy extends J{}class KE extends Fy{}class qE extends Fy{}class Ly extends J{}class QE extends Ly{}class YE extends Ly{}class By extends J{}class XE extends By{}class JE extends By{}class zy extends J{}class ZE extends zy{}class eS extends zy{}class Vy extends J{}class tS extends Vy{}class rS extends Vy{}class Uy extends J{}class nS extends Uy{}class sS extends Uy{}class Wy extends J{}class iS extends Wy{}class oS extends Wy{}class aS extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"])}}class lS extends aS{get_rope_index($,z,ue,we){const{vision_config:ve,image_token_id:Ae,video_token_id:Ve,vision_start_token_id:Qe}=this.config,rt=ve.spatial_merge_size??2,xt=[];if(z||ue){let kt=$.tolist();we||(we=(0,h.ones_like)($));const At=we.tolist(),Yt=Array.from({length:3},mr=>Array.from({length:$.dims[0]},Ir=>Array.from({length:$.dims[1]},Gr=>1))),Tt=z?z.tolist():[],Wt=ue?ue.tolist():[];let _t=0,Ht=0;for(let mr=0;mr<kt.length;++mr){const Ir=kt[mr].filter((Or,yn)=>At[mr][yn]==1),Br=Ir.reduce((Or,yn,da)=>(yn==Qe&&Or.push(da),Or),[]).map(Or=>Ir[Or+1]),un=Br.filter(Or=>Or==Ae).length,Sn=Br.filter(Or=>Or==Ve).length;let Ut=[],_n=0,Is=un,Ol=Sn;for(let Or=0;Or<Br.length;++Or){const yn=Ir.findIndex((Nl,Ei)=>Ei>_n&&Nl==Ae),da=Ir.findIndex((Nl,Ei)=>Ei>_n&&Nl==Ve),Dl=Is>0&&yn!==-1?yn:Ir.length+1,ru=Ol>0&&da!==-1?da:Ir.length+1;let um,Uv,Wv,Gv;Dl<ru?([Uv,Wv,Gv]=Tt[_t],++_t,--Is,um=Dl):([Uv,Wv,Gv]=Wt[Ht],++Ht,--Ol,um=ru);const[YG,Hv,dm]=[Number(Uv),Math.floor(Number(Wv)/rt),Math.floor(Number(Gv)/rt)],Kv=um-_n,U2=Ut.length>0?(0,p.max)(Ut.at(-1))[0]+1:0;Ut.push(Array.from({length:3*Kv},(Nl,Ei)=>U2+Ei%Kv));const qv=Kv+U2,hm=YG*Hv*dm,XG=Array.from({length:hm},(Nl,Ei)=>qv+Math.floor(Ei/(Hv*dm))),JG=Array.from({length:hm},(Nl,Ei)=>qv+Math.floor(Ei/dm)%Hv),ZG=Array.from({length:hm},(Nl,Ei)=>qv+Ei%dm);Ut.push([XG,JG,ZG].flat()),_n=um+hm}if(_n<Ir.length){const Or=Ut.length>0?(0,p.max)(Ut.at(-1))[0]+1:0,yn=Ir.length-_n;Ut.push(Array.from({length:3*yn},(da,Dl)=>Or+Dl%yn))}const is=Ut.reduce((Or,yn)=>Or+yn.length,0),si=new Array(is);let am=0;for(let Or=0;Or<3;++Or)for(let yn=0;yn<Ut.length;++yn){const da=Ut[yn],Dl=da.length/3;for(let ru=Or*Dl;ru<(Or+1)*Dl;++ru)si[am++]=da[ru]}let jl=0;const lm=At[mr];for(let Or=0;Or<lm.length;++Or)if(lm[Or]==1){for(let yn=0;yn<3;++yn)Yt[yn][mr][Or]=si[yn*is/3+jl];++jl}const cm=(0,p.max)(si)[0];xt.push(cm+1-kt[mr].length)}return[new h.Tensor("int64",Yt.flat(1/0),[3,$.dims[0],$.dims[1]]),new h.Tensor("int64",xt,[xt.length,1])]}else if(we){const{data:kt,dims:At}=fe(we),Yt=BigInt64Array.from({length:3*kt.length},(Wt,_t)=>kt[_t%kt.length]),Tt=Array.from({length:At[0]},(Wt,_t)=>(0,p.max)(kt.subarray(At[1]*_t,At[1]*(_t+1)))[0]+1n+BigInt(At[1]));return[new h.Tensor("int64",Yt,[3,...At]),new h.Tensor("int64",Tt,[Tt.length,1])]}else{const[kt,At]=$.dims,Yt=BigInt64Array.from({length:3*kt*At},(Tt,Wt)=>BigInt(Math.floor(Wt%At/kt)));return[new h.Tensor("int64",Yt,[3,...$.dims]),(0,h.zeros)([kt,1])]}}async encode_image({pixel_values:$,image_grid_thw:z}){return(await B(this.sessions.vision_encoder,{pixel_values:$,grid_thw:z})).image_features}_merge_input_ids_with_image_features($){return j({image_token_id:this.config.image_token_id,...$})}prepare_inputs_for_generation($,z,ue){if(z.attention_mask&&!z.position_ids)if(!z.past_key_values)[z.position_ids,z.rope_deltas]=this.get_rope_index(z.input_ids,z.image_grid_thw,z.video_grid_thw,z.attention_mask);else{z.pixel_values=null;const we=BigInt(Object.values(z.past_key_values)[0].dims.at(-2)),ve=z.rope_deltas.map(Ae=>we+Ae);z.position_ids=(0,h.stack)([ve,ve,ve],0)}return z}}class Gy extends J{}class cS extends Gy{}class uS extends Gy{}class Hy extends J{}class dS extends Hy{}class hS extends Hy{}class Ky extends J{}class fS extends Ky{}class pS extends Ky{}class qy extends J{}class mS extends qy{}class gS extends qy{}class Qy extends J{}class _S extends Qy{}class yS extends Qy{}class Yy extends J{}class vS extends Yy{}class wS extends Yy{async _call($){return new Dt(await super._call($))}}class Xy extends J{}class bS extends Xy{}class xS extends Xy{async _call($){return new Dt(await super._call($))}}class MS extends J{}class TS extends MS{}class Jy extends J{}class ES extends Jy{}class SS extends Jy{async _call($){return new Dt(await super._call($))}}class PS extends J{}class CS extends PS{}class Zy extends J{}class kS extends Zy{}class AS extends Zy{async _call($){return new Dt(await super._call($))}}class $S extends J{}class IS extends $S{}class ev extends J{}class OS extends ev{}class jS extends ev{async _call($){return new Dt(await super._call($))}}class DS extends J{}class NS extends DS{async _call($){return new z2(await super._call($))}}class tv extends J{}class RS extends tv{}class FS extends tv{async _call($){return new Dt(await super._call($))}}class rv extends J{}class LS extends rv{}class BS extends rv{async _call($){return new Dt(await super._call($))}}class nv extends J{}class zS extends nv{}class VS extends nv{}class sv extends J{}class US extends sv{}class WS extends sv{}class iv extends J{}class GS extends iv{}class HS extends iv{async _call($){return new Dt(await super._call($))}}class Hp extends J{}class KS extends Hp{}class qS extends Hp{async _call($){return new av(await super._call($))}}class ov extends Hp{async _call($){return new QS(await super._call($))}}class av extends be{constructor({logits:$,pred_boxes:z}){super(),this.logits=$,this.pred_boxes=z}}class QS extends be{constructor({logits:$,pred_boxes:z,pred_masks:ue}){super(),this.logits=$,this.pred_boxes=z,this.pred_masks=ue}}class lv extends J{}class YS extends lv{}class XS extends lv{async _call($){return new _h(await super._call($))}}class _h extends be{constructor({logits:$,pred_boxes:z}){super(),this.logits=$,this.pred_boxes=z}}class cv extends J{}class JS extends cv{}class ZS extends cv{async _call($){return new eP(await super._call($))}}class eP extends _h{}class uv extends J{}class tP extends uv{}class rP extends uv{async _call($){return new nP(await super._call($))}}class nP extends _h{}class dv extends J{}class sP extends dv{}class iP extends dv{async _call($){return new _h(await super._call($))}}class hv extends J{}class oP extends hv{}class aP extends hv{async _call($){return new lP(await super._call($))}}class lP extends av{}class fv extends J{}class cP extends fv{}class uP extends fv{async _call($){return new Dt(await super._call($))}}class pv extends J{}class dP extends pv{}class hP extends pv{async _call($){return new Dt(await super._call($))}}class mv extends J{}class fP extends mv{}class pP extends mv{async _call($){return new Dt(await super._call($))}}class Kp extends J{}class mP extends Kp{}class gP extends Kp{async _call($){return new Dt(await super._call($))}}class _P extends Kp{}class gv extends J{}class yP extends gv{}class vP extends gv{}class _v extends J{}class wP extends _v{}class bP extends _v{}class xP extends J{}class MP extends xP{}class qp extends J{}class TP extends qp{}class EP extends qp{}class SP extends qp{}class PP extends J{}class CP extends PP{}class kP extends J{}class AP extends kP{}class $P extends J{}class IP extends $P{}class yv extends J{}class OP extends yv{}class jP extends yv{}class vv extends J{}class DP extends vv{}class NP extends vv{}class RP extends J{}class FP extends RP{}class wv extends J{}class LP extends wv{}class BP extends wv{async _call($){return new Dt(await super._call($))}}class bv extends J{}class zP extends bv{}class VP extends bv{async _call($){return new Dt(await super._call($))}}class xv extends J{}class UP extends xv{}class WP extends xv{async _call($){return new Dt(await super._call($))}}class Mv extends J{}class GP extends Mv{}class HP extends Mv{async _call($){return new Dt(await super._call($))}}class KP extends J{}class qP extends KP{}class Tv extends J{}class QP extends Tv{}class YP extends Tv{async _call($){return new XP(await super._call($))}}class XP extends be{constructor({logits:$,pred_boxes:z}){super(),this.logits=$,this.pred_boxes=z}}class JP extends J{}class ZP extends JP{async get_image_embeddings({pixel_values:$}){return await R(this,{pixel_values:$})}async forward($){if((!$.image_embeddings||!$.image_positional_embeddings)&&($={...$,...await this.get_image_embeddings($)}),!$.input_labels&&$.input_points){const ue=$.input_points.dims.slice(0,-1),we=ue.reduce((ve,Ae)=>ve*Ae,1);$.input_labels=new h.Tensor("int64",new BigInt64Array(we).fill(1n),ue)}const z={image_embeddings:$.image_embeddings,image_positional_embeddings:$.image_positional_embeddings};return $.input_points&&(z.input_points=$.input_points),$.input_labels&&(z.input_labels=$.input_labels),$.input_boxes&&(z.input_boxes=$.input_boxes),await B(this.sessions.prompt_encoder_mask_decoder,z)}async _call($){return new eC(await super._call($))}}class eC extends be{constructor({iou_scores:$,pred_masks:z}){super(),this.iou_scores=$,this.pred_masks=z}}class Ev extends J{}class tC extends Ev{}class rC extends Ev{}class Sv extends J{}class nC extends Sv{}class sC extends Sv{}class ua extends J{}class iC extends ua{}class oC extends ua{async _call($){return new Il(await super._call($))}}class aC extends ua{async _call($){return new Dt(await super._call($))}}class lC extends ua{async _call($){return new En(await super._call($))}}class Pv extends J{}class cC extends Pv{}class uC extends Pv{async _call($){return new En(await super._call($))}}class dC extends J{}class hC extends dC{}class Qp extends J{}class fC extends Qp{}class pC extends Qp{async _call($){return new Il(await super._call($))}}class mC extends Qp{async _call($){return new Dt(await super._call($))}}class yh extends J{}class gC extends yh{}class _C extends yh{async _call($){return new Il(await super._call($))}}class yC extends yh{async _call($){return new Dt(await super._call($))}}class vC extends yh{async _call($){return new En(await super._call($))}}class Yp extends J{}class wC extends Yp{}class bC extends Yp{async _call($){return new Il(await super._call($))}}class xC extends Yp{async _call($){return new Dt(await super._call($))}}class DG extends J{}class MC extends ua{}class TC extends ua{async _call($){return new Il(await super._call($))}}class EC extends ua{async _call($){return new Dt(await super._call($))}}class eu extends J{}class SC extends eu{}class PC extends eu{async _call($){return new Il(await super._call($))}}class CC extends eu{async _call($){return new Dt(await super._call($))}}class kC extends eu{async _call($){return new B2(await super._call($))}}class AC extends eu{async _call($){return new En(await super._call($))}}class $C extends J{}class IC extends $C{}class Xp extends J{}class NG extends Xp{}class OC extends Xp{}class jC extends Xp{async generate_speech($,z,{threshold:ue=.5,minlenratio:we=0,maxlenratio:ve=20,vocoder:Ae=null}={}){const Ve={input_ids:$},{encoder_outputs:Qe,encoder_attention_mask:rt}=await R(this,Ve),xt=Qe.dims[1]/this.config.reduction_factor,kt=Math.floor(xt*ve),At=Math.floor(xt*we),Yt=this.config.num_mel_bins;let Tt=[],Wt=null,_t=null,Ht=0;for(;;){++Ht;const Gr=X(!!_t);let Br;_t?Br=_t.output_sequence_out:Br=new h.Tensor("float32",new Float32Array(Yt),[1,1,Yt]);let un={use_cache_branch:Gr,output_sequence:Br,encoder_attention_mask:rt,speaker_embeddings:z,encoder_hidden_states:Qe};this.addPastKeyValues(un,Wt),_t=await B(this.sessions.decoder_model_merged,un),Wt=this.getPastKeyValues(_t,Wt);const{prob:Sn,spectrum:Ut}=_t;if(Tt.push(Ut),Ht>=At&&(Array.from(Sn.data).filter(_n=>_n>=ue).length>0||Ht>=kt))break}const mr=(0,h.cat)(Tt),{waveform:Ir}=await B(Ae.sessions.model,{spectrogram:mr});return{spectrogram:mr,waveform:Ir}}}class DC extends J{constructor(){super(...arguments);oe(this,"main_input_name","spectrogram")}}class NC extends J{}class RC extends NC{}class Cv extends J{}class FC extends Cv{}class LC extends Cv{}class kv extends J{}class BC extends kv{}class zC extends kv{}class Av extends J{}class VC extends Av{}class UC extends Av{}class Jp extends J{}class WC extends Jp{}class GC extends Jp{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"text_model"})}}class HC extends Jp{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"audio_model"})}}class KC extends J{}class $v extends KC{async _call($){return new V2(await super._call($))}}class Zp extends J{}class RG extends Zp{}class qC extends Zp{}class QC extends Zp{}class Iv extends J{}class YC extends Iv{}class XC extends Iv{}class Ov extends J{}class JC extends Ov{}class ZC extends Ov{async _call($){return new Dt(await super._call($))}}class jv extends J{}class FG extends jv{}class LG extends jv{}class Dv extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}_apply_and_filter_by_delay_pattern_mask(z){const[ue,we]=z.dims,ve=this.config.decoder.num_codebooks,Ae=we-ve;let Ve=0;for(let xt=0;xt<z.size;++xt){if(z.data[xt]===this.config.decoder.pad_token_id)continue;const kt=xt%we,At=Math.floor(xt/we)%ve,Yt=kt-At;Yt>0&&Yt<=Ae&&(z.data[Ve++]=z.data[xt])}const Qe=Math.floor(ue/ve),rt=Ve/(Qe*ve);return new h.Tensor(z.type,z.data.slice(0,Ve),[Qe,ve,rt])}prepare_inputs_for_generation(z,ue,we){let ve=structuredClone(z);for(let Ve=0;Ve<ve.length;++Ve)for(let Qe=0;Qe<ve[Ve].length;++Qe)Ve%this.config.decoder.num_codebooks>=Qe&&(ve[Ve][Qe]=BigInt(this.config.decoder.pad_token_id));return we.guidance_scale!==null&&we.guidance_scale>1&&(ve=ve.concat(ve)),super.prepare_inputs_for_generation(ve,ue,we)}async generate(z){const ue=await super.generate(z),we=this._apply_and_filter_by_delay_pattern_mask(ue).unsqueeze_(0),{audio_values:ve}=await B(this.sessions.encodec_decode,{audio_codes:we});return ve}}class em extends J{}class ek extends em{}class tk extends em{async _call($){return new Dt(await super._call($))}}class rk extends em{}class tm extends J{}class nk extends tm{}class sk extends tm{async _call($){return new Dt(await super._call($))}}class ik extends tm{}class rm extends J{}class ok extends rm{}class ak extends rm{async _call($){return new Dt(await super._call($))}}class lk extends rm{}class nm extends J{}class ck extends nm{}class uk extends nm{async _call($){return new Dt(await super._call($))}}class dk extends nm{}class hk extends J{}class fk extends hk{}class pk extends J{}class mk extends pk{constructor(...z){super(...z);oe(this,"forward_params",["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"]);this._generation_mode="text"}async forward(z){const ue=this._generation_mode??"text";let we;if(ue==="text"||!z.past_key_values){const rt=this.sessions.prepare_inputs_embeds,xt=(0,a.pick)(z,rt.inputNames);we=await B(rt,xt)}else{const rt=this.sessions.gen_img_embeds,xt=(0,a.pick)({image_ids:z.input_ids},rt.inputNames);we=await B(rt,xt)}const ve={...z,...we},Ae=await re(this,ve),Ve=this.sessions[ue==="text"?"lm_head":"gen_head"];if(!Ve)throw new Error(`Unable to find "${Ve}" generation head`);const Qe=await B(Ve,(0,a.pick)(Ae,Ve.inputNames));return{...we,...Ae,...Qe}}async generate(z){return this._generation_mode="text",super.generate(z)}async generate_images(z){this._generation_mode="image";const ue=(z.inputs??z[this.main_input_name]).dims[1],ve=(await super.generate(z)).slice(null,[ue,null]),Ae=this.sessions.image_decode,{decoded_image:Ve}=await B(Ae,{generated_tokens:ve}),Qe=Ve.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),rt=[];for(const xt of Qe){const kt=f.RawImage.fromTensor(xt);rt.push(kt)}return rt}}class gk extends be{constructor({char_logits:$,bpe_logits:z,wp_logits:ue}){super(),this.char_logits=$,this.bpe_logits=z,this.wp_logits=ue}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class _k extends J{}class yk extends _k{async _call($){return new gk(await super._call($))}}class Nv extends J{}class vk extends Nv{}class wk extends Nv{}class Rv extends J{}class bk extends Rv{}class xk extends Rv{}class Mk extends J{constructor(){super(...arguments);oe(this,"forward_params",["input_ids","attention_mask","position_ids","audio_values","past_key_values"])}}class Tk extends Mk{_merge_input_ids_with_audio_features($){const z=$.audio_features.dims.at(-1),ue=$.audio_features.view(-1,z);return q({audio_token_id:this.config.ignore_index,...$,audio_features:ue})}}class sm extends J{constructor(){super(...arguments);oe(this,"main_input_name","input_values");oe(this,"forward_params",["input_values"])}}class Ek extends be{constructor({audio_codes:$}){super(),this.audio_codes=$}}class Sk extends be{constructor({audio_values:$}){super(),this.audio_values=$}}class Pk extends sm{async encode($){return new Ek(await B(this.sessions.encoder_model,$))}async decode($){return new Sk(await B(this.sessions.decoder_model,$))}}class Ck extends sm{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"encoder_model"})}}class kk extends sm{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"decoder_model"})}}class im extends J{constructor(){super(...arguments);oe(this,"main_input_name","input_values");oe(this,"forward_params",["input_values"])}}class Ak extends be{constructor({audio_codes:$}){super(),this.audio_codes=$}}class $k extends be{constructor({audio_values:$}){super(),this.audio_values=$}}class Ik extends im{async encode($){return new Ak(await B(this.sessions.encoder_model,$))}async decode($){return new $k(await B(this.sessions.decoder_model,$))}}class Ok extends im{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"encoder_model"})}}class jk extends im{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"decoder_model"})}}class om extends J{constructor(){super(...arguments);oe(this,"main_input_name","input_values");oe(this,"forward_params",["input_values"])}}class Dk extends om{async encode($){return await B(this.sessions.encoder_model,$)}async decode($){return await B(this.sessions.decoder_model,$)}}class Nk extends om{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"encoder_model"})}}class Rk extends om{static async from_pretrained($,z={}){return super.from_pretrained($,{...z,model_file_name:z.model_file_name??"decoder_model"})}}class rr{static async from_pretrained($,{progress_callback:z=null,config:ue=null,cache_dir:we=null,local_files_only:ve=!1,revision:Ae="main",model_file_name:Ve=null,subfolder:Qe="onnx",device:rt=null,dtype:xt=null,use_external_data_format:kt=null,session_options:At={}}={}){const Yt={progress_callback:z,config:ue,cache_dir:we,local_files_only:ve,revision:Ae,model_file_name:Ve,subfolder:Qe,device:rt,dtype:xt,use_external_data_format:kt,session_options:At};if(Yt.config=await n.AutoConfig.from_pretrained($,Yt),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const Tt=Yt.config.model_type;for(const Wt of this.MODEL_CLASS_MAPPINGS){let _t=Wt.get(Tt);if(!_t){for(const Ht of Wt.values())if(Ht[0]===Tt){_t=Ht;break}if(!_t)continue}return await _t[1].from_pretrained($,Yt)}if(this.BASE_IF_FAIL)return c2.has(Tt)||console.warn(`Unknown model class "${Tt}", attempting to construct from base class.`),await J.from_pretrained($,Yt);throw Error(`Unsupported model type: ${Tt}`)}}oe(rr,"MODEL_CLASS_MAPPINGS",null),oe(rr,"BASE_IF_FAIL",!1);const BG=new Map([["bert",["BertModel",Ee]],["modernbert",["ModernBertModel",je]],["nomic_bert",["NomicBertModel",We]],["roformer",["RoFormerModel",De]],["electra",["ElectraModel",ye]],["esm",["EsmModel",pt]],["convbert",["ConvBertModel",at]],["camembert",["CamembertModel",mt]],["deberta",["DebertaModel",Ln]],["deberta-v2",["DebertaV2Model",oo]],["mpnet",["MPNetModel",pl]],["albert",["AlbertModel",_e]],["distilbert",["DistilBertModel",co]],["roberta",["RobertaModel",mn]],["xlm",["XLMModel",xl]],["xlm-roberta",["XLMRobertaModel",Sp]],["clap",["ClapModel",WC]],["clip",["CLIPModel",Vp]],["clipseg",["CLIPSegModel",oh]],["chinese_clip",["ChineseCLIPModel",th]],["siglip",["SiglipModel",Up]],["jina_clip",["JinaCLIPModel",rh]],["mobilebert",["MobileBertModel",ti]],["squeezebert",["SqueezeBertModel",oa]],["wav2vec2",["Wav2Vec2Model",iC]],["wav2vec2-bert",["Wav2Vec2BertModel",wC]],["unispeech",["UniSpeechModel",fC]],["unispeech-sat",["UniSpeechSatModel",gC]],["hubert",["HubertModel",MC]],["wavlm",["WavLMModel",SC]],["audio-spectrogram-transformer",["ASTModel",$p]],["vits",["VitsModel",$v]],["pyannote",["PyAnnoteModel",cC]],["wespeaker-resnet",["WeSpeakerResNetModel",hC]],["detr",["DetrModel",KS]],["rt_detr",["RTDetrModel",YS]],["rt_detr_v2",["RTDetrV2Model",JS]],["rf_detr",["RFDetrModel",tP]],["d_fine",["DFineModel",sP]],["table-transformer",["TableTransformerModel",oP]],["vit",["ViTModel",vS]],["ijepa",["IJepaModel",bS]],["pvt",["PvtModel",ES]],["vit_msn",["ViTMSNModel",kS]],["vit_mae",["ViTMAEModel",CS]],["groupvit",["GroupViTModel",IS]],["fastvit",["FastViTModel",OS]],["mobilevit",["MobileViTModel",RS]],["mobilevitv2",["MobileViTV2Model",LS]],["owlvit",["OwlViTModel",zS]],["owlv2",["Owlv2Model",US]],["beit",["BeitModel",GS]],["deit",["DeiTModel",cP]],["hiera",["HieraModel",dP]],["convnext",["ConvNextModel",LP]],["convnextv2",["ConvNextV2Model",zP]],["dinov2",["Dinov2Model",UP]],["dinov2_with_registers",["Dinov2WithRegistersModel",GP]],["resnet",["ResNetModel",fP]],["swin",["SwinModel",mP]],["swin2sr",["Swin2SRModel",yP]],["donut-swin",["DonutSwinModel",FP]],["yolos",["YolosModel",QP]],["dpt",["DPTModel",wP]],["glpn",["GLPNModel",DP]],["hifigan",["SpeechT5HifiGan",DC]],["efficientnet",["EfficientNetModel",JC]],["decision_transformer",["DecisionTransformerModel",fk]],["patchtst",["PatchTSTForPrediction",vk]],["patchtsmixer",["PatchTSMixerForPrediction",bk]],["mobilenet_v1",["MobileNetV1Model",ek]],["mobilenet_v2",["MobileNetV2Model",nk]],["mobilenet_v3",["MobileNetV3Model",ok]],["mobilenet_v4",["MobileNetV4Model",ck]],["maskformer",["MaskFormerModel",OP]],["mgp-str",["MgpstrForSceneTextRecognition",yk]],["style_text_to_speech_2",["StyleTextToSpeech2Model",IC]]]),zG=new Map([["t5",["T5Model",ge]],["longt5",["LongT5Model",tt]],["mt5",["MT5Model",St]],["bart",["BartModel",Sr]],["mbart",["MBartModel",Mn]],["marian",["MarianModel",tC]],["whisper",["WhisperModel",Op]],["m2m_100",["M2M100Model",nC]],["blenderbot",["BlenderbotModel",cn]],["blenderbot-small",["BlenderbotSmallModel",$s]]]),VG=new Map([["mimi",["MimiModel",Pk]],["dac",["DacModel",Ik]],["snac",["SnacModel",Dk]]]),UG=new Map([["bloom",["BloomModel",fS]],["jais",["JAISModel",lh]],["gpt2",["GPT2Model",vt]],["gptj",["GPTJModel",dh]],["gpt_bigcode",["GPTBigCodeModel",Al]],["gpt_neo",["GPTNeoModel",Cl]],["gpt_neox",["GPTNeoXModel",ch]],["codegen",["CodeGenModel",fh]],["llama",["LlamaModel",mh]],["exaone",["ExaoneModel",ke]],["olmo",["OlmoModel",fr]],["olmo2",["Olmo2Model",Gp]],["mobilellm",["MobileLLMModel",lt]],["granite",["GraniteModel",GE]],["cohere",["CohereModel",KE]],["gemma",["GemmaModel",QE]],["gemma2",["Gemma2Model",XE]],["gemma3_text",["Gemma3Model",ZE]],["helium",["HeliumModel",T]],["glm",["GlmModel",H]],["openelm",["OpenELMModel",tS]],["qwen2",["Qwen2Model",nS]],["qwen3",["Qwen3Model",iS]],["phi",["PhiModel",cS]],["phi3",["Phi3Model",dS]],["mpt",["MptModel",mS]],["opt",["OPTModel",_S]],["mistral",["MistralModel",FC]],["starcoder2",["Starcoder2Model",BC]],["falcon",["FalconModel",VC]],["stablelm",["StableLmModel",YC]]]),Fv=new Map([["speecht5",["SpeechT5ForSpeechToText",OC]],["whisper",["WhisperForConditionalGeneration",Wd]],["lite-whisper",["LiteWhisperForConditionalGeneration",Gd]],["moonshine",["MoonshineForConditionalGeneration",Dp]]]),Fk=new Map([["speecht5",["SpeechT5ForTextToSpeech",jC]]]),Lk=new Map([["vits",["VitsModel",$v]],["musicgen",["MusicgenForConditionalGeneration",Dv]]]),Bk=new Map([["bert",["BertForSequenceClassification",Ie]],["modernbert",["ModernBertForSequenceClassification",ot]],["roformer",["RoFormerForSequenceClassification",Mt]],["electra",["ElectraForSequenceClassification",Se]],["esm",["EsmForSequenceClassification",Zs]],["convbert",["ConvBertForSequenceClassification",F]],["camembert",["CamembertForSequenceClassification",sr]],["deberta",["DebertaForSequenceClassification",wi]],["deberta-v2",["DebertaV2ForSequenceClassification",bi]],["mpnet",["MPNetForSequenceClassification",gl]],["albert",["AlbertForSequenceClassification",D]],["distilbert",["DistilBertForSequenceClassification",xn]],["roberta",["RobertaForSequenceClassification",tn]],["xlm",["XLMForSequenceClassification",Tp]],["xlm-roberta",["XLMRobertaForSequenceClassification",Cp]],["bart",["BartForSequenceClassification",ln]],["mbart",["MBartForSequenceClassification",Ar]],["mobilebert",["MobileBertForSequenceClassification",an]],["squeezebert",["SqueezeBertForSequenceClassification",wl]]]),zk=new Map([["bert",["BertForTokenClassification",Ue]],["modernbert",["ModernBertForTokenClassification",ft]],["roformer",["RoFormerForTokenClassification",Lt]],["electra",["ElectraForTokenClassification",jt]],["esm",["EsmForTokenClassification",ei]],["convbert",["ConvBertForTokenClassification",ce]],["camembert",["CamembertForTokenClassification",wr]],["deberta",["DebertaForTokenClassification",Js]],["deberta-v2",["DebertaV2ForTokenClassification",ao]],["mpnet",["MPNetForTokenClassification",_l]],["distilbert",["DistilBertForTokenClassification",xi]],["roberta",["RobertaForTokenClassification",rn]],["xlm",["XLMForTokenClassification",Ep]],["xlm-roberta",["XLMRobertaForTokenClassification",kp]]]),Lv=new Map([["t5",["T5ForConditionalGeneration",Ce]],["longt5",["LongT5ForConditionalGeneration",Xe]],["mt5",["MT5ForConditionalGeneration",tr]],["bart",["BartForConditionalGeneration",hr]],["mbart",["MBartForConditionalGeneration",Tn]],["marian",["MarianMTModel",rC]],["m2m_100",["M2M100ForConditionalGeneration",sC]],["blenderbot",["BlenderbotForConditionalGeneration",Bn]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",In]]]),Bv=new Map([["bloom",["BloomForCausalLM",pS]],["gpt2",["GPT2LMHeadModel",Wp]],["jais",["JAISLMHeadModel",Pl]],["gptj",["GPTJForCausalLM",hh]],["gpt_bigcode",["GPTBigCodeForCausalLM",Xc]],["gpt_neo",["GPTNeoForCausalLM",qc]],["gpt_neox",["GPTNeoXForCausalLM",uh]],["codegen",["CodeGenForCausalLM",ph]],["llama",["LlamaForCausalLM",gh]],["exaone",["ExaoneForCausalLM",ze]],["olmo",["OlmoForCausalLM",gn]],["olmo2",["Olmo2ForCausalLM",WE]],["mobilellm",["MobileLLMForCausalLM",$t]],["granite",["GraniteForCausalLM",HE]],["cohere",["CohereForCausalLM",qE]],["gemma",["GemmaForCausalLM",YE]],["gemma2",["Gemma2ForCausalLM",JE]],["gemma3_text",["Gemma3ForCausalLM",eS]],["helium",["HeliumForCausalLM",A]],["glm",["GlmForCausalLM",ee]],["openelm",["OpenELMForCausalLM",rS]],["qwen2",["Qwen2ForCausalLM",sS]],["qwen3",["Qwen3ForCausalLM",oS]],["phi",["PhiForCausalLM",uS]],["phi3",["Phi3ForCausalLM",hS]],["mpt",["MptForCausalLM",gS]],["opt",["OPTForCausalLM",yS]],["mbart",["MBartForCausalLM",Ti]],["mistral",["MistralForCausalLM",LC]],["starcoder2",["Starcoder2ForCausalLM",zC]],["falcon",["FalconForCausalLM",UC]],["trocr",["TrOCRForCausalLM",RC]],["stablelm",["StableLmForCausalLM",XC]],["phi3_v",["Phi3VForCausalLM",Xd]]]),WG=new Map([["multi_modality",["MultiModalityCausalLM",mk]]]),Vk=new Map([["bert",["BertForMaskedLM",$e]],["modernbert",["ModernBertForMaskedLM",qe]],["roformer",["RoFormerForMaskedLM",yt]],["electra",["ElectraForMaskedLM",Re]],["esm",["EsmForMaskedLM",ir]],["convbert",["ConvBertForMaskedLM",Kn]],["camembert",["CamembertForMaskedLM",ut]],["deberta",["DebertaForMaskedLM",Xs]],["deberta-v2",["DebertaV2ForMaskedLM",ks]],["mpnet",["MPNetForMaskedLM",ml]],["albert",["AlbertForMaskedLM",ie]],["distilbert",["DistilBertForMaskedLM",Fe]],["roberta",["RobertaForMaskedLM",$r]],["xlm",["XLMWithLMHeadModel",Mp]],["xlm-roberta",["XLMRobertaForMaskedLM",Pp]],["mobilebert",["MobileBertForMaskedLM",en]],["squeezebert",["SqueezeBertForMaskedLM",vl]]]),Uk=new Map([["bert",["BertForQuestionAnswering",Ke]],["roformer",["RoFormerForQuestionAnswering",dr]],["electra",["ElectraForQuestionAnswering",er]],["convbert",["ConvBertForQuestionAnswering",W]],["camembert",["CamembertForQuestionAnswering",fn]],["deberta",["DebertaForQuestionAnswering",io]],["deberta-v2",["DebertaV2ForQuestionAnswering",lo]],["mpnet",["MPNetForQuestionAnswering",yl]],["albert",["AlbertForQuestionAnswering",Z]],["distilbert",["DistilBertForQuestionAnswering",qn]],["roberta",["RobertaForQuestionAnswering",On]],["xlm",["XLMForQuestionAnswering",zd]],["xlm-roberta",["XLMRobertaForQuestionAnswering",Ap]],["mobilebert",["MobileBertForQuestionAnswering",ri]],["squeezebert",["SqueezeBertForQuestionAnswering",bl]]]),zv=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Hd]],["idefics3",["Idefics3ForConditionalGeneration",Wc]],["smolvlm",["SmolVLMForConditionalGeneration",Yd]]]),Wk=new Map([["llava",["LlavaForConditionalGeneration",Ml]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",la]],["moondream1",["Moondream1ForConditionalGeneration",Np]],["florence2",["Florence2ForConditionalGeneration",Rp]],["qwen2-vl",["Qwen2VLForConditionalGeneration",lS]],["idefics3",["Idefics3ForConditionalGeneration",Wc]],["smolvlm",["SmolVLMForConditionalGeneration",Yd]],["paligemma",["PaliGemmaForConditionalGeneration",Lp]],["llava_qwen2",["LlavaQwen2ForCausalLM",Uc]],["gemma3n",["Gemma3nForConditionalGeneration",Qd]]]),Gk=new Map([["ultravox",["UltravoxModel",Tk]]]),GG=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Hd]]]),Hk=new Map([["vit",["ViTForImageClassification",wS]],["ijepa",["IJepaForImageClassification",xS]],["pvt",["PvtForImageClassification",SS]],["vit_msn",["ViTMSNForImageClassification",AS]],["fastvit",["FastViTForImageClassification",jS]],["mobilevit",["MobileViTForImageClassification",FS]],["mobilevitv2",["MobileViTV2ForImageClassification",BS]],["beit",["BeitForImageClassification",HS]],["deit",["DeiTForImageClassification",uP]],["hiera",["HieraForImageClassification",hP]],["convnext",["ConvNextForImageClassification",BP]],["convnextv2",["ConvNextV2ForImageClassification",VP]],["dinov2",["Dinov2ForImageClassification",WP]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",HP]],["resnet",["ResNetForImageClassification",pP]],["swin",["SwinForImageClassification",gP]],["segformer",["SegformerForImageClassification",qC]],["efficientnet",["EfficientNetForImageClassification",ZC]],["mobilenet_v1",["MobileNetV1ForImageClassification",tk]],["mobilenet_v2",["MobileNetV2ForImageClassification",sk]],["mobilenet_v3",["MobileNetV3ForImageClassification",ak]],["mobilenet_v4",["MobileNetV4ForImageClassification",uk]]]),Kk=new Map([["detr",["DetrForObjectDetection",qS]],["rt_detr",["RTDetrForObjectDetection",XS]],["rt_detr_v2",["RTDetrV2ForObjectDetection",ZS]],["rf_detr",["RFDetrForObjectDetection",rP]],["d_fine",["DFineForObjectDetection",iP]],["table-transformer",["TableTransformerForObjectDetection",aP]],["yolos",["YolosForObjectDetection",YP]]]),qk=new Map([["owlvit",["OwlViTForObjectDetection",VS]],["owlv2",["Owlv2ForObjectDetection",WS]],["grounding-dino",["GroundingDinoForObjectDetection",qP]]]),tu=new Map([["detr",["DetrForSegmentation",ov]],["clipseg",["CLIPSegForImageSegmentation",ah]]]),Qk=new Map([["segformer",["SegformerForSemanticSegmentation",QC]],["sapiens",["SapiensForSemanticSegmentation",TP]],["swin",["SwinForSemanticSegmentation",_P]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",rk]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",ik]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",lk]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",dk]]]),Yk=new Map([["detr",["DetrForSegmentation",ov]],["maskformer",["MaskFormerForInstanceSegmentation",jP]]]),Xk=new Map([["sam",["SamModel",ZP]]]),Jk=new Map([["wav2vec2",["Wav2Vec2ForCTC",oC]],["wav2vec2-bert",["Wav2Vec2BertForCTC",bC]],["unispeech",["UniSpeechForCTC",pC]],["unispeech-sat",["UniSpeechSatForCTC",_C]],["wavlm",["WavLMForCTC",PC]],["hubert",["HubertForCTC",TC]]]),Zk=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",aC]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",xC]],["unispeech",["UniSpeechForSequenceClassification",mC]],["unispeech-sat",["UniSpeechSatForSequenceClassification",yC]],["wavlm",["WavLMForSequenceClassification",CC]],["hubert",["HubertForSequenceClassification",EC]],["audio-spectrogram-transformer",["ASTForAudioClassification",Ip]]]),e2=new Map([["wavlm",["WavLMForXVector",kC]]]),t2=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",vC]],["wavlm",["WavLMForAudioFrameClassification",AC]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",lC]],["pyannote",["PyAnnoteForAudioFrameClassification",uC]]]),r2=new Map([["vitmatte",["VitMatteForImageMatting",NS]]]),HG=new Map([["patchtst",["PatchTSTForPrediction",wk]],["patchtsmixer",["PatchTSMixerForPrediction",xk]]]),n2=new Map([["swin2sr",["Swin2SRForImageSuperResolution",vP]]]),s2=new Map([["dpt",["DPTForDepthEstimation",bP]],["depth_anything",["DepthAnythingForDepthEstimation",MP]],["glpn",["GLPNForDepthEstimation",NP]],["sapiens",["SapiensForDepthEstimation",EP]],["depth_pro",["DepthProForDepthEstimation",CP]],["metric3d",["Metric3DForDepthEstimation",AP]],["metric3dv2",["Metric3Dv2ForDepthEstimation",IP]]]),i2=new Map([["sapiens",["SapiensForNormalEstimation",SP]]]),o2=new Map([["vitpose",["VitPoseForPoseEstimation",TS]]]),a2=new Map([["clip",["CLIPVisionModelWithProjection",Jd]],["siglip",["SiglipVisionModel",Hc]],["jina_clip",["JinaCLIPVisionModel",sh]]]),l2=[[BG,b.EncoderOnly],[zG,b.EncoderDecoder],[UG,b.DecoderOnly],[VG,b.AutoEncoder],[Bk,b.EncoderOnly],[zk,b.EncoderOnly],[Lv,b.Seq2Seq],[Fv,b.Seq2Seq],[Bv,b.DecoderOnly],[WG,b.MultiModality],[Vk,b.EncoderOnly],[Uk,b.EncoderOnly],[zv,b.Vision2Seq],[Wk,b.ImageTextToText],[Gk,b.AudioTextToText],[Hk,b.EncoderOnly],[tu,b.EncoderOnly],[Yk,b.EncoderOnly],[Qk,b.EncoderOnly],[r2,b.EncoderOnly],[HG,b.EncoderOnly],[n2,b.EncoderOnly],[s2,b.EncoderOnly],[i2,b.EncoderOnly],[o2,b.EncoderOnly],[Kk,b.EncoderOnly],[qk,b.EncoderOnly],[Xk,b.MaskGeneration],[Jk,b.EncoderOnly],[Zk,b.EncoderOnly],[Fk,b.Seq2Seq],[Lk,b.EncoderOnly],[e2,b.EncoderOnly],[t2,b.EncoderOnly],[a2,b.EncoderOnly]];for(const[k,$]of l2)for(const[z,ue]of k.values())x.set(z,$),E.set(ue,z),M.set(z,ue);const KG=[["MusicgenForConditionalGeneration",Dv,b.Musicgen],["Phi3VForCausalLM",Xd,b.Phi3V],["CLIPTextModelWithProjection",Tl,b.EncoderOnly],["SiglipTextModel",Gc,b.EncoderOnly],["JinaCLIPTextModel",nh,b.EncoderOnly],["ClapTextModelWithProjection",GC,b.EncoderOnly],["ClapAudioModelWithProjection",HC,b.EncoderOnly],["DacEncoderModel",Ok,b.EncoderOnly],["DacDecoderModel",jk,b.EncoderOnly],["MimiEncoderModel",Ck,b.EncoderOnly],["MimiDecoderModel",kk,b.EncoderOnly],["SnacEncoderModel",Nk,b.EncoderOnly],["SnacDecoderModel",Rk,b.EncoderOnly],["Gemma3nForConditionalGeneration",Qd,b.ImageAudioTextToText]];for(const[k,$,z]of KG)x.set(k,z),E.set($,k),M.set(k,$);const c2=new Map([["modnet",tu],["birefnet",tu],["isnet",tu],["ben",tu]]);for(const[k,$]of c2.entries())$.set(k,["PreTrainedModel",J]),x.set(k,b.EncoderOnly),E.set(J,k),M.set(k,J);class Vv extends rr{}oe(Vv,"MODEL_CLASS_MAPPINGS",l2.map($=>$[0])),oe(Vv,"BASE_IF_FAIL",!0);class u2 extends rr{}oe(u2,"MODEL_CLASS_MAPPINGS",[Bk]);class d2 extends rr{}oe(d2,"MODEL_CLASS_MAPPINGS",[zk]);class h2 extends rr{}oe(h2,"MODEL_CLASS_MAPPINGS",[Lv]);class f2 extends rr{}oe(f2,"MODEL_CLASS_MAPPINGS",[Fv]);class p2 extends rr{}oe(p2,"MODEL_CLASS_MAPPINGS",[Fk]);class m2 extends rr{}oe(m2,"MODEL_CLASS_MAPPINGS",[Lk]);class g2 extends rr{}oe(g2,"MODEL_CLASS_MAPPINGS",[Bv]);class _2 extends rr{}oe(_2,"MODEL_CLASS_MAPPINGS",[Vk]);class y2 extends rr{}oe(y2,"MODEL_CLASS_MAPPINGS",[Uk]);class v2 extends rr{}oe(v2,"MODEL_CLASS_MAPPINGS",[zv]);class w2 extends rr{}oe(w2,"MODEL_CLASS_MAPPINGS",[Hk]);class b2 extends rr{}oe(b2,"MODEL_CLASS_MAPPINGS",[tu]);class x2 extends rr{}oe(x2,"MODEL_CLASS_MAPPINGS",[Qk]);class M2 extends rr{}oe(M2,"MODEL_CLASS_MAPPINGS",[Yk]);class T2 extends rr{}oe(T2,"MODEL_CLASS_MAPPINGS",[Kk]);class E2 extends rr{}oe(E2,"MODEL_CLASS_MAPPINGS",[qk]);class S2 extends rr{}oe(S2,"MODEL_CLASS_MAPPINGS",[Xk]);class P2 extends rr{}oe(P2,"MODEL_CLASS_MAPPINGS",[Jk]);class C2 extends rr{}oe(C2,"MODEL_CLASS_MAPPINGS",[Zk]);class k2 extends rr{}oe(k2,"MODEL_CLASS_MAPPINGS",[e2]);class A2 extends rr{}oe(A2,"MODEL_CLASS_MAPPINGS",[t2]);class $2 extends rr{}oe($2,"MODEL_CLASS_MAPPINGS",[GG]);class I2 extends rr{}oe(I2,"MODEL_CLASS_MAPPINGS",[r2]);class O2 extends rr{}oe(O2,"MODEL_CLASS_MAPPINGS",[n2]);class j2 extends rr{}oe(j2,"MODEL_CLASS_MAPPINGS",[s2]);class D2 extends rr{}oe(D2,"MODEL_CLASS_MAPPINGS",[i2]);class N2 extends rr{}oe(N2,"MODEL_CLASS_MAPPINGS",[o2]);class R2 extends rr{}oe(R2,"MODEL_CLASS_MAPPINGS",[a2]);class F2 extends rr{}oe(F2,"MODEL_CLASS_MAPPINGS",[Wk]);class L2 extends rr{}oe(L2,"MODEL_CLASS_MAPPINGS",[Gk]);class qG extends be{constructor({logits:$,past_key_values:z,encoder_outputs:ue,decoder_attentions:we=null,cross_attentions:ve=null}){super(),this.logits=$,this.past_key_values=z,this.encoder_outputs=ue,this.decoder_attentions=we,this.cross_attentions=ve}}class Dt extends be{constructor({logits:$,...z}){super(),this.logits=$;const ue=Object.values(z);ue.length>0&&(this.attentions=ue)}}class B2 extends be{constructor({logits:$,embeddings:z}){super(),this.logits=$,this.embeddings=z}}class En extends be{constructor({logits:$}){super(),this.logits=$}}class jn extends be{constructor({logits:$}){super(),this.logits=$}}class Qn extends be{constructor({start_logits:$,end_logits:z}){super(),this.start_logits=$,this.end_logits=z}}class Il extends be{constructor({logits:$}){super(),this.logits=$}}class QG extends be{constructor({logits:$,past_key_values:z}){super(),this.logits=$,this.past_key_values=z}}class z2 extends be{constructor({alphas:$}){super(),this.alphas=$}}class V2 extends be{constructor({waveform:$,spectrogram:z}){super(),this.waveform=$,this.spectrogram=z}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(e,t,r)=>{r.r(t),r.d(t,{ASTFeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var s=r("./src/utils/audio.js");class i extends n.FeatureExtractor{constructor(a){super(a);const l=this.config.sampling_rate,c=(0,s.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(l/2),l,null,"kaldi",!0);this.mel_filters=c,this.window=(0,s.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(a,l){return(0,s.spectrogram)(a,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:l,transpose:!0})}async _call(a){(0,n.validate_audio_inputs)(a,"ASTFeatureExtractor");const l=await this._extract_fbank_features(a,this.config.max_length);if(this.config.do_normalize){const c=this.std*2,u=l.data;for(let d=0;d<u.length;++d)u[d]=(u[d]-this.mean)/c}return{input_values:l.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoFeatureExtractor:()=>o});var n=r("./src/utils/constants.js"),s=r("./src/utils/hub.js");r("./src/base/feature_extraction_utils.js");var i=r("./src/models/feature_extractors.js");class o{static async from_pretrained(l,c={}){const u=await(0,s.getModelJSON)(l,n.FEATURE_EXTRACTOR_NAME,!0,c),d=u.feature_extractor_type,h=i[d];if(!h)throw new Error(`Unknown feature_extractor_type: '${d}'. Please report this at ${n.GITHUB_ISSUE_URL}.`);return new h(u)}}},"./src/models/auto/image_processing_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoImageProcessor:()=>a});var n=r("./src/utils/constants.js"),s=r("./src/utils/hub.js"),i=r("./src/base/image_processors_utils.js"),o=r("./src/models/image_processors.js");class a{static async from_pretrained(c,u={}){const d=await(0,s.getModelJSON)(c,n.IMAGE_PROCESSOR_NAME,!0,u),h=d.image_processor_type??d.feature_extractor_type;let f=o[h==null?void 0:h.replace(/Fast$/,"")];return f||(h!==void 0&&console.warn(`Image processor type '${h}' not found, assuming base ImageProcessor. Please report this at ${n.GITHUB_ISSUE_URL}.`),f=i.ImageProcessor),new f(d)}}},"./src/models/auto/processing_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoProcessor:()=>c});var n=r("./src/utils/constants.js"),s=r("./src/utils/hub.js"),i=r("./src/base/processing_utils.js"),o=r("./src/models/processors.js"),a=r("./src/models/image_processors.js"),l=r("./src/models/feature_extractors.js");class c{static async from_pretrained(d,h={}){const f=await(0,s.getModelJSON)(d,n.IMAGE_PROCESSOR_NAME,!0,h),{image_processor_type:p,feature_extractor_type:_,processor_class:w}=f;if(w&&o[w])return o[w].from_pretrained(d,h);if(!p&&!_)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const y={};if(p){const v=a[p.replace(/Fast$/,"")];if(!v)throw new Error(`Unknown image_processor_type: '${p}'.`);y.image_processor=new v(f)}if(_){const v=a[_];if(v)y.image_processor=new v(f);else{const b=l[_];if(!b)throw new Error(`Unknown feature_extractor_type: '${_}'.`);y.feature_extractor=new b(f)}}const g={};return new i.Processor(g,y,null)}}},"./src/models/beit/image_processing_beit.js":(e,t,r)=>{r.r(t),r.d(t,{BeitFeatureExtractor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(e,t,r)=>{r.r(t),r.d(t,{BitImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(e,t,r)=>{r.r(t),r.d(t,{ChineseCLIPFeatureExtractor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(e,t,r)=>{r.r(t),r.d(t,{ClapFeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var s=r("./src/utils/audio.js");class i extends n.FeatureExtractor{constructor(a){super(a),this.mel_filters=(0,s.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,s.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,s.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(a,l,c,u){let d;const h=a.length-l;if(h>0)if(c==="rand_trunc"){const f=Math.floor(Math.random()*(h+1));a=a.subarray(f,f+l),d=await this._extract_fbank_features(a,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${c}" not implemented`);else{if(h<0){let f=new Float64Array(l);if(f.set(a),u==="repeat")for(let p=a.length;p<l;p+=a.length)f.set(a.subarray(0,Math.min(a.length,l-p)),p);else if(u==="repeatpad")for(let p=a.length;p<-h;p+=a.length)f.set(a,p);a=f}if(c==="fusion")throw new Error(`Truncation strategy "${c}" not implemented`);d=await this._extract_fbank_features(a,this.mel_filters_slaney,this.config.nb_max_samples)}return d.unsqueeze_(0)}async _extract_fbank_features(a,l,c=null){return(0,s.spectrogram)(a,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:l,log_mel:"dB",max_num_frames:c,do_pad:!1,transpose:!0})}async _call(a,{max_length:l=null}={}){return(0,n.validate_audio_inputs)(a,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(a,l??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(e,t,r)=>{r.r(t),r.d(t,{CLIPFeatureExtractor:()=>i,CLIPImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/convnext/image_processing_convnext.js":(e,t,r)=>{r.r(t),r.d(t,{ConvNextFeatureExtractor:()=>i,ConvNextImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{constructor(a){super(a),this.crop_pct=this.config.crop_pct??224/256}async resize(a){var c;const l=(c=this.size)==null?void 0:c.shortest_edge;if(l===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(l<384){const u=Math.floor(l/this.crop_pct),[d,h]=this.get_resize_output_image_size(a,{shortest_edge:u});a=await a.resize(d,h,{resample:this.resample}),a=await a.center_crop(l,l)}else a=await a.resize(l,l,{resample:this.resample});return a}}class i extends s{}},"./src/models/dac/feature_extraction_dac.js":(e,t,r)=>{r.r(t),r.d(t,{DacFeatureExtractor:()=>s});var n=r("./src/models/encodec/feature_extraction_encodec.js");class s extends n.EncodecFeatureExtractor{}},"./src/models/deit/image_processing_deit.js":(e,t,r)=>{r.r(t),r.d(t,{DeiTFeatureExtractor:()=>i,DeiTImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/detr/image_processing_detr.js":(e,t,r)=>{r.r(t),r.d(t,{DetrFeatureExtractor:()=>o,DetrImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/tensor.js");class i extends n.ImageProcessor{async _call(l){const c=await super._call(l),u=[c.pixel_values.dims[0],64,64],d=(0,s.full)(u,1n);return{...c,pixel_mask:d}}post_process_object_detection(...l){return(0,n.post_process_object_detection)(...l)}post_process_panoptic_segmentation(...l){return(0,n.post_process_panoptic_segmentation)(...l)}post_process_instance_segmentation(...l){return(0,n.post_process_instance_segmentation)(...l)}}class o extends i{}},"./src/models/donut/image_processing_donut.js":(e,t,r)=>{r.r(t),r.d(t,{DonutFeatureExtractor:()=>i,DonutImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{pad_image(a,l,c,u={}){const[d,h,f]=l;let p=this.image_mean;Array.isArray(this.image_mean)||(p=new Array(f).fill(p));let _=this.image_std;Array.isArray(_)||(_=new Array(f).fill(p));const w=p.map((y,g)=>-y/_[g]);return super.pad_image(a,l,c,{center:!0,constant_values:w,...u})}}class i extends s{}},"./src/models/dpt/image_processing_dpt.js":(e,t,r)=>{r.r(t),r.d(t,{DPTFeatureExtractor:()=>i,DPTImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/efficientnet/image_processing_efficientnet.js":(e,t,r)=>{r.r(t),r.d(t,{EfficientNetImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{constructor(o){super(o),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(a=>a*a))}}},"./src/models/encodec/feature_extraction_encodec.js":(e,t,r)=>{r.r(t),r.d(t,{EncodecFeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js"),s=r("./src/utils/tensor.js");class i extends n.FeatureExtractor{async _call(a){(0,n.validate_audio_inputs)(a,"EncodecFeatureExtractor"),a instanceof Float64Array&&(a=new Float32Array(a));const l=this.config.feature_size;if(a.length%l!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${l}).`);const c=[1,l,a.length/l];return{input_values:new s.Tensor("float32",a,c)}}}},"./src/models/feature_extractors.js":(e,t,r)=>{r.r(t),r.d(t,{ASTFeatureExtractor:()=>n.ASTFeatureExtractor,ClapFeatureExtractor:()=>i.ClapFeatureExtractor,DacFeatureExtractor:()=>o.DacFeatureExtractor,EncodecFeatureExtractor:()=>s.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>a.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>w.ImageProcessor,MoonshineFeatureExtractor:()=>l.MoonshineFeatureExtractor,PyAnnoteFeatureExtractor:()=>c.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>u.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>d.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>h.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>f.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>p.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>_.WhisperFeatureExtractor});var n=r("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),s=r("./src/models/encodec/feature_extraction_encodec.js"),i=r("./src/models/clap/feature_extraction_clap.js"),o=r("./src/models/dac/feature_extraction_dac.js"),a=r("./src/models/gemma3n/feature_extraction_gemma3n.js"),l=r("./src/models/moonshine/feature_extraction_moonshine.js"),c=r("./src/models/pyannote/feature_extraction_pyannote.js"),u=r("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),d=r("./src/models/snac/feature_extraction_snac.js"),h=r("./src/models/speecht5/feature_extraction_speecht5.js"),f=r("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),p=r("./src/models/wespeaker/feature_extraction_wespeaker.js"),_=r("./src/models/whisper/feature_extraction_whisper.js"),w=r("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(e,t,r)=>{r.r(t),r.d(t,{Florence2Processor:()=>o});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");class o extends n.Processor{constructor(l,c,u){super(l,c,u);const{tasks_answer_post_processing_type:d,task_prompts_without_inputs:h,task_prompts_with_input:f}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(d??{})),this.task_prompts_without_inputs=new Map(Object.entries(h??{})),this.task_prompts_with_input=new Map(Object.entries(f??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(l){typeof l=="string"&&(l=[l]);const c=[];for(const u of l)if(this.task_prompts_without_inputs.has(u))c.push(this.task_prompts_without_inputs.get(u));else{for(const[d,h]of this.task_prompts_with_input)if(u.includes(d)){c.push(h.replaceAll("{input}",u).replaceAll(d,""));break}c.length!==l.length&&c.push(u)}return c}post_process_generation(l,c,u){const d=this.tasks_answer_post_processing_type.get(c)??"pure_text";l=l.replaceAll("<s>","").replaceAll("</s>","");let h;switch(d){case"pure_text":h=l;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const f=d==="ocr"?"quad_boxes":"bboxes",p=l.matchAll(this.regexes[f]),_=[],w=[];for(const[y,g,...v]of p)_.push(g?g.trim():_.at(-1)??""),w.push(v.map((b,x)=>(Number(b)+.5)/this.size_per_bin*u[x%2]));h={labels:_,[f]:w};break;default:throw new Error(`Task "${c}" (of type "${d}") not yet implemented.`)}return{[c]:h}}async _call(l,c=null,u={}){if(!l&&!c)throw new Error("Either text or images must be provided");const d=await this.image_processor(l,u),h=c?this.tokenizer(this.construct_prompts(c),u):{};return{...d,...h}}}oe(o,"tokenizer_class",i.AutoTokenizer),oe(o,"image_processor_class",s.AutoImageProcessor)},"./src/models/gemma3n/feature_extraction_gemma3n.js":(e,t,r)=>{r.r(t),r.d(t,{Gemma3nAudioFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js"),s=r("./src/utils/tensor.js"),i=r("./src/utils/audio.js");class o extends n.FeatureExtractor{constructor(l){super(l);const{fft_length:c,feature_size:u,min_frequency:d,max_frequency:h,sampling_rate:f,frame_length:p}=this.config,_=(0,i.mel_filter_bank)(Math.floor(1+c/2),u,d,h,f,null,"htk",!1);this.mel_filters=_,this.window=(0,i.window_function)(p,"hann")}async _extract_fbank_features(l,c){return(0,i.spectrogram)(l,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call(l,{max_length:c=48e4,truncation:u=!0,padding:d=!0,pad_to_multiple_of:h=128}={}){if((0,n.validate_audio_inputs)(l,"Gemma3nAudioFeatureExtractor"),u&&l.length>c&&(l=l.slice(0,c)),d&&l.length%h!==0){const _=h-l.length%h,w=new Float64Array(l.length+_);w.set(l),this.config.padding_value!==0&&w.fill(this.config.padding_value,l.length),l=w}const f=await this._extract_fbank_features(l,this.config.max_length),p=(0,s.full)([1,f.dims[0]],!0);return{input_features:f.unsqueeze_(0),input_features_mask:p}}}},"./src/models/gemma3n/processing_gemma3n.js":(e,t,r)=>{r.r(t),r.d(t,{Gemma3nProcessor:()=>a});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/tokenizers.js");r("./src/utils/image.js"),r("./src/utils/audio.js");class a extends n.Processor{constructor(c,u,d){super(c,u,d),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;const{audio_token_id:h,boa_token:f,audio_token:p,eoa_token:_,image_token_id:w,boi_token:y,image_token:g,eoi_token:v}=this.tokenizer.config;this.audio_token_id=h,this.boa_token=f,this.audio_token=p;const b=p.repeat(this.audio_seq_length);this.full_audio_sequence=`

${f}${b}${_}

`,this.image_token_id=w,this.boi_token=y,this.image_token=g;const x=g.repeat(this.image_seq_length);this.full_image_sequence=`

${y}${x}${v}

`}async _call(c,u=null,d=null,h={}){typeof c=="string"&&(c=[c]);let f;d&&(f=await this.feature_extractor(d,h),c=c.map(w=>w.replaceAll(this.audio_token,this.full_audio_sequence)));let p;return u&&(p=await this.image_processor(u,h),c=c.map(w=>w.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(c,h),...p,...f}}}oe(a,"image_processor_class",s.AutoImageProcessor),oe(a,"feature_extractor_class",i.AutoFeatureExtractor),oe(a,"tokenizer_class",o.AutoTokenizer),oe(a,"uses_processor_config",!0),oe(a,"uses_chat_template_file",!0)},"./src/models/glpn/image_processing_glpn.js":(e,t,r)=>{r.r(t),r.d(t,{GLPNFeatureExtractor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(e,t,r)=>{r.r(t),r.d(t,{GroundingDinoImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/tensor.js");class i extends n.ImageProcessor{async _call(a){const l=await super._call(a),c=l.pixel_values.dims,u=(0,s.ones)([c[0],c[2],c[3]]);return{...l,pixel_mask:u}}}},"./src/models/grounding_dino/processing_grounding_dino.js":(e,t,r)=>{r.r(t),r.d(t,{GroundingDinoProcessor:()=>l});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/base/image_processors_utils.js");function a(c,u){const h=c.dims.at(-1)-1,f=c.tolist();f.fill(!1,0,1),f.fill(!1,h);const p=u.tolist();return f.map((_,w)=>_?w:null).filter(_=>_!==null).map(_=>p[_])}class l extends n.Processor{async _call(u,d,h={}){const f=u?await this.image_processor(u,h):{};return{...d?this.tokenizer(d,h):{},...f}}post_process_grounded_object_detection(u,d,{box_threshold:h=.25,text_threshold:f=.25,target_sizes:p=null}={}){const{logits:_,pred_boxes:w}=u,y=_.dims[0];if(p!==null&&p.length!==y)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const g=_.dims.at(1),v=_.sigmoid(),b=v.max(-1).tolist(),x=w.tolist().map(E=>E.map(P=>(0,o.center_to_corners_format)(P))),M=[];for(let E=0;E<y;++E){const P=p!==null?p[E]:null;P!==null&&(x[E]=x[E].map(B=>B.map((Y,K)=>Y*P[(K+1)%2])));const I=b[E],O=[],V=[],U=[];for(let B=0;B<g;++B){const Y=I[B];if(Y<=h)continue;const K=x[E][B],X=v[E][B];O.push(Y),U.push(K);const G=a(X.gt(f),d[E]);V.push(G)}M.push({scores:O,boxes:U,labels:this.batch_decode(V)})}return M}}oe(l,"tokenizer_class",i.AutoTokenizer),oe(l,"image_processor_class",s.AutoImageProcessor)},"./src/models/idefics3/image_processing_idefics3.js":(e,t,r)=>{r.r(t),r.d(t,{Idefics3ImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/tensor.js");class i extends n.ImageProcessor{constructor(a){super(a),this.do_image_splitting=a.do_image_splitting??!0,this.max_image_size=a.max_image_size}get_resize_for_vision_encoder(a,l){let[c,u]=a.dims.slice(-2);const d=u/c;return u>=c?(u=Math.ceil(u/l)*l,c=Math.floor(u/d),c=Math.ceil(c/l)*l):(c=Math.ceil(c/l)*l,u=Math.floor(c*d),u=Math.ceil(u/l)*l),{height:c,width:u}}async _call(a,{do_image_splitting:l=null,return_row_col_info:c=!1}={}){let u;if(!Array.isArray(a))u=[[a]];else{if(a.length===0||!a[0])throw new Error("No images provided.");Array.isArray(a[0])?u=a:u=[a]}let d=[],h=[],f=[];const p=[],_=[];for(const E of u){let P=await Promise.all(E.map(V=>this.preprocess(V)));p.push(...P.map(V=>V.original_size)),_.push(...P.map(V=>V.reshaped_input_size)),P.forEach(V=>V.pixel_values.unsqueeze_(0));const{longest_edge:I}=this.max_image_size;let O;if(l??this.do_image_splitting){let V=new Array(P.length),U=new Array(P.length);O=await Promise.all(P.map(async(B,Y)=>{const K=this.get_resize_for_vision_encoder(B.pixel_values,I),X=await(0,s.interpolate_4d)(B.pixel_values,{size:[K.height,K.width]}),{frames:G,num_splits_h:R,num_splits_w:te}=await this.split_image(X,this.max_image_size);return V[Y]=R,U[Y]=te,(0,s.cat)(G,0)})),h.push(V),f.push(U)}else{const V=[I,I];O=await Promise.all(P.map(U=>(0,s.interpolate_4d)(U.pixel_values,{size:V}))),h.push(new Array(P.length).fill(0)),f.push(new Array(P.length).fill(0))}d.push((0,s.cat)(O,0))}const w=d.length,[y,g,v,b]=d[0].dims;let x,M;if(w===1)x=d[0].unsqueeze_(0),M=(0,s.full)([w,y,v,b],!0);else{const E=Math.max(...d.map(O=>O.dims.at(0)));M=(0,s.full)([w,E,v,b],!0);const P=M.data,I=E*v*b;for(let O=0;O<w;++O){const V=d[O].dims[0];if(V<E){d[O]=(0,s.cat)([d[O],(0,s.full)([E-V,g,v,b],0)],0);const U=O*I+V*v*b,B=(O+1)*I;P.fill(!1,U,B)}}x=(0,s.stack)(d,0)}return{pixel_values:x,pixel_attention_mask:M,original_sizes:p,reshaped_input_sizes:_,...c?{rows:h,cols:f}:{}}}async split_image(a,{longest_edge:l}){const c=l,u=l,d=[],[h,f]=a.dims.slice(-2);let p=0,_=0;if(h>c||f>u){p=Math.ceil(h/c),_=Math.ceil(f/u);const w=Math.ceil(h/p),y=Math.ceil(f/_);for(let b=0;b<p;++b)for(let x=0;x<_;++x){let M,E,P,I;b===p-1?(E=h-w,I=h):(E=b*w,I=(b+1)*w),x===_-1?(M=f-y,P=f):(M=x*y,P=(x+1)*y);const O=[E,M],V=[I,P],U=await(0,s.slice)(a,O,V,[2,3]);d.push(U)}const g=c,v=u;(h!==g||f!==v)&&(a=await(0,s.interpolate_4d)(a,{size:[g,v]}))}return d.push(a),{frames:d,num_splits_h:p,num_splits_w:_}}}},"./src/models/idefics3/processing_idefics3.js":(e,t,r)=>{r.r(t),r.d(t,{Idefics3Processor:()=>u});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");r("./src/utils/image.js");var o=r("./src/utils/core.js");function a(d,h,f,p,_,w){let y="";for(let g=0;g<h;++g){for(let v=0;v<f;++v)y+=p+`<row_${g+1}_col_${v+1}>`+_.repeat(d);y+=`
`}return y+=`
${p}${w}`+_.repeat(d)+`${p}`,y}function l(d,h,f,p){return`${h}${p}`+f.repeat(d)+`${h}`}function c(d,h,f,p,_,w){return d===0&&h===0?l(f,p,_,w):a(f,d,h,p,_,w)}class u extends n.Processor{constructor(){super(...arguments);oe(this,"fake_image_token","<fake_token_around_image>");oe(this,"image_token","<image>");oe(this,"global_img_token","<global-img>")}async _call(f,p=null,_={}){_.return_row_col_info??(_.return_row_col_info=!0);let w;p&&(w=await this.image_processor(p,_)),Array.isArray(f)||(f=[f]);const y=w.rows??[new Array(f.length).fill(0)],g=w.cols??[new Array(f.length).fill(0)],v=this.config.image_seq_len,b=[],x=[];for(let E=0;E<f.length;++E){const P=f[E],I=y[E],O=g[E];b.push((0,o.count)(P,this.image_token));const V=I.map((Y,K)=>c(Y,O[K],v,this.fake_image_token,this.image_token,this.global_img_token)),U=P.split(this.image_token);if(U.length===0)throw new Error("The image token should be present in the text.");let B=U[0];for(let Y=0;Y<V.length;++Y)B+=V[Y]+U[Y+1];x.push(B)}return{...this.tokenizer(x),...w}}}oe(u,"image_processor_class",s.AutoImageProcessor),oe(u,"tokenizer_class",i.AutoTokenizer),oe(u,"uses_processor_config",!0)},"./src/models/image_processors.js":(e,t,r)=>{r.r(t),r.d(t,{BeitFeatureExtractor:()=>n.BeitFeatureExtractor,BitImageProcessor:()=>s.BitImageProcessor,CLIPFeatureExtractor:()=>o.CLIPFeatureExtractor,CLIPImageProcessor:()=>o.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>i.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>a.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>a.ConvNextImageProcessor,DPTFeatureExtractor:()=>d.DPTFeatureExtractor,DPTImageProcessor:()=>d.DPTImageProcessor,DeiTFeatureExtractor:()=>l.DeiTFeatureExtractor,DeiTImageProcessor:()=>l.DeiTImageProcessor,DetrFeatureExtractor:()=>c.DetrFeatureExtractor,DetrImageProcessor:()=>c.DetrImageProcessor,DonutFeatureExtractor:()=>u.DonutFeatureExtractor,DonutImageProcessor:()=>u.DonutImageProcessor,EfficientNetImageProcessor:()=>h.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>f.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>p.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>_.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>y.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>g.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>v.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>b.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>b.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>x.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>x.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>M.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>M.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>E.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>E.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>P.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>P.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>I.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>I.MobileViTImageProcessor,NougatImageProcessor:()=>O.NougatImageProcessor,OwlViTFeatureExtractor:()=>U.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>U.OwlViTImageProcessor,Owlv2ImageProcessor:()=>V.Owlv2ImageProcessor,Phi3VImageProcessor:()=>B.Phi3VImageProcessor,PvtImageProcessor:()=>Y.PvtImageProcessor,Qwen2VLImageProcessor:()=>K.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>X.RTDetrImageProcessor,SamImageProcessor:()=>G.SamImageProcessor,SegformerFeatureExtractor:()=>R.SegformerFeatureExtractor,SegformerImageProcessor:()=>R.SegformerImageProcessor,SiglipImageProcessor:()=>te.SiglipImageProcessor,SmolVLMImageProcessor:()=>re.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>L.Swin2SRImageProcessor,VLMImageProcessor:()=>w.VLMImageProcessor,ViTFeatureExtractor:()=>j.ViTFeatureExtractor,ViTImageProcessor:()=>j.ViTImageProcessor,VitMatteImageProcessor:()=>q.VitMatteImageProcessor,VitPoseImageProcessor:()=>ne.VitPoseImageProcessor,YolosFeatureExtractor:()=>me.YolosFeatureExtractor,YolosImageProcessor:()=>me.YolosImageProcessor});var n=r("./src/models/beit/image_processing_beit.js"),s=r("./src/models/bit/image_processing_bit.js"),i=r("./src/models/chinese_clip/image_processing_chinese_clip.js"),o=r("./src/models/clip/image_processing_clip.js"),a=r("./src/models/convnext/image_processing_convnext.js"),l=r("./src/models/deit/image_processing_deit.js"),c=r("./src/models/detr/image_processing_detr.js"),u=r("./src/models/donut/image_processing_donut.js"),d=r("./src/models/dpt/image_processing_dpt.js"),h=r("./src/models/efficientnet/image_processing_efficientnet.js"),f=r("./src/models/glpn/image_processing_glpn.js"),p=r("./src/models/grounding_dino/image_processing_grounding_dino.js"),_=r("./src/models/idefics3/image_processing_idefics3.js"),w=r("./src/models/janus/image_processing_janus.js"),y=r("./src/models/jina_clip/image_processing_jina_clip.js"),g=r("./src/models/llava_onevision/image_processing_llava_onevision.js"),v=r("./src/models/mask2former/image_processing_mask2former.js"),b=r("./src/models/maskformer/image_processing_maskformer.js"),x=r("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),M=r("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),E=r("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),P=r("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),I=r("./src/models/mobilevit/image_processing_mobilevit.js"),O=r("./src/models/nougat/image_processing_nougat.js"),V=r("./src/models/owlv2/image_processing_owlv2.js"),U=r("./src/models/owlvit/image_processing_owlvit.js"),B=r("./src/models/phi3_v/image_processing_phi3_v.js"),Y=r("./src/models/pvt/image_processing_pvt.js"),K=r("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),X=r("./src/models/rt_detr/image_processing_rt_detr.js"),G=r("./src/models/sam/image_processing_sam.js"),R=r("./src/models/segformer/image_processing_segformer.js"),te=r("./src/models/siglip/image_processing_siglip.js"),re=r("./src/models/smolvlm/image_processing_smolvlm.js"),L=r("./src/models/swin2sr/image_processing_swin2sr.js"),j=r("./src/models/vit/image_processing_vit.js"),q=r("./src/models/vitmatte/image_processing_vitmatte.js"),ne=r("./src/models/vitpose/image_processing_vitpose.js"),me=r("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(e,t,r)=>{r.r(t),r.d(t,{VLMImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{constructor(o){super({do_pad:!0,pad_size:{width:o.image_size,height:o.image_size},...o}),this.constant_values=this.config.background_color.map(a=>a*this.rescale_factor)}pad_image(o,a,l,c){return super.pad_image(o,a,l,{constant_values:this.constant_values,center:!0,...c})}}},"./src/models/janus/processing_janus.js":(e,t,r)=>{r.r(t),r.d(t,{VLChatProcessor:()=>c});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/utils/core.js"),a=r("./src/utils/tensor.js"),l=r("./src/utils/image.js");class c extends n.Processor{constructor(d,h,f){super(d,h,f),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(d,{images:h=null,chat_template:f="default"}={}){h?Array.isArray(h)||(h=[h]):h=await Promise.all(d.filter(O=>O.images).flatMap(O=>O.images).map(O=>l.RawImage.read(O)));const p=this.tokenizer,_=p.apply_chat_template(d,{tokenize:!1,add_generation_prompt:!0,chat_template:f}),w=O=>p.encode(O,{add_special_tokens:!1}),y=_.split(this.image_tag),g=y.length-1;if(h.length!==g)throw new Error(`Number of images provided (${h.length}) does not match number of "${this.image_tag}" image tags (${g})`);const[v,b,x]=p.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let M=w(y[0]),E=new Array(M.length).fill(!1);for(let O=1;O<y.length;++O){const V=new Array(this.num_image_tokens).fill(v),U=w(y[O]);M=(0,o.mergeArrays)(M,[b],V,[x],U);const B=new Array(this.num_image_tokens).fill(!0);E=(0,o.mergeArrays)(E,[!1],B,[!1],new Array(U.length).fill(!1))}const P=[1,M.length],I={input_ids:new a.Tensor("int64",M,P),attention_mask:new a.Tensor("int64",new Array(M.length).fill(1),P),images_seq_mask:new a.Tensor("bool",E,P),images_emb_mask:new a.Tensor("bool",new Array(g*this.num_image_tokens).fill(!0),[1,g,this.num_image_tokens])};if(h&&h.length>0){const O=await this.image_processor(h);return O.pixel_values.unsqueeze_(0),{...I,...O}}return I}}oe(c,"image_processor_class",s.AutoImageProcessor),oe(c,"tokenizer_class",i.AutoTokenizer),oe(c,"uses_processor_config",!0)},"./src/models/jina_clip/image_processing_jina_clip.js":(e,t,r)=>{r.r(t),r.d(t,{JinaCLIPImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{constructor(o){const{resize_mode:a,fill_color:l,interpolation:c,size:u,...d}=o,h=a==="squash"?{width:u,height:u}:a==="shortest"?{shortest_edge:u}:{longest_edge:u},f=c==="bicubic"?3:2;super({...d,size:h,resample:f,do_center_crop:!0,crop_size:u,do_normalize:!0})}}},"./src/models/jina_clip/processing_jina_clip.js":(e,t,r)=>{r.r(t),r.d(t,{JinaCLIPProcessor:()=>o});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");class o extends n.Processor{async _call(l=null,c=null,u={}){if(!l&&!c)throw new Error("Either text or images must be provided");const d=l?this.tokenizer(l,u):{},h=c?await this.image_processor(c,u):{};return{...d,...h}}}oe(o,"tokenizer_class",i.AutoTokenizer),oe(o,"image_processor_class",s.AutoImageProcessor)},"./src/models/llava/processing_llava.js":(e,t,r)=>{r.r(t),r.d(t,{LlavaProcessor:()=>o});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");class o extends n.Processor{async _call(l,c=null,u={}){const d=await this.image_processor(l,u);if(c){const[f,p]=d.pixel_values.dims.slice(-2),{image_token:_,patch_size:w,num_additional_image_tokens:y}=this.config,g=Math.floor(f/w)*Math.floor(p/w)+y;c=structuredClone(c),Array.isArray(c)||(c=[c]);for(let v=0;v<c.length;++v)c[v]=c[v].replace(_,_.repeat(g))}const h=c?this.tokenizer(c,u):{};return{...d,...h}}}oe(o,"tokenizer_class",i.AutoTokenizer),oe(o,"image_processor_class",s.AutoImageProcessor),oe(o,"uses_processor_config",!0)},"./src/models/llava_onevision/image_processing_llava_onevision.js":(e,t,r)=>{r.r(t),r.d(t,{LlavaOnevisionImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(e,t,r)=>{r.r(t),r.d(t,{Mask2FormerImageProcessor:()=>s});var n=r("./src/models/maskformer/image_processing_maskformer.js");class s extends n.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(e,t,r)=>{r.r(t),r.d(t,{MaskFormerFeatureExtractor:()=>i,MaskFormerImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{post_process_panoptic_segmentation(...a){return(0,n.post_process_panoptic_segmentation)(...a)}post_process_instance_segmentation(...a){return(0,n.post_process_instance_segmentation)(...a)}}class i extends s{}},"./src/models/mgp_str/processing_mgp_str.js":(e,t,r)=>{r.r(t),r.d(t,{MgpstrProcessor:()=>l});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js"),o=r("./src/utils/maths.js");const a={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class l extends n.Processor{get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(u,d){if(!a.hasOwnProperty(d))throw new Error(`Format ${d} is not supported.`);const[h,f]=a[d],p=this[h].bind(this),[_,w]=u.dims,y=[],g=[],v=u.tolist();for(let x=0;x<_;++x){const M=v[x],E=[],P=[];for(let O=1;O<w;++O){const[V,U]=(0,o.max)((0,o.softmax)(M[O]));if(P.push(V),U==f)break;E.push(U)}const I=P.length>0?P.reduce((O,V)=>O*V,1):0;g.push(E),y.push(I)}return[p(g),y]}char_decode(u){return this.char_tokenizer.batch_decode(u).map(d=>d.replaceAll(" ",""))}bpe_decode(u){return this.bpe_tokenizer.batch_decode(u)}wp_decode(u){return this.wp_tokenizer.batch_decode(u).map(d=>d.replaceAll(" ",""))}batch_decode([u,d,h]){const[f,p]=this._decode_helper(u,"char"),[_,w]=this._decode_helper(d,"bpe"),[y,g]=this._decode_helper(h,"wp"),v=[],b=[];for(let x=0;x<f.length;++x){const[M,E]=(0,o.max)([p[x],w[x],g[x]]);v.push([f[x],_[x],y[x]][E]),b.push(M)}return{generated_text:v,scores:b,char_preds:f,bpe_preds:_,wp_preds:y}}static async from_pretrained(...u){const d=await super.from_pretrained(...u),h=await i.AutoTokenizer.from_pretrained("Xenova/gpt2"),f=await i.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return d.components={image_processor:d.image_processor,char_tokenizer:d.tokenizer,bpe_tokenizer:h,wp_tokenizer:f},d}async _call(u,d=null){const h=await this.image_processor(u);return d&&(h.labels=this.tokenizer(d).input_ids),h}}oe(l,"tokenizer_class",i.AutoTokenizer),oe(l,"image_processor_class",s.AutoImageProcessor)},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV1FeatureExtractor:()=>i,MobileNetV1ImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV2FeatureExtractor:()=>i,MobileNetV2ImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV3FeatureExtractor:()=>i,MobileNetV3ImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV4FeatureExtractor:()=>i,MobileNetV4ImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/mobilevit/image_processing_mobilevit.js":(e,t,r)=>{r.r(t),r.d(t,{MobileViTFeatureExtractor:()=>i,MobileViTImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/moonshine/feature_extraction_moonshine.js":(e,t,r)=>{r.r(t),r.d(t,{MoonshineFeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js"),s=r("./src/utils/tensor.js");class i extends n.FeatureExtractor{async _call(a){(0,n.validate_audio_inputs)(a,"MoonshineFeatureExtractor"),a instanceof Float64Array&&(a=new Float32Array(a));const l=[1,a.length];return{input_values:new s.Tensor("float32",a,l)}}}},"./src/models/moonshine/processing_moonshine.js":(e,t,r)=>{r.r(t),r.d(t,{MoonshineProcessor:()=>o});var n=r("./src/models/auto/feature_extraction_auto.js"),s=r("./src/tokenizers.js"),i=r("./src/base/processing_utils.js");class o extends i.Processor{async _call(l){return await this.feature_extractor(l)}}oe(o,"tokenizer_class",s.AutoTokenizer),oe(o,"feature_extractor_class",n.AutoFeatureExtractor)},"./src/models/nougat/image_processing_nougat.js":(e,t,r)=>{r.r(t),r.d(t,{NougatImageProcessor:()=>s});var n=r("./src/models/donut/image_processing_donut.js");class s extends n.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(e,t,r)=>{r.r(t),r.d(t,{Owlv2ImageProcessor:()=>s});var n=r("./src/models/owlvit/image_processing_owlvit.js");class s extends n.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(e,t,r)=>{r.r(t),r.d(t,{OwlViTFeatureExtractor:()=>i,OwlViTImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{post_process_object_detection(...a){return(0,n.post_process_object_detection)(...a)}}class i extends s{}},"./src/models/owlvit/processing_owlvit.js":(e,t,r)=>{r.r(t),r.d(t,{OwlViTProcessor:()=>o});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");class o extends n.Processor{}oe(o,"tokenizer_class",i.AutoTokenizer),oe(o,"image_processor_class",s.AutoImageProcessor)},"./src/models/paligemma/processing_paligemma.js":(e,t,r)=>{r.r(t),r.d(t,{PaliGemmaProcessor:()=>l});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");const o="<image>";function a(c,u,d,h,f){return`${h.repeat(d*f)}${u}${c}
`}class l extends n.Processor{async _call(u,d=null,h={}){d||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),d=""),Array.isArray(u)||(u=[u]),Array.isArray(d)||(d=[d]);const f=this.tokenizer.bos_token,p=this.image_processor.config.image_seq_length;let _;d.some(g=>g.includes(o))?_=d.map(g=>{const v=g.replaceAll(o,o.repeat(p)),b=v.lastIndexOf(o),x=b===-1?0:b+o.length;return v.slice(0,x)+f+v.slice(x)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),_=d.map(g=>a(g,f,p,o,u.length)));const w=this.tokenizer(_,h);return{...await this.image_processor(u,h),...w}}}oe(l,"tokenizer_class",i.AutoTokenizer),oe(l,"image_processor_class",s.AutoImageProcessor),oe(l,"uses_processor_config",!1)},"./src/models/phi3_v/image_processing_phi3_v.js":(e,t,r)=>{r.r(t),r.d(t,{Phi3VImageProcessor:()=>u});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/tensor.js");const i=336,o=[2,3],{ceil:a,floor:l,sqrt:c}=Math;class u extends n.ImageProcessor{constructor(h){super({...h,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=h.num_crops}calc_num_image_tokens_from_image_size(h,f){const{num_img_tokens:p}=this.config;return l((l(f/i)*l(h/i)+1)*p+1+(l(f/i)+1)*c(p))}get_resize_output_image_size(h,f){const p=this._num_crops,[_,w]=h.size;let y=_/w,g=1;for(;g*Math.ceil(g/y)<=p;)g+=1;g-=1;const v=Math.floor(g*336),b=Math.floor(v/y);return[v,b]}pad_image(h,f,p,_={}){const[w,y]=f,g=i*a(w/i),v=i*a(y/i),b=[1,1,1].map((x,M)=>(x-this.image_mean[M])/this.image_std[M]);return super.pad_image(h,f,{width:v,height:g},{center:!0,constant_values:b,..._})}async _call(h,{num_crops:f=null}={}){if(this._num_crops=f??(f=this.config.num_crops),f<4||c(f)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(h)||(h=[h]);const p=h.length,_=await Promise.all(h.map(E=>this.preprocess(E))),w=_.map(E=>E.original_size),y=_.map(E=>E.reshaped_input_size),g=[];for(const{pixel_values:E}of _){E.unsqueeze_(0);const[P,I]=E.dims.slice(-2),O=await(0,s.interpolate_4d)(E,{size:[i,i],mode:"bicubic"});if(f>0){const V=[],U=c(f),B=l(I/U),Y=l(P/U);for(let X=0;X<U;++X)for(let G=0;G<U;++G){let R,te,re,L;X===U-1?(te=P-Y,L=P):(te=X*Y,L=(X+1)*Y),G===U-1?(R=I-B,re=I):(R=G*B,re=(G+1)*B);const j=[te,R],q=[L,re],ne=await(0,s.slice)(E,j,q,o);V.push(ne)}const K=await(0,s.interpolate_4d)((0,s.cat)(V,0),{size:[i,i],mode:"bicubic"});g.push((0,s.cat)([O,K],0))}else g.push(O)}const v=(0,s.stack)(g,0),b=y.map(E=>E.map(P=>i*a(P/i))),x=new s.Tensor("int64",b.flat(),[p,2]),M=b.map(([E,P])=>this.calc_num_image_tokens_from_image_size(P,E));return{pixel_values:v,original_sizes:w,reshaped_input_sizes:y,image_sizes:x,num_img_tokens:M}}}},"./src/models/phi3_v/processing_phi3_v.js":(e,t,r)=>{r.r(t),r.d(t,{Phi3VProcessor:()=>l});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");r("./src/utils/image.js");const o="<|image|>",a=/<\|image_\d+\|>/g;class l extends n.Processor{async _call(u,d=null,{padding:h=!0,truncation:f=!0,num_crops:p=null}={}){Array.isArray(u)||(u=[u]);let _,w;if(d){w=await this.image_processor(d,{num_crops:p});const{num_img_tokens:y}=w,g=u.map((b,x)=>b.split(a).join(o.repeat(y[x])));_=this.tokenizer(g,{padding:h,truncation:f});const v=this.tokenizer.model.convert_tokens_to_ids([o])[0];_.input_ids.map_(b=>b==v?-b:b)}else _=this.tokenizer(u);return{..._,...w}}}oe(l,"image_processor_class",s.AutoImageProcessor),oe(l,"tokenizer_class",i.AutoTokenizer)},"./src/models/processors.js":(e,t,r)=>{r.r(t),r.d(t,{Florence2Processor:()=>n.Florence2Processor,Gemma3nProcessor:()=>s.Gemma3nProcessor,GroundingDinoProcessor:()=>i.GroundingDinoProcessor,Idefics3Processor:()=>o.Idefics3Processor,JinaCLIPProcessor:()=>l.JinaCLIPProcessor,LlavaProcessor:()=>c.LlavaProcessor,MgpstrProcessor:()=>u.MgpstrProcessor,MoonshineProcessor:()=>d.MoonshineProcessor,OwlViTProcessor:()=>h.OwlViTProcessor,PaliGemmaProcessor:()=>p.PaliGemmaProcessor,Phi3VProcessor:()=>f.Phi3VProcessor,PyAnnoteProcessor:()=>_.PyAnnoteProcessor,Qwen2VLProcessor:()=>w.Qwen2VLProcessor,SamProcessor:()=>y.SamProcessor,SmolVLMProcessor:()=>g.SmolVLMProcessor,SpeechT5Processor:()=>v.SpeechT5Processor,UltravoxProcessor:()=>b.UltravoxProcessor,VLChatProcessor:()=>a.VLChatProcessor,Wav2Vec2Processor:()=>x.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>M.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>E.WhisperProcessor});var n=r("./src/models/florence2/processing_florence2.js"),s=r("./src/models/gemma3n/processing_gemma3n.js"),i=r("./src/models/grounding_dino/processing_grounding_dino.js"),o=r("./src/models/idefics3/processing_idefics3.js"),a=r("./src/models/janus/processing_janus.js"),l=r("./src/models/jina_clip/processing_jina_clip.js"),c=r("./src/models/llava/processing_llava.js"),u=r("./src/models/mgp_str/processing_mgp_str.js"),d=r("./src/models/moonshine/processing_moonshine.js"),h=r("./src/models/owlvit/processing_owlvit.js"),f=r("./src/models/phi3_v/processing_phi3_v.js"),p=r("./src/models/paligemma/processing_paligemma.js"),_=r("./src/models/pyannote/processing_pyannote.js"),w=r("./src/models/qwen2_vl/processing_qwen2_vl.js"),y=r("./src/models/sam/processing_sam.js"),g=r("./src/models/smolvlm/processing_smolvlm.js"),v=r("./src/models/speecht5/processing_speecht5.js"),b=r("./src/models/ultravox/processing_ultravox.js"),x=r("./src/models/wav2vec2/processing_wav2vec2.js"),M=r("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),E=r("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(e,t,r)=>{r.r(t),r.d(t,{PvtImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(e,t,r)=>{r.r(t),r.d(t,{PyAnnoteFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js"),s=r("./src/utils/tensor.js"),i=r("./src/utils/maths.js");class o extends n.FeatureExtractor{async _call(l){(0,n.validate_audio_inputs)(l,"PyAnnoteFeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));const c=[1,1,l.length];return{input_values:new s.Tensor("float32",l,c)}}samples_to_frames(l){return(l-this.config.offset)/this.config.step}post_process_speaker_diarization(l,c){const u=c/this.samples_to_frames(c)/this.config.sampling_rate,d=[];for(const h of l.tolist()){const f=[];let p=-1;for(let _=0;_<h.length;++_){const w=(0,i.softmax)(h[_]),[y,g]=(0,i.max)(w),[v,b]=[_,_+1];g!==p?(p=g,f.push({id:g,start:v,end:b,score:y})):(f.at(-1).end=b,f.at(-1).score+=y)}d.push(f.map(({id:_,start:w,end:y,score:g})=>({id:_,start:w*u,end:y*u,confidence:g/(y-w)})))}return d}}},"./src/models/pyannote/processing_pyannote.js":(e,t,r)=>{r.r(t),r.d(t,{PyAnnoteProcessor:()=>i});var n=r("./src/base/processing_utils.js"),s=r("./src/models/pyannote/feature_extraction_pyannote.js");class i extends n.Processor{async _call(a){return await this.feature_extractor(a)}post_process_speaker_diarization(...a){return this.feature_extractor.post_process_speaker_diarization(...a)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}oe(i,"feature_extractor_class",s.PyAnnoteFeatureExtractor)},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(e,t,r)=>{r.r(t),r.d(t,{Qwen2VLImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/tensor.js");class i extends n.ImageProcessor{async _call(a,...l){const{pixel_values:c,original_sizes:u,reshaped_input_sizes:d}=await super._call(a,...l);let h=c;const{temporal_patch_size:f,merge_size:p,patch_size:_}=this.config;h.dims[0]===1&&(h=(0,s.cat)(Array.from({length:f},()=>h),0));const w=h.dims[0]/f,y=h.dims[1],g=Math.floor(h.dims[2]/_),v=Math.floor(h.dims[3]/_),b=h.view(w,f,y,Math.floor(g/p),p,_,Math.floor(v/p),p,_).permute(0,3,6,4,7,2,1,5,8).view(w*g*v,y*f*_*_),x=new s.Tensor("int64",[w,g,v],[1,3]);return{pixel_values:b,image_grid_thw:x,original_sizes:u,reshaped_input_sizes:d}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(e,t,r)=>{r.r(t),r.d(t,{Qwen2VLProcessor:()=>o});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js"),i=r("./src/tokenizers.js");r("./src/utils/image.js");class o extends n.Processor{async _call(l,c=null,...u){Array.isArray(l)||(l=[l]);let d,h;if(c&&(d=await this.image_processor(c),h=d.image_grid_thw),h){let p=this.image_processor.config.merge_size**2,_=0;const w=h.tolist();l=l.map(y=>{for(;y.includes("<|image_pad|>");){const g=Number(w[_++].reduce((v,b)=>v*b,1n));y=y.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(g/p)))}return y.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(l),...d}}}oe(o,"image_processor_class",s.AutoImageProcessor),oe(o,"tokenizer_class",i.AutoTokenizer)},"./src/models/rt_detr/image_processing_rt_detr.js":(e,t,r)=>{r.r(t),r.d(t,{RTDetrImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{post_process_object_detection(...o){return(0,n.post_process_object_detection)(...o)}}},"./src/models/sam/image_processing_sam.js":(e,t,r)=>{r.r(t),r.d(t,{SamImageProcessor:()=>o});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/core.js"),i=r("./src/utils/tensor.js");class o extends n.ImageProcessor{reshape_input_points(l,c,u,d=!1){l=structuredClone(l);let h=(0,s.calculateDimensions)(l);if(h.length===3)d||(h=[1,...h]),l=[l];else if(h.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let f=0;f<l.length;++f){let p=c[f],_=u[f],w=[_[0]/p[0],_[1]/p[1]];for(let y=0;y<l[f].length;++y)for(let g=0;g<l[f][y].length;++g)for(let v=0;v<l[f][y][g].length;++v)l[f][y][g][v]*=w[v%2]}return new i.Tensor("float32",Float32Array.from(l.flat(1/0)),h)}add_input_labels(l,c){let u=(0,s.calculateDimensions)(l);if(u.length===2)u=[1,...u],l=[l];else if(u.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(u.some((d,h)=>d!==c.dims[h]))throw Error(`The first ${u.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new i.Tensor("int64",l.flat(1/0).map(BigInt),u)}async _call(l,{input_points:c=null,input_labels:u=null,input_boxes:d=null}={}){const h=await super._call(l);if(c&&(h.input_points=this.reshape_input_points(c,h.original_sizes,h.reshaped_input_sizes)),u){if(!h.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");h.input_labels=this.add_input_labels(u,h.input_points)}return d&&(h.input_boxes=this.reshape_input_points(d,h.original_sizes,h.reshaped_input_sizes,!0)),h}async post_process_masks(l,c,u,{mask_threshold:d=0,binarize:h=!0,pad_size:f=null}={}){const p=[];f=f??this.pad_size;const _=[f.height,f.width];for(let w=0;w<c.length;++w){const y=c[w],g=u[w];let v=await(0,i.interpolate_4d)(l[w],{mode:"bilinear",size:_});if(v=v.slice(null,null,[0,g[0]],[0,g[1]]),v=await(0,i.interpolate_4d)(v,{mode:"bilinear",size:y}),h){const b=v.data,x=new Uint8Array(b.length);for(let M=0;M<b.length;++M)b[M]>d&&(x[M]=1);v=new i.Tensor("bool",x,v.dims)}p.push(v)}return p}generate_crop_boxes(l,c,{crop_n_layers:u=0,overlap_ratio:d=512/1500,points_per_crop:h=32,crop_n_points_downscale_factor:f=1}={}){}}},"./src/models/sam/processing_sam.js":(e,t,r)=>{r.r(t),r.d(t,{SamProcessor:()=>i});var n=r("./src/base/processing_utils.js"),s=r("./src/models/auto/image_processing_auto.js");class i extends n.Processor{async _call(...a){return await this.image_processor(...a)}post_process_masks(...a){return this.image_processor.post_process_masks(...a)}reshape_input_points(...a){return this.image_processor.reshape_input_points(...a)}}oe(i,"image_processor_class",s.AutoImageProcessor)},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(e,t,r)=>{r.r(t),r.d(t,{SeamlessM4TFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js"),s=r("./src/utils/tensor.js"),i=r("./src/utils/audio.js");class o extends n.FeatureExtractor{constructor(l){super(l);const c=this.config.sampling_rate,u=(0,i.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(c/2),c,null,"kaldi",!0);this.mel_filters=u,this.window=(0,i.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(l,c){return l=l.map(u=>u*32768),(0,i.spectrogram)(l,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:c,transpose:!0})}async _call(l,{padding:c=!0,pad_to_multiple_of:u=2,do_normalize_per_mel_bins:d=!0,return_attention_mask:h=!0}={}){(0,n.validate_audio_inputs)(l,"SeamlessM4TFeatureExtractor");let f=await this._extract_fbank_features(l,this.config.max_length);if(d){const[x,M]=f.dims,E=f.data;for(let P=0;P<M;++P){let I=0;for(let B=0;B<x;++B)I+=E[B*M+P];const O=I/x;let V=0;for(let B=0;B<x;++B)V+=(E[B*M+P]-O)**2;V/=x-1;const U=Math.sqrt(V+1e-7);for(let B=0;B<x;++B){const Y=B*M+P;E[Y]=(E[Y]-O)/U}}}let p;if(c){const[x,M]=f.dims,E=f.data,P=x%u;if(P>0){const I=new Float32Array(M*(x+P));I.set(E),I.fill(this.config.padding_value,E.length);const O=x+P;f=new s.Tensor(f.type,I,[O,M]),h&&(p=new s.Tensor("int64",new BigInt64Array(O),[1,O]),p.data.fill(1n,0,x))}}const[_,w]=f.dims,y=this.config.stride;if(_%y!==0)throw new Error(`The number of frames (${_}) must be a multiple of the stride (${y}).`);const v=f.view(1,Math.floor(_/y),w*y),b={input_features:v};if(h){const x=v.dims[1],M=new BigInt64Array(x);if(p){const E=p.data;for(let P=1,I=0;P<_;P+=y,++I)M[I]=E[P]}else M.fill(1n);b.attention_mask=new s.Tensor("int64",M,[1,x])}return b}}},"./src/models/segformer/image_processing_segformer.js":(e,t,r)=>{r.r(t),r.d(t,{SegformerFeatureExtractor:()=>i,SegformerImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{post_process_semantic_segmentation(...a){return(0,n.post_process_semantic_segmentation)(...a)}}class i extends s{}},"./src/models/siglip/image_processing_siglip.js":(e,t,r)=>{r.r(t),r.d(t,{SiglipImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}},"./src/models/smolvlm/image_processing_smolvlm.js":(e,t,r)=>{r.r(t),r.d(t,{SmolVLMImageProcessor:()=>n.Idefics3ImageProcessor});var n=r("./src/models/idefics3/image_processing_idefics3.js")},"./src/models/smolvlm/processing_smolvlm.js":(e,t,r)=>{r.r(t),r.d(t,{SmolVLMProcessor:()=>n.Idefics3Processor});var n=r("./src/models/idefics3/processing_idefics3.js")},"./src/models/snac/feature_extraction_snac.js":(e,t,r)=>{r.r(t),r.d(t,{SnacFeatureExtractor:()=>s});var n=r("./src/models/dac/feature_extraction_dac.js");class s extends n.DacFeatureExtractor{}},"./src/models/speecht5/feature_extraction_speecht5.js":(e,t,r)=>{r.r(t),r.d(t,{SpeechT5FeatureExtractor:()=>s});var n=r("./src/base/feature_extraction_utils.js");class s extends n.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(e,t,r)=>{r.r(t),r.d(t,{SpeechT5Processor:()=>o});var n=r("./src/base/processing_utils.js"),s=r("./src/tokenizers.js"),i=r("./src/models/auto/feature_extraction_auto.js");class o extends n.Processor{async _call(l){return await this.feature_extractor(l)}}oe(o,"tokenizer_class",s.AutoTokenizer),oe(o,"feature_extractor_class",i.AutoFeatureExtractor)},"./src/models/swin2sr/image_processing_swin2sr.js":(e,t,r)=>{r.r(t),r.d(t,{Swin2SRImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{pad_image(o,a,l,c={}){const[u,d,h]=a;return super.pad_image(o,a,{width:d+(l-d%l)%l,height:u+(l-u%l)%l},{mode:"symmetric",center:!1,constant_values:-1,...c})}}},"./src/models/ultravox/processing_ultravox.js":(e,t,r)=>{r.r(t),r.d(t,{UltravoxProcessor:()=>o});var n=r("./src/models/auto/feature_extraction_auto.js"),s=r("./src/tokenizers.js"),i=r("./src/base/processing_utils.js");class o extends i.Processor{async _call(l,c=null,u={}){if(Array.isArray(l))throw new Error("Batched inputs are not supported yet.");let d={};if(c){const f=c.length,{input_features:p}=await this.feature_extractor(c,{...u,max_length:f}),_=Math.round(f/this.config.encoder_ds_factor+1e-4),w=1+Math.ceil(_/this.config.stack_factor);d.audio_token_len=[w],d.audio_values=p;const y=this.config.audio_placeholder;if(!l.includes(y))throw new Error(`The input text does not contain the image token ${y}.`);l=l.replaceAll(y,y.repeat(w))}return{...this.tokenizer(l,{add_special_tokens:!1,...u}),...d}}}oe(o,"tokenizer_class",s.AutoTokenizer),oe(o,"feature_extractor_class",n.AutoFeatureExtractor),oe(o,"uses_processor_config",!0)},"./src/models/vit/image_processing_vit.js":(e,t,r)=>{r.r(t),r.d(t,{ViTFeatureExtractor:()=>i,ViTImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{}class i extends s{}},"./src/models/vitmatte/image_processing_vitmatte.js":(e,t,r)=>{r.r(t),r.d(t,{VitMatteImageProcessor:()=>i});var n=r("./src/base/image_processors_utils.js"),s=r("./src/utils/tensor.js");class i extends n.ImageProcessor{async _call(a,l){Array.isArray(a)||(a=[a]),Array.isArray(l)||(l=[l]);const c=await Promise.all(a.map(h=>this.preprocess(h))),u=await Promise.all(l.map(h=>this.preprocess(h,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,s.stack)(c.map((h,f)=>(0,s.cat)([h.pixel_values,u[f].pixel_values],0)),0),original_sizes:c.map(h=>h.original_size),reshaped_input_sizes:c.map(h=>h.reshaped_input_size)}}}},"./src/models/vitpose/image_processing_vitpose.js":(e,t,r)=>{r.r(t),r.d(t,{VitPoseImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{post_process_pose_estimation(o,a,{threshold:l=null}={}){const c=o.tolist(),[u,d,h,f]=o.dims,p=[];for(let _=0;_<u;++_){const w=c[_],y=a[_],g=[];for(let v=0;v<y.length;++v){const b=y[v],x=[],M=[],E=[],P=b.at(-2)/f,I=b.at(-1)/h;for(let O=0;O<w.length;++O){let[V,U]=[0,0],B=0,Y=-1/0;const K=w[O];for(let G=0;G<K.length;++G){const R=K[G];for(let te=0;te<R.length;++te){const re=R[te];B+=re,Y=Math.max(Y,re),V+=(te+.5)*re,U+=G*re}}if(l!=null&&Y<l)continue;const X=[P*V/B,I*U/B];x.push(X),E.push(O),M.push(Y)}g.push({bbox:b,scores:M,labels:E,keypoints:x})}p.push(g)}return p}}},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2FeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js"),s=r("./src/utils/tensor.js");class i extends n.FeatureExtractor{_zero_mean_unit_var_norm(a){const c=a.reduce((d,h)=>d+h,0)/a.length,u=a.reduce((d,h)=>d+(h-c)**2,0)/a.length;return a.map(d=>(d-c)/Math.sqrt(u+1e-7))}async _call(a){(0,n.validate_audio_inputs)(a,"Wav2Vec2FeatureExtractor"),a instanceof Float64Array&&(a=new Float32Array(a));let l=a;this.config.do_normalize&&(l=this._zero_mean_unit_var_norm(l));const c=[1,l.length];return{input_values:new s.Tensor("float32",l,c),attention_mask:new s.Tensor("int64",new BigInt64Array(l.length).fill(1n),c)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2Processor:()=>o});var n=r("./src/tokenizers.js"),s=r("./src/models/auto/feature_extraction_auto.js"),i=r("./src/base/processing_utils.js");class o extends i.Processor{async _call(l){return await this.feature_extractor(l)}}oe(o,"tokenizer_class",n.AutoTokenizer),oe(o,"feature_extractor_class",s.AutoFeatureExtractor)},"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2ProcessorWithLM:()=>o});var n=r("./src/tokenizers.js"),s=r("./src/models/auto/feature_extraction_auto.js"),i=r("./src/base/processing_utils.js");class o extends i.Processor{async _call(l){return await this.feature_extractor(l)}}oe(o,"tokenizer_class",n.AutoTokenizer),oe(o,"feature_extractor_class",s.AutoFeatureExtractor)},"./src/models/wespeaker/feature_extraction_wespeaker.js":(e,t,r)=>{r.r(t),r.d(t,{WeSpeakerFeatureExtractor:()=>i});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var s=r("./src/utils/audio.js");class i extends n.FeatureExtractor{constructor(a){super(a);const l=this.config.sampling_rate,c=(0,s.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(l/2),l,null,"kaldi",!0);this.mel_filters=c,this.window=(0,s.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(a){return a=a.map(l=>l*32768),(0,s.spectrogram)(a,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(a){(0,n.validate_audio_inputs)(a,"WeSpeakerFeatureExtractor");const l=(await this._extract_fbank_features(a)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const c=l.mean(1).data,u=l.data,[d,h,f]=l.dims;for(let p=0;p<d;++p){const _=p*h*f,w=p*f;for(let y=0;y<h;++y){const g=_+y*f;for(let v=0;v<f;++v)u[g+v]-=c[w+v]}}}return{input_features:l}}}},"./src/models/whisper/common_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WHISPER_LANGUAGE_MAPPING:()=>s,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>i,whisper_language_to_code:()=>o});const n=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],s=new Map(n),i=new Map([...n.map(([a,l])=>[l,a]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function o(a){a=a.toLowerCase();let l=i.get(a);if(l===void 0){const c=a.match(/^<\|([a-z]{2})\|>$/);if(c&&(a=c[1]),s.has(a))l=a;else{const d=a.length===2?s.keys():s.values();throw new Error(`Language "${a}" is not supported. Must be one of: ${JSON.stringify(Array.from(d))}`)}}return l}},"./src/models/whisper/feature_extraction_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperFeatureExtractor:()=>o});var n=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var s=r("./src/utils/audio.js"),i=r("./src/utils/maths.js");class o extends n.FeatureExtractor{constructor(l){var c;super(l),(c=this.config).mel_filters??(c.mel_filters=(0,s.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney")),this.window=(0,s.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(l){const c=await(0,s.spectrogram)(l,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(l.length/this.config.hop_length),this.config.nb_max_frames)}),u=c.data,d=(0,i.max)(u)[0];for(let h=0;h<u.length;++h)u[h]=(Math.max(u[h],d-8)+4)/4;return c}async _call(l,{max_length:c=null}={}){(0,n.validate_audio_inputs)(l,"WhisperFeatureExtractor");let u;const d=c??this.config.n_samples;return l.length>d?(l.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),u=l.slice(0,d)):(u=new Float32Array(d),u.set(l)),{input_features:(await this._extract_fbank_features(u)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperGenerationConfig:()=>s});var n=r("./src/generation/configuration_utils.js");class s extends n.GenerationConfig{constructor(){super(...arguments);oe(this,"return_timestamps",null);oe(this,"return_token_timestamps",null);oe(this,"num_frames",null);oe(this,"alignment_heads",null);oe(this,"task",null);oe(this,"language",null);oe(this,"no_timestamps_token_id",null);oe(this,"prompt_ids",null);oe(this,"is_multilingual",null);oe(this,"lang_to_id",null);oe(this,"task_to_id",null);oe(this,"max_initial_timestamp_index",1)}}},"./src/models/whisper/processing_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperProcessor:()=>o});var n=r("./src/models/auto/feature_extraction_auto.js"),s=r("./src/tokenizers.js"),i=r("./src/base/processing_utils.js");class o extends i.Processor{async _call(l){return await this.feature_extractor(l)}}oe(o,"tokenizer_class",s.AutoTokenizer),oe(o,"feature_extractor_class",n.AutoFeatureExtractor)},"./src/models/yolos/image_processing_yolos.js":(e,t,r)=>{r.r(t),r.d(t,{YolosFeatureExtractor:()=>i,YolosImageProcessor:()=>s});var n=r("./src/base/image_processors_utils.js");class s extends n.ImageProcessor{post_process_object_detection(...a){return(0,n.post_process_object_detection)(...a)}}class i extends s{}},"./src/ops/registry.js":(e,t,r)=>{r.r(t),r.d(t,{TensorOpRegistry:()=>l});var n=r("./src/backends/onnx.js"),s=r("./src/utils/tensor.js"),i=r("./src/env.js");const o=i.apis.IS_BROWSER_ENV||i.apis.IS_WEBWORKER_ENV,a=async(c,u,d)=>{const h=await(0,n.createInferenceSession)(new Uint8Array(c),u);let f=Promise.resolve();return async p=>{const _=(0,n.isONNXProxy)(),w=Object.fromEntries(Object.entries(p).map(([g,v])=>[g,(_?v.clone():v).ort_tensor])),y=await(f=o?f.then(()=>h.run(w)):h.run(w));return Array.isArray(d)?d.map(g=>new s.Tensor(y[g])):new s.Tensor(y[d])}};class l{static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=a([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=a([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=a([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=a([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=a([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=a([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=a([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=a([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}oe(l,"session_options",{})},"./src/pipelines.js":(e,t,r)=>{r.r(t),r.d(t,{AudioClassificationPipeline:()=>U,AutomaticSpeechRecognitionPipeline:()=>Y,BackgroundRemovalPipeline:()=>R,DepthEstimationPipeline:()=>me,DocumentQuestionAnsweringPipeline:()=>j,FeatureExtractionPipeline:()=>O,FillMaskPipeline:()=>v,ImageClassificationPipeline:()=>X,ImageFeatureExtractionPipeline:()=>V,ImageSegmentationPipeline:()=>G,ImageToImagePipeline:()=>ne,ImageToTextPipeline:()=>K,ObjectDetectionPipeline:()=>re,Pipeline:()=>_,QuestionAnsweringPipeline:()=>g,SummarizationPipeline:()=>x,Text2TextGenerationPipeline:()=>b,TextClassificationPipeline:()=>w,TextGenerationPipeline:()=>P,TextToAudioPipeline:()=>q,TokenClassificationPipeline:()=>y,TranslationPipeline:()=>M,ZeroShotAudioClassificationPipeline:()=>B,ZeroShotClassificationPipeline:()=>I,ZeroShotImageClassificationPipeline:()=>te,ZeroShotObjectDetectionPipeline:()=>L,pipeline:()=>Pe});var n=r("./src/tokenizers.js"),s=r("./src/models.js"),i=r("./src/models/auto/processing_auto.js");r("./src/base/processing_utils.js");var o=r("./src/utils/generic.js"),a=r("./src/utils/core.js"),l=r("./src/utils/maths.js"),c=r("./src/utils/audio.js"),u=r("./src/utils/tensor.js"),d=r("./src/utils/image.js");async function h(de){return Array.isArray(de)||(de=[de]),await Promise.all(de.map(Q=>d.RawImage.read(Q)))}async function f(de,Q){return Array.isArray(de)||(de=[de]),await Promise.all(de.map(se=>typeof se=="string"||se instanceof URL?(0,c.read_audio)(se,Q):se instanceof Float64Array?new Float32Array(se):se))}function p(de,Q){Q&&(de=de.map(Te=>Te|0));const[se,J,be,xe]=de;return{xmin:se,ymin:J,xmax:be,ymax:xe}}class _ extends o.Callable{constructor({task:Q,model:se,tokenizer:J=null,processor:be=null}){super(),this.task=Q,this.model=se,this.tokenizer=J,this.processor=be}async dispose(){await this.model.dispose()}}class w extends _{constructor(Q){super(Q)}async _call(Q,{top_k:se=1}={}){const J=this.tokenizer(Q,{padding:!0,truncation:!0}),be=await this.model(J),xe=this.model.config.problem_type==="multi_label_classification"?$e=>$e.sigmoid():$e=>new u.Tensor("float32",(0,l.softmax)($e.data),$e.dims),Te=this.model.config.id2label,Ee=[];for(const $e of be.logits){const Ie=xe($e),Ue=await(0,u.topk)(Ie,se),Ke=Ue[0].tolist(),je=Ue[1].tolist().map((qe,ot)=>({label:Te?Te[qe]:`LABEL_${qe}`,score:Ke[ot]}));se===1?Ee.push(...je):Ee.push(je)}return Array.isArray(Q)||se===1?Ee:Ee[0]}}class y extends _{constructor(Q){super(Q)}async _call(Q,{ignore_labels:se=["O"]}={}){const J=Array.isArray(Q),be=this.tokenizer(J?Q:[Q],{padding:!0,truncation:!0}),Te=(await this.model(be)).logits,Ee=this.model.config.id2label,$e=[];for(let Ie=0;Ie<Te.dims[0];++Ie){const Ue=be.input_ids[Ie],Ke=Te[Ie],Je=[];for(let je=0;je<Ke.dims[0];++je){const qe=Ke[je],ot=(0,l.max)(qe.data)[1],ft=Ee?Ee[ot]:`LABEL_${ot}`;if(se.includes(ft))continue;const it=this.tokenizer.decode([Ue[je].item()],{skip_special_tokens:!0});if(it==="")continue;const We=(0,l.softmax)(qe.data);Je.push({entity:ft,score:We[ot],index:je,word:it})}$e.push(Je)}return J?$e:$e[0]}}class g extends _{constructor(Q){super(Q)}async _call(Q,se,{top_k:J=1}={}){const be=this.tokenizer(Q,{text_pair:se,padding:!0,truncation:!0}),{start_logits:xe,end_logits:Te}=await this.model(be),Ee=be.input_ids.tolist(),$e=be.attention_mask.tolist(),Ie=this.tokenizer.all_special_ids,Ue=[];for(let Ke=0;Ke<xe.dims[0];++Ke){const Je=Ee[Ke],je=Je.findIndex(Be=>Be==this.tokenizer.sep_token_id);$e[Ke].map((Be,De)=>Be==1&&(De===0||De>je&&Ie.findIndex(yt=>yt==Je[De])===-1));const qe=xe[Ke].tolist(),ot=Te[Ke].tolist();for(let Be=1;Be<qe.length;++Be)($e[Ke]==0||Be<=je||Ie.findIndex(De=>De==Je[Be])!==-1)&&(qe[Be]=-1/0,ot[Be]=-1/0);const ft=(0,l.softmax)(qe).map((Be,De)=>[Be,De]),it=(0,l.softmax)(ot).map((Be,De)=>[Be,De]);ft[0][0]=0,it[0][0]=0;const We=(0,a.product)(ft,it).filter(Be=>Be[0][1]<=Be[1][1]).map(Be=>[Be[0][1],Be[1][1],Be[0][0]*Be[1][0]]).sort((Be,De)=>De[2]-Be[2]);for(let Be=0;Be<Math.min(We.length,J);++Be){const[De,yt,Mt]=We[Be],Lt=Je.slice(De,yt+1),dr=this.tokenizer.decode(Lt,{skip_special_tokens:!0});Ue.push({answer:dr,score:Mt})}}return J===1?Ue[0]:Ue}}class v extends _{constructor(Q){super(Q)}async _call(Q,{top_k:se=5}={}){const J=this.tokenizer(Q,{padding:!0,truncation:!0}),{logits:be}=await this.model(J),xe=[],Te=J.input_ids.tolist();for(let Ee=0;Ee<Te.length;++Ee){const $e=Te[Ee],Ie=$e.findIndex(qe=>qe==this.tokenizer.mask_token_id);if(Ie===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const Ue=be[Ee][Ie],Ke=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(Ue.data),Ue.dims),se),Je=Ke[0].tolist(),je=Ke[1].tolist();xe.push(je.map((qe,ot)=>{const ft=$e.slice();return ft[Ie]=qe,{score:Je[ot],token:Number(qe),token_str:this.tokenizer.decode([qe]),sequence:this.tokenizer.decode(ft,{skip_special_tokens:!0})}}))}return Array.isArray(Q)?xe:xe[0]}}class b extends _{constructor(se){super(se);oe(this,"_key","generated_text")}async _call(se,J={}){Array.isArray(se)||(se=[se]),this.model.config.prefix&&(se=se.map(Ie=>this.model.config.prefix+Ie));const be=this.model.config.task_specific_params;be&&be[this.task]&&be[this.task].prefix&&(se=se.map(Ie=>be[this.task].prefix+Ie));const xe=this.tokenizer,Te={padding:!0,truncation:!0};let Ee;this instanceof M&&"_build_translation_inputs"in xe?Ee=xe._build_translation_inputs(se,Te,J):Ee=xe(se,Te);const $e=await this.model.generate({...Ee,...J});return xe.batch_decode($e,{skip_special_tokens:!0}).map(Ie=>({[this._key]:Ie}))}}class x extends b{constructor(se){super(se);oe(this,"_key","summary_text")}}class M extends b{constructor(se){super(se);oe(this,"_key","translation_text")}}function E(de){return Array.isArray(de)&&de.every(Q=>"role"in Q&&"content"in Q)}class P extends _{constructor(Q){super(Q)}async _call(Q,se={}){let J=!1,be=!1,xe;if(typeof Q=="string")xe=Q=[Q];else if(Array.isArray(Q)&&Q.every(je=>typeof je=="string"))J=!0,xe=Q;else{if(E(Q))Q=[Q];else if(Array.isArray(Q)&&Q.every(E))J=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");be=!0,xe=Q.map(je=>this.tokenizer.apply_chat_template(je,{tokenize:!1,add_generation_prompt:!0}))}const Te=se.add_special_tokens??!1,Ee=be?!1:se.return_full_text??!0;this.tokenizer.padding_side="left";const $e=this.tokenizer(xe,{add_special_tokens:Te,padding:!0,truncation:!0}),Ie=await this.model.generate({...$e,...se}),Ue=this.tokenizer.batch_decode(Ie,{skip_special_tokens:!0});let Ke;!Ee&&$e.input_ids.dims.at(-1)>0&&(Ke=this.tokenizer.batch_decode($e.input_ids,{skip_special_tokens:!0}).map(je=>je.length));const Je=Array.from({length:Q.length},je=>[]);for(let je=0;je<Ue.length;++je){const qe=Math.floor(je/Ie.dims[0]*Q.length);Ke&&(Ue[je]=Ue[je].slice(Ke[qe])),Je[qe].push({generated_text:be?[...Q[qe],{role:"assistant",content:Ue[je]}]:Ue[je]})}return!J&&Je.length===1?Je[0]:Je}}class I extends _{constructor(Q){super(Q),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([se,J])=>[se.toLowerCase(),J])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(Q,se,{hypothesis_template:J="This example is {}.",multi_label:be=!1}={}){const xe=Array.isArray(Q);xe||(Q=[Q]),Array.isArray(se)||(se=[se]);const Te=se.map(Ie=>J.replace("{}",Ie)),Ee=be||se.length===1,$e=[];for(const Ie of Q){const Ue=[];for(const je of Te){const qe=this.tokenizer(Ie,{text_pair:je,padding:!0,truncation:!0}),ot=await this.model(qe);Ee?Ue.push([ot.logits.data[this.contradiction_id],ot.logits.data[this.entailment_id]]):Ue.push(ot.logits.data[this.entailment_id])}const Je=(Ee?Ue.map(je=>(0,l.softmax)(je)[1]):(0,l.softmax)(Ue)).map((je,qe)=>[je,qe]).sort((je,qe)=>qe[0]-je[0]);$e.push({sequence:Ie,labels:Je.map(je=>se[je[1]]),scores:Je.map(je=>je[0])})}return xe?$e:$e[0]}}class O extends _{constructor(Q){super(Q)}async _call(Q,{pooling:se="none",normalize:J=!1,quantize:be=!1,precision:xe="binary"}={}){const Te=this.tokenizer(Q,{padding:!0,truncation:!0}),Ee=await this.model(Te);let $e=Ee.last_hidden_state??Ee.logits??Ee.token_embeddings;switch(se){case"none":break;case"mean":$e=(0,u.mean_pooling)($e,Te.attention_mask);break;case"first_token":case"cls":$e=$e.slice(null,0);break;case"last_token":case"eos":$e=$e.slice(null,-1);break;default:throw Error(`Pooling method '${se}' not supported.`)}return J&&($e=$e.normalize(2,-1)),be&&($e=(0,u.quantize_embeddings)($e,xe)),$e}}class V extends _{constructor(Q){super(Q)}async _call(Q,{pool:se=null}={}){const J=await h(Q),{pixel_values:be}=await this.processor(J),xe=await this.model({pixel_values:be});let Te;if(se){if(!("pooler_output"in xe))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");Te=xe.pooler_output}else Te=xe.last_hidden_state??xe.logits??xe.image_embeds;return Te}}class U extends _{constructor(Q){super(Q)}async _call(Q,{top_k:se=5}={}){const J=this.processor.feature_extractor.config.sampling_rate,be=await f(Q,J),xe=this.model.config.id2label,Te=[];for(const Ee of be){const $e=await this.processor(Ee),Ue=(await this.model($e)).logits[0],Ke=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(Ue.data),Ue.dims),se),Je=Ke[0].tolist(),qe=Ke[1].tolist().map((ot,ft)=>({label:xe?xe[ot]:`LABEL_${ot}`,score:Je[ft]}));Te.push(qe)}return Array.isArray(Q)?Te:Te[0]}}class B extends _{constructor(Q){super(Q)}async _call(Q,se,{hypothesis_template:J="This is a sound of {}."}={}){const be=!Array.isArray(Q);be&&(Q=[Q]);const xe=se.map(Ue=>J.replace("{}",Ue)),Te=this.tokenizer(xe,{padding:!0,truncation:!0}),Ee=this.processor.feature_extractor.config.sampling_rate,$e=await f(Q,Ee),Ie=[];for(const Ue of $e){const Ke=await this.processor(Ue),Je=await this.model({...Te,...Ke}),je=(0,l.softmax)(Je.logits_per_audio.data);Ie.push([...je].map((qe,ot)=>({score:qe,label:se[ot]})))}return be?Ie[0]:Ie}}class Y extends _{constructor(Q){super(Q)}async _call(Q,se={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(Q,se);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":return this._call_wav2vec2(Q,se);case"moonshine":return this._call_moonshine(Q,se);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(Q,se){se.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),se.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const J=!Array.isArray(Q);J&&(Q=[Q]);const be=this.processor.feature_extractor.config.sampling_rate,xe=await f(Q,be),Te=[];for(const Ee of xe){const $e=await this.processor(Ee),Ue=(await this.model($e)).logits[0],Ke=[];for(const je of Ue)Ke.push((0,l.max)(je.data)[1]);const Je=this.tokenizer.decode(Ke);Te.push({text:Je})}return J?Te[0]:Te}async _call_whisper(Q,se){const J=se.return_timestamps??!1,be=se.chunk_length_s??0,xe=se.force_full_sequences??!1;let Te=se.stride_length_s??null;const Ee={...se};J==="word"&&(Ee.return_token_timestamps=!0,Ee.return_timestamps=!1);const $e=!Array.isArray(Q);$e&&(Q=[Q]);const Ie=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,Ue=this.processor.feature_extractor.config.hop_length,Ke=this.processor.feature_extractor.config.sampling_rate,Je=await f(Q,Ke),je=[];for(const qe of Je){let ot=[];if(be>0){if(Te===null)Te=be/6;else if(be<=Te)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const We=Ke*be,Be=Ke*Te,De=We-2*Be;let yt=0;for(;;){const Mt=yt+We,Lt=qe.subarray(yt,Mt),dr=await this.processor(Lt),pr=yt===0,at=Mt>=qe.length;if(ot.push({stride:[Lt.length,pr?0:Be,at?0:Be],input_features:dr.input_features,is_last:at}),at)break;yt+=De}}else ot=[{stride:[qe.length,0,0],input_features:(await this.processor(qe)).input_features,is_last:!0}];for(const We of ot){Ee.num_frames=Math.floor(We.stride[0]/Ue);const Be=await this.model.generate({inputs:We.input_features,...Ee});J==="word"?(We.tokens=Be.sequences.tolist()[0],We.token_timestamps=Be.token_timestamps.tolist()[0].map(De=>(0,l.round)(De,2))):We.tokens=Be[0].tolist(),We.stride=We.stride.map(De=>De/Ke)}const[ft,it]=this.tokenizer._decode_asr(ot,{time_precision:Ie,return_timestamps:J,force_full_sequences:xe});je.push({text:ft,...it})}return $e?je[0]:je}async _call_moonshine(Q,se){const J=!Array.isArray(Q);J&&(Q=[Q]);const be=this.processor.feature_extractor.config.sampling_rate,xe=await f(Q,be),Te=[];for(const Ee of xe){const $e=await this.processor(Ee),Ie=Math.floor(Ee.length/be)*6,Ue=await this.model.generate({max_new_tokens:Ie,...se,...$e}),Ke=this.processor.batch_decode(Ue,{skip_special_tokens:!0})[0];Te.push({text:Ke})}return J?Te[0]:Te}}class K extends _{constructor(Q){super(Q)}async _call(Q,se={}){const J=Array.isArray(Q),be=await h(Q),{pixel_values:xe}=await this.processor(be),Te=[];for(const Ee of xe){Ee.dims=[1,...Ee.dims];const $e=await this.model.generate({inputs:Ee,...se}),Ie=this.tokenizer.batch_decode($e,{skip_special_tokens:!0}).map(Ue=>({generated_text:Ue.trim()}));Te.push(Ie)}return J?Te:Te[0]}}class X extends _{constructor(Q){super(Q)}async _call(Q,{top_k:se=5}={}){const J=await h(Q),{pixel_values:be}=await this.processor(J),xe=await this.model({pixel_values:be}),Te=this.model.config.id2label,Ee=[];for(const $e of xe.logits){const Ie=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)($e.data),$e.dims),se),Ue=Ie[0].tolist(),Je=Ie[1].tolist().map((je,qe)=>({label:Te?Te[je]:`LABEL_${je}`,score:Ue[qe]}));Ee.push(Je)}return Array.isArray(Q)?Ee:Ee[0]}}class G extends _{constructor(Q){super(Q),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(Q,{threshold:se=.5,mask_threshold:J=.5,overlap_mask_area_threshold:be=.8,label_ids_to_fuse:xe=null,target_sizes:Te=null,subtask:Ee=null}={}){if(Array.isArray(Q)&&Q.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const Ie=await h(Q),Ue=Ie.map(We=>[We.height,We.width]),Ke=await this.processor(Ie),{inputNames:Je,outputNames:je}=this.model.sessions.model;if(!Je.includes("pixel_values")){if(Je.length!==1)throw Error(`Expected a single input name, but got ${Je.length} inputs: ${Je}.`);const We=Je[0];if(We in Ke)throw Error(`Input name ${We} already exists in the inputs.`);Ke[We]=Ke.pixel_values}const qe=await this.model(Ke);let ot=null;if(Ee!==null)ot=this.subtasks_mapping[Ee];else if(this.processor.image_processor){for(const[We,Be]of Object.entries(this.subtasks_mapping))if(Be in this.processor.image_processor){ot=this.processor.image_processor[Be].bind(this.processor.image_processor),Ee=We;break}}const ft=this.model.config.id2label,it=[];if(Ee)if(Ee==="panoptic"||Ee==="instance"){const We=ot(qe,se,J,be,xe,Te??Ue)[0],Be=We.segmentation;for(const De of We.segments_info){const yt=new Uint8ClampedArray(Be.data.length);for(let Lt=0;Lt<Be.data.length;++Lt)Be.data[Lt]===De.id&&(yt[Lt]=255);const Mt=new d.RawImage(yt,Be.dims[1],Be.dims[0],1);it.push({score:De.score,label:ft[De.label_id],mask:Mt})}}else if(Ee==="semantic"){const{segmentation:We,labels:Be}=ot(qe,Te??Ue)[0];for(const De of Be){const yt=new Uint8ClampedArray(We.data.length);for(let Lt=0;Lt<We.data.length;++Lt)We.data[Lt]===De&&(yt[Lt]=255);const Mt=new d.RawImage(yt,We.dims[1],We.dims[0],1);it.push({score:null,label:ft[De],mask:Mt})}}else throw Error(`Subtask ${Ee} not supported.`);else{const Be=qe[je[0]];for(let De=0;De<Ue.length;++De){const yt=Ue[De],Mt=Be[De];Mt.data.some(dr=>dr<-1e-5||dr>1+1e-5)&&Mt.sigmoid_();const Lt=await d.RawImage.fromTensor(Mt.mul_(255).to("uint8")).resize(yt[1],yt[0]);it.push({label:null,score:null,mask:Lt})}}return it}}class R extends G{constructor(Q){super(Q)}async _call(Q,se={}){if(Array.isArray(Q)&&Q.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const be=await h(Q),xe=await super._call(Q,se);return be.map((Ee,$e)=>{const Ie=Ee.clone();return Ie.putAlpha(xe[$e].mask),Ie})}}class te extends _{constructor(Q){super(Q)}async _call(Q,se,{hypothesis_template:J="This is a photo of {}"}={}){const be=Array.isArray(Q),xe=await h(Q),Te=se.map(Je=>J.replace("{}",Je)),Ee=this.tokenizer(Te,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:$e}=await this.processor(xe),Ie=await this.model({...Ee,pixel_values:$e}),Ue=this.model.config.model_type==="siglip"?Je=>Je.sigmoid().data:Je=>(0,l.softmax)(Je.data),Ke=[];for(const Je of Ie.logits_per_image){const qe=[...Ue(Je)].map((ot,ft)=>({score:ot,label:se[ft]}));qe.sort((ot,ft)=>ft.score-ot.score),Ke.push(qe)}return be?Ke:Ke[0]}}class re extends _{constructor(Q){super(Q)}async _call(Q,{threshold:se=.9,percentage:J=!1}={}){const be=Array.isArray(Q);if(be&&Q.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const xe=await h(Q),Te=J?null:xe.map(je=>[je.height,je.width]),{pixel_values:Ee,pixel_mask:$e}=await this.processor(xe),Ie=await this.model({pixel_values:Ee,pixel_mask:$e}),Ue=this.processor.image_processor.post_process_object_detection(Ie,se,Te),Ke=this.model.config.id2label,Je=Ue.map(je=>je.boxes.map((qe,ot)=>({score:je.scores[ot],label:Ke[je.classes[ot]],box:p(qe,!J)})));return be?Je:Je[0]}}class L extends _{constructor(Q){super(Q)}async _call(Q,se,{threshold:J=.1,top_k:be=null,percentage:xe=!1}={}){const Te=Array.isArray(Q),Ee=await h(Q),$e=this.tokenizer(se,{padding:!0,truncation:!0}),Ie=await this.processor(Ee),Ue=[];for(let Ke=0;Ke<Ee.length;++Ke){const Je=Ee[Ke],je=xe?null:[[Je.height,Je.width]],qe=Ie.pixel_values[Ke].unsqueeze_(0),ot=await this.model({...$e,pixel_values:qe});let ft;if("post_process_grounded_object_detection"in this.processor){const it=this.processor.post_process_grounded_object_detection(ot,$e.input_ids,{box_threshold:J,text_threshold:J,target_sizes:je})[0];ft=it.boxes.map((We,Be)=>({score:it.scores[Be],label:it.labels[Be],box:p(We,!xe)}))}else{const it=this.processor.image_processor.post_process_object_detection(ot,J,je,!0)[0];ft=it.boxes.map((We,Be)=>({score:it.scores[Be],label:se[it.classes[Be]],box:p(We,!xe)}))}ft.sort((it,We)=>We.score-it.score),be!==null&&(ft=ft.slice(0,be)),Ue.push(ft)}return Te?Ue:Ue[0]}}class j extends _{constructor(Q){super(Q)}async _call(Q,se,J={}){const be=(await h(Q))[0],{pixel_values:xe}=await this.processor(be),Te=`<s_docvqa><s_question>${se}</s_question><s_answer>`,Ee=this.tokenizer(Te,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,$e=await this.model.generate({inputs:xe,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:Ee,...J}),Ue=this.tokenizer.batch_decode($e)[0].match(/<s_answer>(.*?)<\/s_answer>/);let Ke=null;return Ue&&Ue.length>=2&&(Ke=Ue[1].trim()),[{answer:Ke}]}}class q extends _{constructor(se){super(se);oe(this,"DEFAULT_VOCODER_ID","Xenova/speecht5_hifigan");this.vocoder=se.vocoder??null}async _call(se,{speaker_embeddings:J=null}={}){return this.processor?this._call_text_to_spectrogram(se,{speaker_embeddings:J}):this._call_text_to_waveform(se)}async _call_text_to_waveform(se){const J=this.tokenizer(se,{padding:!0,truncation:!0}),{waveform:be}=await this.model(J),xe=this.model.config.sampling_rate;return new c.RawAudio(be.data,xe)}async _call_text_to_spectrogram(se,{speaker_embeddings:J}){if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await s.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"})),(typeof J=="string"||J instanceof URL)&&(J=new Float32Array(await(await fetch(J)).arrayBuffer())),J instanceof Float32Array)J=new u.Tensor("float32",J,[1,J.length]);else if(!(J instanceof u.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:be}=this.tokenizer(se,{padding:!0,truncation:!0}),{waveform:xe}=await this.model.generate_speech(be,J,{vocoder:this.vocoder}),Te=this.processor.feature_extractor.config.sampling_rate;return new c.RawAudio(xe.data,Te)}}class ne extends _{constructor(Q){super(Q)}async _call(Q){const se=await h(Q),J=await this.processor(se),be=await this.model(J),xe=[];for(const Te of be.reconstruction){const Ee=Te.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");xe.push(d.RawImage.fromTensor(Ee))}return xe.length>1?xe:xe[0]}}class me extends _{constructor(Q){super(Q)}async _call(Q){const se=await h(Q),J=await this.processor(se),{predicted_depth:be}=await this.model(J),xe=[];for(let Te=0;Te<se.length;++Te){const Ee=be[Te],[$e,Ie]=Ee.dims.slice(-2),[Ue,Ke]=se[Te].size,Je=(await(0,u.interpolate_4d)(Ee.view(1,1,$e,Ie),{size:[Ke,Ue],mode:"bilinear"})).view(Ke,Ue),je=Je.min().item(),qe=Je.max().item(),ot=Je.sub(je).div_(qe-je).mul_(255).to("uint8").unsqueeze(0),ft=d.RawImage.fromTensor(ot);xe.push({predicted_depth:Je,depth:ft})}return xe.length>1?xe:xe[0]}}const ae=Object.freeze({"text-classification":{tokenizer:n.AutoTokenizer,pipeline:w,model:s.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:n.AutoTokenizer,pipeline:y,model:s.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:n.AutoTokenizer,pipeline:g,model:s.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:n.AutoTokenizer,pipeline:v,model:s.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:n.AutoTokenizer,pipeline:x,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:n.AutoTokenizer,pipeline:M,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:n.AutoTokenizer,pipeline:b,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:n.AutoTokenizer,pipeline:P,model:s.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:n.AutoTokenizer,pipeline:I,model:s.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:U,model:s.AutoModelForAudioClassification,processor:i.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:n.AutoTokenizer,pipeline:B,model:s.AutoModel,processor:i.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:n.AutoTokenizer,pipeline:Y,model:[s.AutoModelForSpeechSeq2Seq,s.AutoModelForCTC],processor:i.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:n.AutoTokenizer,pipeline:q,model:[s.AutoModelForTextToWaveform,s.AutoModelForTextToSpectrogram],processor:[i.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:n.AutoTokenizer,pipeline:K,model:s.AutoModelForVision2Seq,processor:i.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:X,model:s.AutoModelForImageClassification,processor:i.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:G,model:[s.AutoModelForImageSegmentation,s.AutoModelForSemanticSegmentation,s.AutoModelForUniversalSegmentation],processor:i.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:R,model:[s.AutoModelForImageSegmentation,s.AutoModelForSemanticSegmentation,s.AutoModelForUniversalSegmentation],processor:i.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:n.AutoTokenizer,pipeline:te,model:s.AutoModel,processor:i.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:re,model:s.AutoModelForObjectDetection,processor:i.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:n.AutoTokenizer,pipeline:L,model:s.AutoModelForZeroShotObjectDetection,processor:i.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:n.AutoTokenizer,pipeline:j,model:s.AutoModelForDocumentQuestionAnswering,processor:i.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:ne,model:s.AutoModelForImageToImage,processor:i.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:me,model:s.AutoModelForDepthEstimation,processor:i.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:n.AutoTokenizer,pipeline:O,model:s.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:i.AutoProcessor,pipeline:V,model:[s.AutoModelForImageFeatureExtraction,s.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),fe=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function Pe(de,Q=null,{progress_callback:se=null,config:J=null,cache_dir:be=null,local_files_only:xe=!1,revision:Te="main",device:Ee=null,dtype:$e=null,subfolder:Ie="onnx",use_external_data_format:Ue=null,model_file_name:Ke=null,session_options:Je={}}={}){de=fe[de]??de;const je=ae[de.split("_",1)[0]];if(!je)throw Error(`Unsupported pipeline: ${de}. Must be one of [${Object.keys(ae)}]`);Q||(Q=je.default.model,console.log(`No model specified. Using default model: "${Q}".`));const qe={progress_callback:se,config:J,cache_dir:be,local_files_only:xe,revision:Te,device:Ee,dtype:$e,subfolder:Ie,use_external_data_format:Ue,model_file_name:Ke,session_options:Je},ot=new Map([["tokenizer",je.tokenizer],["model",je.model],["processor",je.processor]]),ft=await Ne(ot,Q,qe);ft.task=de,(0,a.dispatchCallback)(se,{status:"ready",task:de,model:Q});const it=je.pipeline;return new it(ft)}async function Ne(de,Q,se){const J=Object.create(null),be=[];for(const[xe,Te]of de.entries()){if(!Te)continue;let Ee;Array.isArray(Te)?Ee=new Promise(async($e,Ie)=>{var Ke,Je;let Ue;for(const je of Te){if(je===null){$e(null);return}try{$e(await je.from_pretrained(Q,se));return}catch(qe){if((Ke=qe.message)!=null&&Ke.includes("Unsupported model type"))Ue=qe;else if((Je=qe.message)!=null&&Je.includes("Could not locate file"))Ue=qe;else{Ie(qe);return}}}Ie(Ue)}):Ee=Te.from_pretrained(Q,se),J[xe]=Ee,be.push(Ee)}await Promise.all(be);for(const[xe,Te]of Object.entries(J))J[xe]=await Te;return J}},"./src/tokenizers.js":(e,t,r)=>{r.r(t),r.d(t,{AlbertTokenizer:()=>er,AutoTokenizer:()=>ho,BartTokenizer:()=>oo,BertTokenizer:()=>jt,BlenderbotSmallTokenizer:()=>yl,BlenderbotTokenizer:()=>_l,BloomTokenizer:()=>lo,CLIPTokenizer:()=>Mi,CamembertTokenizer:()=>Xs,CodeGenTokenizer:()=>ri,CodeLlamaTokenizer:()=>xn,CohereTokenizer:()=>wl,ConvBertTokenizer:()=>fn,DebertaTokenizer:()=>ut,DebertaV2Tokenizer:()=>sr,DistilBertTokenizer:()=>Ln,ElectraTokenizer:()=>Js,EsmTokenizer:()=>pt,FalconTokenizer:()=>Fe,GPT2Tokenizer:()=>ss,GPTNeoXTokenizer:()=>nt,GemmaTokenizer:()=>Zs,Grok1Tokenizer:()=>ei,HerbertTokenizer:()=>wr,LlamaTokenizer:()=>co,M2M100Tokenizer:()=>en,MBart50Tokenizer:()=>bi,MBartTokenizer:()=>ks,MPNetTokenizer:()=>qn,MarianTokenizer:()=>ml,MgpstrTokenizer:()=>bl,MobileBertTokenizer:()=>bt,NllbTokenizer:()=>ti,NougatTokenizer:()=>oa,PreTrainedTokenizer:()=>Se,Qwen2Tokenizer:()=>ir,RoFormerTokenizer:()=>Er,RobertaTokenizer:()=>ao,SiglipTokenizer:()=>pl,SpeechT5Tokenizer:()=>uo,SqueezeBertTokenizer:()=>mt,T5Tokenizer:()=>io,TokenizerModel:()=>V,VitsTokenizer:()=>vl,Wav2Vec2CTCTokenizer:()=>gl,WhisperTokenizer:()=>an,XLMRobertaTokenizer:()=>xi,XLMTokenizer:()=>wi,is_chinese_char:()=>v});var n=r("./src/utils/generic.js"),s=r("./src/utils/core.js"),i=r("./src/utils/hub.js"),o=r("./src/utils/maths.js"),a=r("./src/utils/tensor.js"),l=r("./src/utils/data-structures.js"),c=r("./node_modules/@huggingface/jinja/dist/index.js"),u=r("./src/models/whisper/common_whisper.js");async function d(_e,D){const Z=await Promise.all([(0,i.getModelJSON)(_e,"tokenizer.json",!0,D),(0,i.getModelJSON)(_e,"tokenizer_config.json",!0,D)]);return D.legacy!==null&&(Z[1].legacy=D.legacy),Z}function h(_e,D){const Z=[];let ie=0;for(const he of _e.matchAll(D)){const ge=he[0];ie<he.index&&Z.push(_e.slice(ie,he.index)),ge.length>0&&Z.push(ge),ie=he.index+ge.length}return ie<_e.length&&Z.push(_e.slice(ie)),Z}function f(_e,D=!0){if(_e.Regex!==void 0){let Z=_e.Regex.replace(/\\([#&~])/g,"$1");for(const[ie,he]of I)Z=Z.replaceAll(ie,he);return new RegExp(Z,"gu")}else if(_e.String!==void 0){const Z=(0,s.escapeRegExp)(_e.String);return new RegExp(D?Z:`(${Z})`,"gu")}else return console.warn("Unknown pattern type:",_e),null}function p(_e){return new Map(Object.entries(_e))}function _(_e){const D=_e.dims;switch(D.length){case 1:return _e.tolist();case 2:if(D[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return _e.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${D.length}.`)}}function w(_e){return _e.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function y(_e){return _e.replace(new RegExp("\\p{M}","gu"),"")}function g(_e){return y(_e.toLowerCase())}function v(_e){return _e>=19968&&_e<=40959||_e>=13312&&_e<=19903||_e>=131072&&_e<=173791||_e>=173824&&_e<=177983||_e>=177984&&_e<=178207||_e>=178208&&_e<=183983||_e>=63744&&_e<=64255||_e>=194560&&_e<=195103}function b(_e,D,Z){const ie=[];let he=0;for(;he<_e.length;){if(ie.push(_e[he]),(D.get(_e[he])??Z)!==Z){++he;continue}for(;++he<_e.length&&(D.get(_e[he])??Z)===Z;)D.get(ie.at(-1))!==Z&&(ie[ie.length-1]+=_e[he])}return ie}function x(_e){return _e.match(/\S+/g)||[]}const M="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",E=new RegExp(`^[${M}]+$`,"gu"),P=".,!?",I=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],[` ?[^(\\s|[${P}])]+`,` ?[^\\s${P}]+`]]);class O{constructor(D){this.content=D.content,this.id=D.id,this.single_word=D.single_word??!1,this.lstrip=D.lstrip??!1,this.rstrip=D.rstrip??!1,this.special=D.special??!1,this.normalized=D.normalized??null}}class V extends n.Callable{constructor(D){super(),this.config=D,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(D,...Z){switch(D.type){case"WordPiece":return new U(D);case"Unigram":return new B(D,...Z);case"BPE":return new X(D);default:if(D.vocab)return Array.isArray(D.vocab)?new B(D,...Z):Object.hasOwn(D,"continuing_subword_prefix")&&Object.hasOwn(D,"unk_token")?Object.hasOwn(D,"merges")?new X(D):new U(D):new G(D,...Z);throw new Error(`Unknown TokenizerModel type: ${D.type}`)}}_call(D){return D=this.encode(D),this.fuse_unk&&(D=b(D,this.tokens_to_ids,this.unk_token_id)),D}encode(D){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(D){return D.map(Z=>this.tokens_to_ids.get(Z)??this.unk_token_id)}convert_ids_to_tokens(D){return D.map(Z=>this.vocab[Z]??this.unk_token)}}class U extends V{constructor(D){super(D),this.tokens_to_ids=p(D.vocab),this.unk_token_id=this.tokens_to_ids.get(D.unk_token),this.unk_token=D.unk_token,this.max_input_chars_per_word=D.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[Z,ie]of this.tokens_to_ids)this.vocab[ie]=Z}encode(D){const Z=[];for(const ie of D){const he=[...ie];if(he.length>this.max_input_chars_per_word){Z.push(this.unk_token);continue}let ge=!1,Ce=0;const Ge=[];for(;Ce<he.length;){let tt=he.length,Xe=null;for(;Ce<tt;){let st=he.slice(Ce,tt).join("");if(Ce>0&&(st=this.config.continuing_subword_prefix+st),this.tokens_to_ids.has(st)){Xe=st;break}--tt}if(Xe===null){ge=!0;break}Ge.push(Xe),Ce=tt}ge?Z.push(this.unk_token):Z.push(...Ge)}return Z}}class B extends V{constructor(D,Z){super(D);const ie=D.vocab.length;this.vocab=new Array(ie),this.scores=new Array(ie);for(let he=0;he<ie;++he)[this.vocab[he],this.scores[he]]=D.vocab[he];this.unk_token_id=D.unk_id,this.unk_token=this.vocab[D.unk_id],this.tokens_to_ids=new Map(this.vocab.map((he,ge)=>[he,ge])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=Z.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,o.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new l.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(D){const Z=D.chars,ie=1;let he=0;for(;he<Z.length;){let ge=!1;const Ce=Z.slice(he).join(""),Ge=this.trie.commonPrefixSearch(Ce);for(const tt of Ge){const Xe=this.tokens_to_ids.get(tt),st=this.scores[Xe],St=(0,s.len)(tt);D.insert(he,St,st,Xe),!ge&&St===ie&&(ge=!0)}ge||D.insert(he,ie,this.unk_score,this.unk_token_id),he+=ie}}tokenize(D){const Z=new l.TokenLattice(D,this.bos_token_id,this.eos_token_id);return this.populateNodes(Z),Z.tokens()}encode(D){const Z=[];for(const ie of D){const he=this.tokenize(ie);Z.push(...he)}return Z}}const Y=(()=>{const _e=[...Array.from({length:94},(he,ge)=>ge+33),...Array.from({length:12},(he,ge)=>ge+161),...Array.from({length:82},(he,ge)=>ge+174)],D=_e.slice();let Z=0;for(let he=0;he<256;++he)_e.includes(he)||(_e.push(he),D.push(256+Z),Z+=1);const ie=D.map(he=>String.fromCharCode(he));return Object.fromEntries(_e.map((he,ge)=>[he,ie[ge]]))})(),K=(0,s.reverseDictionary)(Y);class X extends V{constructor(D){super(D),this.tokens_to_ids=p(D.vocab),this.unk_token_id=this.tokens_to_ids.get(D.unk_token),this.unk_token=D.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[ie,he]of this.tokens_to_ids)this.vocab[he]=ie;const Z=Array.isArray(D.merges[0]);this.merges=Z?D.merges:D.merges.map(ie=>ie.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((ie,he)=>[JSON.stringify(ie),he])),this.end_of_word_suffix=D.end_of_word_suffix,this.continuing_subword_suffix=D.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new l.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(D){if(D.length===0)return[];const Z=this.cache.get(D);if(Z!==void 0)return Z;const ie=Array.from(D);this.end_of_word_suffix&&(ie[ie.length-1]+=this.end_of_word_suffix);let he=[];if(ie.length>1){const ge=new l.PriorityQueue((tt,Xe)=>tt.score<Xe.score);let Ce={token:ie[0],bias:0,prev:null,next:null},Ge=Ce;for(let tt=1;tt<ie.length;++tt){const Xe={bias:tt/ie.length,token:ie[tt],prev:Ge,next:null};Ge.next=Xe,this._add_node(ge,Ge),Ge=Xe}for(;!ge.isEmpty();){const tt=ge.pop();if(tt.deleted||!tt.next||tt.next.deleted)continue;if(tt.deleted=!0,tt.next.deleted=!0,tt.prev){const st={...tt.prev};tt.prev.deleted=!0,tt.prev=st,st.prev?st.prev.next=st:Ce=st}const Xe={token:tt.token+tt.next.token,bias:tt.bias,prev:tt.prev,next:tt.next.next};Xe.prev?(Xe.prev.next=Xe,this._add_node(ge,Xe.prev)):Ce=Xe,Xe.next&&(Xe.next.prev=Xe,this._add_node(ge,Xe))}for(let tt=Ce;tt!==null;tt=tt.next)he.push(tt.token)}else he=ie;if(this.continuing_subword_suffix)for(let ge=0;ge<he.length-1;++ge)he[ge]+=this.continuing_subword_suffix;return D.length<this.max_length_to_cache&&this.cache.put(D,he),he}_add_node(D,Z){const ie=this.bpe_ranks.get(JSON.stringify([Z.token,Z.next.token]));ie!==void 0&&(Z.score=ie+Z.bias,D.push(Z))}encode(D){const Z=[];for(const ie of D){if(this.ignore_merges&&this.tokens_to_ids.has(ie)){Z.push(ie);continue}const he=this.bpe(ie);for(const ge of he)if(this.tokens_to_ids.has(ge))Z.push(ge);else if(this.byte_fallback){const Ce=Array.from(this.text_encoder.encode(ge)).map(Ge=>`<0x${Ge.toString(16).toUpperCase().padStart(2,"0")}>`);Ce.every(Ge=>this.tokens_to_ids.has(Ge))?Z.push(...Ce):Z.push(this.unk_token)}else Z.push(this.unk_token)}return Z}}class G extends V{constructor(D,Z){super(D),this.tokens_to_ids=p(Z.target_lang?D.vocab[Z.target_lang]:D.vocab),this.bos_token=Z.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=Z.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=Z.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=Z.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[ie,he]of this.tokens_to_ids)this.vocab[he]=ie}encode(D){return D}}class R extends n.Callable{constructor(D){super(),this.config=D}static fromConfig(D){if(D===null)return null;switch(D.type){case"BertNormalizer":return new de(D);case"Precompiled":return new at(D);case"Sequence":return new Ne(D);case"Replace":return new te(D);case"NFC":return new L(D);case"NFD":return new j(D);case"NFKC":return new q(D);case"NFKD":return new ne(D);case"Strip":return new me(D);case"StripAccents":return new ae(D);case"Lowercase":return new fe(D);case"Prepend":return new Pe(D);default:throw new Error(`Unknown Normalizer type: ${D.type}`)}}normalize(D){throw Error("normalize should be implemented in subclass.")}_call(D){return this.normalize(D)}}class te extends R{normalize(D){const Z=f(this.config.pattern);return Z===null?D:D.replaceAll(Z,this.config.content)}}class re extends R{constructor(){super(...arguments);oe(this,"form")}normalize(Z){return Z=Z.normalize(this.form),Z}}class L extends re{constructor(){super(...arguments);oe(this,"form","NFC")}}class j extends re{constructor(){super(...arguments);oe(this,"form","NFD")}}class q extends re{constructor(){super(...arguments);oe(this,"form","NFKC")}}class ne extends re{constructor(){super(...arguments);oe(this,"form","NFKD")}}class me extends R{normalize(D){return this.config.strip_left&&this.config.strip_right?D=D.trim():(this.config.strip_left&&(D=D.trimStart()),this.config.strip_right&&(D=D.trimEnd())),D}}class ae extends R{normalize(D){return D=y(D),D}}class fe extends R{normalize(D){return D=D.toLowerCase(),D}}class Pe extends R{normalize(D){return D=this.config.prepend+D,D}}class Ne extends R{constructor(D){super(D),this.normalizers=D.normalizers.map(Z=>R.fromConfig(Z))}normalize(D){return this.normalizers.reduce((Z,ie)=>ie.normalize(Z),D)}}class de extends R{_tokenize_chinese_chars(D){const Z=[];for(let ie=0;ie<D.length;++ie){const he=D[ie],ge=he.charCodeAt(0);v(ge)?(Z.push(" "),Z.push(he),Z.push(" ")):Z.push(he)}return Z.join("")}stripAccents(D){return D.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(D){switch(D){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(D)}}_clean_text(D){const Z=[];for(const ie of D){const he=ie.charCodeAt(0);he===0||he===65533||this._is_control(ie)||(/^\s$/.test(ie)?Z.push(" "):Z.push(ie))}return Z.join("")}normalize(D){return this.config.clean_text&&(D=this._clean_text(D)),this.config.handle_chinese_chars&&(D=this._tokenize_chinese_chars(D)),this.config.lowercase?(D=D.toLowerCase(),this.config.strip_accents!==!1&&(D=this.stripAccents(D))):this.config.strip_accents&&(D=this.stripAccents(D)),D}}class Q extends n.Callable{static fromConfig(D){if(D===null)return null;switch(D.type){case"BertPreTokenizer":return new se(D);case"Sequence":return new Kn(D);case"Whitespace":return new F(D);case"WhitespaceSplit":return new ce(D);case"Metaspace":return new dr(D);case"ByteLevel":return new J(D);case"Split":return new be(D);case"Punctuation":return new xe(D);case"Digits":return new Te(D);case"Replace":return new W(D);default:throw new Error(`Unknown PreTokenizer type: ${D.type}`)}}pre_tokenize_text(D,Z){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(D,Z){return(Array.isArray(D)?D.map(ie=>this.pre_tokenize_text(ie,Z)):this.pre_tokenize_text(D,Z)).flat()}_call(D,Z){return this.pre_tokenize(D,Z)}}class se extends Q{constructor(D){super(),this.pattern=new RegExp(`[^\\s${M}]+|[${M}]`,"gu")}pre_tokenize_text(D,Z){return D.trim().match(this.pattern)||[]}}class J extends Q{constructor(D){super(),this.config=D,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=Y,this.text_encoder=new TextEncoder}pre_tokenize_text(D,Z){return this.add_prefix_space&&!D.startsWith(" ")&&(D=" "+D),(this.use_regex?D.match(this.pattern)||[]:[D]).map(he=>Array.from(this.text_encoder.encode(he),ge=>this.byte_encoder[ge]).join(""))}}class be extends Q{constructor(D){super(),this.config=D,this.pattern=f(this.config.pattern,this.config.invert)}pre_tokenize_text(D,Z){var ie;return this.pattern===null?[]:this.config.invert?D.match(this.pattern)||[]:((ie=this.config.behavior)==null?void 0:ie.toLowerCase())==="removed"?D.split(this.pattern).filter(he=>he):h(D,this.pattern)}}class xe extends Q{constructor(D){super(),this.config=D,this.pattern=new RegExp(`[^${M}]+|[${M}]+`,"gu")}pre_tokenize_text(D,Z){return D.match(this.pattern)||[]}}class Te extends Q{constructor(D){super(),this.config=D;const Z=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(Z,"gu")}pre_tokenize_text(D,Z){return D.match(this.pattern)||[]}}class Ee extends n.Callable{constructor(D){super(),this.config=D}static fromConfig(D){if(D===null)return null;switch(D.type){case"TemplateProcessing":return new Ue(D);case"ByteLevel":return new Ke(D);case"RobertaProcessing":return new Ie(D);case"BertProcessing":return new $e(D);case"Sequence":return new Je(D);default:throw new Error(`Unknown PostProcessor type: ${D.type}`)}}post_process(D,...Z){throw Error("post_process should be implemented in subclass.")}_call(D,...Z){return this.post_process(D,...Z)}}class $e extends Ee{constructor(D){super(D),this.cls=D.cls[0],this.sep=D.sep[0]}post_process(D,Z=null,{add_special_tokens:ie=!0}={}){ie&&(D=(0,s.mergeArrays)([this.cls],D,[this.sep]));let he=new Array(D.length).fill(0);if(Z!==null){const ge=ie&&this instanceof Ie?[this.sep]:[],Ce=ie?[this.sep]:[];D=(0,s.mergeArrays)(D,ge,Z,Ce),he=(0,s.mergeArrays)(he,new Array(Z.length+ge.length+Ce.length).fill(1))}return{tokens:D,token_type_ids:he}}}class Ie extends $e{}class Ue extends Ee{constructor(D){super(D),this.single=D.single,this.pair=D.pair}post_process(D,Z=null,{add_special_tokens:ie=!0}={}){const he=Z===null?this.single:this.pair;let ge=[],Ce=[];for(const Ge of he)"SpecialToken"in Ge?ie&&(ge.push(Ge.SpecialToken.id),Ce.push(Ge.SpecialToken.type_id)):"Sequence"in Ge&&(Ge.Sequence.id==="A"?(ge=(0,s.mergeArrays)(ge,D),Ce=(0,s.mergeArrays)(Ce,new Array(D.length).fill(Ge.Sequence.type_id))):Ge.Sequence.id==="B"&&(ge=(0,s.mergeArrays)(ge,Z),Ce=(0,s.mergeArrays)(Ce,new Array(Z.length).fill(Ge.Sequence.type_id))));return{tokens:ge,token_type_ids:Ce}}}class Ke extends Ee{post_process(D,Z=null){return Z&&(D=(0,s.mergeArrays)(D,Z)),{tokens:D}}}class Je extends Ee{constructor(D){super(D),this.processors=D.processors.map(Z=>Ee.fromConfig(Z))}post_process(D,Z=null,ie={}){let he;for(const ge of this.processors)if(ge instanceof Ke)D=ge.post_process(D).tokens,Z&&(Z=ge.post_process(Z).tokens);else{const Ce=ge.post_process(D,Z,ie);D=Ce.tokens,he=Ce.token_type_ids}return{tokens:D,token_type_ids:he}}}class je extends n.Callable{constructor(D){super(),this.config=D,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=D.trim_offsets}static fromConfig(D){if(D===null)return null;switch(D.type){case"WordPiece":return new We(D);case"Metaspace":return new pr(D);case"ByteLevel":return new Be(D);case"Replace":return new qe(D);case"ByteFallback":return new ot(D);case"Fuse":return new ft(D);case"Strip":return new it(D);case"Sequence":return new yt(D);case"CTC":return new De(D);case"BPEDecoder":return new Mt(D);default:throw new Error(`Unknown Decoder type: ${D.type}`)}}_call(D){return this.decode(D)}decode(D){return this.decode_chain(D).join("")}decode_chain(D){throw Error("`decode_chain` should be implemented in subclass.")}}class qe extends je{decode_chain(D){const Z=f(this.config.pattern);return Z===null?D:D.map(ie=>ie.replaceAll(Z,this.config.content))}}class ot extends je{constructor(D){super(D),this.text_decoder=new TextDecoder}decode_chain(D){const Z=[];let ie=[];for(const he of D){let ge=null;if(he.length===6&&he.startsWith("<0x")&&he.endsWith(">")){const Ce=parseInt(he.slice(3,5),16);isNaN(Ce)||(ge=Ce)}if(ge!==null)ie.push(ge);else{if(ie.length>0){const Ce=this.text_decoder.decode(Uint8Array.from(ie));Z.push(Ce),ie=[]}Z.push(he)}}if(ie.length>0){const he=this.text_decoder.decode(Uint8Array.from(ie));Z.push(he),ie=[]}return Z}}class ft extends je{decode_chain(D){return[D.join("")]}}class it extends je{constructor(D){super(D),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(D){return D.map(Z=>{let ie=0;for(let ge=0;ge<this.start&&Z[ge]===this.content;++ge){ie=ge+1;continue}let he=Z.length;for(let ge=0;ge<this.stop;++ge){const Ce=Z.length-ge-1;if(Z[Ce]===this.content){he=Ce;continue}else break}return Z.slice(ie,he)})}}class We extends je{constructor(D){super(D),this.cleanup=D.cleanup}decode_chain(D){return D.map((Z,ie)=>(ie!==0&&(Z.startsWith(this.config.prefix)?Z=Z.replace(this.config.prefix,""):Z=" "+Z),this.cleanup&&(Z=w(Z)),Z))}}class Be extends je{constructor(D){super(D),this.byte_decoder=K,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(D){const Z=D.join(""),ie=new Uint8Array([...Z].map(ge=>this.byte_decoder[ge]));return this.text_decoder.decode(ie)}decode_chain(D){const Z=[];let ie=[];for(const he of D)this.added_tokens.find(ge=>ge.content===he)!==void 0?(ie.length>0&&(Z.push(this.convert_tokens_to_string(ie)),ie=[]),Z.push(he)):ie.push(he);return ie.length>0&&Z.push(this.convert_tokens_to_string(ie)),Z}}class De extends je{constructor(D){super(D),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(D){if(D.length===0)return"";const Z=[D[0]];for(let ge=1;ge<D.length;++ge)D[ge]!==Z.at(-1)&&Z.push(D[ge]);let he=Z.filter(ge=>ge!==this.pad_token).join("");return this.cleanup&&(he=w(he).replaceAll(this.word_delimiter_token," ").trim()),he}decode_chain(D){return[this.convert_tokens_to_string(D)]}}class yt extends je{constructor(D){super(D),this.decoders=D.decoders.map(Z=>je.fromConfig(Z))}decode_chain(D){return this.decoders.reduce((Z,ie)=>ie.decode_chain(Z),D)}}class Mt extends je{constructor(D){super(D),this.suffix=this.config.suffix}decode_chain(D){return D.map((Z,ie)=>Z.replaceAll(this.suffix,ie===D.length-1?"":" "))}}class Lt extends je{decode_chain(D){let Z="";for(let ie=1;ie<D.length;ie+=2)Z+=D[ie];return[Z]}}class dr extends Q{constructor(D){super(),this.addPrefixSpace=D.add_prefix_space,this.replacement=D.replacement,this.strRep=D.str_rep||this.replacement,this.prepend_scheme=D.prepend_scheme??"always"}pre_tokenize_text(D,{section_index:Z=void 0}={}){let ie=D.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!ie.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&Z===0)&&(ie=this.strRep+ie),[ie]}}class pr extends je{constructor(D){super(D),this.addPrefixSpace=D.add_prefix_space,this.replacement=D.replacement}decode_chain(D){const Z=[];for(let ie=0;ie<D.length;++ie){let he=D[ie].replaceAll(this.replacement," ");this.addPrefixSpace&&ie==0&&he.startsWith(" ")&&(he=he.substring(1)),Z.push(he)}return Z}}class at extends R{constructor(D){super(D),this.charsmap=D.precompiled_charsmap}normalize(D){return D=D.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),D=D.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),D.includes("")?D=D.split("").map(ie=>ie.normalize("NFKC")).join(""):D=D.normalize("NFKC"),D}}class Kn extends Q{constructor(D){super(),this.tokenizers=D.pretokenizers.map(Z=>Q.fromConfig(Z))}pre_tokenize_text(D,Z){return this.tokenizers.reduce((ie,he)=>he.pre_tokenize(ie,Z),[D])}}class F extends Q{constructor(D){super()}pre_tokenize_text(D,Z){return D.match(/\w+|[^\w\s]+/g)||[]}}class ce extends Q{constructor(D){super()}pre_tokenize_text(D,Z){return x(D)}}class W extends Q{constructor(D){super(),this.config=D,this.pattern=f(this.config.pattern),this.content=this.config.content}pre_tokenize_text(D,Z){return this.pattern===null?[D]:[D.replaceAll(this.pattern,this.config.content)]}}const le=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function ye(_e,D,Z,ie){for(const he of Object.keys(_e)){const ge=D-_e[he].length,Ce=Z(he),Ge=new Array(ge).fill(Ce);_e[he]=ie==="right"?(0,s.mergeArrays)(_e[he],Ge):(0,s.mergeArrays)(Ge,_e[he])}}function Re(_e,D){for(const Z of Object.keys(_e))_e[Z].length=D}class Se extends n.Callable{constructor(Z,ie){super();oe(this,"return_token_type_ids",!1);oe(this,"padding_side","right");this.config=ie,this.normalizer=R.fromConfig(Z.normalizer),this.pre_tokenizer=Q.fromConfig(Z.pre_tokenizer),this.model=V.fromConfig(Z.model,ie),this.post_processor=Ee.fromConfig(Z.post_processor),this.decoder=je.fromConfig(Z.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const he of Z.added_tokens){const ge=new O(he);this.added_tokens.push(ge),this.model.tokens_to_ids.set(ge.content,ge.id),this.model.vocab[ge.id]=ge.content,ge.special&&(this.special_tokens.push(ge.content),this.all_special_ids.push(ge.id))}if(this.additional_special_tokens=ie.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new l.DictionarySplitter(this.added_tokens.map(he=>he.content)),this.added_tokens_map=new Map(this.added_tokens.map(he=>[he.content,he])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=ie.model_max_length,this.remove_space=ie.remove_space,this.clean_up_tokenization_spaces=ie.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=ie.do_lowercase_and_remove_accent??!1,ie.padding_side&&(this.padding_side=ie.padding_side),this.legacy=!1,this.chat_template=ie.chat_template??null,Array.isArray(this.chat_template)){const he=Object.create(null);for(const{name:ge,template:Ce}of this.chat_template){if(typeof ge!="string"||typeof Ce!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');he[ge]=Ce}this.chat_template=he}this._compiled_template_cache=new Map}getToken(...Z){for(const ie of Z){const he=this.config[ie];if(he)if(typeof he=="object"){if(he.__type==="AddedToken")return he.content;throw Error(`Unknown token: ${he}`)}else return he}return null}static async from_pretrained(Z,{progress_callback:ie=null,config:he=null,cache_dir:ge=null,local_files_only:Ce=!1,revision:Ge="main",legacy:tt=null}={}){const Xe=await d(Z,{progress_callback:ie,config:he,cache_dir:ge,local_files_only:Ce,revision:Ge,legacy:tt});return new this(...Xe)}_call(Z,{text_pair:ie=null,add_special_tokens:he=!0,padding:ge=!1,truncation:Ce=null,max_length:Ge=null,return_tensor:tt=!0,return_token_type_ids:Xe=null}={}){const st=Array.isArray(Z);let St;if(st){if(Z.length===0)throw Error("text array must be non-empty");if(ie!==null){if(Array.isArray(ie)){if(Z.length!==ie.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");St=Z.map((Zt,Sr)=>this._encode_plus(Zt,{text_pair:ie[Sr],add_special_tokens:he,return_token_type_ids:Xe}))}else St=Z.map(Zt=>this._encode_plus(Zt,{add_special_tokens:he,return_token_type_ids:Xe}))}else{if(Z==null)throw Error("text may not be null or undefined");if(Array.isArray(ie))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");St=[this._encode_plus(Z,{text_pair:ie,add_special_tokens:he,return_token_type_ids:Xe})]}if(Ge===null?Ge=this.model_max_length:Ce===null&&(ge===!0?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),Ge=this.model_max_length):ge===!1&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),Ce=!0)),ge===!0&&(Ge=Math.min((0,o.max)(St.map(Zt=>Zt.input_ids.length))[0],Ge??1/0)),Ge=Math.min(Ge,this.model_max_length??1/0),ge||Ce)for(let Zt=0;Zt<St.length;++Zt)St[Zt].input_ids.length!==Ge&&(St[Zt].input_ids.length>Ge?Ce&&Re(St[Zt],Ge):ge&&ye(St[Zt],Ge,Sr=>Sr==="input_ids"?this.pad_token_id:0,this.padding_side));const tr={};if(tt){if(!(ge&&Ce)&&St.some(Sr=>{var hr;for(const ln of Object.keys(Sr))if(Sr[ln].length!==((hr=St[0][ln])==null?void 0:hr.length))return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const Zt=[St.length,St[0].input_ids.length];for(const Sr of Object.keys(St[0]))tr[Sr]=new a.Tensor("int64",BigInt64Array.from(St.flatMap(hr=>hr[Sr]).map(BigInt)),Zt)}else{for(const Zt of Object.keys(St[0]))tr[Zt]=St.map(Sr=>Sr[Zt]);if(!st)for(const Zt of Object.keys(tr))tr[Zt]=tr[Zt][0]}return tr}_encode_text(Z){if(Z===null)return null;const ie=this.added_tokens_splitter.split(Z);for(let ge=0;ge<ie.length;++ge){const Ce=this.added_tokens_map.get(ie[ge]);Ce&&(Ce.lstrip&&ge>0&&(ie[ge-1]=ie[ge-1].trimEnd()),Ce.rstrip&&ge<ie.length-1&&(ie[ge+1]=ie[ge+1].trimStart()))}return ie.flatMap((ge,Ce)=>{if(ge.length===0)return[];if(this.added_tokens_map.has(ge))return[ge];if(this.remove_space===!0&&(ge=ge.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(ge=g(ge)),this.normalizer!==null&&(ge=this.normalizer(ge)),ge.length===0)return[];const Ge=this.pre_tokenizer!==null?this.pre_tokenizer(ge,{section_index:Ce}):[ge];return this.model(Ge)})}_encode_plus(Z,{text_pair:ie=null,add_special_tokens:he=!0,return_token_type_ids:ge=null}={}){const{tokens:Ce,token_type_ids:Ge}=this._tokenize_helper(Z,{pair:ie,add_special_tokens:he}),tt=this.model.convert_tokens_to_ids(Ce),Xe={input_ids:tt,attention_mask:new Array(tt.length).fill(1)};return(ge??this.return_token_type_ids)&&Ge&&(Xe.token_type_ids=Ge),Xe}_tokenize_helper(Z,{pair:ie=null,add_special_tokens:he=!1}={}){const ge=this._encode_text(Z),Ce=this._encode_text(ie);return this.post_processor?this.post_processor(ge,Ce,{add_special_tokens:he}):{tokens:(0,s.mergeArrays)(ge??[],Ce??[])}}tokenize(Z,{pair:ie=null,add_special_tokens:he=!1}={}){return this._tokenize_helper(Z,{pair:ie,add_special_tokens:he}).tokens}encode(Z,{text_pair:ie=null,add_special_tokens:he=!0,return_token_type_ids:ge=null}={}){return this._encode_plus(Z,{text_pair:ie,add_special_tokens:he,return_token_type_ids:ge}).input_ids}batch_decode(Z,ie={}){return Z instanceof a.Tensor&&(Z=Z.tolist()),Z.map(he=>this.decode(he,ie))}decode(Z,ie={}){if(Z instanceof a.Tensor&&(Z=_(Z)),!Array.isArray(Z)||Z.length===0||!(0,s.isIntegralNumber)(Z[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(Z,ie)}decode_single(Z,{skip_special_tokens:ie=!1,clean_up_tokenization_spaces:he=null}){let ge=this.model.convert_ids_to_tokens(Z);ie&&(ge=ge.filter(Ge=>!this.special_tokens.includes(Ge)));let Ce=this.decoder?this.decoder(ge):ge.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(Ce=Ce.replaceAll(this.decoder.end_of_word_suffix," "),ie&&(Ce=Ce.trim())),(he??this.clean_up_tokenization_spaces)&&(Ce=w(Ce)),Ce}get_chat_template({chat_template:Z=null,tools:ie=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const he=this.chat_template;if(Z!==null&&Object.hasOwn(he,Z))Z=he[Z];else if(Z===null)if(ie!==null&&"tool_use"in he)Z=he.tool_use;else if("default"in he)Z=he.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(he).sort()}.`)}else if(Z===null)if(this.chat_template)Z=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return Z}apply_chat_template(Z,{tools:ie=null,documents:he=null,chat_template:ge=null,add_generation_prompt:Ce=!1,tokenize:Ge=!0,padding:tt=!1,truncation:Xe=!1,max_length:st=null,return_tensor:St=!0,return_dict:tr=!1,tokenizer_kwargs:Zt={},...Sr}={}){if(ge=this.get_chat_template({chat_template:ge,tools:ie}),typeof ge!="string")throw Error(`chat_template must be a string, but got ${typeof ge}`);let hr=this._compiled_template_cache.get(ge);hr===void 0&&(hr=new c.Template(ge),this._compiled_template_cache.set(ge,hr));const ln=Object.create(null);for(const Mn of le){const Tn=this.getToken(Mn);Tn&&(ln[Mn]=Tn)}const pn=hr.render({messages:Z,add_generation_prompt:Ce,tools:ie,documents:he,...ln,...Sr});if(Ge){const Mn=this._call(pn,{add_special_tokens:!1,padding:tt,truncation:Xe,max_length:st,return_tensor:St,...Zt});return tr?Mn:Mn.input_ids}return pn}}class jt extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class er extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class bt extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class mt extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class ut extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class sr extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class wr extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class fn extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class Er extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class Ln extends Se{}class Xs extends Se{}class wi extends Se{constructor(Z,ie){super(Z,ie);oe(this,"return_token_type_ids",!0);console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class Js extends Se{constructor(){super(...arguments);oe(this,"return_token_type_ids",!0)}}class io extends Se{}class ss extends Se{}class oo extends Se{}class ks extends Se{constructor(D,Z){super(D,Z),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(ie=>this.languageRegex.test(ie)),this.lang_to_token=ie=>ie}_build_translation_inputs(D,Z,ie){return Zr(this,D,Z,ie)}}class bi extends ks{}class ao extends Se{}class lo extends Se{}const Wr="";class co extends Se{constructor(Z,ie){super(Z,ie);oe(this,"padding_side","left");this.legacy=ie.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new dr({replacement:Wr,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text(Z){if(Z===null)return null;if(this.legacy||Z.length===0)return super._encode_text(Z);let ie=super._encode_text(Wr+Z.replaceAll(Wr," "));return ie.length>1&&ie[0]===Wr&&this.special_tokens.includes(ie[1])&&(ie=ie.slice(1)),ie}}class xn extends Se{}class xi extends Se{}class qn extends Se{}class Fe extends Se{}class nt extends Se{}class pt extends Se{}class ir extends Se{}class Zs extends Se{}class ei extends Se{}function Zr(_e,D,Z,ie){if(!("language_codes"in _e)||!Array.isArray(_e.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in _e)||!(_e.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in _e)||typeof _e.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const he=ie.src_lang,ge=ie.tgt_lang;if(!_e.language_codes.includes(ge))throw new Error(`Target language code "${ge}" is not valid. Must be one of: {${_e.language_codes.join(", ")}}`);if(he!==void 0){if(!_e.language_codes.includes(he))throw new Error(`Source language code "${he}" is not valid. Must be one of: {${_e.language_codes.join(", ")}}`);for(const Ce of _e.post_processor.config.single)if("SpecialToken"in Ce&&_e.languageRegex.test(Ce.SpecialToken.id)){Ce.SpecialToken.id=_e.lang_to_token(he);break}}return ie.forced_bos_token_id=_e.model.convert_tokens_to_ids([_e.lang_to_token(ge)])[0],_e._call(D,Z)}class ti extends Se{constructor(D,Z){super(D,Z),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(ie=>this.languageRegex.test(ie)),this.lang_to_token=ie=>ie}_build_translation_inputs(D,Z,ie){return Zr(this,D,Z,ie)}}class en extends Se{constructor(D,Z){super(D,Z),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(ie=>this.languageRegex.test(ie)).map(ie=>ie.slice(2,-2)),this.lang_to_token=ie=>`__${ie}__`}_build_translation_inputs(D,Z,ie){return Zr(this,D,Z,ie)}}class an extends Se{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(D,{return_timestamps:Z=!1,return_language:ie=!1,time_precision:he=null,force_full_sequences:ge=!0}={}){if(he===null)throw Error("Must specify time_precision");let Ce=null;const Ge=Z==="word";function tt(){return{language:Ce,timestamp:[null,null],text:""}}const Xe=[];let st=tt(),St=0;const tr=this.timestamp_begin,Sr=tr+1500;let hr=[],ln=[],pn=!1,Mn=null;const Tn=new Set(this.all_special_ids);for(const _r of D){const cn=_r.tokens,Bn=Ge?_r.token_timestamps:null;let As=null,$s=tr;if("stride"in _r){const[mn,$r,tn]=_r.stride;if(St-=$r,Mn=mn-tn,$r&&($s=$r/he+tr),tn)for(let rn=cn.length-1;rn>=0;--rn){const On=Number(cn[rn]);if(On>=tr){if(As!==null&&(On-tr)*he<Mn)break;As=On}}}let In=[],zn=[];for(let mn=0;mn<cn.length;++mn){const $r=Number(cn[mn]);if(Tn.has($r)){const tn=this.decode([$r]),rn=u.WHISPER_LANGUAGE_MAPPING.get(tn.slice(2,-2));if(rn!==void 0){if(Ce!==null&&rn!==Ce&&!Z){hr.push(In);const On=this.findLongestCommonSequence(hr)[0],ni=this.decode(On);st.text=ni,Xe.push(st),hr=[],In=[],st=tt()}Ce=st.language=rn}}else if($r>=tr&&$r<=Sr){const tn=($r-tr)*he+St,rn=(0,o.round)(tn,2);if(As!==null&&$r>=As)pn=!0;else if(pn||hr.length>0&&$r<$s)pn=!1;else if(st.timestamp[0]===null)st.timestamp[0]=rn;else if(rn!==st.timestamp[0]){st.timestamp[1]=rn,hr.push(In),Ge&&ln.push(zn);const[On,ni]=this.findLongestCommonSequence(hr,ln),xl=this.decode(On);st.text=xl,Ge&&(st.words=this.collateWordTimestamps(On,ni,Ce)),Xe.push(st),hr=[],In=[],ln=[],zn=[],st=tt()}}else if(In.push($r),Ge){let tn=(0,o.round)(Bn[mn]+St,2),rn;if(mn+1<Bn.length){rn=(0,o.round)(Bn[mn+1]+St,2);const On=this.decode([$r]);E.test(On)&&(rn=(0,o.round)(Math.min(tn+he,rn),2))}else rn=null;zn.push([tn,rn])}}if("stride"in _r){const[mn,$r,tn]=_r.stride;St+=mn-tn}In.length>0?(hr.push(In),Ge&&ln.push(zn)):hr.every(mn=>mn.length===0)&&(st=tt(),hr=[],In=[],ln=[],zn=[])}if(hr.length>0){if(ge&&Z)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[_r,cn]=this.findLongestCommonSequence(hr,ln),Bn=this.decode(_r);st.text=Bn,Ge&&(st.words=this.collateWordTimestamps(_r,cn,Ce)),Xe.push(st)}let Ar=Object.create(null);const Ti=Xe.map(_r=>_r.text).join("");if(Z||ie){for(let _r=0;_r<Xe.length;++_r){const cn=Xe[_r];Z||delete cn.timestamp,ie||delete cn.language}if(Ge){const _r=[];for(const cn of Xe)for(const Bn of cn.words)_r.push(Bn);Ar={chunks:_r}}else Ar={chunks:Xe}}return[Ti,Ar]}findLongestCommonSequence(D,Z=null){let ie=D[0],he=ie.length,ge=[];const Ce=Array.isArray(Z)&&Z.length>0;let Ge=Ce?[]:null,tt=Ce?Z[0]:null;for(let Xe=1;Xe<D.length;++Xe){const st=D[Xe];let St=0,tr=[he,he,0,0];const Zt=st.length;for(let Ar=1;Ar<he+Zt;++Ar){const Ti=Math.max(0,he-Ar),_r=Math.min(he,he+Zt-Ar),cn=ie.slice(Ti,_r),Bn=Math.max(0,Ar-he),As=Math.min(Zt,Ar),$s=st.slice(Bn,As);if(cn.length!==$s.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let In;Ce?In=cn.filter(($r,tn)=>$r===$s[tn]&&tt[Ti+tn]<=Z[Xe][Bn+tn]).length:In=cn.filter(($r,tn)=>$r===$s[tn]).length;const zn=Ar/1e4,mn=In/Ar+zn;In>1&&mn>St&&(St=mn,tr=[Ti,_r,Bn,As])}const[Sr,hr,ln,pn]=tr,Mn=Math.floor((hr+Sr)/2),Tn=Math.floor((pn+ln)/2);ge.push(...ie.slice(0,Mn)),ie=st.slice(Tn),he=ie.length,Ce&&(Ge.push(...tt.slice(0,Mn)),tt=Z[Xe].slice(Tn))}return ge.push(...ie),Ce?(Ge.push(...tt),[ge,Ge]):[ge,[]]}collateWordTimestamps(D,Z,ie){const[he,ge,Ce]=this.combineTokensIntoWords(D,ie),Ge=[];for(let tt=0;tt<he.length;++tt){const Xe=Ce[tt];Ge.push({text:he[tt],timestamp:[Z[Xe.at(0)][0],Z[Xe.at(-1)][1]]})}return Ge}combineTokensIntoWords(D,Z,ie=`"'([{-`,he=`"'.,!?:)]}`){Z=Z??"english";let ge,Ce,Ge;return["chinese","japanese","thai","lao","myanmar"].includes(Z)?[ge,Ce,Ge]=this.splitTokensOnUnicode(D):[ge,Ce,Ge]=this.splitTokensOnSpaces(D),this.mergePunctuations(ge,Ce,Ge,ie,he)}decode(D,Z){let ie;return Z!=null&&Z.decode_with_timestamps?(D instanceof a.Tensor&&(D=_(D)),ie=this.decodeWithTimestamps(D,Z)):ie=super.decode(D,Z),ie}decodeWithTimestamps(D,Z){const ie=(Z==null?void 0:Z.time_precision)??.02,he=Array.from(this.all_special_ids).at(-1)+1;let ge=[[]];for(let Ce of D)if(Ce=Number(Ce),Ce>=he){const Ge=((Ce-he)*ie).toFixed(2);ge.push(`<|${Ge}|>`),ge.push([])}else ge[ge.length-1].push(Ce);return ge=ge.map(Ce=>typeof Ce=="string"?Ce:super.decode(Ce,Z)),ge.join("")}splitTokensOnUnicode(D){const Z=this.decode(D,{decode_with_timestamps:!0}),ie="",he=[],ge=[],Ce=[];let Ge=[],tt=[],Xe=0;for(let st=0;st<D.length;++st){const St=D[st];Ge.push(St),tt.push(st);const tr=this.decode(Ge,{decode_with_timestamps:!0});(!tr.includes(ie)||Z[Xe+tr.indexOf(ie)]===ie)&&(he.push(tr),ge.push(Ge),Ce.push(tt),Ge=[],tt=[],Xe+=tr.length)}return[he,ge,Ce]}splitTokensOnSpaces(D){const[Z,ie,he]=this.splitTokensOnUnicode(D),ge=[],Ce=[],Ge=[],tt=new RegExp(`^[${M}]$`,"gu");for(let Xe=0;Xe<Z.length;++Xe){const st=Z[Xe],St=ie[Xe],tr=he[Xe],Zt=St[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),Sr=st.startsWith(" "),hr=st.trim(),ln=tt.test(hr);if(Zt||Sr||ln||ge.length===0)ge.push(st),Ce.push(St),Ge.push(tr);else{const pn=ge.length-1;ge[pn]+=st,Ce[pn].push(...St),Ge[pn].push(...tr)}}return[ge,Ce,Ge]}mergePunctuations(D,Z,ie,he,ge){const Ce=structuredClone(D),Ge=structuredClone(Z),tt=structuredClone(ie);let Xe=Ce.length-2,st=Ce.length-1;for(;Xe>=0;)Ce[Xe].startsWith(" ")&&he.includes(Ce[Xe].trim())?(Ce[st]=Ce[Xe]+Ce[st],Ge[st]=(0,s.mergeArrays)(Ge[Xe],Ge[st]),tt[st]=(0,s.mergeArrays)(tt[Xe],tt[st]),Ce[Xe]="",Ge[Xe]=[],tt[Xe]=[]):st=Xe,--Xe;for(Xe=0,st=1;st<Ce.length;)!Ce[Xe].endsWith(" ")&&ge.includes(Ce[st])?(Ce[Xe]+=Ce[st],Ge[Xe]=(0,s.mergeArrays)(Ge[Xe],Ge[st]),tt[Xe]=(0,s.mergeArrays)(tt[Xe],tt[st]),Ce[st]="",Ge[st]=[],tt[st]=[]):Xe=st,++st;return[Ce.filter(St=>St),Ge.filter(St=>St.length>0),tt.filter(St=>St.length>0)]}}class ri extends Se{}class Mi extends Se{}class pl extends Se{}class ml extends Se{constructor(D,Z){super(D,Z),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(ie=>this.languageRegex.test(ie)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(D){if(D===null)return null;const[Z,...ie]=D.trim().split(this.languageRegex);if(ie.length===0)return super._encode_text(Z);if(ie.length===2){const[he,ge]=ie;return this.supported_language_codes.includes(he)||console.warn(`Unsupported language code "${he}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,s.mergeArrays)([he],super._encode_text(ge))}}}class gl extends Se{}class _l extends Se{}class yl extends Se{}class uo extends Se{}class oa extends Se{}class vl extends Se{constructor(D,Z){super(D,Z),this.decoder=new Lt({})}}class wl extends Se{}class bl extends Se{}class ho{static async from_pretrained(D,{progress_callback:Z=null,config:ie=null,cache_dir:he=null,local_files_only:ge=!1,revision:Ce="main",legacy:Ge=null}={}){var tr;const[tt,Xe]=await d(D,{progress_callback:Z,config:ie,cache_dir:he,local_files_only:ge,revision:Ce,legacy:Ge}),st=((tr=Xe.tokenizer_class)==null?void 0:tr.replace(/Fast$/,""))??"PreTrainedTokenizer";let St=this.TOKENIZER_CLASS_MAPPING[st];return St||(console.warn(`Unknown tokenizer class "${st}", attempting to construct from base class.`),St=Se),new St(tt,Xe)}}oe(ho,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer:io,DistilBertTokenizer:Ln,CamembertTokenizer:Xs,DebertaTokenizer:ut,DebertaV2Tokenizer:sr,BertTokenizer:jt,HerbertTokenizer:wr,ConvBertTokenizer:fn,RoFormerTokenizer:Er,XLMTokenizer:wi,ElectraTokenizer:Js,MobileBertTokenizer:bt,SqueezeBertTokenizer:mt,AlbertTokenizer:er,GPT2Tokenizer:ss,BartTokenizer:oo,MBartTokenizer:ks,MBart50Tokenizer:bi,RobertaTokenizer:ao,WhisperTokenizer:an,CodeGenTokenizer:ri,CLIPTokenizer:Mi,SiglipTokenizer:pl,MarianTokenizer:ml,BloomTokenizer:lo,NllbTokenizer:ti,M2M100Tokenizer:en,LlamaTokenizer:co,CodeLlamaTokenizer:xn,XLMRobertaTokenizer:xi,MPNetTokenizer:qn,FalconTokenizer:Fe,GPTNeoXTokenizer:nt,EsmTokenizer:pt,Wav2Vec2CTCTokenizer:gl,BlenderbotTokenizer:_l,BlenderbotSmallTokenizer:yl,SpeechT5Tokenizer:uo,NougatTokenizer:oa,VitsTokenizer:vl,Qwen2Tokenizer:ir,GemmaTokenizer:Zs,Grok1Tokenizer:ei,CohereTokenizer:wl,MgpstrTokenizer:bl,PreTrainedTokenizer:Se})},"./src/utils/audio.js":(e,t,r)=>{r.r(t),r.d(t,{RawAudio:()=>U,hamming:()=>h,hanning:()=>d,mel_filter_bank:()=>v,read_audio:()=>c,spectrogram:()=>P,window_function:()=>I});var n=r("./src/utils/hub.js"),s=r("./src/utils/maths.js"),i=r("./src/utils/core.js"),o=r("./src/env.js"),a=r("./src/utils/tensor.js"),l=r("?7992");async function c(B,Y){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const K=await(await(0,n.getFile)(B)).arrayBuffer(),X=new AudioContext({sampleRate:Y});typeof Y>"u"&&console.warn(`No sampling rate provided, using default of ${X.sampleRate}Hz.`);const G=await X.decodeAudioData(K);let R;if(G.numberOfChannels===2){const te=Math.sqrt(2),re=G.getChannelData(0),L=G.getChannelData(1);R=new Float32Array(re.length);for(let j=0;j<G.length;++j)R[j]=te*(re[j]+L[j])/2}else R=G.getChannelData(0);return R}function u(B,Y){if(B<1)return new Float64Array;if(B===1)return new Float64Array([1]);const K=1-Y,X=2*Math.PI/(B-1),G=new Float64Array(B);for(let R=0;R<B;++R)G[R]=Y-K*Math.cos(R*X);return G}function d(B){return u(B,.5)}function h(B){return u(B,.54)}const f={htk:B=>2595*Math.log10(1+B/700),kaldi:B=>1127*Math.log(1+B/700),slaney:(B,Y=1e3,K=15,X=27/Math.log(6.4))=>B>=Y?K+Math.log(B/Y)*X:3*B/200};function p(B,Y="htk"){const K=f[Y];if(!K)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof B=="number"?K(B):B.map(X=>K(X))}const _={htk:B=>700*(10**(B/2595)-1),kaldi:B=>700*(Math.exp(B/1127)-1),slaney:(B,Y=1e3,K=15,X=Math.log(6.4)/27)=>B>=K?Y*Math.exp(X*(B-K)):200*B/3};function w(B,Y="htk"){const K=_[Y];if(!K)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof B=="number"?K(B):B.map(X=>K(X))}function y(B,Y){const K=Float64Array.from({length:Y.length-1},(te,re)=>Y[re+1]-Y[re]),X=Array.from({length:B.length},()=>new Array(Y.length));for(let te=0;te<B.length;++te){const re=X[te];for(let L=0;L<Y.length;++L)re[L]=Y[L]-B[te]}const G=Y.length-2,R=Array.from({length:G},()=>new Array(B.length));for(let te=0;te<B.length;++te){const re=X[te];for(let L=0;L<G;++L){const j=-re[L]/K[L],q=re[L+2]/K[L+1];R[L][te]=Math.max(0,Math.min(j,q))}}return R}function g(B,Y,K){const X=(Y-B)/(K-1);return Float64Array.from({length:K},(G,R)=>B+X*R)}function v(B,Y,K,X,G,R=null,te="htk",re=!1){if(R!==null&&R!=="slaney")throw new Error('norm must be one of null or "slaney"');if(B<2)throw new Error(`Require num_frequency_bins: ${B} >= 2`);if(K>X)throw new Error(`Require min_frequency: ${K} <= max_frequency: ${X}`);const L=p(K,te),j=p(X,te),q=g(L,j,Y+2);let ne=w(q,te),me;if(re){const fe=G/((B-1)*2);me=p(Float64Array.from({length:B},(Pe,Ne)=>Ne*fe),te),ne=q}else me=g(0,Math.floor(G/2),B);const ae=y(me,ne);if(R!==null&&R==="slaney")for(let fe=0;fe<Y;++fe){const Pe=ae[fe],Ne=2/(ne[fe+2]-ne[fe]);for(let de=0;de<B;++de)Pe[de]*=Ne}return ae}function b(B,Y,K){const X=new B.constructor(B.length+Y+K),G=B.length-1;for(let R=0;R<B.length;++R)X[Y+R]=B[R];for(let R=1;R<=Y;++R)X[Y-R]=B[(0,i.calculateReflectOffset)(R,G)];for(let R=1;R<=K;++R)X[G+Y+R]=B[(0,i.calculateReflectOffset)(G-R,G)];return X}function x(B,Y,K,X,G){if(K<=0)throw new Error("reference must be greater than zero");if(X<=0)throw new Error("min_value must be greater than zero");K=Math.max(X,K);const R=Math.log10(K);for(let te=0;te<B.length;++te)B[te]=Y*Math.log10(Math.max(X,B[te])-R);if(G!==null){if(G<=0)throw new Error("db_range must be greater than zero");const te=(0,s.max)(B)[0]-G;for(let re=0;re<B.length;++re)B[re]=Math.max(B[re],te)}return B}function M(B,Y=1,K=1e-5,X=null){return x(B,20,Y,K,X)}function E(B,Y=1,K=1e-10,X=null){return x(B,10,Y,K,X)}async function P(B,Y,K,X,{fft_length:G=null,power:R=1,center:te=!0,pad_mode:re="reflect",onesided:L=!0,preemphasis:j=null,preemphasis_htk_flavor:q=!0,mel_filters:ne=null,mel_floor:me=1e-10,log_mel:ae=null,reference:fe=1,min_value:Pe=1e-10,db_range:Ne=null,remove_dc_offset:de=null,min_num_frames:Q=null,max_num_frames:se=null,do_pad:J=!0,transpose:be=!1}={}){const xe=Y.length;if(G===null&&(G=K),K>G)throw Error(`frame_length (${K}) may not be larger than fft_length (${G})`);if(xe!==K)throw new Error(`Length of the window (${xe}) must equal frame_length (${K})`);if(X<=0)throw new Error("hop_length must be greater than zero");if(R===null&&ne!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!q)throw new Error("`preemphasis_htk_flavor=false` is not currently supported.");if(te){if(re!=="reflect")throw new Error(`pad_mode="${re}" not implemented yet.`);const it=Math.floor((G-1)/2)+1;B=b(B,it,it)}let Te=Math.floor(1+Math.floor((B.length-K)/X));Q!==null&&Te<Q&&(Te=Q);const Ee=L?Math.floor(G/2)+1:G;let $e=Te,Ie=Te;se!==null&&(se>Te?J&&(Ie=se):Ie=$e=se);const Ue=new s.FFT(G),Ke=new Float64Array(G),Je=new Float64Array(Ue.outputBufferSize),je=new Float32Array(Ee*Ie);for(let it=0;it<$e;++it){const We=it*X,Be=Math.min(B.length-We,K);Be!==K&&Ke.fill(0,0,K);for(let De=0;De<Be;++De)Ke[De]=B[We+De];if(de){let De=0;for(let Mt=0;Mt<Be;++Mt)De+=Ke[Mt];const yt=De/Be;for(let Mt=0;Mt<Be;++Mt)Ke[Mt]-=yt}if(j!==null){for(let De=Be-1;De>=1;--De)Ke[De]-=j*Ke[De-1];Ke[0]*=1-j}for(let De=0;De<Y.length;++De)Ke[De]*=Y[De];Ue.realTransform(Je,Ke);for(let De=0;De<Ee;++De){const yt=De<<1;je[De*Ie+it]=Je[yt]**2+Je[yt+1]**2}}if(R!==null&&R!==2){const it=R/2;for(let We=0;We<je.length;++We)je[We]**=it}const qe=ne.length;let ot=await(0,a.matmul)(new a.Tensor("float32",ne.flat(),[qe,Ee]),new a.Tensor("float32",je,[Ee,Ie]));be&&(ot=ot.transpose(1,0));const ft=ot.data;for(let it=0;it<ft.length;++it)ft[it]=Math.max(me,ft[it]);if(R!==null&&ae!==null){const it=Math.min(ft.length,$e*qe);switch(ae){case"log":for(let We=0;We<it;++We)ft[We]=Math.log(ft[We]);break;case"log10":for(let We=0;We<it;++We)ft[We]=Math.log10(ft[We]);break;case"dB":if(R===1)M(ft,fe,Pe,Ne);else if(R===2)E(ft,fe,Pe,Ne);else throw new Error(`Cannot use log_mel option '${ae}' with power ${R}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${ae}'`)}}return ot}function I(B,Y,{periodic:K=!0,frame_length:X=null,center:G=!0}={}){const R=K?B+1:B;let te;switch(Y){case"boxcar":te=new Float64Array(R).fill(1);break;case"hann":case"hann_window":te=d(R);break;case"hamming":te=h(R);break;case"povey":te=d(R).map(re=>Math.pow(re,.85));break;default:throw new Error(`Unknown window type ${Y}.`)}if(K&&(te=te.subarray(0,B)),X===null)return te;if(B>X)throw new Error(`Length of the window (${B}) may not be larger than frame_length (${X})`);return te}function O(B,Y){let K=44;const X=new ArrayBuffer(K+B.length*4),G=new DataView(X);V(G,0,"RIFF"),G.setUint32(4,36+B.length*4,!0),V(G,8,"WAVE"),V(G,12,"fmt "),G.setUint32(16,16,!0),G.setUint16(20,3,!0),G.setUint16(22,1,!0),G.setUint32(24,Y,!0),G.setUint32(28,Y*4,!0),G.setUint16(32,4,!0),G.setUint16(34,32,!0),V(G,36,"data"),G.setUint32(40,B.length*4,!0);for(let R=0;R<B.length;++R,K+=4)G.setFloat32(K,B[R],!0);return X}function V(B,Y,K){for(let X=0;X<K.length;++X)B.setUint8(Y+X,K.charCodeAt(X))}class U{constructor(Y,K){this.audio=Y,this.sampling_rate=K}toWav(){return O(this.audio,this.sampling_rate)}toBlob(){const Y=this.toWav();return new Blob([Y],{type:"audio/wav"})}async save(Y){let K;if(o.apis.IS_BROWSER_ENV){if(o.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");K=i.saveBlob}else if(o.apis.IS_FS_AVAILABLE)K=async(X,G)=>{let R=await G.arrayBuffer();l.writeFileSync(X,Buffer.from(R))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await K(Y,this.toBlob())}}},"./src/utils/constants.js":(e,t,r)=>{r.r(t),r.d(t,{CHAT_TEMPLATE_NAME:()=>l,CONFIG_NAME:()=>s,FEATURE_EXTRACTOR_NAME:()=>i,GENERATION_CONFIG_NAME:()=>c,GITHUB_ISSUE_URL:()=>n,IMAGE_PROCESSOR_NAME:()=>o,PROCESSOR_NAME:()=>a});const n="https://github.com/huggingface/transformers.js/issues/new/choose",s="config.json",i="preprocessor_config.json",o=i,a="processor_config.json",l="chat_template.jinja",c="generation_config.json"},"./src/utils/core.js":(e,t,r)=>{r.r(t),r.d(t,{calculateDimensions:()=>c,calculateReflectOffset:()=>f,count:()=>y,dispatchCallback:()=>n,escapeRegExp:()=>i,isIntegralNumber:()=>a,isNullishDimension:()=>l,isTypedArray:()=>o,len:()=>w,mergeArrays:()=>d,pick:()=>_,pop:()=>u,product:()=>h,reverseDictionary:()=>s,saveBlob:()=>p});function n(g,v){g&&g(v)}function s(g){return Object.fromEntries(Object.entries(g).map(([v,b])=>[b,v]))}function i(g){return g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(g){var v,b,x;return((x=(b=(v=g==null?void 0:g.prototype)==null?void 0:v.__proto__)==null?void 0:b.constructor)==null?void 0:x.name)==="TypedArray"}function a(g){return Number.isInteger(g)||typeof g=="bigint"}function l(g){return g==null||g===-1}function c(g){const v=[];let b=g;for(;Array.isArray(b);)v.push(b.length),b=b[0];return v}function u(g,v,b=void 0){const x=g[v];if(x!==void 0)return delete g[v],x;if(b===void 0)throw Error(`Key ${v} does not exist in object.`);return b}function d(...g){return Array.prototype.concat.apply([],g)}function h(...g){return g.reduce((v,b)=>v.flatMap(x=>b.map(M=>[x,M])))}function f(g,v){return Math.abs((g+v)%(2*v)-v)}function p(g,v){const b=URL.createObjectURL(v),x=document.createElement("a");x.href=b,x.download=g,x.click(),x.remove(),URL.revokeObjectURL(b)}function _(g,v){return Object.assign({},...v.map(b=>{if(g[b]!==void 0)return{[b]:g[b]}}))}function w(g){let v=0;for(const b of g)++v;return v}function y(g,v){let b=0;for(const x of g)x===v&&++b;return b}},"./src/utils/data-structures.js":(e,t,r)=>{r.r(t),r.d(t,{CharTrie:()=>s,DictionarySplitter:()=>l,LRUCache:()=>c,PriorityQueue:()=>n,TokenLattice:()=>o});class n{constructor(d=(f,p)=>f>p,h=1/0){this._heap=[],this._comparator=d,this._maxSize=h}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...d){return this.extend(d)}extend(d){for(const h of d)if(this.size<this._maxSize)this._heap.push(h),this._siftUp();else{const f=this._smallest();this._comparator(h,this._heap[f])&&(this._heap[f]=h,this._siftUpFrom(f))}return this.size}pop(){const d=this.peek(),h=this.size-1;return h>0&&this._swap(0,h),this._heap.pop(),this._siftDown(),d}replace(d){const h=this.peek();return this._heap[0]=d,this._siftDown(),h}_parent(d){return(d+1>>>1)-1}_left(d){return(d<<1)+1}_right(d){return d+1<<1}_greater(d,h){return this._comparator(this._heap[d],this._heap[h])}_swap(d,h){const f=this._heap[d];this._heap[d]=this._heap[h],this._heap[h]=f}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(d){for(;d>0&&this._greater(d,this._parent(d));)this._swap(d,this._parent(d)),d=this._parent(d)}_siftDown(){let d=0;for(;this._left(d)<this.size&&this._greater(this._left(d),d)||this._right(d)<this.size&&this._greater(this._right(d),d);){const h=this._right(d)<this.size&&this._greater(this._right(d),this._left(d))?this._right(d):this._left(d);this._swap(d,h),d=h}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class s{constructor(){this.root=i.default()}extend(d){for(const h of d)this.push(h)}push(d){let h=this.root;for(const f of d){let p=h.children.get(f);p===void 0&&(p=i.default(),h.children.set(f,p)),h=p}h.isLeaf=!0}*commonPrefixSearch(d){let h=this.root;if(h===void 0)return;let f="";for(const p of d){if(f+=p,h=h.children.get(p),h===void 0)return;h.isLeaf&&(yield f)}}}class i{constructor(d,h){this.isLeaf=d,this.children=h}static default(){return new i(!1,new Map)}}class o{constructor(d,h,f){this.chars=Array.from(d),this.len=this.chars.length,this.bosTokenId=h,this.eosTokenId=f,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const p=new a(this.bosTokenId,0,0,0,0),_=new a(this.eosTokenId,1,this.len,0,0);this.nodes.push(p.clone()),this.nodes.push(_.clone()),this.beginNodes[this.len].push(_),this.endNodes[0].push(p)}insert(d,h,f,p){const _=this.nodes.length,w=new a(p,_,d,h,f);this.beginNodes[d].push(w),this.endNodes[d+h].push(w),this.nodes.push(w)}viterbi(){const d=this.len;let h=0;for(;h<=d;){if(this.beginNodes[h].length==0)return[];for(let y of this.beginNodes[h]){y.prev=null;let g=0,v=null;for(let b of this.endNodes[h]){const x=b.backtraceScore+y.score;(v===null||x>g)&&(v=b.clone(),g=x)}if(v!==null)y.prev=v,y.backtraceScore=g;else return[]}++h}const f=[],_=this.beginNodes[d][0].prev;if(_===null)return[];let w=_.clone();for(;w.prev!==null;)f.push(w.clone()),w=w.clone().prev.clone();return f.reverse(),f}piece(d){return this.chars.slice(d.pos,d.pos+d.length).join("")}tokens(){return this.viterbi().map(h=>this.piece(h))}tokenIds(){return this.viterbi().map(h=>h.tokenId)}}class a{constructor(d,h,f,p,_){this.tokenId=d,this.nodeId=h,this.pos=f,this.length=p,this.score=_,this.prev=null,this.backtraceScore=0}clone(){const d=new a(this.tokenId,this.nodeId,this.pos,this.length,this.score);return d.prev=this.prev,d.backtraceScore=this.backtraceScore,d}}class l{constructor(d){this.trie=this._buildTrie(d)}_buildTrie(d){var f;const h=Object.create(null);for(const p of d){let _=h;for(let w=0;w<p.length;++w)_=_[f=p[w]]??(_[f]=Object.create(null));_.end=p}return h}split(d){const h=[],f=d.length;let p=0,_=0;for(;_<f;){let w=this.trie,y=null,g=_;for(;g<f&&(w=w[d[g]]);)w.end&&(y=w.end),++g;y?(_>p&&h.push(d.slice(p,_)),h.push(y),_+=y.length,p=_):++_}return p<f&&h.push(d.slice(p)),h}}class c{constructor(d){this.capacity=d,this.cache=new Map}get(d){if(!this.cache.has(d))return;const h=this.cache.get(d);return this.cache.delete(d),this.cache.set(d,h),h}put(d,h){this.cache.has(d)&&this.cache.delete(d),this.cache.set(d,h),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}},"./src/utils/devices.js":(e,t,r)=>{r.r(t),r.d(t,{DEVICE_TYPES:()=>n});const n=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(e,t,r)=>{r.r(t),r.d(t,{DATA_TYPES:()=>o,DEFAULT_DEVICE_DTYPE_MAPPING:()=>a,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>l,isWebGpuFp16Supported:()=>i});var n=r("./src/env.js"),s=r("./src/utils/devices.js");const i=function(){let c;return async function(){if(c===void 0)if(!n.apis.IS_WEBGPU_AVAILABLE)c=!1;else try{c=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{c=!1}return c}}(),o=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),a=Object.freeze({[s.DEVICE_TYPES.wasm]:o.q8}),l=Object.freeze({[o.fp32]:"",[o.fp16]:"_fp16",[o.int8]:"_int8",[o.uint8]:"_uint8",[o.q8]:"_quantized",[o.q4]:"_q4",[o.q4f16]:"_q4f16",[o.bnb4]:"_bnb4"})},"./src/utils/generic.js":(e,t,r)=>{r.r(t),r.d(t,{Callable:()=>n});const n=class{constructor(){let s=function(...i){return s._call(...i)};return Object.setPrototypeOf(s,new.target.prototype)}_call(...s){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(e,t,r)=>{r.r(t),r.d(t,{MAX_EXTERNAL_DATA_CHUNKS:()=>a,getFile:()=>f,getModelFile:()=>g,getModelJSON:()=>b,getModelText:()=>v});var n=r("?7992"),s=r("?5af5"),i=r("./src/env.js"),o=r("./src/utils/core.js");const a=100,l={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class c{constructor(P){if(this.filePath=P,this.headers=new Headers,this.exists=n.existsSync(P),this.exists){this.status=200,this.statusText="OK";let I=n.statSync(P);this.headers.set("content-length",I.size.toString()),this.updateContentType();const O=n.createReadStream(P);this.body=new ReadableStream({start(V){O.on("data",U=>V.enqueue(U)),O.on("end",()=>V.close()),O.on("error",U=>V.error(U))},cancel(){O.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const P=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",l[P]??"application/octet-stream")}clone(){let P=new c(this.filePath);return P.exists=this.exists,P.status=this.status,P.statusText=this.statusText,P.headers=new Headers(this.headers),P}async arrayBuffer(){return(await n.promises.readFile(this.filePath)).buffer}async blob(){const P=await n.promises.readFile(this.filePath);return new Blob([P],{type:this.headers.get("content-type")})}async text(){return await n.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function u(E,P=null,I=null){let O;try{O=new URL(E)}catch{return!1}return!(P&&!P.includes(O.protocol)||I&&!I.includes(O.hostname))}const d=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;function h(E){return!(!d.test(E)||E.includes("..")||E.includes("--")||E.endsWith(".git")||E.endsWith(".ipynb"))}async function f(E){var P;if(i.env.useFS&&!u(E,["http:","https:","blob:"]))return new c(E instanceof URL?E.protocol==="file:"?E.pathname:E.toString():E);if(typeof process<"u"&&((P=process==null?void 0:process.release)==null?void 0:P.name)==="node"){const I=!!(Lo!=null&&Lo.TESTING_REMOTELY),O=i.env.version,V=new Headers;if(V.set("User-Agent",`transformers.js/${O}; is_ci/${I};`),u(E,["http:","https:"],["huggingface.co","hf.co"])){const B=(Lo==null?void 0:Lo.HF_TOKEN)??(Lo==null?void 0:Lo.HF_ACCESS_TOKEN);B&&V.set("Authorization",`Bearer ${B}`)}return fetch(E,{headers:V})}else return fetch(E)}const p={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function _(E,P,I){if(!I)return null;const O=p[E]??`Error (${E}) occurred while trying to load file`;throw Error(`${O}: "${P}".`)}class w{constructor(P){this.path=P}async match(P){let I=s.join(this.path,P),O=new c(I);if(O.exists)return O}async put(P,I,O=void 0){let V=s.join(this.path,P);try{const U=I.headers.get("Content-Length"),B=parseInt(U??"0");let Y=0;await n.promises.mkdir(s.dirname(V),{recursive:!0});const K=n.createWriteStream(V),X=I.body.getReader();for(;;){const{done:G,value:R}=await X.read();if(G)break;await new Promise((re,L)=>{K.write(R,j=>{if(j){L(j);return}re()})}),Y+=R.length;const te=B?Y/B*100:0;O==null||O({progress:te,loaded:Y,total:B})}K.close()}catch(U){try{await n.promises.unlink(V)}catch{}throw U}}}async function y(E,...P){for(let I of P)try{let O=await E.match(I);if(O)return O}catch{continue}}async function g(E,P,I=!0,O={},V=!1){if(!i.env.allowLocalModels){if(O.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!i.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,o.dispatchCallback)(O.progress_callback,{status:"initiate",name:E,file:P});let U;if(!U&&i.env.useCustomCache){if(!i.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!i.env.customCache.match||!i.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");U=i.env.customCache}if(!U&&i.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{U=await caches.open("transformers-cache")}catch(me){console.warn("An error occurred while opening the browser cache:",me)}}if(!U&&i.env.useFSCache){if(!i.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");U=new w(O.cache_dir??i.env.cacheDir)}const B=O.revision??"main",Y=M(E,P),K=h(E),X=K?M(i.env.localModelPath,Y):Y,G=M(i.env.remoteHost,i.env.remotePathTemplate.replaceAll("{model}",E).replaceAll("{revision}",encodeURIComponent(B)),P);let R;const te=U instanceof w?B==="main"?Y:M(E,B,P):G;let re=!1,L;U&&(L=await y(U,X,te));const j=L!==void 0;if(L===void 0){if(i.env.allowLocalModels)if(u(Y,["http:","https:"])){if(O.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${Y}.`);if(!i.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${Y}.`)}else try{L=await f(X),R=X}catch(ae){console.warn(`Unable to load from local path "${X}": "${ae}"`)}if(L===void 0||L.status===404){if(O.local_files_only||!i.env.allowRemoteModels){if(I)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${X}".`);return null}if(!K)throw Error(`Local file missing at "${X}" and download aborted due to invalid model ID "${E}".`);if(L=await f(G),L.status!==200)return _(L.status,G,I);R=te}re=U&&typeof Response<"u"&&L instanceof Response&&L.status===200}(0,o.dispatchCallback)(O.progress_callback,{status:"download",name:E,file:P});let q;if(!(i.apis.IS_NODE_ENV&&V)){let me;O.progress_callback?j&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(me=new Uint8Array(await L.arrayBuffer()),(0,o.dispatchCallback)(O.progress_callback,{status:"progress",name:E,file:P,progress:100,loaded:me.length,total:me.length})):me=await x(L,ae=>{(0,o.dispatchCallback)(O.progress_callback,{status:"progress",name:E,file:P,...ae})}):me=new Uint8Array(await L.arrayBuffer()),q=me}if(re&&R&&await U.match(R)===void 0&&(q?await U.put(R,new Response(q,{headers:L.headers})).catch(me=>{console.warn(`Unable to add response to browser cache: ${me}.`)}):await U.put(R,L,O.progress_callback)),(0,o.dispatchCallback)(O.progress_callback,{status:"done",name:E,file:P}),q){if(!i.apis.IS_NODE_ENV&&V)throw new Error("Cannot return path in a browser environment.");return q}if(L instanceof c)return L.filePath;const ne=await(U==null?void 0:U.match(R));if(ne instanceof c)return ne.filePath;if(ne instanceof Response)return new Uint8Array(await ne.arrayBuffer());if(typeof ne=="string")return ne;throw new Error("Unable to get model file path or buffer.")}async function v(E,P,I=!0,O={}){const V=await g(E,P,I,O,!1);return V===null?null:new TextDecoder("utf-8").decode(V)}async function b(E,P,I=!0,O={}){const V=await v(E,P,I,O);return V===null?{}:JSON.parse(V)}async function x(E,P){const I=E.headers.get("Content-Length");I===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let O=parseInt(I??"0"),V=new Uint8Array(O),U=0;const B=E.body.getReader();async function Y(){const{done:K,value:X}=await B.read();if(K)return;const G=U+X.length;if(G>O){O=G;const te=new Uint8Array(O);te.set(V),V=te}V.set(X,U),U=G;const R=U/O*100;return P({progress:R,loaded:U,total:O}),Y()}return await Y(),V}function M(...E){return E=E.map((P,I)=>(I&&(P=P.replace(new RegExp("^/"),"")),I!==E.length-1&&(P=P.replace(new RegExp("/$"),"")),P)),E.join("/")}},"./src/utils/image.js":(e,t,r)=>{r.r(t),r.d(t,{RawImage:()=>p,load_image:()=>_});var n=r("./src/utils/core.js"),s=r("./src/utils/hub.js"),i=r("./src/env.js"),o=r("./src/utils/tensor.js"),a=r("?2b25");let l,c,u;const d=i.apis.IS_BROWSER_ENV||i.apis.IS_WEBWORKER_ENV;if(d)l=(w,y)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(w,y)},u=self.createImageBitmap,c=self.ImageData;else if(a)u=async w=>{const g=(await w.metadata()).channels,{data:v,info:b}=await w.rotate().raw().toBuffer({resolveWithObject:!0}),x=new p(new Uint8ClampedArray(v),b.width,b.height,b.channels);return g!==void 0&&g!==b.channels&&x.convert(g),x};else throw new Error("Unable to load image processing library.");const h={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},f=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class p{constructor(y,g,v,b){this.data=y,this.width=g,this.height=v,this.channels=b}get size(){return[this.width,this.height]}static async read(y){if(y instanceof p)return y;if(typeof y=="string"||y instanceof URL)return await this.fromURL(y);if(y instanceof Blob)return await this.fromBlob(y);if(typeof HTMLCanvasElement<"u"&&y instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&y instanceof OffscreenCanvas)return this.fromCanvas(y);throw new Error(`Unsupported input type: ${typeof y}`)}static fromCanvas(y){if(!d)throw new Error("fromCanvas() is only supported in browser environments.");const v=y.getContext("2d").getImageData(0,0,y.width,y.height).data;return new p(v,y.width,y.height,4)}static async fromURL(y){const g=await(0,s.getFile)(y);if(g.status!==200)throw new Error(`Unable to read image from "${y}" (${g.status} ${g.statusText})`);const v=await g.blob();return this.fromBlob(v)}static async fromBlob(y){if(d){const g=await u(y),v=l(g.width,g.height).getContext("2d");return v.drawImage(g,0,0),new this(v.getImageData(0,0,g.width,g.height).data,g.width,g.height,4)}else{const g=a(await y.arrayBuffer());return await u(g)}}static fromTensor(y,g="CHW"){if(y.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${y.dims.length} dimensions.`);if(g==="CHW")y=y.transpose(1,2,0);else if(g!=="HWC")throw new Error(`Unsupported channel format: ${g}`);if(!(y.data instanceof Uint8ClampedArray||y.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${y.type}`);switch(y.dims[2]){case 1:case 2:case 3:case 4:return new p(y.data,y.dims[1],y.dims[0],y.dims[2]);default:throw new Error(`Unsupported number of channels: ${y.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const y=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let g=0,v=0;g<this.data.length;g+=this.channels){const b=this.data[g],x=this.data[g+1],M=this.data[g+2];y[v++]=Math.round(.2989*b+.587*x+.114*M)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(y,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const y=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let g=0,v=0;g<this.data.length;++g)y[v++]=this.data[g],y[v++]=this.data[g],y[v++]=this.data[g];break;case 4:for(let g=0,v=0;g<this.data.length;g+=4)y[v++]=this.data[g],y[v++]=this.data[g+1],y[v++]=this.data[g+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(y,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const y=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let g=0,v=0;g<this.data.length;++g)y[v++]=this.data[g],y[v++]=this.data[g],y[v++]=this.data[g],y[v++]=255;break;case 3:for(let g=0,v=0;g<this.data.length;g+=3)y[v++]=this.data[g],y[v++]=this.data[g+1],y[v++]=this.data[g+2],y[v++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(y,this.width,this.height,4)}putAlpha(y){if(y.width!==this.width||y.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${y.width}x${y.height}`);if(y.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${y.channels}`);const g=this.data,v=y.data,b=this.width*this.height;if(this.channels===3){const x=new Uint8ClampedArray(b*4);for(let M=0,E=0,P=0;M<b;++M)x[P++]=g[E++],x[P++]=g[E++],x[P++]=g[E++],x[P++]=v[M];return this._update(x,this.width,this.height,4)}else if(this.channels===4){for(let x=0;x<b;++x)g[4*x+3]=v[x];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(y,g,{resample:v=2}={}){if(this.width===y&&this.height===g)return this;let b=h[v]??v;const x=(0,n.isNullishDimension)(y),M=(0,n.isNullishDimension)(g);if(x&&M)return this;if(x?y=g/this.height*this.width:M&&(g=y/this.width*this.height),d){const E=this.channels,P=this.toCanvas(),I=l(y,g).getContext("2d");return I.drawImage(P,0,0,y,g),new p(I.getImageData(0,0,y,g).data,y,g,4).convert(E)}else{let E=this.toSharp();switch(b){case"box":case"hamming":(b==="box"||b==="hamming")&&(console.warn(`Resampling method ${b} is not yet supported. Using bilinear instead.`),b="bilinear");case"nearest":case"bilinear":case"bicubic":E=E.affine([y/this.width,0,0,g/this.height],{interpolator:b});break;case"lanczos":E=E.resize({width:y,height:g,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${b} is not supported.`)}return await u(E)}}async pad([y,g,v,b]){if(y=Math.max(y,0),g=Math.max(g,0),v=Math.max(v,0),b=Math.max(b,0),y===0&&g===0&&v===0&&b===0)return this;if(d){const x=this.channels,M=this.toCanvas(),E=this.width+y+g,P=this.height+v+b,I=l(E,P).getContext("2d");return I.drawImage(M,0,0,this.width,this.height,y,v,this.width,this.height),new p(I.getImageData(0,0,E,P).data,E,P,4).convert(x)}else{const x=this.toSharp().extend({left:y,right:g,top:v,bottom:b});return await u(x)}}async crop([y,g,v,b]){if(y=Math.max(y,0),g=Math.max(g,0),v=Math.min(v,this.width-1),b=Math.min(b,this.height-1),y===0&&g===0&&v===this.width-1&&b===this.height-1)return this;const x=v-y+1,M=b-g+1;if(d){const E=this.channels,P=this.toCanvas(),I=l(x,M).getContext("2d");return I.drawImage(P,y,g,x,M,0,0,x,M),new p(I.getImageData(0,0,x,M).data,x,M,4).convert(E)}else{const E=this.toSharp().extract({left:y,top:g,width:x,height:M});return await u(E)}}async center_crop(y,g){if(this.width===y&&this.height===g)return this;const v=(this.width-y)/2,b=(this.height-g)/2;if(d){const x=this.channels,M=this.toCanvas(),E=l(y,g).getContext("2d");let P=0,I=0,O=0,V=0;return v>=0?P=v:O=-v,b>=0?I=b:V=-b,E.drawImage(M,P,I,y,g,O,V,y,g),new p(E.getImageData(0,0,y,g).data,y,g,4).convert(x)}else{let x=this.toSharp();if(v>=0&&b>=0)x=x.extract({left:Math.floor(v),top:Math.floor(b),width:y,height:g});else if(v<=0&&b<=0){const M=Math.floor(-b),E=Math.floor(-v);x=x.extend({top:M,left:E,right:y-this.width-E,bottom:g-this.height-M})}else{let M=[0,0],E=0;b<0?(M[0]=Math.floor(-b),M[1]=g-this.height-M[0]):E=Math.floor(b);let P=[0,0],I=0;v<0?(P[0]=Math.floor(-v),P[1]=y-this.width-P[0]):I=Math.floor(v),x=x.extend({top:M[0],bottom:M[1],left:P[0],right:P[1]}).extract({left:I,top:E,width:y,height:g})}return await u(x)}}async toBlob(y="image/png",g=1){if(!d)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:y,quality:g})}toTensor(y="CHW"){let g=new o.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(y!=="HWC")if(y==="CHW")g=g.permute(2,0,1);else throw new Error(`Unsupported channel format: ${y}`);return g}toCanvas(){if(!d)throw new Error("toCanvas() is only supported in browser environments.");const y=this.clone().rgba(),g=l(y.width,y.height),v=new c(y.data,y.width,y.height);return g.getContext("2d").putImageData(v,0,0),g}split(){const{data:y,width:g,height:v,channels:b}=this,x=y.constructor,M=y.length/b,E=Array.from({length:b},()=>new x(M));for(let P=0;P<M;++P){const I=b*P;for(let O=0;O<b;++O)E[O][P]=y[I+O]}return E.map(P=>new p(P,g,v,1))}_update(y,g,v,b=null){return this.data=y,this.width=g,this.height=v,b!==null&&(this.channels=b),this}clone(){return new p(this.data.slice(),this.width,this.height,this.channels)}convert(y){if(this.channels===y)return this;switch(y){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(y){if(d){if(i.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const g=y.split(".").pop().toLowerCase(),v=f.get(g)??"image/png",b=await this.toBlob(v);(0,n.saveBlob)(y,b)}else{if(i.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(y);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(d)throw new Error("toSharp() is only supported in server-side environments.");return a(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const _=p.read.bind(p)},"./src/utils/maths.js":(e,t,r)=>{r.r(t),r.d(t,{FFT:()=>_,bankers_round:()=>g,cos_sim:()=>l,dot:()=>a,dynamic_time_warping:()=>v,interpolate_data:()=>n,log_softmax:()=>o,magnitude:()=>c,max:()=>d,medianFilter:()=>w,min:()=>u,permute_data:()=>s,round:()=>y,softmax:()=>i});function n(b,[x,M,E],[P,I],O="bilinear",V=!1){const U=I/E,B=P/M,Y=new b.constructor(P*I*x),K=M*E,X=P*I;for(let G=0;G<P;++G)for(let R=0;R<I;++R){const te=G*I+R,re=(R+.5)/U-.5,L=(G+.5)/B-.5;let j=Math.floor(re),q=Math.floor(L);const ne=Math.min(j+1,E-1),me=Math.min(q+1,M-1);j=Math.max(j,0),q=Math.max(q,0);const ae=re-j,fe=L-q,Pe=(1-ae)*(1-fe),Ne=ae*(1-fe),de=(1-ae)*fe,Q=ae*fe,se=q*E,J=me*E,be=se+j,xe=se+ne,Te=J+j,Ee=J+ne;for(let $e=0;$e<x;++$e){const Ie=$e*K;Y[$e*X+te]=Pe*b[Ie+be]+Ne*b[Ie+xe]+de*b[Ie+Te]+Q*b[Ie+Ee]}}return Y}function s(b,x,M){const E=new Array(M.length),P=new Array(M.length);for(let V=M.length-1,U=1;V>=0;--V)P[V]=U,E[V]=x[M[V]],U*=E[V];const I=M.map((V,U)=>P[M.indexOf(U)]),O=new b.constructor(b.length);for(let V=0;V<b.length;++V){let U=0;for(let B=x.length-1,Y=V;B>=0;--B)U+=Y%x[B]*I[B],Y=Math.floor(Y/x[B]);O[U]=b[V]}return[O,E]}function i(b){const x=d(b)[0],M=b.map(I=>Math.exp(I-x)),E=M.reduce((I,O)=>I+O,0);return M.map(I=>I/E)}function o(b){const x=d(b)[0];let M=0;for(let I=0;I<b.length;++I)M+=Math.exp(b[I]-x);const E=Math.log(M);return b.map(I=>I-x-E)}function a(b,x){let M=0;for(let E=0;E<b.length;++E)M+=b[E]*x[E];return M}function l(b,x){const M=a(b,x),E=c(b),P=c(x);return M/(E*P)}function c(b){return Math.sqrt(b.reduce((x,M)=>x+M*M,0))}function u(b){if(b.length===0)throw Error("Array must not be empty");let x=b[0],M=0;for(let E=1;E<b.length;++E)b[E]<x&&(x=b[E],M=E);return[x,M]}function d(b){if(b.length===0)throw Error("Array must not be empty");let x=b[0],M=0;for(let E=1;E<b.length;++E)b[E]>x&&(x=b[E],M=E);return[x,M]}function h(b){return b>0&&(b&b-1)===0}class f{constructor(x){if(this.size=x|0,this.size<=1||!h(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=x<<1,this.table=new Float64Array(this.size*2);for(let E=0;E<this.table.length;E+=2){const P=Math.PI*E/this.size;this.table[E]=Math.cos(P),this.table[E+1]=-Math.sin(P)}let M=0;for(let E=1;this.size>E;E<<=1)++M;this._width=M%2===0?M-1:M,this._bitrev=new Int32Array(1<<this._width);for(let E=0;E<this._bitrev.length;++E){this._bitrev[E]=0;for(let P=0;P<this._width;P+=2){const I=this._width-P-2;this._bitrev[E]|=(E>>>P&3)<<I}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(x,M){const E=M||new Array(x.length>>>1);for(let P=0;P<x.length;P+=2)E[P>>>1]=x[P];return E}toComplexArray(x,M){const E=M||this.createComplexArray();for(let P=0;P<E.length;P+=2)E[P]=x[P>>>1],E[P+1]=0;return E}transform(x,M){if(x===M)throw new Error("Input and output buffers must be different");this._transform4(x,M,1)}realTransform(x,M){if(x===M)throw new Error("Input and output buffers must be different");this._realTransform4(x,M,1)}inverseTransform(x,M){if(x===M)throw new Error("Input and output buffers must be different");this._transform4(x,M,-1);for(let E=0;E<x.length;++E)x[E]/=this.size}_transform4(x,M,E){const P=this._csize;let O=1<<this._width,V=P/O<<1,U,B;const Y=this._bitrev;if(V===4)for(U=0,B=0;U<P;U+=V,++B){const X=Y[B];this._singleTransform2(M,x,U,X,O)}else for(U=0,B=0;U<P;U+=V,++B){const X=Y[B];this._singleTransform4(M,x,U,X,O,E)}const K=this.table;for(O>>=2;O>=2;O>>=2){V=P/O<<1;const X=V>>>2;for(U=0;U<P;U+=V){const G=U+X-1;for(let R=U,te=0;R<G;R+=2,te+=O){const re=R,L=re+X,j=L+X,q=j+X,ne=x[re],me=x[re+1],ae=x[L],fe=x[L+1],Pe=x[j],Ne=x[j+1],de=x[q],Q=x[q+1],se=K[te],J=E*K[te+1],be=ae*se-fe*J,xe=ae*J+fe*se,Te=K[2*te],Ee=E*K[2*te+1],$e=Pe*Te-Ne*Ee,Ie=Pe*Ee+Ne*Te,Ue=K[3*te],Ke=E*K[3*te+1],Je=de*Ue-Q*Ke,je=de*Ke+Q*Ue,qe=ne+$e,ot=me+Ie,ft=ne-$e,it=me-Ie,We=be+Je,Be=xe+je,De=E*(be-Je),yt=E*(xe-je);x[re]=qe+We,x[re+1]=ot+Be,x[L]=ft+yt,x[L+1]=it-De,x[j]=qe-We,x[j+1]=ot-Be,x[q]=ft-yt,x[q+1]=it+De}}}}_singleTransform2(x,M,E,P,I){const O=x[P],V=x[P+1],U=x[P+I],B=x[P+I+1];M[E]=O+U,M[E+1]=V+B,M[E+2]=O-U,M[E+3]=V-B}_singleTransform4(x,M,E,P,I,O){const V=I*2,U=I*3,B=x[P],Y=x[P+1],K=x[P+I],X=x[P+I+1],G=x[P+V],R=x[P+V+1],te=x[P+U],re=x[P+U+1],L=B+G,j=Y+R,q=B-G,ne=Y-R,me=K+te,ae=X+re,fe=O*(K-te),Pe=O*(X-re);M[E]=L+me,M[E+1]=j+ae,M[E+2]=q+Pe,M[E+3]=ne-fe,M[E+4]=L-me,M[E+5]=j-ae,M[E+6]=q-Pe,M[E+7]=ne+fe}_realTransform4(x,M,E){const P=this._csize;let O=1<<this._width,V=P/O<<1,U,B;const Y=this._bitrev;if(V===4)for(U=0,B=0;U<P;U+=V,++B){const G=Y[B];this._singleRealTransform2(M,x,U,G>>>1,O>>>1)}else for(U=0,B=0;U<P;U+=V,++B){const G=Y[B];this._singleRealTransform4(M,x,U,G>>>1,O>>>1,E)}const K=this.table;for(O>>=2;O>=2;O>>=2){V=P/O<<1;const G=V>>>1,R=G>>>1,te=R>>>1;for(U=0;U<P;U+=V)for(let re=0,L=0;re<=te;re+=2,L+=O){const j=U+re,q=j+R,ne=q+R,me=ne+R,ae=x[j],fe=x[j+1],Pe=x[q],Ne=x[q+1],de=x[ne],Q=x[ne+1],se=x[me],J=x[me+1],be=ae,xe=fe,Te=K[L],Ee=E*K[L+1],$e=Pe*Te-Ne*Ee,Ie=Pe*Ee+Ne*Te,Ue=K[2*L],Ke=E*K[2*L+1],Je=de*Ue-Q*Ke,je=de*Ke+Q*Ue,qe=K[3*L],ot=E*K[3*L+1],ft=se*qe-J*ot,it=se*ot+J*qe,We=be+Je,Be=xe+je,De=be-Je,yt=xe-je,Mt=$e+ft,Lt=Ie+it,dr=E*($e-ft),pr=E*(Ie-it);if(x[j]=We+Mt,x[j+1]=Be+Lt,x[q]=De+pr,x[q+1]=yt-dr,re===0){x[ne]=We-Mt,x[ne+1]=Be-Lt;continue}if(re===te)continue;const at=U+R-re,Kn=U+G-re;x[at]=De-E*pr,x[at+1]=-yt-E*dr,x[Kn]=We-E*Mt,x[Kn+1]=-Be+E*Lt}}const X=P>>>1;for(let G=2;G<X;G+=2)x[P-G]=x[G],x[P-G+1]=-x[G+1]}_singleRealTransform2(x,M,E,P,I){const O=x[P],V=x[P+I];M[E]=O+V,M[E+1]=0,M[E+2]=O-V,M[E+3]=0}_singleRealTransform4(x,M,E,P,I,O){const V=I*2,U=I*3,B=x[P],Y=x[P+I],K=x[P+V],X=x[P+U],G=B+K,R=B-K,te=Y+X,re=O*(Y-X);M[E]=G+te,M[E+1]=0,M[E+2]=R,M[E+3]=-re,M[E+4]=G-te,M[E+5]=0,M[E+6]=R,M[E+7]=re}}class p{constructor(x){const M=2*(x-1),E=2*(2*x-1),P=2**Math.ceil(Math.log2(E));this.bufferSize=P,this._a=M;const I=new Float64Array(E),O=new Float64Array(P);this._chirpBuffer=new Float64Array(P),this._buffer1=new Float64Array(P),this._buffer2=new Float64Array(P),this._outBuffer1=new Float64Array(P),this._outBuffer2=new Float64Array(P);const V=-2*Math.PI/x,U=Math.cos(V),B=Math.sin(V);for(let Y=0;Y<E>>1;++Y){const K=(Y+1-x)**2/2,X=Math.sqrt(U**2+B**2)**K,G=K*Math.atan2(B,U),R=2*Y;I[R]=X*Math.cos(G),I[R+1]=X*Math.sin(G),O[R]=I[R],O[R+1]=-I[R+1]}this._slicedChirpBuffer=I.subarray(M,E),this._f=new f(P>>1),this._f.transform(this._chirpBuffer,O)}_transform(x,M,E){const P=this._buffer1,I=this._buffer2,O=this._outBuffer1,V=this._outBuffer2,U=this._chirpBuffer,B=this._slicedChirpBuffer,Y=this._a;if(E)for(let K=0;K<B.length;K+=2){const X=K+1,G=K>>1,R=M[G];P[K]=R*B[K],P[X]=R*B[X]}else for(let K=0;K<B.length;K+=2){const X=K+1;P[K]=M[K]*B[K]-M[X]*B[X],P[X]=M[K]*B[X]+M[X]*B[K]}this._f.transform(O,P);for(let K=0;K<U.length;K+=2){const X=K+1;I[K]=O[K]*U[K]-O[X]*U[X],I[X]=O[K]*U[X]+O[X]*U[K]}this._f.inverseTransform(V,I);for(let K=0;K<V.length;K+=2){const X=V[K+Y],G=V[K+Y+1],R=B[K],te=B[K+1];x[K]=X*R-G*te,x[K+1]=X*te+G*R}}transform(x,M){this._transform(x,M,!1)}realTransform(x,M){this._transform(x,M,!0)}}class _{constructor(x){this.fft_length=x,this.isPowerOfTwo=h(x),this.isPowerOfTwo?(this.fft=new f(x),this.outputBufferSize=2*x):(this.fft=new p(x),this.outputBufferSize=this.fft.bufferSize)}realTransform(x,M){this.fft.realTransform(x,M)}transform(x,M){this.fft.transform(x,M)}}function w(b,x){if(x%2===0||x<=0)throw new Error("Window size must be a positive odd number");const M=new b.constructor(b.length),E=new b.constructor(x),P=Math.floor(x/2);for(let I=0;I<b.length;++I){let O=0;for(let V=-P;V<=P;++V){let U=I+V;U<0?U=Math.abs(U):U>=b.length&&(U=2*(b.length-1)-U),E[O++]=b[U]}E.sort(),M[I]=E[P]}return M}function y(b,x){const M=Math.pow(10,x);return Math.round(b*M)/M}function g(b){const x=Math.round(b);return Math.abs(b)%1===.5?x%2===0?x:x-1:x}function v(b){const x=b.length,M=b[0].length,E=[x+1,M+1],P=Array.from({length:E[0]},()=>Array(E[1]).fill(1/0));P[0][0]=0;const I=Array.from({length:E[0]},()=>Array(E[1]).fill(-1));for(let Y=1;Y<E[1];++Y)for(let K=1;K<E[0];++K){const X=P[K-1][Y-1],G=P[K-1][Y],R=P[K][Y-1];let te,re;X<G&&X<R?(te=X,re=0):G<X&&G<R?(te=G,re=1):(te=R,re=2),P[K][Y]=b[K-1][Y-1]+te,I[K][Y]=re}for(let Y=0;Y<E[1];++Y)I[0][Y]=2;for(let Y=0;Y<E[0];++Y)I[Y][0]=1;let O=x,V=M,U=[],B=[];for(;O>0||V>0;)switch(U.push(O-1),B.push(V-1),I[O][V]){case 0:--O,--V;break;case 1:--O;break;case 2:--V;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${O}, ${V}]. Please file a bug report.`)}return U.reverse(),B.reverse(),[U,B]}},"./src/utils/tensor.js":(e,t,r)=>{r.r(t),r.d(t,{DataTypeMap:()=>o,Tensor:()=>a,cat:()=>M,full:()=>B,full_like:()=>Y,interpolate:()=>u,interpolate_4d:()=>d,layer_norm:()=>g,matmul:()=>h,mean:()=>O,mean_pooling:()=>y,ones:()=>K,ones_like:()=>X,permute:()=>c,quantize_embeddings:()=>re,rand:()=>te,rfft:()=>f,slice:()=>w,stack:()=>E,std_mean:()=>I,topk:()=>p,zeros:()=>G,zeros_like:()=>R});var n=r("./src/utils/maths.js"),s=r("./src/backends/onnx.js"),i=r("./src/ops/registry.js");const o=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class a{constructor(...j){oe(this,"ort_tensor");return(0,s.isONNXTensor)(j[0])?this.ort_tensor=j[0]:this.ort_tensor=new s.Tensor(j[0],j[1],j[2]),new Proxy(this,{get:(q,ne)=>{if(typeof ne=="string"){let me=Number(ne);if(Number.isInteger(me))return q._getitem(me)}return q[ne]},set:(q,ne,me)=>q[ne]=me})}get dims(){return this.ort_tensor.dims}set dims(j){this.ort_tensor.dims=j}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[j,...q]=this.dims;if(q.length>0){const ne=q.reduce((me,ae)=>me*ae);for(let me=0;me<j;++me)yield this._subarray(me,ne,q)}else yield*this.data}_getitem(j){const[q,...ne]=this.dims;if(j=x(j,q),ne.length>0){const me=ne.reduce((ae,fe)=>ae*fe);return this._subarray(j,me,ne)}else return new a(this.type,[this.data[j]],ne)}indexOf(j){const q=this.data;for(let ne=0;ne<q.length;++ne)if(q[ne]==j)return ne;return-1}_subarray(j,q,ne){const me=j*q,ae=(j+1)*q,fe="subarray"in this.data?this.data.subarray(me,ae):this.data.slice(me,ae);return new a(this.type,fe,ne)}item(){const j=this.data;if(j.length!==1)throw new Error(`a Tensor with ${j.length} elements cannot be converted to Scalar`);return j[0]}tolist(){return l(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const j=this.data;for(let q=0;q<j.length;++q)j[q]=1/(1+Math.exp(-j[q]));return this}map(j){return this.clone().map_(j)}map_(j){const q=this.data;for(let ne=0;ne<q.length;++ne)q[ne]=j(q[ne],ne,q);return this}mul(j){return this.clone().mul_(j)}mul_(j){const q=this.data;for(let ne=0;ne<q.length;++ne)q[ne]*=j;return this}div(j){return this.clone().div_(j)}div_(j){const q=this.data;for(let ne=0;ne<q.length;++ne)q[ne]/=j;return this}add(j){return this.clone().add_(j)}add_(j){const q=this.data;for(let ne=0;ne<q.length;++ne)q[ne]+=j;return this}sub(j){return this.clone().sub_(j)}sub_(j){const q=this.data;for(let ne=0;ne<q.length;++ne)q[ne]-=j;return this}clone(){return new a(this.type,this.data.slice(),this.dims.slice())}slice(...j){const q=[],ne=[];for(let de=0;de<this.dims.length;++de){let Q=j[de];if(Q==null)ne.push([0,this.dims[de]]),q.push(this.dims[de]);else if(typeof Q=="number")Q=x(Q,this.dims[de],de),ne.push([Q,Q+1]);else if(Array.isArray(Q)&&Q.length===2){let[se,J]=Q;if(se=se===null?0:x(se,this.dims[de],de,!1),J=J===null?this.dims[de]:x(J,this.dims[de],de,!1),se>J)throw new Error(`Invalid slice: ${Q}`);const be=[Math.max(se,0),Math.min(J,this.dims[de])];ne.push(be),q.push(be[1]-be[0])}else throw new Error(`Invalid slice: ${Q}`)}const me=ne.map(([de,Q])=>Q-de),ae=me.reduce((de,Q)=>de*Q),fe=this.data,Pe=new fe.constructor(ae),Ne=this.stride();for(let de=0;de<ae;++de){let Q=0;for(let se=me.length-1,J=de;se>=0;--se){const be=me[se];Q+=(J%be+ne[se][0])*Ne[se],J=Math.floor(J/be)}Pe[de]=fe[Q]}return new a(this.type,Pe,q)}permute(...j){return c(this,j)}transpose(...j){return this.permute(...j)}sum(j=null,q=!1){return this.norm(1,j,q)}norm(j="fro",q=null,ne=!1){if(j==="fro")j=2;else if(typeof j=="string")throw Error(`Unsupported norm: ${j}`);const me=this.data,ae=(de,Q)=>de+Q**j;if(q===null){const de=me.reduce(ae,0)**(1/j);return new a(this.type,[de],[])}const[fe,Pe,Ne]=P(ae,this,q,ne);if(j!==1)for(let de=0;de<Pe.length;++de)Pe[de]=Pe[de]**(1/j);return new a(fe,Pe,Ne)}normalize_(j=2,q=1){q=x(q,this.dims.length);const ne=this.norm(j,q,!0),me=this.data,ae=ne.data;for(let fe=0;fe<me.length;++fe){let Pe=0;for(let Ne=this.dims.length-1,de=fe,Q=1;Ne>=0;--Ne){const se=this.dims[Ne];if(Ne!==q){const J=de%se;Pe+=J*Q,Q*=this.dims[Ne]}de=Math.floor(de/se)}me[fe]/=ae[Pe]}return this}normalize(j=2,q=1){return this.clone().normalize_(j,q)}stride(){return V(this.dims)}squeeze(j=null){return new a(this.type,this.data,v(this.dims,j))}squeeze_(j=null){return this.dims=v(this.dims,j),this}unsqueeze(j=null){return new a(this.type,this.data,b(this.dims,j))}unsqueeze_(j=null){return this.dims=b(this.dims,j),this}flatten_(j=0,q=-1){q=(q+this.dims.length)%this.dims.length;let ne=this.dims.slice(0,j),me=this.dims.slice(j,q+1),ae=this.dims.slice(q+1);return this.dims=[...ne,me.reduce((fe,Pe)=>fe*Pe,1),...ae],this}flatten(j=0,q=-1){return this.clone().flatten_(j,q)}view(...j){let q=-1;for(let me=0;me<j.length;++me)if(j[me]===-1){if(q!==-1)throw new Error("Only one dimension can be inferred");q=me}const ne=this.data;if(q!==-1){const me=j.reduce((ae,fe,Pe)=>Pe!==q?ae*fe:ae,1);j[q]=ne.length/me}return new a(this.type,ne,j)}neg_(){const j=this.data;for(let q=0;q<j.length;++q)j[q]=-j[q];return this}neg(){return this.clone().neg_()}gt(j){const q=new Uint8Array(this.data.length),ne=this.data;for(let me=0;me<ne.length;++me)q[me]=ne[me]>j?1:0;return new a("bool",q,this.dims)}lt(j){const q=new Uint8Array(this.data.length),ne=this.data;for(let me=0;me<ne.length;++me)q[me]=ne[me]<j?1:0;return new a("bool",q,this.dims)}clamp_(j,q){const ne=this.data;for(let me=0;me<ne.length;++me)ne[me]=Math.min(Math.max(ne[me],j),q);return this}clamp(j,q){return this.clone().clamp_(j,q)}round_(){const j=this.data;for(let q=0;q<j.length;++q)j[q]=Math.round(j[q]);return this}round(){return this.clone().round_()}mean(j=null,q=!1){return O(this,j,q)}min(j=null,q=!1){if(j===null){const fe=(0,n.min)(this.data)[0];return new a(this.type,[fe],[])}const[ne,me,ae]=P((fe,Pe)=>Math.min(fe,Pe),this,j,q,1/0);return new a(ne,me,ae)}max(j=null,q=!1){if(j===null){const fe=(0,n.max)(this.data)[0];return new a(this.type,[fe],[])}const[ne,me,ae]=P((fe,Pe)=>Math.max(fe,Pe),this,j,q,-1/0);return new a(ne,me,ae)}argmin(j=null,q=!1){if(j!==null)throw new Error("`dim !== null` not yet implemented.");const ne=(0,n.min)(this.data)[1];return new a("int64",[BigInt(ne)],[])}argmax(j=null,q=!1){if(j!==null)throw new Error("`dim !== null` not yet implemented.");const ne=(0,n.max)(this.data)[1];return new a("int64",[BigInt(ne)],[])}to(j){if(this.type===j)return this;if(!o.hasOwnProperty(j))throw new Error(`Unsupported type: ${j}`);let q;const ne=["int64","uint64"].includes(this.type),me=["int64","uint64"].includes(j);return ne&&!me?q=Number:!ne&&me&&(q=BigInt),new a(j,o[j].from(this.data,q),this.dims)}}function l(L,j){const q=L.length,ne=j.reduce((ae,fe)=>ae*fe);if(q!==ne)throw Error(`cannot reshape array of size ${q} into shape (${j})`);let me=L;for(let ae=j.length-1;ae>=0;ae--)me=me.reduce((fe,Pe)=>{let Ne=fe[fe.length-1];return Ne.length<j[ae]?Ne.push(Pe):fe.push([Pe]),fe},[[]]);return me[0]}function c(L,j){const[q,ne]=(0,n.permute_data)(L.data,L.dims,j);return new a(L.type,q,ne)}function u(L,[j,q],ne="bilinear",me=!1){const ae=L.dims.at(-3)??1,fe=L.dims.at(-2),Pe=L.dims.at(-1);let Ne=(0,n.interpolate_data)(L.data,[ae,fe,Pe],[j,q],ne,me);return new a(L.type,Ne,[ae,j,q])}async function d(L,{size:j=null,mode:q="bilinear"}={}){if(L.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!j)throw new Error("`interpolate_4d` requires a `size` argument.");let ne;if(j.length===2)ne=[...L.dims.slice(0,2),...j];else if(j.length===3)ne=[L.dims[0],...j];else if(j.length===4)ne=j;else throw new Error("`size` must be of length 2, 3, or 4.");let me;if(q==="nearest")me=await i.TensorOpRegistry.nearest_interpolate_4d;else if(q==="bilinear")me=await i.TensorOpRegistry.bilinear_interpolate_4d;else if(q==="bicubic")me=await i.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${q}`);const ae=new a("int64",new BigInt64Array(ne.map(BigInt)),[ne.length]);return await me({x:L,s:ae})}async function h(L,j){return await(await i.TensorOpRegistry.matmul)({a:L,b:j})}async function f(L,j){return await(await i.TensorOpRegistry.rfft)({x:L,a:j})}async function p(L,j){const q=await i.TensorOpRegistry.top_k;return j==null?j=L.dims.at(-1):j=Math.min(j,L.dims.at(-1)),await q({x:L,k:new a("int64",[BigInt(j)],[1])})}const _=L=>new a("int64",L,[L.length]);async function w(L,j,q,ne,me){return await(await i.TensorOpRegistry.slice)({x:L,s:_(j),e:_(q),a:_(ne),t:_(me??new Array(ne.length).fill(1))})}function y(L,j){const q=L.data,ne=j.data,me=[L.dims[0],L.dims[2]],ae=new q.constructor(me[0]*me[1]),[fe,Pe,Ne]=L.dims;let de=0;for(let Q=0;Q<fe;++Q){const se=Q*Ne*Pe;for(let J=0;J<Ne;++J){let be=0,xe=0;const Te=Q*Pe,Ee=se+J;for(let Ie=0;Ie<Pe;++Ie){const Ue=Number(ne[Te+Ie]);xe+=Ue,be+=q[Ee+Ie*Ne]*Ue}const $e=be/xe;ae[de++]=$e}}return new a(L.type,ae,me)}function g(L,j,{eps:q=1e-5}={}){if(L.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[ne,me]=L.dims;if(j.length!==1&&j[0]!==me)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[ae,fe]=I(L,1,0,!0),Pe=ae.data,Ne=fe.data,de=L.data,Q=new de.constructor(de.length);for(let se=0;se<ne;++se){const J=se*me;for(let be=0;be<me;++be){const xe=J+be;Q[xe]=(de[xe]-Ne[se])/(Pe[se]+q)}}return new a(L.type,Q,L.dims)}function v(L,j){return L=L.slice(),j===null?L=L.filter(q=>q!==1):typeof j=="number"?L[j]===1&&L.splice(j,1):Array.isArray(j)&&(L=L.filter((q,ne)=>q!==1||!j.includes(ne))),L}function b(L,j){return j=x(j,L.length+1),L=L.slice(),L.splice(j,0,1),L}function x(L,j,q=null,ne=!0){if(L<-j||L>=j){if(ne)throw new Error(`IndexError: index ${L} is out of bounds for dimension${q===null?"":" "+q} with size ${j}`);return L<-j?0:j}return L<0&&(L=(L%j+j)%j),L}function M(L,j=0){j=x(j,L[0].dims.length);const q=L[0].dims.slice();q[j]=L.reduce((fe,Pe)=>fe+Pe.dims[j],0);const ne=q.reduce((fe,Pe)=>fe*Pe,1),me=new L[0].data.constructor(ne),ae=L[0].type;if(j===0){let fe=0;for(const Pe of L){const Ne=Pe.data;me.set(Ne,fe),fe+=Ne.length}}else{let fe=0;for(let Pe=0;Pe<L.length;++Pe){const{data:Ne,dims:de}=L[Pe];for(let Q=0;Q<Ne.length;++Q){let se=0;for(let J=de.length-1,be=Q,xe=1;J>=0;--J){const Te=de[J];let Ee=be%Te;J===j&&(Ee+=fe),se+=Ee*xe,xe*=q[J],be=Math.floor(be/Te)}me[se]=Ne[Q]}fe+=de[j]}}return new a(ae,me,q)}function E(L,j=0){return M(L.map(q=>q.unsqueeze(j)),j)}function P(L,j,q=null,ne=!1,me=null){const ae=j.data,fe=j.dims;q=x(q,fe.length);const Pe=fe.slice();Pe[q]=1;const Ne=new ae.constructor(ae.length/fe[q]);me!==null&&Ne.fill(me);for(let de=0;de<ae.length;++de){let Q=0;for(let se=fe.length-1,J=de,be=1;se>=0;--se){const xe=fe[se];if(se!==q){const Te=J%xe;Q+=Te*be,be*=Pe[se]}J=Math.floor(J/xe)}Ne[Q]=L(Ne[Q],ae[de],de,Q)}return ne||Pe.splice(q,1),[j.type,Ne,Pe]}function I(L,j=null,q=1,ne=!1){const me=L.data,ae=L.dims;if(j===null){const be=me.reduce(($e,Ie)=>$e+Ie,0)/me.length,xe=Math.sqrt(me.reduce(($e,Ie)=>$e+(Ie-be)**2,0)/(me.length-q)),Te=new a(L.type,[be],[]);return[new a(L.type,[xe],[]),Te]}j=x(j,ae.length);const fe=O(L,j,ne),Pe=fe.data,[Ne,de,Q]=P((J,be,xe,Te)=>J+(be-Pe[Te])**2,L,j,ne);for(let J=0;J<de.length;++J)de[J]=Math.sqrt(de[J]/(ae[j]-q));return[new a(Ne,de,Q),fe]}function O(L,j=null,q=!1){const ne=L.dims,me=L.data;if(j===null){const Ne=me.reduce((de,Q)=>de+Q,0);return new a(L.type,[Ne/me.length],[])}j=x(j,ne.length);const[ae,fe,Pe]=P((Ne,de)=>Ne+de,L,j,q);if(ne[j]!==1)for(let Ne=0;Ne<fe.length;++Ne)fe[Ne]/=ne[j];return new a(ae,fe,Pe)}function V(L){const j=new Array(L.length);for(let q=L.length-1,ne=1;q>=0;--q)j[q]=ne,ne*=L[q];return j}function U(L,j,q,ne){const me=L.reduce((ae,fe)=>ae*fe,1);return new a(q,new ne(me).fill(j),L)}function B(L,j){let q,ne;if(typeof j=="number")q="float32",ne=Float32Array;else if(typeof j=="bigint")q="int64",ne=BigInt64Array;else if(typeof j=="boolean")q="bool",ne=Uint8Array;else throw new Error(`Unsupported data type: ${typeof j}`);return U(L,j,q,ne)}function Y(L,j){return B(L.dims,j)}function K(L){return U(L,1n,"int64",BigInt64Array)}function X(L){return K(L.dims)}function G(L){return U(L,0n,"int64",BigInt64Array)}function R(L){return G(L.dims)}function te(L){const j=L.reduce((q,ne)=>q*ne,1);return new a("float32",Float32Array.from({length:j},()=>Math.random()),L)}function re(L,j){if(L.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(L.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(j))throw new Error("The precision must be either 'binary' or 'ubinary'");const q=j==="binary",ne=q?"int8":"uint8",me=q?Int8Array:Uint8Array,ae=L.data,fe=new me(ae.length/8);for(let Pe=0;Pe<ae.length;++Pe){const Ne=ae[Pe]>0?1:0,de=Math.floor(Pe/8),Q=Pe%8;fe[de]|=Ne<<7-Q,q&&Q===0&&(fe[de]-=128)}return new a(ne,fe,[L.dims[0],L.dims[1]/8])}},"./src/utils/video.js":(e,t,r)=>{r.r(t),r.d(t,{RawVideo:()=>o,RawVideoFrame:()=>i,load_video:()=>a});var n=r("./src/utils/image.js"),s=r("./src/env.js");class i{constructor(c,u){this.image=c,this.timestamp=u}}class o{constructor(c,u){c.length>0&&c[0]instanceof n.RawImage&&(c=c.map((d,h)=>new i(d,(h+1)/(c.length+1)*u))),this.frames=c,this.duration=u}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function a(l,{num_frames:c=null,fps:u=null}={}){if(!s.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(c==null&&u==null)throw new Error("Either num_frames or fps must be provided.");const d=[],h=document.createElement("video");if(h.crossOrigin="anonymous",h.muted=!0,typeof l=="string")h.src=l;else if(l instanceof Blob)h.src=URL.createObjectURL(l);else if(l instanceof HTMLVideoElement)h.src=l.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(v=>h.onloadedmetadata=v),h.seekable.start(0)===h.seekable.end(0)){const b=await(await fetch(h.src)).blob();h.src=URL.createObjectURL(b),await new Promise(x=>h.onloadedmetadata=x)}const f=h.duration;let p,_;c!=null?(p=c,_=c===1?0:f/(c-1)):(_=1/u,p=Math.floor(f/_));let w=[];for(let v=0;v<p;++v)w.push(c===1?f/2:v*_);const y=document.createElement("canvas");y.width=h.videoWidth,y.height=h.videoHeight;const g=y.getContext("2d",{willReadFrequently:!0});for(const v of w){h.currentTime=v,await new Promise(E=>{h.onseeked=E}),g.drawImage(h,0,0,y.width,y.height);const b=g.getImageData(0,0,y.width,y.height),x=new n.RawImage(b.data,y.width,y.height,4),M=new i(x,v);d.push(M)}return h.remove(),new o(d,f)}}},fR={};function or(e){var t=fR[e];if(t!==void 0)return t.exports;var r=fR[e]={exports:{}};return vce[e](r,r.exports,or),r.exports}(()=>{var e=Object.getPrototypeOf?r=>Object.getPrototypeOf(r):r=>r.__proto__,t;or.t=function(r,n){if(n&1&&(r=this(r)),n&8||typeof r=="object"&&r&&(n&4&&r.__esModule||n&16&&typeof r.then=="function"))return r;var s=Object.create(null);or.r(s);var i={};t=t||[null,e({}),e([]),e(e)];for(var o=n&2&&r;typeof o=="object"&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach(a=>i[a]=()=>r[a]);return i.default=()=>r,or.d(s,i),s}})();or.d=(e,t)=>{for(var r in t)or.o(t,r)&&!or.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})};or.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);or.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var S={};(()=>{/*!*****************************!*\
  !*** ./src/transformers.js ***!
  \*****************************/or.r(S),or.d(S,{ASTFeatureExtractor:()=>d.ASTFeatureExtractor,ASTForAudioClassification:()=>r.ASTForAudioClassification,ASTModel:()=>r.ASTModel,ASTPreTrainedModel:()=>r.ASTPreTrainedModel,AlbertForMaskedLM:()=>r.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>r.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>r.AlbertForSequenceClassification,AlbertModel:()=>r.AlbertModel,AlbertPreTrainedModel:()=>r.AlbertPreTrainedModel,AlbertTokenizer:()=>n.AlbertTokenizer,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>s.AutoConfig,AutoFeatureExtractor:()=>h.AutoFeatureExtractor,AutoImageProcessor:()=>_.AutoImageProcessor,AutoModel:()=>r.AutoModel,AutoModelForAudioClassification:()=>r.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>r.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>r.AutoModelForAudioTextToText,AutoModelForCTC:()=>r.AutoModelForCTC,AutoModelForCausalLM:()=>r.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>r.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>r.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>r.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>r.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>r.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>r.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>r.AutoModelForImageTextToText,AutoModelForImageToImage:()=>r.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>r.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>r.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>r.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>r.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>r.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>r.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>r.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>r.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>r.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>r.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>r.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>r.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>r.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>r.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>r.AutoModelForVision2Seq,AutoModelForXVector:()=>r.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>r.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>g.AutoProcessor,AutoTokenizer:()=>n.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>t.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>r.BartForConditionalGeneration,BartForSequenceClassification:()=>r.BartForSequenceClassification,BartModel:()=>r.BartModel,BartPretrainedModel:()=>r.BartPretrainedModel,BartTokenizer:()=>n.BartTokenizer,BaseModelOutput:()=>r.BaseModelOutput,BaseStreamer:()=>v.BaseStreamer,BeitFeatureExtractor:()=>p.BeitFeatureExtractor,BeitForImageClassification:()=>r.BeitForImageClassification,BeitModel:()=>r.BeitModel,BeitPreTrainedModel:()=>r.BeitPreTrainedModel,BertForMaskedLM:()=>r.BertForMaskedLM,BertForQuestionAnswering:()=>r.BertForQuestionAnswering,BertForSequenceClassification:()=>r.BertForSequenceClassification,BertForTokenClassification:()=>r.BertForTokenClassification,BertModel:()=>r.BertModel,BertPreTrainedModel:()=>r.BertPreTrainedModel,BertTokenizer:()=>n.BertTokenizer,BitImageProcessor:()=>p.BitImageProcessor,BlenderbotForConditionalGeneration:()=>r.BlenderbotForConditionalGeneration,BlenderbotModel:()=>r.BlenderbotModel,BlenderbotPreTrainedModel:()=>r.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>r.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>r.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>r.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>n.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>n.BlenderbotTokenizer,BloomForCausalLM:()=>r.BloomForCausalLM,BloomModel:()=>r.BloomModel,BloomPreTrainedModel:()=>r.BloomPreTrainedModel,BloomTokenizer:()=>n.BloomTokenizer,CLIPFeatureExtractor:()=>p.CLIPFeatureExtractor,CLIPImageProcessor:()=>p.CLIPImageProcessor,CLIPModel:()=>r.CLIPModel,CLIPPreTrainedModel:()=>r.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>r.CLIPSegForImageSegmentation,CLIPSegModel:()=>r.CLIPSegModel,CLIPSegPreTrainedModel:()=>r.CLIPSegPreTrainedModel,CLIPTextModel:()=>r.CLIPTextModel,CLIPTextModelWithProjection:()=>r.CLIPTextModelWithProjection,CLIPTokenizer:()=>n.CLIPTokenizer,CLIPVisionModel:()=>r.CLIPVisionModel,CLIPVisionModelWithProjection:()=>r.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>r.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>r.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>r.CamembertForSequenceClassification,CamembertForTokenClassification:()=>r.CamembertForTokenClassification,CamembertModel:()=>r.CamembertModel,CamembertPreTrainedModel:()=>r.CamembertPreTrainedModel,CamembertTokenizer:()=>n.CamembertTokenizer,CausalLMOutput:()=>r.CausalLMOutput,CausalLMOutputWithPast:()=>r.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>p.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>r.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>r.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>r.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>d.ClapFeatureExtractor,ClapModel:()=>r.ClapModel,ClapPreTrainedModel:()=>r.ClapPreTrainedModel,ClapTextModelWithProjection:()=>r.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>x.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>r.CodeGenForCausalLM,CodeGenModel:()=>r.CodeGenModel,CodeGenPreTrainedModel:()=>r.CodeGenPreTrainedModel,CodeGenTokenizer:()=>n.CodeGenTokenizer,CodeLlamaTokenizer:()=>n.CodeLlamaTokenizer,CohereForCausalLM:()=>r.CohereForCausalLM,CohereModel:()=>r.CohereModel,CoherePreTrainedModel:()=>r.CoherePreTrainedModel,CohereTokenizer:()=>n.CohereTokenizer,ConvBertForMaskedLM:()=>r.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>r.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>r.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>r.ConvBertForTokenClassification,ConvBertModel:()=>r.ConvBertModel,ConvBertPreTrainedModel:()=>r.ConvBertPreTrainedModel,ConvBertTokenizer:()=>n.ConvBertTokenizer,ConvNextFeatureExtractor:()=>p.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>r.ConvNextForImageClassification,ConvNextImageProcessor:()=>p.ConvNextImageProcessor,ConvNextModel:()=>r.ConvNextModel,ConvNextPreTrainedModel:()=>r.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>r.ConvNextV2ForImageClassification,ConvNextV2Model:()=>r.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>r.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>r.DFineForObjectDetection,DFineModel:()=>r.DFineModel,DFinePreTrainedModel:()=>r.DFinePreTrainedModel,DPTFeatureExtractor:()=>p.DPTFeatureExtractor,DPTForDepthEstimation:()=>r.DPTForDepthEstimation,DPTImageProcessor:()=>p.DPTImageProcessor,DPTModel:()=>r.DPTModel,DPTPreTrainedModel:()=>r.DPTPreTrainedModel,DacDecoderModel:()=>r.DacDecoderModel,DacDecoderOutput:()=>r.DacDecoderOutput,DacEncoderModel:()=>r.DacEncoderModel,DacEncoderOutput:()=>r.DacEncoderOutput,DacFeatureExtractor:()=>d.DacFeatureExtractor,DacModel:()=>r.DacModel,DacPreTrainedModel:()=>r.DacPreTrainedModel,DataTypeMap:()=>l.DataTypeMap,DebertaForMaskedLM:()=>r.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>r.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>r.DebertaForSequenceClassification,DebertaForTokenClassification:()=>r.DebertaForTokenClassification,DebertaModel:()=>r.DebertaModel,DebertaPreTrainedModel:()=>r.DebertaPreTrainedModel,DebertaTokenizer:()=>n.DebertaTokenizer,DebertaV2ForMaskedLM:()=>r.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>r.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>r.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>r.DebertaV2ForTokenClassification,DebertaV2Model:()=>r.DebertaV2Model,DebertaV2PreTrainedModel:()=>r.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>n.DebertaV2Tokenizer,DecisionTransformerModel:()=>r.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>r.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>p.DeiTFeatureExtractor,DeiTForImageClassification:()=>r.DeiTForImageClassification,DeiTImageProcessor:()=>p.DeiTImageProcessor,DeiTModel:()=>r.DeiTModel,DeiTPreTrainedModel:()=>r.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>r.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>r.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>r.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>r.DepthProPreTrainedModel,DetrFeatureExtractor:()=>p.DetrFeatureExtractor,DetrForObjectDetection:()=>r.DetrForObjectDetection,DetrForSegmentation:()=>r.DetrForSegmentation,DetrImageProcessor:()=>p.DetrImageProcessor,DetrModel:()=>r.DetrModel,DetrObjectDetectionOutput:()=>r.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>r.DetrPreTrainedModel,DetrSegmentationOutput:()=>r.DetrSegmentationOutput,Dinov2ForImageClassification:()=>r.Dinov2ForImageClassification,Dinov2Model:()=>r.Dinov2Model,Dinov2PreTrainedModel:()=>r.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>r.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>r.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>r.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>r.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>r.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>r.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>r.DistilBertForTokenClassification,DistilBertModel:()=>r.DistilBertModel,DistilBertPreTrainedModel:()=>r.DistilBertPreTrainedModel,DistilBertTokenizer:()=>n.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>p.DonutFeatureExtractor,DonutImageProcessor:()=>p.DonutImageProcessor,DonutSwinModel:()=>r.DonutSwinModel,DonutSwinPreTrainedModel:()=>r.DonutSwinPreTrainedModel,EfficientNetForImageClassification:()=>r.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>p.EfficientNetImageProcessor,EfficientNetModel:()=>r.EfficientNetModel,EfficientNetPreTrainedModel:()=>r.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>r.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>r.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>r.ElectraForSequenceClassification,ElectraForTokenClassification:()=>r.ElectraForTokenClassification,ElectraModel:()=>r.ElectraModel,ElectraPreTrainedModel:()=>r.ElectraPreTrainedModel,ElectraTokenizer:()=>n.ElectraTokenizer,EncodecFeatureExtractor:()=>d.EncodecFeatureExtractor,EosTokenCriteria:()=>b.EosTokenCriteria,EsmForMaskedLM:()=>r.EsmForMaskedLM,EsmForSequenceClassification:()=>r.EsmForSequenceClassification,EsmForTokenClassification:()=>r.EsmForTokenClassification,EsmModel:()=>r.EsmModel,EsmPreTrainedModel:()=>r.EsmPreTrainedModel,EsmTokenizer:()=>n.EsmTokenizer,ExaoneForCausalLM:()=>r.ExaoneForCausalLM,ExaoneModel:()=>r.ExaoneModel,ExaonePreTrainedModel:()=>r.ExaonePreTrainedModel,FFT:()=>c.FFT,FalconForCausalLM:()=>r.FalconForCausalLM,FalconModel:()=>r.FalconModel,FalconPreTrainedModel:()=>r.FalconPreTrainedModel,FalconTokenizer:()=>n.FalconTokenizer,FastViTForImageClassification:()=>r.FastViTForImageClassification,FastViTModel:()=>r.FastViTModel,FastViTPreTrainedModel:()=>r.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>u.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>r.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>r.Florence2PreTrainedModel,Florence2Processor:()=>y.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>x.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>x.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>p.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>r.GLPNForDepthEstimation,GLPNModel:()=>r.GLPNModel,GLPNPreTrainedModel:()=>r.GLPNPreTrainedModel,GPT2LMHeadModel:()=>r.GPT2LMHeadModel,GPT2Model:()=>r.GPT2Model,GPT2PreTrainedModel:()=>r.GPT2PreTrainedModel,GPT2Tokenizer:()=>n.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>r.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>r.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>r.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>r.GPTJForCausalLM,GPTJModel:()=>r.GPTJModel,GPTJPreTrainedModel:()=>r.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>r.GPTNeoForCausalLM,GPTNeoModel:()=>r.GPTNeoModel,GPTNeoPreTrainedModel:()=>r.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>r.GPTNeoXForCausalLM,GPTNeoXModel:()=>r.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>r.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>n.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>r.Gemma2ForCausalLM,Gemma2Model:()=>r.Gemma2Model,Gemma2PreTrainedModel:()=>r.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>r.Gemma3ForCausalLM,Gemma3Model:()=>r.Gemma3Model,Gemma3PreTrainedModel:()=>r.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>d.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>r.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>r.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>y.Gemma3nProcessor,GemmaForCausalLM:()=>r.GemmaForCausalLM,GemmaModel:()=>r.GemmaModel,GemmaPreTrainedModel:()=>r.GemmaPreTrainedModel,GemmaTokenizer:()=>n.GemmaTokenizer,GlmForCausalLM:()=>r.GlmForCausalLM,GlmModel:()=>r.GlmModel,GlmPreTrainedModel:()=>r.GlmPreTrainedModel,GraniteForCausalLM:()=>r.GraniteForCausalLM,GraniteModel:()=>r.GraniteModel,GranitePreTrainedModel:()=>r.GranitePreTrainedModel,Grok1Tokenizer:()=>n.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>r.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>p.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>r.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>y.GroundingDinoProcessor,GroupViTModel:()=>r.GroupViTModel,GroupViTPreTrainedModel:()=>r.GroupViTPreTrainedModel,HeliumForCausalLM:()=>r.HeliumForCausalLM,HeliumModel:()=>r.HeliumModel,HeliumPreTrainedModel:()=>r.HeliumPreTrainedModel,HerbertTokenizer:()=>n.HerbertTokenizer,HieraForImageClassification:()=>r.HieraForImageClassification,HieraModel:()=>r.HieraModel,HieraPreTrainedModel:()=>r.HieraPreTrainedModel,HubertForCTC:()=>r.HubertForCTC,HubertForSequenceClassification:()=>r.HubertForSequenceClassification,HubertModel:()=>r.HubertModel,HubertPreTrainedModel:()=>r.HubertPreTrainedModel,IJepaForImageClassification:()=>r.IJepaForImageClassification,IJepaModel:()=>r.IJepaModel,IJepaPreTrainedModel:()=>r.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>r.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>p.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>r.Idefics3PreTrainedModel,Idefics3Processor:()=>y.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>d.ImageFeatureExtractor,ImageMattingOutput:()=>r.ImageMattingOutput,ImageProcessor:()=>f.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>b.InterruptableStoppingCriteria,JAISLMHeadModel:()=>r.JAISLMHeadModel,JAISModel:()=>r.JAISModel,JAISPreTrainedModel:()=>r.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>p.JinaCLIPImageProcessor,JinaCLIPModel:()=>r.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>r.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>y.JinaCLIPProcessor,JinaCLIPTextModel:()=>r.JinaCLIPTextModel,JinaCLIPVisionModel:()=>r.JinaCLIPVisionModel,LiteWhisperForConditionalGeneration:()=>r.LiteWhisperForConditionalGeneration,LlamaForCausalLM:()=>r.LlamaForCausalLM,LlamaModel:()=>r.LlamaModel,LlamaPreTrainedModel:()=>r.LlamaPreTrainedModel,LlamaTokenizer:()=>n.LlamaTokenizer,LlavaForConditionalGeneration:()=>r.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>r.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>p.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>r.LlavaPreTrainedModel,LlavaProcessor:()=>y.LlavaProcessor,LlavaQwen2ForCausalLM:()=>r.LlavaQwen2ForCausalLM,LogitsProcessor:()=>x.LogitsProcessor,LogitsProcessorList:()=>x.LogitsProcessorList,LogitsWarper:()=>x.LogitsWarper,LongT5ForConditionalGeneration:()=>r.LongT5ForConditionalGeneration,LongT5Model:()=>r.LongT5Model,LongT5PreTrainedModel:()=>r.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>r.M2M100ForConditionalGeneration,M2M100Model:()=>r.M2M100Model,M2M100PreTrainedModel:()=>r.M2M100PreTrainedModel,M2M100Tokenizer:()=>n.M2M100Tokenizer,MBart50Tokenizer:()=>n.MBart50Tokenizer,MBartForCausalLM:()=>r.MBartForCausalLM,MBartForConditionalGeneration:()=>r.MBartForConditionalGeneration,MBartForSequenceClassification:()=>r.MBartForSequenceClassification,MBartModel:()=>r.MBartModel,MBartPreTrainedModel:()=>r.MBartPreTrainedModel,MBartTokenizer:()=>n.MBartTokenizer,MPNetForMaskedLM:()=>r.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>r.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>r.MPNetForSequenceClassification,MPNetForTokenClassification:()=>r.MPNetForTokenClassification,MPNetModel:()=>r.MPNetModel,MPNetPreTrainedModel:()=>r.MPNetPreTrainedModel,MPNetTokenizer:()=>n.MPNetTokenizer,MT5ForConditionalGeneration:()=>r.MT5ForConditionalGeneration,MT5Model:()=>r.MT5Model,MT5PreTrainedModel:()=>r.MT5PreTrainedModel,MarianMTModel:()=>r.MarianMTModel,MarianModel:()=>r.MarianModel,MarianPreTrainedModel:()=>r.MarianPreTrainedModel,MarianTokenizer:()=>n.MarianTokenizer,Mask2FormerImageProcessor:()=>p.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>p.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>r.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>p.MaskFormerImageProcessor,MaskFormerModel:()=>r.MaskFormerModel,MaskFormerPreTrainedModel:()=>r.MaskFormerPreTrainedModel,MaskedLMOutput:()=>r.MaskedLMOutput,MaxLengthCriteria:()=>b.MaxLengthCriteria,Metric3DForDepthEstimation:()=>r.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>r.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>r.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>r.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>r.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>r.MgpstrModelOutput,MgpstrPreTrainedModel:()=>r.MgpstrPreTrainedModel,MgpstrProcessor:()=>y.MgpstrProcessor,MgpstrTokenizer:()=>n.MgpstrTokenizer,MimiDecoderModel:()=>r.MimiDecoderModel,MimiDecoderOutput:()=>r.MimiDecoderOutput,MimiEncoderModel:()=>r.MimiEncoderModel,MimiEncoderOutput:()=>r.MimiEncoderOutput,MimiModel:()=>r.MimiModel,MimiPreTrainedModel:()=>r.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>x.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>x.MinNewTokensLengthLogitsProcessor,MistralForCausalLM:()=>r.MistralForCausalLM,MistralModel:()=>r.MistralModel,MistralPreTrainedModel:()=>r.MistralPreTrainedModel,MobileBertForMaskedLM:()=>r.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>r.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>r.MobileBertForSequenceClassification,MobileBertModel:()=>r.MobileBertModel,MobileBertPreTrainedModel:()=>r.MobileBertPreTrainedModel,MobileBertTokenizer:()=>n.MobileBertTokenizer,MobileLLMForCausalLM:()=>r.MobileLLMForCausalLM,MobileLLMModel:()=>r.MobileLLMModel,MobileLLMPreTrainedModel:()=>r.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>p.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>r.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>r.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>p.MobileNetV1ImageProcessor,MobileNetV1Model:()=>r.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>r.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>p.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>r.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>r.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>p.MobileNetV2ImageProcessor,MobileNetV2Model:()=>r.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>r.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>p.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>r.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>r.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>p.MobileNetV3ImageProcessor,MobileNetV3Model:()=>r.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>r.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>p.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>r.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>r.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>p.MobileNetV4ImageProcessor,MobileNetV4Model:()=>r.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>r.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>p.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>r.MobileViTForImageClassification,MobileViTImageProcessor:()=>p.MobileViTImageProcessor,MobileViTModel:()=>r.MobileViTModel,MobileViTPreTrainedModel:()=>r.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>r.MobileViTV2ForImageClassification,MobileViTV2Model:()=>r.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>r.MobileViTV2PreTrainedModel,ModelOutput:()=>r.ModelOutput,ModernBertForMaskedLM:()=>r.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>r.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>r.ModernBertForTokenClassification,ModernBertModel:()=>r.ModernBertModel,ModernBertPreTrainedModel:()=>r.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>r.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>d.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>r.MoonshineForConditionalGeneration,MoonshineModel:()=>r.MoonshineModel,MoonshinePreTrainedModel:()=>r.MoonshinePreTrainedModel,MoonshineProcessor:()=>y.MoonshineProcessor,MptForCausalLM:()=>r.MptForCausalLM,MptModel:()=>r.MptModel,MptPreTrainedModel:()=>r.MptPreTrainedModel,MultiModalityCausalLM:()=>r.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>r.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>r.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>r.MusicgenForConditionalGeneration,MusicgenModel:()=>r.MusicgenModel,MusicgenPreTrainedModel:()=>r.MusicgenPreTrainedModel,NllbTokenizer:()=>n.NllbTokenizer,NoBadWordsLogitsProcessor:()=>x.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>x.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>r.NomicBertModel,NomicBertPreTrainedModel:()=>r.NomicBertPreTrainedModel,NougatImageProcessor:()=>p.NougatImageProcessor,NougatTokenizer:()=>n.NougatTokenizer,OPTForCausalLM:()=>r.OPTForCausalLM,OPTModel:()=>r.OPTModel,OPTPreTrainedModel:()=>r.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>r.Olmo2ForCausalLM,Olmo2Model:()=>r.Olmo2Model,Olmo2PreTrainedModel:()=>r.Olmo2PreTrainedModel,OlmoForCausalLM:()=>r.OlmoForCausalLM,OlmoModel:()=>r.OlmoModel,OlmoPreTrainedModel:()=>r.OlmoPreTrainedModel,OpenELMForCausalLM:()=>r.OpenELMForCausalLM,OpenELMModel:()=>r.OpenELMModel,OpenELMPreTrainedModel:()=>r.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>p.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>r.OwlViTForObjectDetection,OwlViTImageProcessor:()=>p.OwlViTImageProcessor,OwlViTModel:()=>r.OwlViTModel,OwlViTPreTrainedModel:()=>r.OwlViTPreTrainedModel,OwlViTProcessor:()=>y.OwlViTProcessor,Owlv2ForObjectDetection:()=>r.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>p.Owlv2ImageProcessor,Owlv2Model:()=>r.Owlv2Model,Owlv2PreTrainedModel:()=>r.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>r.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>r.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>y.PaliGemmaProcessor,PatchTSMixerForPrediction:()=>r.PatchTSMixerForPrediction,PatchTSMixerModel:()=>r.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>r.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>r.PatchTSTForPrediction,PatchTSTModel:()=>r.PatchTSTModel,PatchTSTPreTrainedModel:()=>r.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>r.Phi3ForCausalLM,Phi3Model:()=>r.Phi3Model,Phi3PreTrainedModel:()=>r.Phi3PreTrainedModel,Phi3VForCausalLM:()=>r.Phi3VForCausalLM,Phi3VImageProcessor:()=>p.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>r.Phi3VPreTrainedModel,Phi3VProcessor:()=>y.Phi3VProcessor,PhiForCausalLM:()=>r.PhiForCausalLM,PhiModel:()=>r.PhiModel,PhiPreTrainedModel:()=>r.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PreTrainedModel:()=>r.PreTrainedModel,PreTrainedTokenizer:()=>n.PreTrainedTokenizer,PretrainedConfig:()=>s.PretrainedConfig,PretrainedMixin:()=>r.PretrainedMixin,Processor:()=>w.Processor,PvtForImageClassification:()=>r.PvtForImageClassification,PvtImageProcessor:()=>p.PvtImageProcessor,PvtModel:()=>r.PvtModel,PvtPreTrainedModel:()=>r.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>d.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>r.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>r.PyAnnoteModel,PyAnnotePreTrainedModel:()=>r.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>y.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>r.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>r.Qwen2ForCausalLM,Qwen2Model:()=>r.Qwen2Model,Qwen2PreTrainedModel:()=>r.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>n.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>r.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>p.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>r.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>y.Qwen2VLProcessor,Qwen3ForCausalLM:()=>r.Qwen3ForCausalLM,Qwen3Model:()=>r.Qwen3Model,Qwen3PreTrainedModel:()=>r.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>r.RFDetrForObjectDetection,RFDetrModel:()=>r.RFDetrModel,RFDetrObjectDetectionOutput:()=>r.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>r.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>r.RTDetrForObjectDetection,RTDetrImageProcessor:()=>p.RTDetrImageProcessor,RTDetrModel:()=>r.RTDetrModel,RTDetrObjectDetectionOutput:()=>r.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>r.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>r.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>r.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>r.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>r.RTDetrV2PreTrainedModel,RawAudio:()=>i.RawAudio,RawImage:()=>o.RawImage,RawVideo:()=>a.RawVideo,RawVideoFrame:()=>a.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>x.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>r.ResNetForImageClassification,ResNetModel:()=>r.ResNetModel,ResNetPreTrainedModel:()=>r.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>r.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>r.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>r.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>r.RoFormerForTokenClassification,RoFormerModel:()=>r.RoFormerModel,RoFormerPreTrainedModel:()=>r.RoFormerPreTrainedModel,RoFormerTokenizer:()=>n.RoFormerTokenizer,RobertaForMaskedLM:()=>r.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>r.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>r.RobertaForSequenceClassification,RobertaForTokenClassification:()=>r.RobertaForTokenClassification,RobertaModel:()=>r.RobertaModel,RobertaPreTrainedModel:()=>r.RobertaPreTrainedModel,RobertaTokenizer:()=>n.RobertaTokenizer,SamImageProcessor:()=>p.SamImageProcessor,SamImageSegmentationOutput:()=>r.SamImageSegmentationOutput,SamModel:()=>r.SamModel,SamPreTrainedModel:()=>r.SamPreTrainedModel,SamProcessor:()=>y.SamProcessor,SapiensForDepthEstimation:()=>r.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>r.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>r.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>r.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>d.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>p.SegformerFeatureExtractor,SegformerForImageClassification:()=>r.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>r.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>p.SegformerImageProcessor,SegformerModel:()=>r.SegformerModel,SegformerPreTrainedModel:()=>r.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>r.Seq2SeqLMOutput,SequenceClassifierOutput:()=>r.SequenceClassifierOutput,SiglipImageProcessor:()=>p.SiglipImageProcessor,SiglipModel:()=>r.SiglipModel,SiglipPreTrainedModel:()=>r.SiglipPreTrainedModel,SiglipTextModel:()=>r.SiglipTextModel,SiglipTokenizer:()=>n.SiglipTokenizer,SiglipVisionModel:()=>r.SiglipVisionModel,SmolVLMForConditionalGeneration:()=>r.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>p.SmolVLMImageProcessor,SmolVLMProcessor:()=>y.SmolVLMProcessor,SnacDecoderModel:()=>r.SnacDecoderModel,SnacEncoderModel:()=>r.SnacEncoderModel,SnacFeatureExtractor:()=>d.SnacFeatureExtractor,SnacModel:()=>r.SnacModel,SnacPreTrainedModel:()=>r.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>d.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>r.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>r.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>r.SpeechT5HifiGan,SpeechT5Model:()=>r.SpeechT5Model,SpeechT5PreTrainedModel:()=>r.SpeechT5PreTrainedModel,SpeechT5Processor:()=>y.SpeechT5Processor,SpeechT5Tokenizer:()=>n.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>r.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>r.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>r.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>r.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>r.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>n.SqueezeBertTokenizer,StableLmForCausalLM:()=>r.StableLmForCausalLM,StableLmModel:()=>r.StableLmModel,StableLmPreTrainedModel:()=>r.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>r.Starcoder2ForCausalLM,Starcoder2Model:()=>r.Starcoder2Model,Starcoder2PreTrainedModel:()=>r.Starcoder2PreTrainedModel,StoppingCriteria:()=>b.StoppingCriteria,StoppingCriteriaList:()=>b.StoppingCriteriaList,StyleTextToSpeech2Model:()=>r.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>r.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SuppressTokensAtBeginLogitsProcessor:()=>x.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>r.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>p.Swin2SRImageProcessor,Swin2SRModel:()=>r.Swin2SRModel,Swin2SRPreTrainedModel:()=>r.Swin2SRPreTrainedModel,SwinForImageClassification:()=>r.SwinForImageClassification,SwinForSemanticSegmentation:()=>r.SwinForSemanticSegmentation,SwinModel:()=>r.SwinModel,SwinPreTrainedModel:()=>r.SwinPreTrainedModel,T5ForConditionalGeneration:()=>r.T5ForConditionalGeneration,T5Model:()=>r.T5Model,T5PreTrainedModel:()=>r.T5PreTrainedModel,T5Tokenizer:()=>n.T5Tokenizer,TableTransformerForObjectDetection:()=>r.TableTransformerForObjectDetection,TableTransformerModel:()=>r.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>r.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>r.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>x.TemperatureLogitsWarper,Tensor:()=>l.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>v.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>r.TokenClassifierOutput,TokenizerModel:()=>n.TokenizerModel,TopKLogitsWarper:()=>x.TopKLogitsWarper,TopPLogitsWarper:()=>x.TopPLogitsWarper,TrOCRForCausalLM:()=>r.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>r.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UltravoxModel:()=>r.UltravoxModel,UltravoxPreTrainedModel:()=>r.UltravoxPreTrainedModel,UltravoxProcessor:()=>y.UltravoxProcessor,UniSpeechForCTC:()=>r.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>r.UniSpeechForSequenceClassification,UniSpeechModel:()=>r.UniSpeechModel,UniSpeechPreTrainedModel:()=>r.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>r.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>r.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>r.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>r.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>r.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>y.VLChatProcessor,VLMImageProcessor:()=>p.VLMImageProcessor,ViTFeatureExtractor:()=>p.ViTFeatureExtractor,ViTForImageClassification:()=>r.ViTForImageClassification,ViTImageProcessor:()=>p.ViTImageProcessor,ViTMAEModel:()=>r.ViTMAEModel,ViTMAEPreTrainedModel:()=>r.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>r.ViTMSNForImageClassification,ViTMSNModel:()=>r.ViTMSNModel,ViTMSNPreTrainedModel:()=>r.ViTMSNPreTrainedModel,ViTModel:()=>r.ViTModel,ViTPreTrainedModel:()=>r.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>r.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>r.VitMatteForImageMatting,VitMatteImageProcessor:()=>p.VitMatteImageProcessor,VitMattePreTrainedModel:()=>r.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>r.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>p.VitPoseImageProcessor,VitPosePreTrainedModel:()=>r.VitPosePreTrainedModel,VitsModel:()=>r.VitsModel,VitsModelOutput:()=>r.VitsModelOutput,VitsPreTrainedModel:()=>r.VitsPreTrainedModel,VitsTokenizer:()=>n.VitsTokenizer,Wav2Vec2BertForCTC:()=>r.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>r.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>r.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>r.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>n.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>d.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>r.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>r.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>r.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>r.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>r.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>y.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>y.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>r.WavLMForAudioFrameClassification,WavLMForCTC:()=>r.WavLMForCTC,WavLMForSequenceClassification:()=>r.WavLMForSequenceClassification,WavLMForXVector:()=>r.WavLMForXVector,WavLMModel:()=>r.WavLMModel,WavLMPreTrainedModel:()=>r.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>d.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>r.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>r.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>d.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>r.WhisperForConditionalGeneration,WhisperModel:()=>r.WhisperModel,WhisperPreTrainedModel:()=>r.WhisperPreTrainedModel,WhisperProcessor:()=>y.WhisperProcessor,WhisperTextStreamer:()=>v.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>x.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>n.WhisperTokenizer,XLMForQuestionAnswering:()=>r.XLMForQuestionAnswering,XLMForSequenceClassification:()=>r.XLMForSequenceClassification,XLMForTokenClassification:()=>r.XLMForTokenClassification,XLMModel:()=>r.XLMModel,XLMPreTrainedModel:()=>r.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>r.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>r.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>r.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>r.XLMRobertaForTokenClassification,XLMRobertaModel:()=>r.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>r.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>n.XLMRobertaTokenizer,XLMTokenizer:()=>n.XLMTokenizer,XLMWithLMHeadModel:()=>r.XLMWithLMHeadModel,XVectorOutput:()=>r.XVectorOutput,YolosFeatureExtractor:()=>p.YolosFeatureExtractor,YolosForObjectDetection:()=>r.YolosForObjectDetection,YolosImageProcessor:()=>p.YolosImageProcessor,YolosModel:()=>r.YolosModel,YolosObjectDetectionOutput:()=>r.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>r.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>c.bankers_round,cat:()=>l.cat,cos_sim:()=>c.cos_sim,dot:()=>c.dot,dynamic_time_warping:()=>c.dynamic_time_warping,env:()=>e.env,full:()=>l.full,full_like:()=>l.full_like,getKeyValueShapes:()=>s.getKeyValueShapes,hamming:()=>i.hamming,hanning:()=>i.hanning,interpolate:()=>l.interpolate,interpolate_4d:()=>l.interpolate_4d,interpolate_data:()=>c.interpolate_data,is_chinese_char:()=>n.is_chinese_char,layer_norm:()=>l.layer_norm,load_image:()=>o.load_image,load_video:()=>a.load_video,log_softmax:()=>c.log_softmax,magnitude:()=>c.magnitude,matmul:()=>l.matmul,max:()=>c.max,mean:()=>l.mean,mean_pooling:()=>l.mean_pooling,medianFilter:()=>c.medianFilter,mel_filter_bank:()=>i.mel_filter_bank,min:()=>c.min,ones:()=>l.ones,ones_like:()=>l.ones_like,permute:()=>l.permute,permute_data:()=>c.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>l.quantize_embeddings,rand:()=>l.rand,read_audio:()=>i.read_audio,rfft:()=>l.rfft,round:()=>c.round,slice:()=>l.slice,softmax:()=>c.softmax,spectrogram:()=>i.spectrogram,stack:()=>l.stack,std_mean:()=>l.std_mean,topk:()=>l.topk,window_function:()=>i.window_function,zeros:()=>l.zeros,zeros_like:()=>l.zeros_like});var e=or("./src/env.js"),t=or("./src/pipelines.js"),r=or("./src/models.js"),n=or("./src/tokenizers.js"),s=or("./src/configs.js"),i=or("./src/utils/audio.js"),o=or("./src/utils/image.js"),a=or("./src/utils/video.js"),l=or("./src/utils/tensor.js"),c=or("./src/utils/maths.js"),u=or("./src/base/feature_extraction_utils.js"),d=or("./src/models/feature_extractors.js"),h=or("./src/models/auto/feature_extraction_auto.js"),f=or("./src/base/image_processors_utils.js"),p=or("./src/models/image_processors.js"),_=or("./src/models/auto/image_processing_auto.js"),w=or("./src/base/processing_utils.js"),y=or("./src/models/processors.js"),g=or("./src/models/auto/processing_auto.js"),v=or("./src/generation/streamers.js"),b=or("./src/generation/stopping_criteria.js"),x=or("./src/generation/logits_process.js")})();S.ASTFeatureExtractor;S.ASTForAudioClassification;S.ASTModel;S.ASTPreTrainedModel;S.AlbertForMaskedLM;S.AlbertForQuestionAnswering;S.AlbertForSequenceClassification;S.AlbertModel;S.AlbertPreTrainedModel;S.AlbertTokenizer;S.AudioClassificationPipeline;S.AutoConfig;S.AutoFeatureExtractor;S.AutoImageProcessor;S.AutoModel;S.AutoModelForAudioClassification;S.AutoModelForAudioFrameClassification;S.AutoModelForAudioTextToText;S.AutoModelForCTC;S.AutoModelForCausalLM;S.AutoModelForDepthEstimation;S.AutoModelForDocumentQuestionAnswering;S.AutoModelForImageClassification;S.AutoModelForImageFeatureExtraction;S.AutoModelForImageMatting;S.AutoModelForImageSegmentation;S.AutoModelForImageTextToText;S.AutoModelForImageToImage;S.AutoModelForMaskGeneration;S.AutoModelForMaskedLM;S.AutoModelForNormalEstimation;S.AutoModelForObjectDetection;S.AutoModelForPoseEstimation;S.AutoModelForQuestionAnswering;S.AutoModelForSemanticSegmentation;S.AutoModelForSeq2SeqLM;S.AutoModelForSequenceClassification;S.AutoModelForSpeechSeq2Seq;S.AutoModelForTextToSpectrogram;S.AutoModelForTextToWaveform;S.AutoModelForTokenClassification;S.AutoModelForUniversalSegmentation;S.AutoModelForVision2Seq;S.AutoModelForXVector;S.AutoModelForZeroShotObjectDetection;S.AutoProcessor;S.AutoTokenizer;S.AutomaticSpeechRecognitionPipeline;S.BackgroundRemovalPipeline;S.BartForConditionalGeneration;S.BartForSequenceClassification;S.BartModel;S.BartPretrainedModel;S.BartTokenizer;S.BaseModelOutput;S.BaseStreamer;S.BeitFeatureExtractor;S.BeitForImageClassification;S.BeitModel;S.BeitPreTrainedModel;S.BertForMaskedLM;S.BertForQuestionAnswering;S.BertForSequenceClassification;S.BertForTokenClassification;S.BertModel;S.BertPreTrainedModel;S.BertTokenizer;S.BitImageProcessor;S.BlenderbotForConditionalGeneration;S.BlenderbotModel;S.BlenderbotPreTrainedModel;S.BlenderbotSmallForConditionalGeneration;S.BlenderbotSmallModel;S.BlenderbotSmallPreTrainedModel;S.BlenderbotSmallTokenizer;S.BlenderbotTokenizer;S.BloomForCausalLM;S.BloomModel;S.BloomPreTrainedModel;S.BloomTokenizer;S.CLIPFeatureExtractor;S.CLIPImageProcessor;S.CLIPModel;S.CLIPPreTrainedModel;S.CLIPSegForImageSegmentation;S.CLIPSegModel;S.CLIPSegPreTrainedModel;S.CLIPTextModel;S.CLIPTextModelWithProjection;S.CLIPTokenizer;S.CLIPVisionModel;S.CLIPVisionModelWithProjection;S.CamembertForMaskedLM;S.CamembertForQuestionAnswering;S.CamembertForSequenceClassification;S.CamembertForTokenClassification;S.CamembertModel;S.CamembertPreTrainedModel;S.CamembertTokenizer;S.CausalLMOutput;S.CausalLMOutputWithPast;S.ChineseCLIPFeatureExtractor;S.ChineseCLIPModel;S.ChineseCLIPPreTrainedModel;S.ClapAudioModelWithProjection;S.ClapFeatureExtractor;S.ClapModel;S.ClapPreTrainedModel;S.ClapTextModelWithProjection;S.ClassifierFreeGuidanceLogitsProcessor;S.CodeGenForCausalLM;S.CodeGenModel;S.CodeGenPreTrainedModel;S.CodeGenTokenizer;S.CodeLlamaTokenizer;S.CohereForCausalLM;S.CohereModel;S.CoherePreTrainedModel;S.CohereTokenizer;S.ConvBertForMaskedLM;S.ConvBertForQuestionAnswering;S.ConvBertForSequenceClassification;S.ConvBertForTokenClassification;S.ConvBertModel;S.ConvBertPreTrainedModel;S.ConvBertTokenizer;S.ConvNextFeatureExtractor;S.ConvNextForImageClassification;S.ConvNextImageProcessor;S.ConvNextModel;S.ConvNextPreTrainedModel;S.ConvNextV2ForImageClassification;S.ConvNextV2Model;S.ConvNextV2PreTrainedModel;S.DFineForObjectDetection;S.DFineModel;S.DFinePreTrainedModel;S.DPTFeatureExtractor;S.DPTForDepthEstimation;S.DPTImageProcessor;S.DPTModel;S.DPTPreTrainedModel;S.DacDecoderModel;S.DacDecoderOutput;S.DacEncoderModel;S.DacEncoderOutput;S.DacFeatureExtractor;S.DacModel;S.DacPreTrainedModel;S.DataTypeMap;S.DebertaForMaskedLM;S.DebertaForQuestionAnswering;S.DebertaForSequenceClassification;S.DebertaForTokenClassification;S.DebertaModel;S.DebertaPreTrainedModel;S.DebertaTokenizer;S.DebertaV2ForMaskedLM;S.DebertaV2ForQuestionAnswering;S.DebertaV2ForSequenceClassification;S.DebertaV2ForTokenClassification;S.DebertaV2Model;S.DebertaV2PreTrainedModel;S.DebertaV2Tokenizer;S.DecisionTransformerModel;S.DecisionTransformerPreTrainedModel;S.DeiTFeatureExtractor;S.DeiTForImageClassification;S.DeiTImageProcessor;S.DeiTModel;S.DeiTPreTrainedModel;S.DepthAnythingForDepthEstimation;S.DepthAnythingPreTrainedModel;S.DepthEstimationPipeline;S.DepthProForDepthEstimation;S.DepthProPreTrainedModel;S.DetrFeatureExtractor;S.DetrForObjectDetection;S.DetrForSegmentation;S.DetrImageProcessor;S.DetrModel;S.DetrObjectDetectionOutput;S.DetrPreTrainedModel;S.DetrSegmentationOutput;S.Dinov2ForImageClassification;S.Dinov2Model;S.Dinov2PreTrainedModel;S.Dinov2WithRegistersForImageClassification;S.Dinov2WithRegistersModel;S.Dinov2WithRegistersPreTrainedModel;S.DistilBertForMaskedLM;S.DistilBertForQuestionAnswering;S.DistilBertForSequenceClassification;S.DistilBertForTokenClassification;S.DistilBertModel;S.DistilBertPreTrainedModel;S.DistilBertTokenizer;S.DocumentQuestionAnsweringPipeline;S.DonutFeatureExtractor;S.DonutImageProcessor;S.DonutSwinModel;S.DonutSwinPreTrainedModel;S.EfficientNetForImageClassification;S.EfficientNetImageProcessor;S.EfficientNetModel;S.EfficientNetPreTrainedModel;S.ElectraForMaskedLM;S.ElectraForQuestionAnswering;S.ElectraForSequenceClassification;S.ElectraForTokenClassification;S.ElectraModel;S.ElectraPreTrainedModel;S.ElectraTokenizer;S.EncodecFeatureExtractor;S.EosTokenCriteria;S.EsmForMaskedLM;S.EsmForSequenceClassification;S.EsmForTokenClassification;S.EsmModel;S.EsmPreTrainedModel;S.EsmTokenizer;S.ExaoneForCausalLM;S.ExaoneModel;S.ExaonePreTrainedModel;S.FFT;S.FalconForCausalLM;S.FalconModel;S.FalconPreTrainedModel;S.FalconTokenizer;S.FastViTForImageClassification;S.FastViTModel;S.FastViTPreTrainedModel;S.FeatureExtractionPipeline;S.FeatureExtractor;S.FillMaskPipeline;S.Florence2ForConditionalGeneration;S.Florence2PreTrainedModel;S.Florence2Processor;S.ForcedBOSTokenLogitsProcessor;S.ForcedEOSTokenLogitsProcessor;S.GLPNFeatureExtractor;S.GLPNForDepthEstimation;S.GLPNModel;S.GLPNPreTrainedModel;S.GPT2LMHeadModel;S.GPT2Model;S.GPT2PreTrainedModel;S.GPT2Tokenizer;S.GPTBigCodeForCausalLM;S.GPTBigCodeModel;S.GPTBigCodePreTrainedModel;S.GPTJForCausalLM;S.GPTJModel;S.GPTJPreTrainedModel;S.GPTNeoForCausalLM;S.GPTNeoModel;S.GPTNeoPreTrainedModel;S.GPTNeoXForCausalLM;S.GPTNeoXModel;S.GPTNeoXPreTrainedModel;S.GPTNeoXTokenizer;S.Gemma2ForCausalLM;S.Gemma2Model;S.Gemma2PreTrainedModel;S.Gemma3ForCausalLM;S.Gemma3Model;S.Gemma3PreTrainedModel;S.Gemma3nAudioFeatureExtractor;S.Gemma3nForConditionalGeneration;S.Gemma3nPreTrainedModel;S.Gemma3nProcessor;S.GemmaForCausalLM;S.GemmaModel;S.GemmaPreTrainedModel;S.GemmaTokenizer;S.GlmForCausalLM;S.GlmModel;S.GlmPreTrainedModel;S.GraniteForCausalLM;S.GraniteModel;S.GranitePreTrainedModel;S.Grok1Tokenizer;S.GroundingDinoForObjectDetection;S.GroundingDinoImageProcessor;S.GroundingDinoPreTrainedModel;S.GroundingDinoProcessor;S.GroupViTModel;S.GroupViTPreTrainedModel;S.HeliumForCausalLM;S.HeliumModel;S.HeliumPreTrainedModel;S.HerbertTokenizer;S.HieraForImageClassification;S.HieraModel;S.HieraPreTrainedModel;S.HubertForCTC;S.HubertForSequenceClassification;S.HubertModel;S.HubertPreTrainedModel;S.IJepaForImageClassification;S.IJepaModel;S.IJepaPreTrainedModel;S.Idefics3ForConditionalGeneration;S.Idefics3ImageProcessor;S.Idefics3PreTrainedModel;S.Idefics3Processor;S.ImageClassificationPipeline;S.ImageFeatureExtractionPipeline;S.ImageFeatureExtractor;S.ImageMattingOutput;S.ImageProcessor;S.ImageSegmentationPipeline;S.ImageToImagePipeline;S.ImageToTextPipeline;S.InterruptableStoppingCriteria;S.JAISLMHeadModel;S.JAISModel;S.JAISPreTrainedModel;S.JinaCLIPImageProcessor;S.JinaCLIPModel;S.JinaCLIPPreTrainedModel;S.JinaCLIPProcessor;S.JinaCLIPTextModel;S.JinaCLIPVisionModel;S.LiteWhisperForConditionalGeneration;S.LlamaForCausalLM;S.LlamaModel;S.LlamaPreTrainedModel;S.LlamaTokenizer;S.LlavaForConditionalGeneration;S.LlavaOnevisionForConditionalGeneration;S.LlavaOnevisionImageProcessor;S.LlavaPreTrainedModel;S.LlavaProcessor;S.LlavaQwen2ForCausalLM;S.LogitsProcessor;S.LogitsProcessorList;S.LogitsWarper;S.LongT5ForConditionalGeneration;S.LongT5Model;S.LongT5PreTrainedModel;S.M2M100ForConditionalGeneration;S.M2M100Model;S.M2M100PreTrainedModel;S.M2M100Tokenizer;S.MBart50Tokenizer;S.MBartForCausalLM;S.MBartForConditionalGeneration;S.MBartForSequenceClassification;S.MBartModel;S.MBartPreTrainedModel;S.MBartTokenizer;S.MPNetForMaskedLM;S.MPNetForQuestionAnswering;S.MPNetForSequenceClassification;S.MPNetForTokenClassification;S.MPNetModel;S.MPNetPreTrainedModel;S.MPNetTokenizer;S.MT5ForConditionalGeneration;S.MT5Model;S.MT5PreTrainedModel;S.MarianMTModel;S.MarianModel;S.MarianPreTrainedModel;S.MarianTokenizer;S.Mask2FormerImageProcessor;S.MaskFormerFeatureExtractor;S.MaskFormerForInstanceSegmentation;S.MaskFormerImageProcessor;S.MaskFormerModel;S.MaskFormerPreTrainedModel;S.MaskedLMOutput;S.MaxLengthCriteria;S.Metric3DForDepthEstimation;S.Metric3DPreTrainedModel;S.Metric3Dv2ForDepthEstimation;S.Metric3Dv2PreTrainedModel;S.MgpstrForSceneTextRecognition;S.MgpstrModelOutput;S.MgpstrPreTrainedModel;S.MgpstrProcessor;S.MgpstrTokenizer;S.MimiDecoderModel;S.MimiDecoderOutput;S.MimiEncoderModel;S.MimiEncoderOutput;S.MimiModel;S.MimiPreTrainedModel;S.MinLengthLogitsProcessor;S.MinNewTokensLengthLogitsProcessor;S.MistralForCausalLM;S.MistralModel;S.MistralPreTrainedModel;S.MobileBertForMaskedLM;S.MobileBertForQuestionAnswering;S.MobileBertForSequenceClassification;S.MobileBertModel;S.MobileBertPreTrainedModel;S.MobileBertTokenizer;S.MobileLLMForCausalLM;S.MobileLLMModel;S.MobileLLMPreTrainedModel;S.MobileNetV1FeatureExtractor;S.MobileNetV1ForImageClassification;S.MobileNetV1ForSemanticSegmentation;S.MobileNetV1ImageProcessor;S.MobileNetV1Model;S.MobileNetV1PreTrainedModel;S.MobileNetV2FeatureExtractor;S.MobileNetV2ForImageClassification;S.MobileNetV2ForSemanticSegmentation;S.MobileNetV2ImageProcessor;S.MobileNetV2Model;S.MobileNetV2PreTrainedModel;S.MobileNetV3FeatureExtractor;S.MobileNetV3ForImageClassification;S.MobileNetV3ForSemanticSegmentation;S.MobileNetV3ImageProcessor;S.MobileNetV3Model;S.MobileNetV3PreTrainedModel;S.MobileNetV4FeatureExtractor;S.MobileNetV4ForImageClassification;S.MobileNetV4ForSemanticSegmentation;S.MobileNetV4ImageProcessor;S.MobileNetV4Model;S.MobileNetV4PreTrainedModel;S.MobileViTFeatureExtractor;S.MobileViTForImageClassification;S.MobileViTImageProcessor;S.MobileViTModel;S.MobileViTPreTrainedModel;S.MobileViTV2ForImageClassification;S.MobileViTV2Model;S.MobileViTV2PreTrainedModel;S.ModelOutput;S.ModernBertForMaskedLM;S.ModernBertForSequenceClassification;S.ModernBertForTokenClassification;S.ModernBertModel;S.ModernBertPreTrainedModel;S.Moondream1ForConditionalGeneration;S.MoonshineFeatureExtractor;S.MoonshineForConditionalGeneration;S.MoonshineModel;S.MoonshinePreTrainedModel;S.MoonshineProcessor;S.MptForCausalLM;S.MptModel;S.MptPreTrainedModel;S.MultiModalityCausalLM;S.MultiModalityPreTrainedModel;S.MusicgenForCausalLM;S.MusicgenForConditionalGeneration;S.MusicgenModel;S.MusicgenPreTrainedModel;S.NllbTokenizer;S.NoBadWordsLogitsProcessor;S.NoRepeatNGramLogitsProcessor;S.NomicBertModel;S.NomicBertPreTrainedModel;S.NougatImageProcessor;S.NougatTokenizer;S.OPTForCausalLM;S.OPTModel;S.OPTPreTrainedModel;S.ObjectDetectionPipeline;S.Olmo2ForCausalLM;S.Olmo2Model;S.Olmo2PreTrainedModel;S.OlmoForCausalLM;S.OlmoModel;S.OlmoPreTrainedModel;S.OpenELMForCausalLM;S.OpenELMModel;S.OpenELMPreTrainedModel;S.OwlViTFeatureExtractor;S.OwlViTForObjectDetection;S.OwlViTImageProcessor;S.OwlViTModel;S.OwlViTPreTrainedModel;S.OwlViTProcessor;S.Owlv2ForObjectDetection;S.Owlv2ImageProcessor;S.Owlv2Model;S.Owlv2PreTrainedModel;S.PaliGemmaForConditionalGeneration;S.PaliGemmaPreTrainedModel;S.PaliGemmaProcessor;S.PatchTSMixerForPrediction;S.PatchTSMixerModel;S.PatchTSMixerPreTrainedModel;S.PatchTSTForPrediction;S.PatchTSTModel;S.PatchTSTPreTrainedModel;S.Phi3ForCausalLM;S.Phi3Model;S.Phi3PreTrainedModel;S.Phi3VForCausalLM;S.Phi3VImageProcessor;S.Phi3VPreTrainedModel;S.Phi3VProcessor;S.PhiForCausalLM;S.PhiModel;S.PhiPreTrainedModel;S.Pipeline;S.PreTrainedModel;S.PreTrainedTokenizer;S.PretrainedConfig;S.PretrainedMixin;S.Processor;S.PvtForImageClassification;S.PvtImageProcessor;S.PvtModel;S.PvtPreTrainedModel;S.PyAnnoteFeatureExtractor;S.PyAnnoteForAudioFrameClassification;S.PyAnnoteModel;S.PyAnnotePreTrainedModel;S.PyAnnoteProcessor;S.QuestionAnsweringModelOutput;S.QuestionAnsweringPipeline;S.Qwen2ForCausalLM;S.Qwen2Model;S.Qwen2PreTrainedModel;S.Qwen2Tokenizer;S.Qwen2VLForConditionalGeneration;S.Qwen2VLImageProcessor;S.Qwen2VLPreTrainedModel;S.Qwen2VLProcessor;S.Qwen3ForCausalLM;S.Qwen3Model;S.Qwen3PreTrainedModel;S.RFDetrForObjectDetection;S.RFDetrModel;S.RFDetrObjectDetectionOutput;S.RFDetrPreTrainedModel;S.RTDetrForObjectDetection;S.RTDetrImageProcessor;S.RTDetrModel;S.RTDetrObjectDetectionOutput;S.RTDetrPreTrainedModel;S.RTDetrV2ForObjectDetection;S.RTDetrV2Model;S.RTDetrV2ObjectDetectionOutput;S.RTDetrV2PreTrainedModel;S.RawAudio;S.RawImage;S.RawVideo;S.RawVideoFrame;S.RepetitionPenaltyLogitsProcessor;S.ResNetForImageClassification;S.ResNetModel;S.ResNetPreTrainedModel;S.RoFormerForMaskedLM;S.RoFormerForQuestionAnswering;S.RoFormerForSequenceClassification;S.RoFormerForTokenClassification;S.RoFormerModel;S.RoFormerPreTrainedModel;S.RoFormerTokenizer;S.RobertaForMaskedLM;S.RobertaForQuestionAnswering;S.RobertaForSequenceClassification;S.RobertaForTokenClassification;S.RobertaModel;S.RobertaPreTrainedModel;S.RobertaTokenizer;S.SamImageProcessor;S.SamImageSegmentationOutput;S.SamModel;S.SamPreTrainedModel;S.SamProcessor;S.SapiensForDepthEstimation;S.SapiensForNormalEstimation;S.SapiensForSemanticSegmentation;S.SapiensPreTrainedModel;S.SeamlessM4TFeatureExtractor;S.SegformerFeatureExtractor;S.SegformerForImageClassification;S.SegformerForSemanticSegmentation;S.SegformerImageProcessor;S.SegformerModel;S.SegformerPreTrainedModel;S.Seq2SeqLMOutput;S.SequenceClassifierOutput;S.SiglipImageProcessor;S.SiglipModel;S.SiglipPreTrainedModel;S.SiglipTextModel;S.SiglipTokenizer;S.SiglipVisionModel;S.SmolVLMForConditionalGeneration;S.SmolVLMImageProcessor;S.SmolVLMProcessor;S.SnacDecoderModel;S.SnacEncoderModel;S.SnacFeatureExtractor;S.SnacModel;S.SnacPreTrainedModel;S.SpeechT5FeatureExtractor;S.SpeechT5ForSpeechToText;S.SpeechT5ForTextToSpeech;S.SpeechT5HifiGan;S.SpeechT5Model;S.SpeechT5PreTrainedModel;S.SpeechT5Processor;S.SpeechT5Tokenizer;S.SqueezeBertForMaskedLM;S.SqueezeBertForQuestionAnswering;S.SqueezeBertForSequenceClassification;S.SqueezeBertModel;S.SqueezeBertPreTrainedModel;S.SqueezeBertTokenizer;S.StableLmForCausalLM;S.StableLmModel;S.StableLmPreTrainedModel;S.Starcoder2ForCausalLM;S.Starcoder2Model;S.Starcoder2PreTrainedModel;S.StoppingCriteria;S.StoppingCriteriaList;S.StyleTextToSpeech2Model;S.StyleTextToSpeech2PreTrainedModel;S.SummarizationPipeline;S.SuppressTokensAtBeginLogitsProcessor;S.Swin2SRForImageSuperResolution;S.Swin2SRImageProcessor;S.Swin2SRModel;S.Swin2SRPreTrainedModel;S.SwinForImageClassification;S.SwinForSemanticSegmentation;S.SwinModel;S.SwinPreTrainedModel;S.T5ForConditionalGeneration;S.T5Model;S.T5PreTrainedModel;S.T5Tokenizer;S.TableTransformerForObjectDetection;S.TableTransformerModel;S.TableTransformerObjectDetectionOutput;S.TableTransformerPreTrainedModel;S.TemperatureLogitsWarper;S.Tensor;S.Text2TextGenerationPipeline;S.TextClassificationPipeline;S.TextGenerationPipeline;S.TextStreamer;S.TextToAudioPipeline;S.TokenClassificationPipeline;S.TokenClassifierOutput;S.TokenizerModel;S.TopKLogitsWarper;S.TopPLogitsWarper;S.TrOCRForCausalLM;S.TrOCRPreTrainedModel;S.TranslationPipeline;S.UltravoxModel;S.UltravoxPreTrainedModel;S.UltravoxProcessor;S.UniSpeechForCTC;S.UniSpeechForSequenceClassification;S.UniSpeechModel;S.UniSpeechPreTrainedModel;S.UniSpeechSatForAudioFrameClassification;S.UniSpeechSatForCTC;S.UniSpeechSatForSequenceClassification;S.UniSpeechSatModel;S.UniSpeechSatPreTrainedModel;S.VLChatProcessor;S.VLMImageProcessor;S.ViTFeatureExtractor;S.ViTForImageClassification;S.ViTImageProcessor;S.ViTMAEModel;S.ViTMAEPreTrainedModel;S.ViTMSNForImageClassification;S.ViTMSNModel;S.ViTMSNPreTrainedModel;S.ViTModel;S.ViTPreTrainedModel;S.VisionEncoderDecoderModel;S.VitMatteForImageMatting;S.VitMatteImageProcessor;S.VitMattePreTrainedModel;S.VitPoseForPoseEstimation;S.VitPoseImageProcessor;S.VitPosePreTrainedModel;S.VitsModel;S.VitsModelOutput;S.VitsPreTrainedModel;S.VitsTokenizer;S.Wav2Vec2BertForCTC;S.Wav2Vec2BertForSequenceClassification;S.Wav2Vec2BertModel;S.Wav2Vec2BertPreTrainedModel;S.Wav2Vec2CTCTokenizer;S.Wav2Vec2FeatureExtractor;S.Wav2Vec2ForAudioFrameClassification;S.Wav2Vec2ForCTC;S.Wav2Vec2ForSequenceClassification;S.Wav2Vec2Model;S.Wav2Vec2PreTrainedModel;S.Wav2Vec2Processor;S.Wav2Vec2ProcessorWithLM;S.WavLMForAudioFrameClassification;S.WavLMForCTC;S.WavLMForSequenceClassification;S.WavLMForXVector;S.WavLMModel;S.WavLMPreTrainedModel;S.WeSpeakerFeatureExtractor;S.WeSpeakerResNetModel;S.WeSpeakerResNetPreTrainedModel;S.WhisperFeatureExtractor;S.WhisperForConditionalGeneration;S.WhisperModel;S.WhisperPreTrainedModel;S.WhisperProcessor;S.WhisperTextStreamer;S.WhisperTimeStampLogitsProcessor;S.WhisperTokenizer;S.XLMForQuestionAnswering;S.XLMForSequenceClassification;S.XLMForTokenClassification;S.XLMModel;S.XLMPreTrainedModel;S.XLMRobertaForMaskedLM;S.XLMRobertaForQuestionAnswering;S.XLMRobertaForSequenceClassification;S.XLMRobertaForTokenClassification;S.XLMRobertaModel;S.XLMRobertaPreTrainedModel;S.XLMRobertaTokenizer;S.XLMTokenizer;S.XLMWithLMHeadModel;S.XVectorOutput;S.YolosFeatureExtractor;S.YolosForObjectDetection;S.YolosImageProcessor;S.YolosModel;S.YolosObjectDetectionOutput;S.YolosPreTrainedModel;S.ZeroShotAudioClassificationPipeline;S.ZeroShotClassificationPipeline;S.ZeroShotImageClassificationPipeline;S.ZeroShotObjectDetectionPipeline;S.bankers_round;S.cat;S.cos_sim;S.dot;S.dynamic_time_warping;var sG=S.env;S.full;S.full_like;S.getKeyValueShapes;S.hamming;S.hanning;S.interpolate;S.interpolate_4d;S.interpolate_data;S.is_chinese_char;S.layer_norm;S.load_image;S.load_video;S.log_softmax;S.magnitude;S.matmul;S.max;S.mean;S.mean_pooling;S.medianFilter;S.mel_filter_bank;S.min;S.ones;S.ones_like;S.permute;S.permute_data;var AE=S.pipeline;S.quantize_embeddings;S.rand;S.read_audio;S.rfft;S.round;S.slice;S.softmax;S.spectrogram;S.stack;S.std_mean;S.topk;S.window_function;S.zeros;S.zeros_like;sG.allowLocalModels=!1;sG.useBrowserCache=!1;const fu=1024,wce=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState(0),s=(l,c,u)=>{let d=u.naturalWidth,h=u.naturalHeight;return(d>fu||h>fu)&&(d>h?(h=Math.round(h*fu/d),d=fu):(d=Math.round(d*fu/h),h=fu)),l.width=d,l.height=h,c.drawImage(u,0,0,d,h),{width:d,height:h}},i=async l=>{n(20),console.log("Starting background removal...");const c=await AE("image-segmentation","Xenova/segformer-b0-finetuned-ade-512-512",{device:"webgpu"});n(40);const u=document.createElement("canvas"),d=u.getContext("2d");if(!d)throw new Error("Could not get canvas context");const h=new Image;await new Promise((v,b)=>{h.onload=v,h.onerror=b,h.src=URL.createObjectURL(l)}),s(u,d,h),n(60);const f=u.toDataURL("image/jpeg",.8),p=await c(f);if(n(80),!p||!Array.isArray(p)||p.length===0||!p[0].mask)throw new Error("Invalid segmentation result");const _=document.createElement("canvas");_.width=u.width,_.height=u.height;const w=_.getContext("2d");if(!w)throw new Error("Could not get output canvas context");w.drawImage(u,0,0);const y=w.getImageData(0,0,_.width,_.height),g=y.data;for(let v=0;v<p[0].mask.data.length;v++){const b=Math.round((1-p[0].mask.data[v])*255);g[v*4+3]=b}return w.putImageData(y,0,0),n(90),_.toDataURL("image/png")},o=l=>new Promise(c=>{const u=document.createElement("canvas"),d=u.getContext("2d"),h=new Image;h.onload=()=>{if(!d)return c([]);u.width=h.width,u.height=h.height,d.drawImage(h,0,0);const p=d.getImageData(0,0,u.width,u.height).data,_={};let w=0;for(let g=0;g<p.length;g+=32){const v=p[g],b=p[g+1],x=p[g+2];if(p[g+3]<128)continue;const E=Math.round(v/16)*16,P=Math.round(b/16)*16,I=Math.round(x/16)*16,O=`${E},${P},${I}`;_[O]=(_[O]||0)+1,w++}const y=Object.entries(_).sort(([,g],[,v])=>v-g).slice(0,5).map(([g,v])=>{const[b,x,M]=g.split(",").map(Number),E=`#${b.toString(16).padStart(2,"0")}${x.toString(16).padStart(2,"0")}${M.toString(16).padStart(2,"0")}`,P=Math.round(v/w*100);return{hex:E,name:bce(b,x,M),rgb:{r:b,g:x,b:M},percentage:P}});c(y)},h.src=l});return{processImage:async l=>{t(!0),n(0);try{const c=URL.createObjectURL(l);n(10);const u=await i(l),d=await o(u);return n(100),{originalImage:c,processedImage:u,dominantColors:d,primaryColor:d[0]||{hex:"#000000",name:"Black",rgb:{r:0,g:0,b:0},percentage:0}}}finally{t(!1),n(0)}},isProcessing:e,progress:r}},bce=(e,t,r)=>{const n=[{name:"Crimson Red",r:220,g:20,b:60},{name:"Cherry Red",r:222,g:49,b:99},{name:"Burgundy",r:128,g:0,b:32},{name:"Rose Red",r:255,g:102,b:102},{name:"Scarlet",r:255,g:36,b:0},{name:"Royal Blue",r:65,g:105,b:225},{name:"Navy Blue",r:0,g:0,b:128},{name:"Sky Blue",r:135,g:206,b:235},{name:"Deep Blue",r:0,g:0,b:139},{name:"Teal Blue",r:0,g:128,b:128},{name:"Powder Blue",r:176,g:224,b:230},{name:"Forest Green",r:34,g:139,b:34},{name:"Emerald Green",r:80,g:200,b:120},{name:"Olive Green",r:128,g:128,b:0},{name:"Mint Green",r:152,g:251,b:152},{name:"Sage Green",r:154,g:205,b:50},{name:"Lavender",r:230,g:230,b:250},{name:"Coral",r:255,g:127,b:80},{name:"Peach",r:255,g:218,b:185},{name:"Cream",r:255,g:253,b:208},{name:"Beige",r:245,g:245,b:220},{name:"Charcoal",r:54,g:69,b:79},{name:"Ivory",r:255,g:255,b:240},{name:"Red",r:255,g:0,b:0},{name:"Blue",r:0,g:0,b:255},{name:"Green",r:0,g:255,b:0},{name:"Yellow",r:255,g:255,b:0},{name:"Purple",r:128,g:0,b:128},{name:"Orange",r:255,g:165,b:0},{name:"Pink",r:255,g:192,b:203},{name:"Black",r:0,g:0,b:0},{name:"White",r:255,g:255,b:255},{name:"Gray",r:128,g:128,b:128},{name:"Brown",r:165,g:42,b:42}];let s="Unknown",i=1/0;return n.forEach(o=>{const a=Math.sqrt(Math.pow(e-o.r,2)+Math.pow(t-o.g,2)+Math.pow(r-o.b,2));a<i&&(i=a,s=o.name)}),s},xce=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState(0);return{detectPattern:async i=>{t(!0),n(20);try{const o=await AE("image-classification","Xenova/vit-base-patch16-224",{progress_callback:u=>{u.status==="progress"&&n(20+(u.progress||0)*.6)}});n(80);const a=URL.createObjectURL(i),l=await o(a);n(90),URL.revokeObjectURL(a);const c=Mce(l);return n(100),c}catch(o){return console.error("Error detecting pattern:",o),{pattern:"solid",confidence:.5,styleTags:["casual"]}}finally{t(!1),setTimeout(()=>n(0),500)}},isProcessing:e,progress:r}};function Mce(e){const t={striped:["stripe","striped","lines","horizontal","vertical"],floral:["floral","flower","botanical","rose","daisy"],geometric:["geometric","triangle","circle","square","pattern"],plaid:["plaid","checkered","tartan","gingham"],polkadot:["dot","polka","spotted"],animal:["leopard","zebra","snake","animal print"],abstract:["abstract","artistic","modern"],solid:["solid","plain","uniform"]},r={casual:["t-shirt","jeans","casual","everyday"],formal:["suit","dress","formal","elegant","blazer"],sporty:["athletic","sport","gym","active"],bohemian:["boho","hippie","ethnic","tribal"],vintage:["vintage","retro","classic"],modern:["modern","contemporary","minimalist"]};let n="solid",s=0;const i=[];for(const o of e.slice(0,5)){const a=o.label.toLowerCase(),l=o.score;for(const[c,u]of Object.entries(t))u.some(d=>a.includes(d))&&l>s&&(n=c,s=l);for(const[c,u]of Object.entries(r))u.some(d=>a.includes(d))&&(i.includes(c)||i.push(c))}return i.length===0&&i.push("casual"),{pattern:n,confidence:s||.5,styleTags:i}}const Tce=()=>{const[e,t]=C.useState(!1),r=async(a,l,c)=>{t(!0);try{const u=await AE("image-classification","Xenova/vit-base-patch16-224"),d=URL.createObjectURL(a),h=await u(d);URL.revokeObjectURL(d);const f={};return(l==="Tops"||l==="Dresses"||l==="Outerwear")&&(f.sleeveType=n(h,c)),l==="Bottoms"&&(f.pantStyle=s(h,c)),(l==="Tops"||l==="Dresses")&&(f.neckline=i(h)),["Tops","Bottoms","Dresses","Outerwear"].includes(l)&&(f.fit=o(h)),f}catch(u){return console.error("Attribute detection error:",u),{}}finally{t(!1)}},n=(a,l)=>{const c=a.map(u=>u.label.toLowerCase());return c.some(u=>u.includes("tank")||u.includes("sleeveless"))?"Sleeveless":c.some(u=>u.includes("short sleeve")||(l==null?void 0:l.toLowerCase().includes("t-shirt")))?"Short Sleeve":c.some(u=>u.includes("long sleeve")||u.includes("sweater"))?"Long Sleeve":c.some(u=>u.includes("three quarter")||u.includes("3/4"))?"3/4 Sleeve":"Regular"},s=(a,l)=>{const c=a.map(d=>d.label.toLowerCase()),u=(l==null?void 0:l.toLowerCase())||"";return u.includes("jean")||c.some(d=>d.includes("jean"))?"Denim":c.some(d=>d.includes("wide")||d.includes("palazzo"))?"Wide Leg":c.some(d=>d.includes("bell")||d.includes("flare"))?"Bell Bottom":c.some(d=>d.includes("straight"))?"Straight Fit":c.some(d=>d.includes("skinny")||d.includes("tight"))?"Skinny":c.some(d=>d.includes("boot"))?"Bootcut":u.includes("legging")?"Leggings":"Regular"},i=a=>{const l=a.map(c=>c.label.toLowerCase());return l.some(c=>c.includes("v-neck")||c.includes("vneck"))?"V-Neck":l.some(c=>c.includes("crew")||c.includes("round"))?"Crew Neck":l.some(c=>c.includes("turtle"))?"Turtleneck":l.some(c=>c.includes("scoop"))?"Scoop Neck":l.some(c=>c.includes("collar")||c.includes("button"))?"Collared":l.some(c=>c.includes("off shoulder"))?"Off-Shoulder":"Regular"},o=a=>{const l=a.map(c=>c.label.toLowerCase());return l.some(c=>c.includes("oversized")||c.includes("loose"))?"Oversized":l.some(c=>c.includes("slim")||c.includes("fitted"))?"Slim Fit":l.some(c=>c.includes("relaxed"))?"Relaxed":l.some(c=>c.includes("tight")||c.includes("body"))?"Fitted":"Regular"};return{detectAttributes:r,isProcessing:e}},Ece=()=>{const[e,t]=C.useState(!1),r=async s=>{t(!0);try{const{data:i,error:o}=await xr.functions.invoke("generate-item-name",{body:{details:s}});if(o)throw o;return i.name||n(s)}catch(i){return console.error("Error generating name:",i),n(s)}finally{t(!1)}},n=s=>{const i=[];return s.color&&i.push(s.color),s.pattern&&s.pattern!=="solid"&&i.push(s.pattern),s.material&&i.push(s.material),s.sleeveType&&i.push(s.sleeveType),s.pantStyle&&i.push(s.pantStyle),s.neckline&&i.push(s.neckline),s.fit&&i.push(s.fit),i.push(s.subcategory||s.category),i.join(" ")};return{generateName:r,isGenerating:e}},Sce=({result:e,onColorSelect:t,selectedColor:r})=>(vi(),m.jsxs("div",{className:"space-y-4",children:[m.jsxs(BT,{defaultValue:"processed",className:"w-full",children:[m.jsxs(Cy,{className:"grid w-full grid-cols-2",children:[m.jsx(mc,{value:"original",children:"Original"}),m.jsx(mc,{value:"processed",children:"Processed"})]}),m.jsx(gc,{value:"original",className:"mt-4",children:m.jsx(vr,{children:m.jsx(Cr,{className:"p-4",children:m.jsx("img",{src:e.originalImage,alt:"Original",className:"w-full h-48 object-cover rounded-lg"})})})}),m.jsx(gc,{value:"processed",className:"mt-4",children:m.jsx(vr,{children:m.jsx(Cr,{className:"p-4",children:m.jsx("img",{src:e.processedImage,alt:"Background removed",className:"w-full h-48 object-cover rounded-lg bg-gray-100"})})})})]}),m.jsxs(vr,{children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"flex items-center gap-2",children:[m.jsx(P3,{className:"h-5 w-5"}),"Choose the Best Matching Color"]})}),m.jsx(Cr,{children:m.jsx("div",{className:"flex flex-wrap gap-2",children:e.dominantColors.map((n,s)=>{const i=(r==null?void 0:r.hex)===n.hex;return m.jsxs("div",{className:`relative cursor-pointer transition-all ${i?"scale-110 ring-2 ring-primary ring-offset-2":"hover:scale-105"}`,onClick:()=>t(n),children:[m.jsx("div",{className:"w-12 h-12 rounded-lg border-2 border-border",style:{backgroundColor:n.hex}}),i&&m.jsx("div",{className:"absolute -top-1 -right-1 bg-primary rounded-full w-5 h-5 flex items-center justify-center",children:m.jsx(cy,{className:"h-3 w-3 text-white"})}),s===0&&m.jsx("div",{className:"absolute -bottom-1 -right-1 bg-secondary rounded-full w-4 h-4 flex items-center justify-center",children:m.jsx("div",{className:"w-2 h-2 bg-secondary-foreground rounded-full"})})]},s)})})})]})]}));var $E="Checkbox",[Pce,tfe]=Dc($E),[Cce,kce]=Pce($E),iG=C.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:i,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,f]=C.useState(null),p=kr(t,b=>f(b)),_=C.useRef(!1),w=h?u||!!h.closest("form"):!0,[y=!1,g]=Tc({prop:s,defaultProp:i,onChange:c}),v=C.useRef(y);return C.useEffect(()=>{const b=h==null?void 0:h.form;if(b){const x=()=>g(v.current);return b.addEventListener("reset",x),()=>b.removeEventListener("reset",x)}},[h,g]),m.jsxs(Cce,{scope:r,state:y,disabled:a,children:[m.jsx(Nt.button,{type:"button",role:"checkbox","aria-checked":Ka(y)?"mixed":y,"aria-required":o,"data-state":lG(y),"data-disabled":a?"":void 0,disabled:a,value:l,...d,ref:p,onKeyDown:Ct(e.onKeyDown,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:Ct(e.onClick,b=>{g(x=>Ka(x)?!0:!x),w&&(_.current=b.isPropagationStopped(),_.current||b.stopPropagation())})}),w&&m.jsx(Ace,{control:h,bubbles:!_.current,name:n,value:l,checked:y,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Ka(i)?!1:i})]})});iG.displayName=$E;var oG="CheckboxIndicator",aG=C.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...s}=e,i=kce(oG,r);return m.jsx(al,{present:n||Ka(i.state)||i.state===!0,children:m.jsx(Nt.span,{"data-state":lG(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});aG.displayName=oG;var Ace=e=>{const{control:t,checked:r,bubbles:n=!0,defaultChecked:s,...i}=e,o=C.useRef(null),a=CU(r),l=Z3(t);C.useEffect(()=>{const u=o.current,d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(a!==r&&f){const p=new Event("click",{bubbles:n});u.indeterminate=Ka(r),f.call(u,Ka(r)?!1:r),u.dispatchEvent(p)}},[a,r,n]);const c=C.useRef(Ka(r)?!1:r);return m.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??c.current,...i,tabIndex:-1,ref:o,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ka(e){return e==="indeterminate"}function lG(e){return Ka(e)?"indeterminate":e?"checked":"unchecked"}var cG=iG,$ce=aG;const uG=C.forwardRef(({className:e,...t},r)=>m.jsx(cG,{ref:r,className:zt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:m.jsx($ce,{className:zt("flex items-center justify-center text-current"),children:m.jsx(cy,{className:"h-4 w-4"})})}));uG.displayName=cG.displayName;const pR=({label:e,options:t,value:r,onChange:n,className:s})=>{const i=o=>{const a=r.includes(o)?r.filter(l=>l!==o):[...r,o];n(a)};return m.jsxs("div",{className:s,children:[m.jsx("label",{className:"text-sm font-medium",children:e}),m.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:t.map(o=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(uG,{id:`${e}-${o.value}`,checked:r.includes(o.value),onCheckedChange:()=>i(o.value)}),m.jsx("label",{htmlFor:`${e}-${o.value}`,className:"text-sm cursor-pointer",children:o.label})]},o.value))})]})},Ice={general:["Getting you slayed... ","Cooking up some looks... ","Serving fashion realness... ","Making magic happen... ","Your outfit is about to be iconic... ","Preparing your slay... ","Fashion loading... please wait gorgeous! ","Curating your moment... "],weather:["Checking the weather vibes... ","Finding your weather-perfect lewk... ","Matching you to the forecast... ","Weather-checking your style... ","Climate coordinating your outfit... "],outfit:["Styling your perfect combo... ","Curating your fit... ","Assembling your lewk... ","Creating outfit magic... ","Your style moment loading... "],upload:["Analyzing your gorgeous piece... ","Reading the fashion tea... ","Processing your style... ","Getting the deets on your item... ","Fashion scanning in progress... "],colors:["Detecting those stunning colors... ","Reading your color palette... ","Finding your perfect hues... ","Color-coding your vibe... "],save:["Saving to your style vault... ","Adding to your fashion arsenal... ","Storing your iconic piece... ","Your wardrobe is expanding... "]},_c=e=>{const t=Ice[e];return t[Math.floor(Math.random()*t.length)]},dG=({editItem:e,onSave:t})=>{var Be;const[r,n]=C.useState((e==null?void 0:e.name)||""),[s,i]=C.useState((e==null?void 0:e.category)||""),[o,a]=C.useState((e==null?void 0:e.subcategory)||""),[l,c]=C.useState((e==null?void 0:e.seasons)||[]),[u,d]=C.useState((e==null?void 0:e.occasions)||[]),[h,f]=C.useState((e==null?void 0:e.size)||""),[p,_]=C.useState((e==null?void 0:e.material)||""),[w,y]=C.useState((e==null?void 0:e.notes)||""),[g,v]=C.useState(null),[b,x]=C.useState({name:(e==null?void 0:e.color)||"",hex:(e==null?void 0:e.hex_color)||""}),[M,E]=C.useState(null),[P,I]=C.useState(!1),[O,V]=C.useState(!1),[U,B]=C.useState(""),Y=Ys(),{user:K}=Do(),{addItem:X,updateItem:G}=Rd(),{processImage:R,isProcessing:te,progress:re}=wce(),{detectPattern:L,isProcessing:j}=xce(),{detectAttributes:q,isProcessing:ne}=Tce(),{generateName:me,isGenerating:ae}=Ece(),{toast:fe}=vi(),[Pe,Ne]=C.useState((e==null?void 0:e.pattern)||""),[de,Q]=C.useState((e==null?void 0:e.style_tags)||[]),[se,J]=C.useState((e==null?void 0:e.sleeve_type)||""),[be,xe]=C.useState((e==null?void 0:e.pant_style)||""),[Te,Ee]=C.useState((e==null?void 0:e.neckline)||""),[$e,Ie]=C.useState((e==null?void 0:e.fit)||""),Ue=["Tops","Bottoms","Dresses","Outerwear","Shoes","Accessories","Underwear","Sleepwear","Activewear"],Ke={Tops:["T-shirt","Shirt","Blouse","Sweater","Tank Top","Hoodie"],Bottoms:["Jeans","Pants","Shorts","Skirt","Leggings"],Dresses:["Casual","Formal","Maxi","Mini","Midi"],Outerwear:["Jacket","Coat","Blazer","Cardigan"],Shoes:["Sneakers","Boots","Heels","Flats","Sandals"],Accessories:["Bag","Hat","Scarf","Belt","Jewelry"],Underwear:["Bra","Underwear","Socks"],Sleepwear:["Pajamas","Nightgown","Robe"],Activewear:["Sports Bra","Workout Top","Yoga Pants","Shorts"]},Je=[{value:"spring",label:"Spring"},{value:"summer",label:"Summer"},{value:"fall",label:"Fall"},{value:"winter",label:"Winter"}],je=[{value:"casual",label:"Casual"},{value:"work",label:"Work"},{value:"formal",label:"Formal"},{value:"party",label:"Party"},{value:"date",label:"Date"},{value:"workout",label:"Workout"}],qe=async De=>{if(De){V(!0);try{const yt=`${b.name||"colored"} ${s.toLowerCase()} ${o?`(${o.toLowerCase()})`:""} ${p?`made of ${p.toLowerCase()}`:""}`.trim();y(yt),fe({title:"Description generated!",description:"Auto-generated description has been added to notes."})}catch(yt){console.error("Error generating description:",yt),fe({title:"Description generation failed",description:"You can add a description manually.",variant:"destructive"})}finally{V(!1)}}},ot=async De=>{var Mt,Lt;const yt=(Mt=De.target.files)==null?void 0:Mt[0];if(yt){if(!yt.type.startsWith("image/")){fe({title:"Invalid file type",description:"Please select an image file.",variant:"destructive"});return}v(yt);try{const dr=await R(yt);E(dr),dr.primaryColor&&x({name:dr.primaryColor.name,hex:dr.primaryColor.hex});const pr=await L(yt);if(Ne(pr.pattern),Q(pr.styleTags),s){fe({title:"Analyzing details...",description:"Detecting sleeves, fit, and style details"});const at=await q(yt,s,o);at.sleeveType&&J(at.sleeveType),at.pantStyle&&xe(at.pantStyle),at.neckline&&Ee(at.neckline),at.fit&&Ie(at.fit);const Kn=await me({category:s,subcategory:o,color:((Lt=dr.primaryColor)==null?void 0:Lt.name)||b.name,pattern:pr.pattern,material:p,sleeveType:at.sleeveType,pantStyle:at.pantStyle,neckline:at.neckline,fit:at.fit});r||n(Kn),fe({title:"Analysis complete!",description:"Auto-generated name and detected all attributes"})}}catch(dr){console.error("Detection error:",dr),fe({title:"Analysis warning",description:"Some features may be limited. You can still add the item.",variant:"destructive"})}}},ft=De=>{x({name:De.name,hex:De.hex}),fe({title:"Color selected!",description:`Selected ${De.name} as the primary color.`})},it=async De=>{if(!K)throw new Error("No user found");const yt=De.name.split(".").pop(),Mt=`${K.id}/${Date.now()}.${yt}`,{error:Lt}=await xr.storage.from("clothing-images").upload(Mt,De);if(Lt)throw Lt;const{data:dr}=xr.storage.from("clothing-images").getPublicUrl(Mt);return dr.publicUrl},We=async De=>{if(De.preventDefault(),!r.trim()||!s){fe({title:"Required fields missing",description:"Please fill in the name and category.",variant:"destructive"});return}I(!0),B(_c("save"));try{let yt=(e==null?void 0:e.image_url)||"";g&&(yt=await it(g));const Mt={name:r.trim(),category:s,subcategory:o||void 0,color:b.name||"Unknown",hex_color:b.hex||"#808080",pattern:Pe||"solid",style_tags:de.length>0?de:void 0,sleeve_type:se||void 0,pant_style:be||void 0,neckline:Te||void 0,fit:$e||void 0,size:h.trim()||void 0,material:p.trim()||void 0,seasons:l.length>0?l:void 0,occasions:u.length>0?u:void 0,image_url:yt||void 0,notes:w.trim()||void 0,is_favorite:(e==null?void 0:e.is_favorite)||!1};e?(await G(e.id,Mt),fe({title:"Item updated!",description:"Your clothing item has been updated."}),t&&t(Mt)):(await X(Mt),fe({title:"Item added!",description:"Your clothing item has been added to your wardrobe."})),Y("/wardrobe")}catch(yt){console.error("Error saving item:",yt),fe({title:`Error ${e?"updating":"adding"} item`,description:"Please try again.",variant:"destructive"})}finally{I(!1)}};return m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-outfit-primary/5 to-outfit-secondary/5 p-4 space-y-6 pb-20",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>Y(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-outfit-primary to-outfit-secondary bg-clip-text text-transparent",children:e?"Edit Item":"Add Item"}),m.jsx("div",{className:"w-10"})]}),m.jsxs("form",{onSubmit:We,className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Photo"}),m.jsxs("div",{className:"space-y-4",children:[m.jsx(vr,{className:"border-2 border-dashed cursor-pointer hover:bg-accent/50 transition-all interactive-card",onClick:()=>{var De;return(De=document.getElementById("file-input"))==null?void 0:De.click()},children:m.jsx(Cr,{className:"p-6 text-center",children:g||e!=null&&e.image_url?m.jsxs("div",{className:"space-y-2",children:[m.jsx("img",{src:g?URL.createObjectURL(g):e==null?void 0:e.image_url,alt:"Preview",className:"w-32 h-32 object-cover rounded-lg mx-auto"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:g?g.name:"Current image"}),b.hex&&m.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[m.jsx("div",{className:"w-5 h-5 rounded-full border border-gray-300",style:{backgroundColor:b.hex}}),m.jsx("span",{className:"text-sm font-medium",children:b.name})]})]}):m.jsxs("div",{className:"space-y-2",children:[m.jsx(Rq,{className:"h-12 w-12 mx-auto text-muted-foreground"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Tap to upload a photo"})]})})}),m.jsx("input",{id:"file-input",type:"file",accept:"image/*",onChange:ot,className:"hidden"}),m.jsxs(Bt,{type:"button",variant:"outline",className:"w-full mt-2",onClick:()=>{const De=document.createElement("input");De.type="file",De.accept="image/*",De.capture="environment",De.onchange=yt=>{var Lt;const Mt=(Lt=yt.target.files)==null?void 0:Lt[0];Mt&&(v(Mt),ot({target:{files:[Mt]}}))},De.click()},children:[m.jsx(Pq,{className:"h-4 w-4 mr-2"}),"Take Photo"]})]}),(te||j||ne||ae)&&m.jsxs("div",{className:"space-y-3 p-4 bg-gradient-to-r from-outfit-primary/10 to-outfit-secondary/10 rounded-lg",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(P3,{className:"h-4 w-4 text-outfit-primary animate-pulse"}),m.jsx("span",{className:"text-sm font-medium text-outfit-primary",children:te?_c("colors"):j?"Detecting patterns...":ne?"Analyzing sleeves, fit & style...":"Generating name..."})]}),m.jsx(_W,{value:re,className:"w-full"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:te?_c("upload"):"AI is analyzing your item to make adding clothes super easy"})]}),(Pe||se||be||Te||$e)&&m.jsxs("div",{className:"p-3 bg-accent/50 rounded-lg border border-primary/20 space-y-1",children:[m.jsx("p",{className:"text-sm font-medium mb-2",children:" AI Detected Attributes:"}),Pe&&m.jsxs("p",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Pattern:"})," ",Pe]}),se&&m.jsxs("p",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Sleeves:"})," ",se]}),be&&m.jsxs("p",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Pant Style:"})," ",be]}),Te&&m.jsxs("p",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Neckline:"})," ",Te]}),$e&&m.jsxs("p",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Fit:"})," ",$e]}),de.length>0&&m.jsxs("p",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Style Tags:"})," ",de.join(", ")]})]}),M&&m.jsx(Sce,{result:M,onColorSelect:ft,selectedColor:b})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Item Name *"}),m.jsx(ko,{value:r,onChange:De=>n(De.target.value),placeholder:"e.g., Blue Cotton T-shirt",className:"mt-1"})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Category *"}),m.jsxs(bo,{value:s,onValueChange:i,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select category"})}),m.jsx(Ki,{children:Ue.map(De=>m.jsx(qt,{value:De,children:De},De))})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Subcategory"}),m.jsxs(bo,{value:o,onValueChange:a,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select subcategory"})}),m.jsx(Ki,{children:s&&((Be=Ke[s])==null?void 0:Be.map(De=>m.jsx(qt,{value:De,children:De},De)))})]})]})]}),m.jsx(pR,{label:"Seasons",options:Je,value:l,onChange:c}),m.jsx(pR,{label:"Occasions",options:je,value:u,onChange:d}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Size"}),m.jsx(ko,{value:h,onChange:De=>f(De.target.value),placeholder:"e.g., M, L, XL",className:"mt-1"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Material"}),m.jsx(ko,{value:p,onChange:De=>_(De.target.value),placeholder:"e.g., Cotton",className:"mt-1"})]})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("label",{className:"text-sm font-medium",children:"Notes"}),g&&s&&m.jsxs(Bt,{type:"button",variant:"outline",size:"sm",onClick:()=>qe(g),disabled:O,className:"flex items-center gap-1",children:[m.jsx(hs,{className:"h-3 w-3"}),O?"Generating...":"Auto-describe"]})]}),m.jsx($y,{value:w,onChange:De=>y(De.target.value),placeholder:"Any additional notes...",className:"mt-1",rows:3})]})]}),m.jsx(Bt,{type:"submit",className:"w-full interactive-card",disabled:P||!r.trim()||!s,children:P?m.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[m.jsxs("span",{children:[e?"Updating":"Adding"," Item..."]}),m.jsx("span",{className:"text-xs opacity-75",children:U})]}):`${e?"Update":"Add to"} Wardrobe`})]})]})};var Oce="Separator",mR="horizontal",jce=["horizontal","vertical"],hG=C.forwardRef((e,t)=>{const{decorative:r,orientation:n=mR,...s}=e,i=Dce(n)?n:mR,a=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return m.jsx(Nt.div,{"data-orientation":i,...a,...s,ref:t})});hG.displayName=Oce;function Dce(e){return jce.includes(e)}var fG=hG;const O1=C.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},s)=>m.jsx(fG,{ref:s,decorative:r,orientation:t,className:zt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));O1.displayName=fG.displayName;const Nce=ly("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Wn({className:e,variant:t,...r}){return m.jsx("div",{className:zt(Nce({variant:t}),e),...r})}const Rce=()=>{const{id:e}=jB(),t=Ys(),{items:r,updateItem:n,deleteItem:s}=Rd(),{toast:i}=vi(),[o,a]=C.useState(!1),l=r.find(f=>f.id===e),c=()=>{a(!1)},u=async()=>{if(l&&window.confirm("Are you sure you want to delete this item?"))try{await s(l.id),i({title:"Item deleted",description:"The item has been removed from your wardrobe."}),t("/wardrobe")}catch{i({title:"Error deleting item",description:"Please try again.",variant:"destructive"})}},d=async()=>{if(l)try{await n(l.id,{is_favorite:!l.is_favorite}),i({title:l.is_favorite?"Removed from favorites":"Added to favorites",description:l.is_favorite?"Item removed from favorites.":"Item added to favorites."})}catch{i({title:"Error updating item",description:"Please try again.",variant:"destructive"})}},h=async()=>{if(l)try{await n(l.id,{times_worn:l.times_worn+1,last_worn:new Date().toISOString().split("T")[0]}),i({title:"Item marked as worn",description:"Your wear count has been updated."})}catch{i({title:"Error updating item",description:"Please try again.",variant:"destructive"})}};return l?o?m.jsx(dG,{editItem:l,onSave:c}):m.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold",children:"Item Details"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:d,children:m.jsx(Ao,{className:`h-5 w-5 ${l.is_favorite?"fill-red-500 text-red-500":""}`})}),m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>a(!0),children:m.jsx($3,{className:"h-5 w-5"})})]})]}),m.jsx("div",{className:"aspect-square w-full overflow-hidden bg-muted rounded-md",children:l.image_url?m.jsx("img",{src:l.image_url,alt:l.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center",children:m.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-gray-300",style:{backgroundColor:l.hex_color||l.color}})})}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-2xl font-bold",children:l.name}),m.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[m.jsx(Wn,{children:l.category}),l.subcategory&&m.jsx(Wn,{variant:"outline",children:l.subcategory}),m.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:l.hex_color||l.color}})]})]}),m.jsx(O1,{}),m.jsxs("div",{className:"space-y-4",children:[l.size&&m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Size"}),m.jsx("p",{children:l.size})]}),l.material&&m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Material"}),m.jsx("p",{children:l.material})]}),l.seasons&&l.seasons.length>0&&m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Seasons"}),m.jsx("div",{className:"flex gap-1 flex-wrap",children:l.seasons.map(f=>m.jsx(Wn,{variant:"outline",className:"text-xs",children:f},f))})]}),l.occasions&&l.occasions.length>0&&m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Occasions"}),m.jsx("div",{className:"flex gap-1 flex-wrap",children:l.occasions.map(f=>m.jsx(Wn,{variant:"outline",className:"text-xs",children:f},f))})]}),l.notes&&m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),m.jsx("p",{children:l.notes})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Date Added"}),m.jsx("p",{children:new Date(l.created_at).toLocaleDateString()})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Times Worn"}),m.jsx("p",{children:l.times_worn})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Last Worn"}),m.jsx("p",{children:l.last_worn?new Date(l.last_worn).toLocaleDateString():"Never"})]})]}),m.jsx(O1,{}),m.jsxs("div",{className:"space-y-3",children:[m.jsx(Bt,{onClick:h,className:"w-full",children:"Mark as Worn Today"}),m.jsxs(Bt,{variant:"destructive",onClick:u,className:"w-full flex items-center gap-2",children:[m.jsx(I3,{className:"h-4 w-4"}),"Remove from Wardrobe"]})]})]}):m.jsxs("div",{className:"p-4 text-center",children:[m.jsx("p",{className:"text-muted-foreground",children:"Item not found"}),m.jsx(Bt,{onClick:()=>t("/wardrobe"),className:"mt-4",children:"Back to Wardrobe"})]})},Fce=()=>{const[e,t]=C.useState(""),[r,n]=C.useState(""),[s,i]=C.useState(""),[o,a]=C.useState(""),[l,c]=C.useState(""),[u,d]=C.useState([]),[h,f]=C.useState(!1),[p,_]=C.useState(""),[w,y]=C.useState(!1),[g,v]=C.useState(""),b=Ys(),{items:x}=Rd(),{createOutfit:M}=Fd(),{toast:E}=vi(),P=V=>{d(U=>U.includes(V)?U.filter(B=>B!==V):[...U,V])},I=async V=>{try{const U=await fetch("https://kicpepyarfiorraejwqh.functions.supabase.co/functions/v1/outfit-description",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:V,occasion:o,weather:l,season:s})});if(U.ok)return await U.json()}catch(U){console.error("Error generating AI descriptions:",U)}return null},O=async V=>{var U,B;if(V.preventDefault(),!e.trim()){E({title:"Name required",description:"Please enter a name for your outfit.",variant:"destructive"});return}if(u.length===0){E({title:"Select items",description:"Please select at least one item for your outfit.",variant:"destructive"});return}f(!0),_(_c("outfit"));try{const Y=x.filter(G=>u.includes(G.id)),K=await I(Y),X=r.trim()||(K==null?void 0:K.mainDescription)||void 0;if(await M({name:e.trim(),description:X,season:s||void 0,occasion:o||void 0,weather:l||void 0,itemIds:u}),K!=null&&K.alternatives&&K.alternatives.length>0)for(const G of K.alternatives){const R=G.items.map(te=>{const re=Y.find(L=>L.name.toLowerCase().includes(te.toLowerCase())||te.toLowerCase().includes(L.name.toLowerCase()));return re==null?void 0:re.id}).filter(Boolean);R.length>0&&await M({name:`${e.trim()} - ${G.name}`,description:G.description,season:s||void 0,occasion:o||void 0,weather:l||void 0,itemIds:R})}v(((U=K==null?void 0:K.alternatives)==null?void 0:U.length)>0?`Stunning! I created ${1+K.alternatives.length} outfit variations for you! `:"Gorgeous outfit created, bestie! You're gonna look amazing! "),y(!0),E({title:"Outfit created!",description:((B=K==null?void 0:K.alternatives)==null?void 0:B.length)>0?`Created ${1+K.alternatives.length} outfit variations!`:"Your new outfit has been saved to your collection."}),setTimeout(()=>{b("/outfits")},2e3)}catch(Y){console.error("Error creating outfit:",Y),E({title:"Error creating outfit",description:"Please try again.",variant:"destructive"})}finally{f(!1)}};return m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-outfit-primary/5 to-outfit-secondary/5 p-4 space-y-6 pb-20",children:[m.jsx(ky,{message:g,isVisible:w,onClose:()=>y(!1),autoHide:!0,duration:3e3}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>b(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-outfit-primary to-outfit-secondary bg-clip-text text-transparent",children:"Create Outfit"}),m.jsx("div",{className:"w-10"})]}),m.jsxs("form",{onSubmit:O,className:"space-y-6",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Outfit Name *"}),m.jsx(ko,{value:e,onChange:V=>t(V.target.value),placeholder:"e.g., Summer Casual",className:"mt-1"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Description"}),m.jsx($y,{value:r,onChange:V=>n(V.target.value),placeholder:"Optional description...",className:"mt-1",rows:3})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Season"}),m.jsxs(bo,{value:s,onValueChange:i,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select season"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"spring",children:"Spring"}),m.jsx(qt,{value:"summer",children:"Summer"}),m.jsx(qt,{value:"fall",children:"Fall"}),m.jsx(qt,{value:"winter",children:"Winter"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Occasion"}),m.jsxs(bo,{value:o,onValueChange:a,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select occasion"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"casual",children:"Casual"}),m.jsx(qt,{value:"work",children:"Work"}),m.jsx(qt,{value:"formal",children:"Formal"}),m.jsx(qt,{value:"party",children:"Party"}),m.jsx(qt,{value:"date",children:"Date"}),m.jsx(qt,{value:"workout",children:"Workout"})]})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Weather"}),m.jsxs(bo,{value:l,onValueChange:c,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select weather"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"sunny",children:"Sunny"}),m.jsx(qt,{value:"cloudy",children:"Cloudy"}),m.jsx(qt,{value:"rainy",children:"Rainy"}),m.jsx(qt,{value:"cold",children:"Cold"}),m.jsx(qt,{value:"hot",children:"Hot"})]})]})]})]}),m.jsxs("div",{children:[m.jsxs("h3",{className:"text-sm font-medium mb-3",children:["Select Items (",u.length,")"]}),x.length===0?m.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No items in your wardrobe yet. Add some items first!"}):m.jsx("div",{className:"grid grid-cols-2 gap-3",children:x.map(V=>m.jsx(vr,{className:`cursor-pointer transition-all interactive-card ${u.includes(V.id)?"ring-2 ring-outfit-primary bg-gradient-to-br from-outfit-primary/10 to-outfit-secondary/10 shadow-glow":"hover:bg-accent hover:shadow-elegant"}`,onClick:()=>P(V.id),children:m.jsxs(Cr,{className:"p-3",children:[m.jsxs("div",{className:"aspect-square bg-muted rounded-md overflow-hidden mb-2 relative",children:[V.image_url?m.jsx("img",{src:V.image_url,alt:V.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center",children:m.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundColor:V.hex_color||V.color}})}),u.includes(V.id)&&m.jsx("div",{className:"absolute top-2 right-2 bg-outfit-primary text-white rounded-full p-1",children:m.jsx(cy,{className:"h-3 w-3"})})]}),m.jsx("h4",{className:"text-sm font-medium truncate",children:V.name}),m.jsx("p",{className:"text-xs text-muted-foreground",children:V.category})]})},V.id))})]}),m.jsx(Bt,{type:"submit",className:"w-full interactive-card",disabled:h||!e.trim(),children:h?m.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[m.jsx("span",{children:"Creating..."}),m.jsx("span",{className:"text-xs opacity-75",children:p})]}):"Create Outfit"})]})]})},Lce=()=>{var h;const{id:e}=jB(),t=Ys(),{outfits:r,loading:n,deleteOutfit:s,toggleFavorite:i,updateOutfit:o}=Fd(),{toast:a}=vi(),l=r.find(f=>f.id===e),c=async()=>{if(l&&window.confirm("Are you sure you want to delete this outfit?"))try{await s(l.id),a({title:"Outfit deleted",description:"The outfit has been removed from your collection."}),t("/outfits")}catch{a({title:"Error deleting outfit",description:"Please try again.",variant:"destructive"})}},u=async()=>{if(l)try{await i(l.id),a({title:l.is_favorite?"Removed from favorites":"Added to favorites",description:l.is_favorite?"Outfit removed from favorites.":"Outfit added to favorites."})}catch{a({title:"Error updating outfit",description:"Please try again.",variant:"destructive"})}},d=async()=>{if(l)try{await o(l.id,{times_worn:l.times_worn+1,last_worn:new Date().toISOString().split("T")[0]}),a({title:"Outfit marked as worn",description:"Your wear count has been updated."})}catch{a({title:"Error updating outfit",description:"Please try again.",variant:"destructive"})}};return n?m.jsxs("div",{className:"p-4 space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx(Nu,{className:"h-6 w-32"}),m.jsx("div",{className:"w-10"})]}),m.jsx(Nu,{className:"h-48 w-full rounded-lg"}),m.jsxs("div",{className:"space-y-4",children:[m.jsx(Nu,{className:"h-4 w-3/4"}),m.jsx(Nu,{className:"h-4 w-1/2"})]})]}):l?m.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold",children:"Outfit Details"}),m.jsx(Bt,{variant:"ghost",size:"icon",onClick:u,children:m.jsx(Ao,{className:`h-5 w-5 ${l.is_favorite?"fill-red-500 text-red-500":""}`})})]}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-2xl font-bold mb-2",children:l.name}),l.description&&m.jsx("p",{className:"text-muted-foreground mb-4",children:l.description}),m.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[l.season&&m.jsx(Wn,{variant:"secondary",children:l.season}),l.occasion&&m.jsx(Wn,{variant:"secondary",children:l.occasion}),l.weather&&m.jsx(Wn,{variant:"secondary",children:l.weather})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-muted-foreground",children:"Times worn:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.times_worn})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-muted-foreground",children:"Last worn:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.last_worn?new Date(l.last_worn).toLocaleDateString():"Never"})]})]})]}),m.jsxs("div",{children:[m.jsxs("h3",{className:"font-medium mb-3",children:["Items in this outfit (",((h=l.items)==null?void 0:h.length)||0,")"]}),l.items&&l.items.length>0?m.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.items.map(f=>{var p,_,w,y;return m.jsx(vr,{className:"cursor-pointer hover:bg-accent",onClick:()=>t(`/wardrobe/item/${f.clothing_item_id}`),children:m.jsxs(Cr,{className:"p-3",children:[m.jsx("div",{className:"aspect-square bg-muted rounded-md overflow-hidden mb-2",children:(p=f.clothing_item)!=null&&p.image_url?m.jsx("img",{src:f.clothing_item.image_url,alt:f.clothing_item.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center",children:m.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundColor:(_=f.clothing_item)==null?void 0:_.color}})})}),m.jsx("h4",{className:"text-sm font-medium truncate",children:(w=f.clothing_item)==null?void 0:w.name}),m.jsx("p",{className:"text-xs text-muted-foreground",children:(y=f.clothing_item)==null?void 0:y.category})]})},f.id)})}):m.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No items in this outfit"})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsx(Bt,{onClick:d,className:"w-full",children:"Mark as Worn Today"}),m.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[m.jsxs(Bt,{variant:"outline",className:"flex items-center gap-2",children:[m.jsx(Dq,{className:"h-4 w-4"}),"Share"]}),m.jsxs(Bt,{variant:"outline",className:"flex items-center gap-2",children:[m.jsx($3,{className:"h-4 w-4"}),"Edit"]})]}),m.jsxs(Bt,{variant:"destructive",onClick:c,className:"w-full flex items-center gap-2",children:[m.jsx(I3,{className:"h-4 w-4"}),"Delete Outfit"]})]})]}):m.jsxs("div",{className:"p-4 text-center",children:[m.jsx("p",{className:"text-muted-foreground",children:"Outfit not found"}),m.jsx(Bt,{onClick:()=>t("/outfits"),className:"mt-4",children:"Back to Outfits"})]})},pG=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!1),{user:s}=Do();return{suggestions:e,loading:r,generateSuggestions:async a=>{if(s){n(!0);try{const{data:l,error:c}=await xr.functions.invoke("fashion-stylist",{body:{filters:a,user_id:s.id}});if(c)throw c;const u=await Promise.all((l.outfits||[]).map(async d=>{const{data:h}=await xr.from("clothing_items").select("id, name, image_url").eq("user_id",s.id),f=d.items.map(p=>{const _=h==null?void 0:h.find(w=>w.name.toLowerCase()===p.toLowerCase());return _?{name:_.name,image_url:_.image_url,id:_.id}:{name:p,image_url:"",id:""}});return{...d,items:f}}));t(u)}catch(l){console.error("Error generating suggestions:",l),t([])}finally{n(!1)}}},saveOutfit:async a=>{if(s)try{const{data:l,error:c}=await xr.from("clothing_items").select("*").eq("user_id",s.id);if(c)throw c;const u=a.items.map(_=>l==null?void 0:l.find(w=>w.name.toLowerCase()===_.name.toLowerCase())).filter(Boolean);if(u.length===0)throw new Error("No matching items found");const{data:d,error:h}=await xr.from("outfits").insert({user_id:s.id,name:a.title,description:a.reasoning,occasion:a.occasion}).select().single();if(h)throw h;const f=u.map(_=>({outfit_id:d.id,clothing_item_id:_.id})),{error:p}=await xr.from("outfit_items").insert(f);if(p)throw p;return d}catch(l){throw console.error("Error saving outfit:",l),l}}}},Bce=()=>{const[e,t]=C.useState(""),[r,n]=C.useState(""),[s,i]=C.useState(""),[o,a]=C.useState(""),[l,c]=C.useState(""),[u,d]=C.useState(!1),[h,f]=C.useState(""),p=Ys(),{suggestions:_,loading:w,generateSuggestions:y,saveOutfit:g}=pG(),{toast:v}=vi(),b=async()=>{c(_c("outfit")),await y({occasion:e||void 0,weather:r||void 0,season:s||void 0,style:o||void 0})},x=async M=>{try{await g(M),f("Perfect choice, gorgeous! That outfit is absolutely divine! "),d(!0),v({title:"Outfit saved!",description:"Added to your collection "})}catch{v({title:"Error",description:"Failed to save outfit",variant:"destructive"})}};return m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-outfit-primary/5 to-outfit-secondary/5 p-4 space-y-6 pb-20",children:[m.jsx(ky,{message:h,isVisible:u,onClose:()=>d(!1),autoHide:!0,duration:3e3}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>p(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-outfit-primary to-outfit-secondary bg-clip-text text-transparent",children:"Outfit Suggestions"}),m.jsx("div",{className:"w-10"})]}),m.jsxs(vr,{className:"border-0 shadow-elegant backdrop-blur-sm bg-white/80 interactive-card",children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"flex items-center gap-2",children:[m.jsx(hs,{className:"h-5 w-5"}),"Get AI Suggestions"]})}),m.jsxs(Cr,{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Occasion"}),m.jsxs(bo,{value:e,onValueChange:t,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select occasion"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"casual",children:"Casual"}),m.jsx(qt,{value:"work",children:"Work"}),m.jsx(qt,{value:"formal",children:"Formal"}),m.jsx(qt,{value:"party",children:"Party"}),m.jsx(qt,{value:"date",children:"Date"}),m.jsx(qt,{value:"workout",children:"Workout"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Weather"}),m.jsxs(bo,{value:r,onValueChange:n,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select weather"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"sunny",children:"Sunny"}),m.jsx(qt,{value:"cloudy",children:"Cloudy"}),m.jsx(qt,{value:"rainy",children:"Rainy"}),m.jsx(qt,{value:"cold",children:"Cold"}),m.jsx(qt,{value:"hot",children:"Hot"})]})]})]})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Season"}),m.jsxs(bo,{value:s,onValueChange:i,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select season"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"spring",children:"Spring"}),m.jsx(qt,{value:"summer",children:"Summer"}),m.jsx(qt,{value:"fall",children:"Fall"}),m.jsx(qt,{value:"winter",children:"Winter"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Style"}),m.jsxs(bo,{value:o,onValueChange:a,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select style"})}),m.jsxs(Ki,{children:[m.jsx(qt,{value:"minimalist",children:"Minimalist"}),m.jsx(qt,{value:"trendy",children:"Trendy"}),m.jsx(qt,{value:"classic",children:"Classic"}),m.jsx(qt,{value:"bohemian",children:"Bohemian"}),m.jsx(qt,{value:"edgy",children:"Edgy"})]})]})]})]}),m.jsx(Bt,{onClick:b,className:"w-full",disabled:w,children:w?m.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[m.jsx(Cg,{className:"h-4 w-4 animate-spin"}),m.jsx("span",{className:"text-xs",children:l})]}):m.jsxs(m.Fragment,{children:[m.jsx(hs,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})})]})]}),_.length>0&&m.jsxs("div",{className:"space-y-4",children:[m.jsx("h2",{className:"text-lg font-semibold",children:"Suggested Outfits"}),_.map((M,E)=>m.jsx(vr,{className:"border-0 shadow-elegant backdrop-blur-sm bg-white/80 interactive-card animate-fade-in",children:m.jsxs(Cr,{className:"p-4",children:[m.jsxs("div",{className:"flex justify-between items-start mb-3",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold",children:M.title}),m.jsx("p",{className:"text-sm text-muted-foreground",children:M.reasoning})]}),m.jsxs(Wn,{variant:"secondary",children:[M.match_score," match"]})]}),m.jsxs("div",{className:"space-y-3 mb-3",children:[m.jsx("h4",{className:"text-sm font-medium",children:"Items in this outfit:"}),m.jsx("div",{className:"grid grid-cols-3 gap-2",children:M.items.map((P,I)=>m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"aspect-square bg-muted rounded-md overflow-hidden mb-1",children:P.image_url?m.jsx("img",{src:P.image_url,alt:P.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"No Image"})}),m.jsx(Wn,{variant:"outline",className:"text-xs",children:P.name})]},I))}),M.footwear&&m.jsxs("div",{className:"mt-3",children:[m.jsx("h5",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Footwear:"}),m.jsx(Wn,{variant:"secondary",className:"text-xs",children:M.footwear})]}),M.accessories&&m.jsxs("div",{className:"mt-2",children:[m.jsx("h5",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Accessories:"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:M.accessories})]})]}),m.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-3",children:[m.jsxs("span",{children:[M.items.length," items"]}),m.jsx(Wn,{variant:"outline",children:M.occasion})]}),m.jsxs(Bt,{onClick:()=>x(M),variant:"outline",className:"w-full",children:[m.jsx(k3,{className:"h-4 w-4 mr-2"}),"Save This Outfit"]})]})},E))]}),!w&&_.length===0&&m.jsx(vr,{children:m.jsxs(Cr,{className:"p-8 text-center",children:[m.jsx(hs,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),m.jsx("h3",{className:"font-medium mb-2",children:"Ready for suggestions?"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:'Set your preferences above and click "Generate Suggestions" to get personalized outfit ideas based on your wardrobe.'})]})})]})},zce=()=>{const[e,t]=C.useState(null),[r,n]=C.useState(!1),[s,i]=C.useState(!1),[o,a]=C.useState(""),[l,c]=C.useState(!1),[u,d]=C.useState(""),h=Ys(),{suggestions:f,loading:p,generateSuggestions:_,saveOutfit:w}=pG(),{toast:y}=vi(),g=async()=>{i(!0);try{const M=await new Promise((O,V)=>{navigator.geolocation.getCurrentPosition(O,V)}),{latitude:E,longitude:P}=M.coords,I=await fetch("https://kicpepyarfiorraejwqh.functions.supabase.co/functions/v1/weather-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({latitude:E,longitude:P})});if(I.ok){const O=await I.json();t(O)}else throw new Error("Weather API failed")}catch{t({temperature:22,description:"partly cloudy",condition:"cloudy",location:"Current Location"}),y({title:"Using demo weather",description:"Unable to fetch real weather data. Using sample data for demonstration."})}finally{i(!1)}};C.useEffect(()=>{g()},[]);const v=async()=>{if(!e)return;n(!0),a(_c("weather"));const M=b();await _({weather:e.condition,season:M,occasion:"casual"}),n(!1)},b=()=>{const M=new Date().getMonth();return M>=2&&M<=4?"spring":M>=5&&M<=7?"summer":M>=8&&M<=10?"fall":"winter"},x=async M=>{try{await w(M),d("Yass! That outfit is now in your collection, bestie! "),c(!0),y({title:"Outfit saved!",description:"Added to your collection "})}catch{y({title:"Error",description:"Failed to save outfit",variant:"destructive"})}};return m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-outfit-primary/5 to-outfit-secondary/5 p-4 space-y-6 pb-20",children:[m.jsx(ky,{message:u,isVisible:l,onClose:()=>c(!1),autoHide:!0,duration:3e3}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>h(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-outfit-primary to-outfit-secondary bg-clip-text text-transparent",children:"Weather Outfits"}),m.jsx("div",{className:"w-10"})]}),m.jsxs(vr,{className:"border-0 shadow-elegant backdrop-blur-sm bg-white/80 interactive-card",children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"flex items-center gap-2",children:[m.jsx(Pg,{className:"h-5 w-5 text-outfit-primary"}),"Current Weather"]})}),m.jsx(Cr,{children:s?m.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-3",children:[m.jsx(Cg,{className:"h-6 w-6 animate-spin text-outfit-primary"}),m.jsx("p",{className:"text-sm text-outfit-primary animate-pulse",children:_c("general")})]}):e?m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Oq,{className:"h-4 w-4 text-muted-foreground"}),m.jsx("span",{className:"text-sm text-muted-foreground",children:e.location})]}),m.jsx(Wn,{variant:"secondary",className:"capitalize",children:e.condition})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Nq,{className:"h-5 w-5 text-outfit-accent"}),m.jsxs("span",{className:"text-2xl font-bold text-outfit-primary",children:[e.temperature,"C"]})]}),m.jsx("span",{className:"text-muted-foreground capitalize",children:e.description})]}),m.jsx(Bt,{onClick:v,className:"w-full interactive-card",disabled:r||p,children:r||p?m.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[m.jsx(Cg,{className:"h-4 w-4 animate-spin"}),m.jsx("span",{className:"text-xs",children:o})]}):m.jsxs(m.Fragment,{children:[m.jsx(Pg,{className:"h-4 w-4 mr-2"}),"Get Weather-Based Outfits"]})})]}):m.jsx("div",{className:"text-center py-4",children:m.jsxs(Bt,{onClick:g,variant:"outline",children:[m.jsx(Cg,{className:"h-4 w-4 mr-2"}),"Retry Weather Fetch"]})})})]}),f.length>0&&m.jsxs("div",{className:"space-y-4",children:[m.jsx("h2",{className:"text-lg font-semibold bg-gradient-to-r from-outfit-primary to-outfit-secondary bg-clip-text text-transparent",children:"Weather-Perfect Outfits"}),f.map((M,E)=>m.jsx(vr,{className:"border-0 shadow-elegant backdrop-blur-sm bg-white/80 interactive-card animate-fade-in",children:m.jsxs(Cr,{className:"p-4",children:[m.jsxs("div",{className:"flex justify-between items-start mb-3",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold text-outfit-dark",children:M.title}),m.jsx("p",{className:"text-sm text-muted-foreground",children:M.reasoning})]}),m.jsxs(Wn,{variant:"secondary",className:"bg-gradient-to-r from-outfit-primary to-outfit-secondary text-white border-0",children:[M.match_score," match"]})]}),m.jsxs("div",{className:"space-y-3 mb-3",children:[m.jsx("h4",{className:"text-sm font-medium",children:"Perfect for this weather:"}),m.jsx("div",{className:"grid grid-cols-3 gap-2",children:M.items.map((P,I)=>m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"aspect-square bg-gradient-to-br from-outfit-primary/5 to-outfit-secondary/5 rounded-xl overflow-hidden mb-1 border border-outfit-primary/10",children:P.image_url?m.jsx("img",{src:P.image_url,alt:P.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"No Image"})}),m.jsx(Wn,{variant:"outline",className:"text-xs border-outfit-primary/20",children:P.name})]},I))}),M.footwear&&m.jsxs("div",{className:"mt-3",children:[m.jsx("h5",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Recommended Footwear:"}),m.jsx(Wn,{variant:"secondary",className:"text-xs",children:M.footwear})]}),M.accessories&&m.jsxs("div",{className:"mt-2",children:[m.jsx("h5",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Weather Accessories:"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:M.accessories})]})]}),m.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-3",children:[m.jsxs("span",{children:[M.items.length," items"]}),m.jsxs(Wn,{variant:"outline",className:"border-outfit-primary/20",children:[e==null?void 0:e.condition," ready"]})]}),m.jsxs(Bt,{onClick:()=>x(M),variant:"outline",className:"w-full border-outfit-primary/20 hover:bg-gradient-to-r hover:from-outfit-primary hover:to-outfit-secondary hover:text-white",children:[m.jsx(k3,{className:"h-4 w-4 mr-2"}),"Save Weather Outfit"]})]})},E))]}),!r&&!p&&f.length===0&&e&&m.jsx(vr,{className:"border-0 shadow-elegant backdrop-blur-sm bg-white/80",children:m.jsxs(Cr,{className:"p-8 text-center",children:[m.jsx(Pg,{className:"h-12 w-12 mx-auto mb-4 text-outfit-primary"}),m.jsx("h3",{className:"font-medium mb-2 text-outfit-dark",children:"Ready for weather-perfect outfits?"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:'Click "Get Weather-Based Outfits" to receive personalized suggestions based on current weather conditions.'})]})})]})};function cr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ks(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function us(e,t){const r=cr(e);return isNaN(t)?Ks(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function to(e,t){const r=cr(e);if(isNaN(t))return Ks(e,NaN);if(!t)return r;const n=r.getDate(),s=Ks(e,r.getTime());s.setMonth(r.getMonth()+t+1,0);const i=s.getDate();return n>=i?s:(r.setFullYear(s.getFullYear(),s.getMonth(),n),r)}const IE=6048e5,Vce=864e5;let Uce={};function vp(){return Uce}function Io(e,t){var a,l,c,u;const r=vp(),n=(t==null?void 0:t.weekStartsOn)??((l=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=cr(e),i=s.getDay(),o=(i<n?7:0)+i-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function $c(e){return Io(e,{weekStartsOn:1})}function mG(e){const t=cr(e),r=t.getFullYear(),n=Ks(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=$c(n),i=Ks(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=$c(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function xd(e){const t=cr(e);return t.setHours(0,0,0,0),t}function z_(e){const t=cr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Mo(e,t){const r=xd(e),n=xd(t),s=+r-z_(r),i=+n-z_(n);return Math.round((s-i)/Vce)}function Wce(e){const t=mG(e),r=Ks(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),$c(r)}function j1(e,t){const r=t*7;return us(e,r)}function Gce(e,t){return to(e,t*12)}function Hce(e){let t;return e.forEach(function(r){const n=cr(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function Kce(e){let t;return e.forEach(r=>{const n=cr(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function Ts(e,t){const r=xd(e),n=xd(t);return+r==+n}function OE(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function qce(e){if(!OE(e)&&typeof e!="number")return!1;const t=cr(e);return!isNaN(Number(t))}function tp(e,t){const r=cr(e),n=cr(t),s=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return s*12+i}function Qce(e,t,r){const n=Io(e,r),s=Io(t,r),i=+n-z_(n),o=+s-z_(s);return Math.round((i-o)/IE)}function jE(e){const t=cr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Cs(e){const t=cr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function gG(e){const t=cr(e),r=Ks(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function DE(e,t){var a,l,c,u;const r=vp(),n=(t==null?void 0:t.weekStartsOn)??((l=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=cr(e),i=s.getDay(),o=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function _G(e){return DE(e,{weekStartsOn:1})}const Yce={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Xce=(e,t,r)=>{let n;const s=Yce[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function lb(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Jce={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Zce={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},eue={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},tue={date:lb({formats:Jce,defaultWidth:"full"}),time:lb({formats:Zce,defaultWidth:"full"}),dateTime:lb({formats:eue,defaultWidth:"full"})},rue={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},nue=(e,t,r,n)=>rue[e];function zh(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,a=r!=null&&r.width?String(r.width):o;s=e.formattingValues[a]||e.formattingValues[o]}else{const o=e.defaultWidth,a=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[a]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const sue={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},iue={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},oue={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},aue={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},lue={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},cue={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},uue=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},due={ordinalNumber:uue,era:zh({values:sue,defaultWidth:"wide"}),quarter:zh({values:iue,defaultWidth:"wide",argumentCallback:e=>e-1}),month:zh({values:oue,defaultWidth:"wide"}),day:zh({values:aue,defaultWidth:"wide"}),dayPeriod:zh({values:lue,defaultWidth:"wide",formattingValues:cue,defaultFormattingWidth:"wide"})};function Vh(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],a=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(a)?fue(a,d=>d.test(o)):hue(a,d=>d.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function hue(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function fue(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function pue(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const a=t.slice(s.length);return{value:o,rest:a}}}const mue=/^(\d+)(th|st|nd|rd)?/i,gue=/\d+/i,_ue={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},yue={any:[/^b/i,/^(a|c)/i]},vue={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wue={any:[/1/i,/2/i,/3/i,/4/i]},bue={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},xue={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Mue={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Tue={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Eue={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Sue={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Pue={ordinalNumber:pue({matchPattern:mue,parsePattern:gue,valueCallback:e=>parseInt(e,10)}),era:Vh({matchPatterns:_ue,defaultMatchWidth:"wide",parsePatterns:yue,defaultParseWidth:"any"}),quarter:Vh({matchPatterns:vue,defaultMatchWidth:"wide",parsePatterns:wue,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Vh({matchPatterns:bue,defaultMatchWidth:"wide",parsePatterns:xue,defaultParseWidth:"any"}),day:Vh({matchPatterns:Mue,defaultMatchWidth:"wide",parsePatterns:Tue,defaultParseWidth:"any"}),dayPeriod:Vh({matchPatterns:Eue,defaultMatchWidth:"any",parsePatterns:Sue,defaultParseWidth:"any"})},yG={code:"en-US",formatDistance:Xce,formatLong:tue,formatRelative:nue,localize:due,match:Pue,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Cue(e){const t=cr(e);return Mo(t,gG(t))+1}function vG(e){const t=cr(e),r=+$c(t)-+Wce(t);return Math.round(r/IE)+1}function wG(e,t){var u,d,h,f;const r=cr(e),n=r.getFullYear(),s=vp(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((f=(h=s.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=Ks(e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const a=Io(o,t),l=Ks(e,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const c=Io(l,t);return r.getTime()>=a.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function kue(e,t){var a,l,c,u;const r=vp(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=wG(e,t),i=Ks(e,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),Io(i,t)}function bG(e,t){const r=cr(e),n=+Io(r,t)-+kue(r,t);return Math.round(n/IE)+1}function br(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const va={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return br(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):br(r+1,2)},d(e,t){return br(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return br(e.getHours()%12||12,t.length)},H(e,t){return br(e.getHours(),t.length)},m(e,t){return br(e.getMinutes(),t.length)},s(e,t){return br(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return br(s,t.length)}},pu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},gR={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return va.y(e,t)},Y:function(e,t,r,n){const s=wG(e,n),i=s>0?s:1-s;if(t==="YY"){const o=i%100;return br(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):br(i,t.length)},R:function(e,t){const r=mG(e);return br(r,t.length)},u:function(e,t){const r=e.getFullYear();return br(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return br(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return br(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return va.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return br(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=bG(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):br(s,t.length)},I:function(e,t,r){const n=vG(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):br(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):va.d(e,t)},D:function(e,t,r){const n=Cue(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):br(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return br(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return br(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return br(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=pu.noon:n===0?s=pu.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=pu.evening:n>=12?s=pu.afternoon:n>=4?s=pu.morning:s=pu.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return va.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):va.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):br(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):br(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):va.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):va.s(e,t)},S:function(e,t){return va.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return yR(n);case"XXXX":case"XX":return Ql(n);case"XXXXX":case"XXX":default:return Ql(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return yR(n);case"xxxx":case"xx":return Ql(n);case"xxxxx":case"xxx":default:return Ql(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_R(n,":");case"OOOO":default:return"GMT"+Ql(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_R(n,":");case"zzzz":default:return"GMT"+Ql(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return br(n,t.length)},T:function(e,t,r){const n=e.getTime();return br(n,t.length)}};function _R(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+t+br(i,2)}function yR(e,t){return e%60===0?(e>0?"-":"+")+br(Math.abs(e)/60,2):Ql(e,t)}function Ql(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=br(Math.trunc(n/60),2),i=br(n%60,2);return r+s+t+i}const vR=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},xG=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Aue=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return vR(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",vR(n,t)).replace("{{time}}",xG(s,t))},$ue={p:xG,P:Aue},Iue=/^D+$/,Oue=/^Y+$/,jue=["D","DD","YY","YYYY"];function Due(e){return Iue.test(e)}function Nue(e){return Oue.test(e)}function Rue(e,t,r){const n=Fue(e,t,r);if(console.warn(n),jue.includes(e))throw new RangeError(n)}function Fue(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Lue=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Bue=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zue=/^'([^]*?)'?$/,Vue=/''/g,Uue=/[a-zA-Z]/;function Bc(e,t,r){var u,d,h,f,p,_,w,y;const n=vp(),s=(r==null?void 0:r.locale)??n.locale??yG,i=(r==null?void 0:r.firstWeekContainsDate)??((d=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((_=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:_.weekStartsOn)??n.weekStartsOn??((y=(w=n.locale)==null?void 0:w.options)==null?void 0:y.weekStartsOn)??0,a=cr(e);if(!qce(a))throw new RangeError("Invalid time value");let l=t.match(Bue).map(g=>{const v=g[0];if(v==="p"||v==="P"){const b=$ue[v];return b(g,s.formatLong)}return g}).join("").match(Lue).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const v=g[0];if(v==="'")return{isToken:!1,value:Wue(g)};if(gR[v])return{isToken:!0,value:g};if(v.match(Uue))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:g}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(g=>{if(!g.isToken)return g.value;const v=g.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Nue(v)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Due(v))&&Rue(v,t,String(e));const b=gR[v[0]];return b(a,v,s.localize,c)}).join("")}function Wue(e){const t=e.match(zue);return t?t[1].replace(Vue,"'"):e}function Gue(e){const t=cr(e),r=t.getFullYear(),n=t.getMonth(),s=Ks(e,0);return s.setFullYear(r,n+1,0),s.setHours(0,0,0,0),s.getDate()}function Hue(e){return Math.trunc(+cr(e)/1e3)}function Kue(e){const t=cr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function que(e,t){return Qce(Kue(e),Cs(e),t)+1}function D1(e,t){const r=cr(e),n=cr(t);return r.getTime()>n.getTime()}function MG(e,t){const r=cr(e),n=cr(t);return+r<+n}function NE(e,t){const r=cr(e),n=cr(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Que(e,t){const r=cr(e),n=cr(t);return r.getFullYear()===n.getFullYear()}function cb(e,t){return us(e,-t)}function ub(e,t){const r=cr(e),n=r.getFullYear(),s=r.getDate(),i=Ks(e,0);i.setFullYear(n,t,15),i.setHours(0,0,0,0);const o=Gue(i);return r.setMonth(t,Math.min(s,o)),r}function wR(e,t){const r=cr(e);return isNaN(+r)?Ks(e,NaN):(r.setFullYear(t),r)}var Ot=function(){return Ot=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ot.apply(this,arguments)};function Yue(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function TG(e,t,r){for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function wp(e){return e.mode==="multiple"}function bp(e){return e.mode==="range"}function Dy(e){return e.mode==="single"}var Xue={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Jue(e,t){return Bc(e,"LLLL y",t)}function Zue(e,t){return Bc(e,"d",t)}function ede(e,t){return Bc(e,"LLLL",t)}function tde(e){return"".concat(e)}function rde(e,t){return Bc(e,"cccccc",t)}function nde(e,t){return Bc(e,"yyyy",t)}var sde=Object.freeze({__proto__:null,formatCaption:Jue,formatDay:Zue,formatMonthCaption:ede,formatWeekNumber:tde,formatWeekdayName:rde,formatYearCaption:nde}),ide=function(e,t,r){return Bc(e,"do MMMM (EEEE)",r)},ode=function(){return"Month: "},ade=function(){return"Go to next month"},lde=function(){return"Go to previous month"},cde=function(e,t){return Bc(e,"cccc",t)},ude=function(e){return"Week n. ".concat(e)},dde=function(){return"Year: "},hde=Object.freeze({__proto__:null,labelDay:ide,labelMonthDropdown:ode,labelNext:ade,labelPrevious:lde,labelWeekNumber:ude,labelWeekday:cde,labelYearDropdown:dde});function fde(){var e="buttons",t=Xue,r=yG,n={},s={},i=1,o={},a=new Date;return{captionLayout:e,classNames:t,formatters:sde,labels:hde,locale:r,modifiersClassNames:n,modifiers:s,numberOfMonths:i,styles:o,today:a,mode:"default"}}function pde(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,s=e.toMonth,i=e.fromDate,o=e.toDate;return n?i=Cs(n):t&&(i=new Date(t,0,1)),s?o=jE(s):r&&(o=new Date(r,11,31)),{fromDate:i?xd(i):void 0,toDate:o?xd(o):void 0}}var EG=C.createContext(void 0);function mde(e){var t,r=e.initialProps,n=fde(),s=pde(r),i=s.fromDate,o=s.toDate,a=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;a!=="buttons"&&(!i||!o)&&(a="buttons");var l;(Dy(r)||wp(r)||bp(r))&&(l=r.onSelect);var c=Ot(Ot(Ot({},n),r),{captionLayout:a,classNames:Ot(Ot({},n.classNames),r.classNames),components:Ot({},r.components),formatters:Ot(Ot({},n.formatters),r.formatters),fromDate:i,labels:Ot(Ot({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:Ot(Ot({},n.modifiers),r.modifiers),modifiersClassNames:Ot(Ot({},n.modifiersClassNames),r.modifiersClassNames),onSelect:l,styles:Ot(Ot({},n.styles),r.styles),toDate:o});return m.jsx(EG.Provider,{value:c,children:e.children})}function Nr(){var e=C.useContext(EG);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function SG(e){var t=Nr(),r=t.locale,n=t.classNames,s=t.styles,i=t.formatters.formatCaption;return m.jsx("div",{className:n.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function gde(e){return m.jsx("svg",Ot({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:m.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function PG(e){var t,r,n=e.onChange,s=e.value,i=e.children,o=e.caption,a=e.className,l=e.style,c=Nr(),u=(r=(t=c.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:gde;return m.jsxs("div",{className:a,style:l,children:[m.jsx("span",{className:c.classNames.vhidden,children:e["aria-label"]}),m.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:c.classNames.dropdown,style:c.styles.dropdown,value:s,onChange:n,children:i}),m.jsxs("div",{className:c.classNames.caption_label,style:c.styles.caption_label,"aria-hidden":"true",children:[o,m.jsx(u,{className:c.classNames.dropdown_icon,style:c.styles.dropdown_icon})]})]})}function _de(e){var t,r=Nr(),n=r.fromDate,s=r.toDate,i=r.styles,o=r.locale,a=r.formatters.formatMonthCaption,l=r.classNames,c=r.components,u=r.labels.labelMonthDropdown;if(!n)return m.jsx(m.Fragment,{});if(!s)return m.jsx(m.Fragment,{});var d=[];if(Que(n,s))for(var h=Cs(n),f=n.getMonth();f<=s.getMonth();f++)d.push(ub(h,f));else for(var h=Cs(new Date),f=0;f<=11;f++)d.push(ub(h,f));var p=function(w){var y=Number(w.target.value),g=ub(Cs(e.displayMonth),y);e.onChange(g)},_=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:PG;return m.jsx(_,{name:"months","aria-label":u(),className:l.dropdown_month,style:i.dropdown_month,onChange:p,value:e.displayMonth.getMonth(),caption:a(e.displayMonth,{locale:o}),children:d.map(function(w){return m.jsx("option",{value:w.getMonth(),children:a(w,{locale:o})},w.getMonth())})})}function yde(e){var t,r=e.displayMonth,n=Nr(),s=n.fromDate,i=n.toDate,o=n.locale,a=n.styles,l=n.classNames,c=n.components,u=n.formatters.formatYearCaption,d=n.labels.labelYearDropdown,h=[];if(!s)return m.jsx(m.Fragment,{});if(!i)return m.jsx(m.Fragment,{});for(var f=s.getFullYear(),p=i.getFullYear(),_=f;_<=p;_++)h.push(wR(gG(new Date),_));var w=function(g){var v=wR(Cs(r),Number(g.target.value));e.onChange(v)},y=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:PG;return m.jsx(y,{name:"years","aria-label":d(),className:l.dropdown_year,style:a.dropdown_year,onChange:w,value:r.getFullYear(),caption:u(r,{locale:o}),children:h.map(function(g){return m.jsx("option",{value:g.getFullYear(),children:u(g,{locale:o})},g.getFullYear())})})}function vde(e,t){var r=C.useState(e),n=r[0],s=r[1],i=t===void 0?n:t;return[i,s]}function wde(e){var t=e.month,r=e.defaultMonth,n=e.today,s=t||r||n||new Date,i=e.toDate,o=e.fromDate,a=e.numberOfMonths,l=a===void 0?1:a;if(i&&tp(i,s)<0){var c=-1*(l-1);s=to(i,c)}return o&&tp(s,o)<0&&(s=o),Cs(s)}function bde(){var e=Nr(),t=wde(e),r=vde(t,e.month),n=r[0],s=r[1],i=function(o){var a;if(!e.disableNavigation){var l=Cs(o);s(l),(a=e.onMonthChange)===null||a===void 0||a.call(e,l)}};return[n,i]}function xde(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,s=Cs(e),i=Cs(to(s,n)),o=tp(i,s),a=[],l=0;l<o;l++){var c=to(s,l);a.push(c)}return r&&(a=a.reverse()),a}function Mde(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,s=t.numberOfMonths,i=s===void 0?1:s,o=n?i:1,a=Cs(e);if(!r)return to(a,o);var l=tp(r,e);if(!(l<i))return to(a,o)}}function Tde(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,s=t.numberOfMonths,i=s===void 0?1:s,o=n?i:1,a=Cs(e);if(!r)return to(a,-o);var l=tp(a,r);if(!(l<=0))return to(a,-o)}}var CG=C.createContext(void 0);function Ede(e){var t=Nr(),r=bde(),n=r[0],s=r[1],i=xde(n,t),o=Mde(n,t),a=Tde(n,t),l=function(d){return i.some(function(h){return NE(d,h)})},c=function(d,h){l(d)||(h&&MG(d,h)?s(to(d,1+t.numberOfMonths*-1)):s(d))},u={currentMonth:n,displayMonths:i,goToMonth:s,goToDate:c,previousMonth:a,nextMonth:o,isDateDisplayed:l};return m.jsx(CG.Provider,{value:u,children:e.children})}function xp(){var e=C.useContext(CG);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function bR(e){var t,r=Nr(),n=r.classNames,s=r.styles,i=r.components,o=xp().goToMonth,a=function(u){o(to(u,e.displayIndex?-e.displayIndex:0))},l=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:SG,c=m.jsx(l,{id:e.id,displayMonth:e.displayMonth});return m.jsxs("div",{className:n.caption_dropdowns,style:s.caption_dropdowns,children:[m.jsx("div",{className:n.vhidden,children:c}),m.jsx(_de,{onChange:a,displayMonth:e.displayMonth}),m.jsx(yde,{onChange:a,displayMonth:e.displayMonth})]})}function Sde(e){return m.jsx("svg",Ot({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:m.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Pde(e){return m.jsx("svg",Ot({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:m.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var V_=C.forwardRef(function(e,t){var r=Nr(),n=r.classNames,s=r.styles,i=[n.button_reset,n.button];e.className&&i.push(e.className);var o=i.join(" "),a=Ot(Ot({},s.button_reset),s.button);return e.style&&Object.assign(a,e.style),m.jsx("button",Ot({},e,{ref:t,type:"button",className:o,style:a}))});function Cde(e){var t,r,n=Nr(),s=n.dir,i=n.locale,o=n.classNames,a=n.styles,l=n.labels,c=l.labelPrevious,u=l.labelNext,d=n.components;if(!e.nextMonth&&!e.previousMonth)return m.jsx(m.Fragment,{});var h=c(e.previousMonth,{locale:i}),f=[o.nav_button,o.nav_button_previous].join(" "),p=u(e.nextMonth,{locale:i}),_=[o.nav_button,o.nav_button_next].join(" "),w=(t=d==null?void 0:d.IconRight)!==null&&t!==void 0?t:Pde,y=(r=d==null?void 0:d.IconLeft)!==null&&r!==void 0?r:Sde;return m.jsxs("div",{className:o.nav,style:a.nav,children:[!e.hidePrevious&&m.jsx(V_,{name:"previous-month","aria-label":h,className:f,style:a.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:s==="rtl"?m.jsx(w,{className:o.nav_icon,style:a.nav_icon}):m.jsx(y,{className:o.nav_icon,style:a.nav_icon})}),!e.hideNext&&m.jsx(V_,{name:"next-month","aria-label":p,className:_,style:a.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:s==="rtl"?m.jsx(y,{className:o.nav_icon,style:a.nav_icon}):m.jsx(w,{className:o.nav_icon,style:a.nav_icon})})]})}function xR(e){var t=Nr().numberOfMonths,r=xp(),n=r.previousMonth,s=r.nextMonth,i=r.goToMonth,o=r.displayMonths,a=o.findIndex(function(p){return NE(e.displayMonth,p)}),l=a===0,c=a===o.length-1,u=t>1&&(l||!c),d=t>1&&(c||!l),h=function(){n&&i(n)},f=function(){s&&i(s)};return m.jsx(Cde,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:d,nextMonth:s,previousMonth:n,onPreviousClick:h,onNextClick:f})}function kde(e){var t,r=Nr(),n=r.classNames,s=r.disableNavigation,i=r.styles,o=r.captionLayout,a=r.components,l=(t=a==null?void 0:a.CaptionLabel)!==null&&t!==void 0?t:SG,c;return s?c=m.jsx(l,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?c=m.jsx(bR,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?c=m.jsxs(m.Fragment,{children:[m.jsx(bR,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),m.jsx(xR,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):c=m.jsxs(m.Fragment,{children:[m.jsx(l,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),m.jsx(xR,{displayMonth:e.displayMonth,id:e.id})]}),m.jsx("div",{className:n.caption,style:i.caption,children:c})}function Ade(e){var t=Nr(),r=t.footer,n=t.styles,s=t.classNames.tfoot;return r?m.jsx("tfoot",{className:s,style:n.tfoot,children:m.jsx("tr",{children:m.jsx("td",{colSpan:8,children:r})})}):m.jsx(m.Fragment,{})}function $de(e,t,r){for(var n=r?$c(new Date):Io(new Date,{locale:e,weekStartsOn:t}),s=[],i=0;i<7;i++){var o=us(n,i);s.push(o)}return s}function Ide(){var e=Nr(),t=e.classNames,r=e.styles,n=e.showWeekNumber,s=e.locale,i=e.weekStartsOn,o=e.ISOWeek,a=e.formatters.formatWeekdayName,l=e.labels.labelWeekday,c=$de(s,i,o);return m.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&m.jsx("td",{style:r.head_cell,className:t.head_cell}),c.map(function(u,d){return m.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":l(u,{locale:s}),children:a(u,{locale:s})},d)})]})}function Ode(){var e,t=Nr(),r=t.classNames,n=t.styles,s=t.components,i=(e=s==null?void 0:s.HeadRow)!==null&&e!==void 0?e:Ide;return m.jsx("thead",{style:n.head,className:r.head,children:m.jsx(i,{})})}function jde(e){var t=Nr(),r=t.locale,n=t.formatters.formatDay;return m.jsx(m.Fragment,{children:n(e.date,{locale:r})})}var RE=C.createContext(void 0);function Dde(e){if(!wp(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return m.jsx(RE.Provider,{value:t,children:e.children})}return m.jsx(Nde,{initialProps:e.initialProps,children:e.children})}function Nde(e){var t=e.initialProps,r=e.children,n=t.selected,s=t.min,i=t.max,o=function(c,u,d){var h,f;(h=t.onDayClick)===null||h===void 0||h.call(t,c,u,d);var p=!!(u.selected&&s&&(n==null?void 0:n.length)===s);if(!p){var _=!!(!u.selected&&i&&(n==null?void 0:n.length)===i);if(!_){var w=n?TG([],n):[];if(u.selected){var y=w.findIndex(function(g){return Ts(c,g)});w.splice(y,1)}else w.push(c);(f=t.onSelect)===null||f===void 0||f.call(t,w,c,u,d)}}},a={disabled:[]};n&&a.disabled.push(function(c){var u=i&&n.length>i-1,d=n.some(function(h){return Ts(h,c)});return!!(u&&!d)});var l={selected:n,onDayClick:o,modifiers:a};return m.jsx(RE.Provider,{value:l,children:r})}function FE(){var e=C.useContext(RE);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Rde(e,t){var r=t||{},n=r.from,s=r.to;return n&&s?Ts(s,e)&&Ts(n,e)?void 0:Ts(s,e)?{from:s,to:void 0}:Ts(n,e)?void 0:D1(n,e)?{from:e,to:s}:{from:n,to:e}:s?D1(e,s)?{from:s,to:e}:{from:e,to:s}:n?MG(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var LE=C.createContext(void 0);function Fde(e){if(!bp(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return m.jsx(LE.Provider,{value:t,children:e.children})}return m.jsx(Lde,{initialProps:e.initialProps,children:e.children})}function Lde(e){var t=e.initialProps,r=e.children,n=t.selected,s=n||{},i=s.from,o=s.to,a=t.min,l=t.max,c=function(f,p,_){var w,y;(w=t.onDayClick)===null||w===void 0||w.call(t,f,p,_);var g=Rde(f,n);(y=t.onSelect)===null||y===void 0||y.call(t,g,f,p,_)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],o?(u.range_end=[o],Ts(i,o)||(u.range_middle=[{after:i,before:o}])):u.range_end=[i]):o&&(u.range_start=[o],u.range_end=[o]),a&&(i&&!o&&u.disabled.push({after:cb(i,a-1),before:us(i,a-1)}),i&&o&&u.disabled.push({after:i,before:us(i,a-1)}),!i&&o&&u.disabled.push({after:cb(o,a-1),before:us(o,a-1)})),l){if(i&&!o&&(u.disabled.push({before:us(i,-l+1)}),u.disabled.push({after:us(i,l-1)})),i&&o){var d=Mo(o,i)+1,h=l-d;u.disabled.push({before:cb(i,h)}),u.disabled.push({after:us(o,h)})}!i&&o&&(u.disabled.push({before:us(o,-l+1)}),u.disabled.push({after:us(o,l-1)}))}return m.jsx(LE.Provider,{value:{selected:n,onDayClick:c,modifiers:u},children:r})}function BE(){var e=C.useContext(LE);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function zg(e){return Array.isArray(e)?TG([],e):e!==void 0?[e]:[]}function Bde(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],s=r[1];t[n]=zg(s)}),t}var ro;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(ro||(ro={}));var zde=ro.Selected,Bo=ro.Disabled,Vde=ro.Hidden,Ude=ro.Today,db=ro.RangeEnd,hb=ro.RangeMiddle,fb=ro.RangeStart,Wde=ro.Outside;function Gde(e,t,r){var n,s=(n={},n[zde]=zg(e.selected),n[Bo]=zg(e.disabled),n[Vde]=zg(e.hidden),n[Ude]=[e.today],n[db]=[],n[hb]=[],n[fb]=[],n[Wde]=[],n);return e.fromDate&&s[Bo].push({before:e.fromDate}),e.toDate&&s[Bo].push({after:e.toDate}),wp(e)?s[Bo]=s[Bo].concat(t.modifiers[Bo]):bp(e)&&(s[Bo]=s[Bo].concat(r.modifiers[Bo]),s[fb]=r.modifiers[fb],s[hb]=r.modifiers[hb],s[db]=r.modifiers[db]),s}var kG=C.createContext(void 0);function Hde(e){var t=Nr(),r=FE(),n=BE(),s=Gde(t,r,n),i=Bde(t.modifiers),o=Ot(Ot({},s),i);return m.jsx(kG.Provider,{value:o,children:e.children})}function AG(){var e=C.useContext(kG);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Kde(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function qde(e){return!!(e&&typeof e=="object"&&"from"in e)}function Qde(e){return!!(e&&typeof e=="object"&&"after"in e)}function Yde(e){return!!(e&&typeof e=="object"&&"before"in e)}function Xde(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Jde(e,t){var r,n=t.from,s=t.to;if(n&&s){var i=Mo(s,n)<0;i&&(r=[s,n],n=r[0],s=r[1]);var o=Mo(e,n)>=0&&Mo(s,e)>=0;return o}return s?Ts(s,e):n?Ts(n,e):!1}function Zde(e){return OE(e)}function ehe(e){return Array.isArray(e)&&e.every(OE)}function the(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Zde(r))return Ts(e,r);if(ehe(r))return r.includes(e);if(qde(r))return Jde(e,r);if(Xde(r))return r.dayOfWeek.includes(e.getDay());if(Kde(r)){var n=Mo(r.before,e),s=Mo(r.after,e),i=n>0,o=s<0,a=D1(r.before,r.after);return a?o&&i:i||o}return Qde(r)?Mo(e,r.after)>0:Yde(r)?Mo(r.before,e)>0:typeof r=="function"?r(e):!1})}function zE(e,t,r){var n=Object.keys(t).reduce(function(i,o){var a=t[o];return the(e,a)&&i.push(o),i},[]),s={};return n.forEach(function(i){return s[i]=!0}),r&&!NE(e,r)&&(s.outside=!0),s}function rhe(e,t){for(var r=Cs(e[0]),n=jE(e[e.length-1]),s,i,o=r;o<=n;){var a=zE(o,t),l=!a.disabled&&!a.hidden;if(!l){o=us(o,1);continue}if(a.selected)return o;a.today&&!i&&(i=o),s||(s=o),o=us(o,1)}return i||s}var nhe=365;function $G(e,t){var r=t.moveBy,n=t.direction,s=t.context,i=t.modifiers,o=t.retry,a=o===void 0?{count:0,lastFocused:e}:o,l=s.weekStartsOn,c=s.fromDate,u=s.toDate,d=s.locale,h={day:us,week:j1,month:to,year:Gce,startOfWeek:function(w){return s.ISOWeek?$c(w):Io(w,{locale:d,weekStartsOn:l})},endOfWeek:function(w){return s.ISOWeek?_G(w):DE(w,{locale:d,weekStartsOn:l})}},f=h[r](e,n==="after"?1:-1);n==="before"&&c?f=Hce([c,f]):n==="after"&&u&&(f=Kce([u,f]));var p=!0;if(i){var _=zE(f,i);p=!_.disabled&&!_.hidden}return p?f:a.count>nhe?a.lastFocused:$G(f,{moveBy:r,direction:n,context:s,modifiers:i,retry:Ot(Ot({},a),{count:a.count+1})})}var IG=C.createContext(void 0);function she(e){var t=xp(),r=AG(),n=C.useState(),s=n[0],i=n[1],o=C.useState(),a=o[0],l=o[1],c=rhe(t.displayMonths,r),u=s??(a&&t.isDateDisplayed(a))?a:c,d=function(){l(s),i(void 0)},h=function(w){i(w)},f=Nr(),p=function(w,y){if(s){var g=$G(s,{moveBy:w,direction:y,context:f,modifiers:r});Ts(s,g)||(t.goToDate(g,s),h(g))}},_={focusedDay:s,focusTarget:u,blur:d,focus:h,focusDayAfter:function(){return p("day","after")},focusDayBefore:function(){return p("day","before")},focusWeekAfter:function(){return p("week","after")},focusWeekBefore:function(){return p("week","before")},focusMonthBefore:function(){return p("month","before")},focusMonthAfter:function(){return p("month","after")},focusYearBefore:function(){return p("year","before")},focusYearAfter:function(){return p("year","after")},focusStartOfWeek:function(){return p("startOfWeek","before")},focusEndOfWeek:function(){return p("endOfWeek","after")}};return m.jsx(IG.Provider,{value:_,children:e.children})}function VE(){var e=C.useContext(IG);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function ihe(e,t){var r=AG(),n=zE(e,r,t);return n}var UE=C.createContext(void 0);function ohe(e){if(!Dy(e.initialProps)){var t={selected:void 0};return m.jsx(UE.Provider,{value:t,children:e.children})}return m.jsx(ahe,{initialProps:e.initialProps,children:e.children})}function ahe(e){var t=e.initialProps,r=e.children,n=function(i,o,a){var l,c,u;if((l=t.onDayClick)===null||l===void 0||l.call(t,i,o,a),o.selected&&!t.required){(c=t.onSelect)===null||c===void 0||c.call(t,void 0,i,o,a);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,o,a)},s={selected:t.selected,onDayClick:n};return m.jsx(UE.Provider,{value:s,children:r})}function OG(){var e=C.useContext(UE);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function lhe(e,t){var r=Nr(),n=OG(),s=FE(),i=BE(),o=VE(),a=o.focusDayAfter,l=o.focusDayBefore,c=o.focusWeekAfter,u=o.focusWeekBefore,d=o.blur,h=o.focus,f=o.focusMonthBefore,p=o.focusMonthAfter,_=o.focusYearBefore,w=o.focusYearAfter,y=o.focusStartOfWeek,g=o.focusEndOfWeek,v=function(G){var R,te,re,L;Dy(r)?(R=n.onDayClick)===null||R===void 0||R.call(n,e,t,G):wp(r)?(te=s.onDayClick)===null||te===void 0||te.call(s,e,t,G):bp(r)?(re=i.onDayClick)===null||re===void 0||re.call(i,e,t,G):(L=r.onDayClick)===null||L===void 0||L.call(r,e,t,G)},b=function(G){var R;h(e),(R=r.onDayFocus)===null||R===void 0||R.call(r,e,t,G)},x=function(G){var R;d(),(R=r.onDayBlur)===null||R===void 0||R.call(r,e,t,G)},M=function(G){var R;(R=r.onDayMouseEnter)===null||R===void 0||R.call(r,e,t,G)},E=function(G){var R;(R=r.onDayMouseLeave)===null||R===void 0||R.call(r,e,t,G)},P=function(G){var R;(R=r.onDayPointerEnter)===null||R===void 0||R.call(r,e,t,G)},I=function(G){var R;(R=r.onDayPointerLeave)===null||R===void 0||R.call(r,e,t,G)},O=function(G){var R;(R=r.onDayTouchCancel)===null||R===void 0||R.call(r,e,t,G)},V=function(G){var R;(R=r.onDayTouchEnd)===null||R===void 0||R.call(r,e,t,G)},U=function(G){var R;(R=r.onDayTouchMove)===null||R===void 0||R.call(r,e,t,G)},B=function(G){var R;(R=r.onDayTouchStart)===null||R===void 0||R.call(r,e,t,G)},Y=function(G){var R;(R=r.onDayKeyUp)===null||R===void 0||R.call(r,e,t,G)},K=function(G){var R;switch(G.key){case"ArrowLeft":G.preventDefault(),G.stopPropagation(),r.dir==="rtl"?a():l();break;case"ArrowRight":G.preventDefault(),G.stopPropagation(),r.dir==="rtl"?l():a();break;case"ArrowDown":G.preventDefault(),G.stopPropagation(),c();break;case"ArrowUp":G.preventDefault(),G.stopPropagation(),u();break;case"PageUp":G.preventDefault(),G.stopPropagation(),G.shiftKey?_():f();break;case"PageDown":G.preventDefault(),G.stopPropagation(),G.shiftKey?w():p();break;case"Home":G.preventDefault(),G.stopPropagation(),y();break;case"End":G.preventDefault(),G.stopPropagation(),g();break}(R=r.onDayKeyDown)===null||R===void 0||R.call(r,e,t,G)},X={onClick:v,onFocus:b,onBlur:x,onKeyDown:K,onKeyUp:Y,onMouseEnter:M,onMouseLeave:E,onPointerEnter:P,onPointerLeave:I,onTouchCancel:O,onTouchEnd:V,onTouchMove:U,onTouchStart:B};return X}function che(){var e=Nr(),t=OG(),r=FE(),n=BE(),s=Dy(e)?t.selected:wp(e)?r.selected:bp(e)?n.selected:void 0;return s}function uhe(e){return Object.values(ro).includes(e)}function dhe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var s=e.modifiersClassNames[n];if(s)r.push(s);else if(uhe(n)){var i=e.classNames["day_".concat(n)];i&&r.push(i)}}),r}function hhe(e,t){var r=Ot({},e.styles.day);return Object.keys(t).forEach(function(n){var s;r=Ot(Ot({},r),(s=e.modifiersStyles)===null||s===void 0?void 0:s[n])}),r}function fhe(e,t,r){var n,s,i,o=Nr(),a=VE(),l=ihe(e,t),c=lhe(e,l),u=che(),d=!!(o.onDayClick||o.mode!=="default");C.useEffect(function(){var M;l.outside||a.focusedDay&&d&&Ts(a.focusedDay,e)&&((M=r.current)===null||M===void 0||M.focus())},[a.focusedDay,e,r,d,l.outside]);var h=dhe(o,l).join(" "),f=hhe(o,l),p=!!(l.outside&&!o.showOutsideDays||l.hidden),_=(i=(s=o.components)===null||s===void 0?void 0:s.DayContent)!==null&&i!==void 0?i:jde,w=m.jsx(_,{date:e,displayMonth:t,activeModifiers:l}),y={style:f,className:h,children:w,role:"gridcell"},g=a.focusTarget&&Ts(a.focusTarget,e)&&!l.outside,v=a.focusedDay&&Ts(a.focusedDay,e),b=Ot(Ot(Ot({},y),(n={disabled:l.disabled,role:"gridcell"},n["aria-selected"]=l.selected,n.tabIndex=v||g?0:-1,n)),c),x={isButton:d,isHidden:p,activeModifiers:l,selectedDays:u,buttonProps:b,divProps:y};return x}function phe(e){var t=C.useRef(null),r=fhe(e.date,e.displayMonth,t);return r.isHidden?m.jsx("div",{role:"gridcell"}):r.isButton?m.jsx(V_,Ot({name:"day",ref:t},r.buttonProps)):m.jsx("div",Ot({},r.divProps))}function mhe(e){var t=e.number,r=e.dates,n=Nr(),s=n.onWeekNumberClick,i=n.styles,o=n.classNames,a=n.locale,l=n.labels.labelWeekNumber,c=n.formatters.formatWeekNumber,u=c(Number(t),{locale:a});if(!s)return m.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:u});var d=l(Number(t),{locale:a}),h=function(f){s(t,r,f)};return m.jsx(V_,{name:"week-number","aria-label":d,className:o.weeknumber,style:i.weeknumber,onClick:h,children:u})}function ghe(e){var t,r,n=Nr(),s=n.styles,i=n.classNames,o=n.showWeekNumber,a=n.components,l=(t=a==null?void 0:a.Day)!==null&&t!==void 0?t:phe,c=(r=a==null?void 0:a.WeekNumber)!==null&&r!==void 0?r:mhe,u;return o&&(u=m.jsx("td",{className:i.cell,style:s.cell,children:m.jsx(c,{number:e.weekNumber,dates:e.dates})})),m.jsxs("tr",{className:i.row,style:s.row,children:[u,e.dates.map(function(d){return m.jsx("td",{className:i.cell,style:s.cell,role:"presentation",children:m.jsx(l,{displayMonth:e.displayMonth,date:d})},Hue(d))})]})}function MR(e,t,r){for(var n=r!=null&&r.ISOWeek?_G(t):DE(t,r),s=r!=null&&r.ISOWeek?$c(e):Io(e,r),i=Mo(n,s),o=[],a=0;a<=i;a++)o.push(us(s,a));var l=o.reduce(function(c,u){var d=r!=null&&r.ISOWeek?vG(u):bG(u,r),h=c.find(function(f){return f.weekNumber===d});return h?(h.dates.push(u),c):(c.push({weekNumber:d,dates:[u]}),c)},[]);return l}function _he(e,t){var r=MR(Cs(e),jE(e),t);if(t!=null&&t.useFixedWeeks){var n=que(e,t);if(n<6){var s=r[r.length-1],i=s.dates[s.dates.length-1],o=j1(i,6-n),a=MR(j1(i,1),o,t);r.push.apply(r,a)}}return r}function yhe(e){var t,r,n,s=Nr(),i=s.locale,o=s.classNames,a=s.styles,l=s.hideHead,c=s.fixedWeeks,u=s.components,d=s.weekStartsOn,h=s.firstWeekContainsDate,f=s.ISOWeek,p=_he(e.displayMonth,{useFixedWeeks:!!c,ISOWeek:f,locale:i,weekStartsOn:d,firstWeekContainsDate:h}),_=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:Ode,w=(r=u==null?void 0:u.Row)!==null&&r!==void 0?r:ghe,y=(n=u==null?void 0:u.Footer)!==null&&n!==void 0?n:Ade;return m.jsxs("table",{id:e.id,className:o.table,style:a.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!l&&m.jsx(_,{}),m.jsx("tbody",{className:o.tbody,style:a.tbody,children:p.map(function(g){return m.jsx(w,{displayMonth:e.displayMonth,dates:g.dates,weekNumber:g.weekNumber},g.weekNumber)})}),m.jsx(y,{displayMonth:e.displayMonth})]})}function vhe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var whe=vhe()?C.useLayoutEffect:C.useEffect,pb=!1,bhe=0;function TR(){return"react-day-picker-".concat(++bhe)}function xhe(e){var t,r=e??(pb?TR():null),n=C.useState(r),s=n[0],i=n[1];return whe(function(){s===null&&i(TR())},[]),C.useEffect(function(){pb===!1&&(pb=!0)},[]),(t=e??s)!==null&&t!==void 0?t:void 0}function Mhe(e){var t,r,n=Nr(),s=n.dir,i=n.classNames,o=n.styles,a=n.components,l=xp().displayMonths,c=xhe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,d=[i.month],h=o.month,f=e.displayIndex===0,p=e.displayIndex===l.length-1,_=!f&&!p;s==="rtl"&&(t=[f,p],p=t[0],f=t[1]),f&&(d.push(i.caption_start),h=Ot(Ot({},h),o.caption_start)),p&&(d.push(i.caption_end),h=Ot(Ot({},h),o.caption_end)),_&&(d.push(i.caption_between),h=Ot(Ot({},h),o.caption_between));var w=(r=a==null?void 0:a.Caption)!==null&&r!==void 0?r:kde;return m.jsxs("div",{className:d.join(" "),style:h,children:[m.jsx(w,{id:c,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),m.jsx(yhe,{id:u,"aria-labelledby":c,displayMonth:e.displayMonth})]},e.displayIndex)}function The(e){var t=Nr(),r=t.classNames,n=t.styles;return m.jsx("div",{className:r.months,style:n.months,children:e.children})}function Ehe(e){var t,r,n=e.initialProps,s=Nr(),i=VE(),o=xp(),a=C.useState(!1),l=a[0],c=a[1];C.useEffect(function(){s.initialFocus&&i.focusTarget&&(l||(i.focus(i.focusTarget),c(!0)))},[s.initialFocus,l,i.focus,i.focusTarget,i]);var u=[s.classNames.root,s.className];s.numberOfMonths>1&&u.push(s.classNames.multiple_months),s.showWeekNumber&&u.push(s.classNames.with_weeknumber);var d=Ot(Ot({},s.styles.root),s.style),h=Object.keys(n).filter(function(p){return p.startsWith("data-")}).reduce(function(p,_){var w;return Ot(Ot({},p),(w={},w[_]=n[_],w))},{}),f=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:The;return m.jsx("div",Ot({className:u.join(" "),style:d,dir:s.dir,id:s.id,nonce:n.nonce,title:n.title,lang:n.lang},h,{children:m.jsx(f,{children:o.displayMonths.map(function(p,_){return m.jsx(Mhe,{displayIndex:_,displayMonth:p},_)})})}))}function She(e){var t=e.children,r=Yue(e,["children"]);return m.jsx(mde,{initialProps:r,children:m.jsx(Ede,{children:m.jsx(ohe,{initialProps:r,children:m.jsx(Dde,{initialProps:r,children:m.jsx(Fde,{initialProps:r,children:m.jsx(Hde,{children:m.jsx(she,{children:t})})})})})})})}function Phe(e){return m.jsx(She,Ot({},e,{children:m.jsx(Ehe,{initialProps:e})}))}function jG({className:e,classNames:t,showOutsideDays:r=!0,...n}){return m.jsx(Phe,{showOutsideDays:r,className:zt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:zt(o1({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:zt(o1({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...s})=>m.jsx(Cq,{className:"h-4 w-4"}),IconRight:({...s})=>m.jsx(E3,{className:"h-4 w-4"})},...n})}jG.displayName="Calendar";const Che=()=>{const[e,t]=C.useState([]),[r,n]=C.useState(!0),{user:s}=Do(),i=async()=>{if(!s)return;n(!0);const{data:c,error:u}=await xr.from("outfit_calendar").select(`
        *,
        outfits (
          id,
          name,
          description,
          outfit_items (
            id,
            clothing_item_id,
            clothing_items (
              id,
              name,
              image_url,
              color,
              hex_color,
              category
            )
          )
        )
      `).order("date",{ascending:!1});if(u)console.error("Error fetching outfit calendar:",u);else{const d=(c==null?void 0:c.map(h=>{var f;return{...h,outfit:h.outfits?{...h.outfits,items:(f=h.outfits.outfit_items)==null?void 0:f.map(p=>({id:p.id,clothing_item_id:p.clothing_item_id,clothing_item:p.clothing_items}))}:void 0}}))||[];t(d)}n(!1)},o=async(c,u,d)=>{if(!s)return;const{data:h,error:f}=await xr.from("outfit_calendar").upsert([{user_id:s.id,date:c,outfit_id:u,notes:d}]).select().single();if(f)throw console.error("Error adding calendar entry:",f),f;return await i(),h},a=async(c,u)=>{const{data:d,error:h}=await xr.from("outfit_calendar").update(u).eq("id",c).select().single();if(h)throw console.error("Error updating calendar entry:",h),h;return await i(),d},l=async c=>{const{error:u}=await xr.from("outfit_calendar").delete().eq("id",c);if(u)throw console.error("Error deleting calendar entry:",u),u;t(d=>d.filter(h=>h.id!==c))};return C.useEffect(()=>{i()},[s]),{entries:e,loading:r,addEntry:o,updateEntry:a,deleteEntry:l,refetch:i}},khe=()=>{const[e,t]=C.useState(new Date),[r,n]=C.useState(""),[s,i]=C.useState(""),[o,a]=C.useState(!1),l=Ys(),{entries:c,addEntry:u,loading:d}=Che(),{outfits:h}=Fd(),{toast:f}=vi(),p=y=>y.toISOString().split("T")[0],_=e?c.find(y=>y.date===p(e)):null,w=async()=>{if(e)try{await u(p(e),r||void 0,s.trim()||void 0),f({title:"Outfit saved!",description:"Your outfit has been added to the calendar."}),a(!1),n(""),i("")}catch{f({title:"Error saving outfit",description:"Please try again.",variant:"destructive"})}};return m.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Bt,{variant:"ghost",size:"icon",onClick:()=>l(-1),children:m.jsx(Ya,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-xl font-bold",children:"Outfit Calendar"}),m.jsx("div",{className:"w-10"})]}),m.jsxs(vr,{children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"flex items-center gap-2",children:[m.jsx(Sq,{className:"h-5 w-5"}),"Select Date"]})}),m.jsx(Cr,{children:m.jsx(jG,{mode:"single",selected:e,onSelect:t,className:"rounded-md border"})})]}),e&&m.jsxs(vr,{children:[m.jsx(Wi,{children:m.jsxs(Gi,{className:"flex items-center justify-between",children:[m.jsx("span",{children:e.toLocaleDateString()}),m.jsxs(MU,{open:o,onOpenChange:a,children:[m.jsx(TU,{asChild:!0,children:m.jsxs(Bt,{size:"sm",children:[m.jsx(C3,{className:"h-4 w-4 mr-1"}),"Add Outfit"]})}),m.jsxs(qT,{children:[m.jsx(QT,{children:m.jsxs(YT,{children:["Add Outfit for ",e.toLocaleDateString()]})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Choose Outfit"}),m.jsxs(bo,{value:r,onValueChange:n,children:[m.jsx(Hi,{className:"mt-1",children:m.jsx(xo,{placeholder:"Select an outfit"})}),m.jsx(Ki,{children:h.map(y=>m.jsx(qt,{value:y.id,children:y.name},y.id))})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Notes"}),m.jsx($y,{value:s,onChange:y=>i(y.target.value),placeholder:"Any notes about this outfit...",className:"mt-1",rows:3})]}),m.jsx(Bt,{onClick:w,className:"w-full",children:"Save Outfit"})]})]})]})]})}),m.jsx(Cr,{children:_?m.jsxs("div",{className:"space-y-4",children:[_.outfit&&m.jsxs("div",{children:[m.jsxs("h4",{className:"font-medium mb-2",children:["Outfit: ",_.outfit.name]}),_.outfit.items&&_.outfit.items.length>0&&m.jsx("div",{className:"grid grid-cols-3 gap-2",children:_.outfit.items.map(y=>{var g,v,b,x;return m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"aspect-square bg-muted rounded-md overflow-hidden mb-1",children:(g=y.clothing_item)!=null&&g.image_url?m.jsx("img",{src:y.clothing_item.image_url,alt:y.clothing_item.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center",children:m.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-300",style:{backgroundColor:(v=y.clothing_item)==null?void 0:v.hex_color}})})}),m.jsx("p",{className:"text-xs truncate",children:(b=y.clothing_item)==null?void 0:b.name}),m.jsx(Wn,{variant:"outline",className:"text-xs",children:(x=y.clothing_item)==null?void 0:x.category})]},y.id)})})]}),_.notes&&m.jsxs("div",{children:[m.jsx("h4",{className:"font-medium",children:"Notes:"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:_.notes})]})]}):m.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No outfit planned for this day"})})]})]})},Ahe="/assets/login-background-DDZN4XIG.jpg",$he=()=>{const[e,t]=C.useState(!0),[r,n]=C.useState(""),[s,i]=C.useState(""),[o,a]=C.useState(!1),{signIn:l,signUp:c}=Do(),u=Ys(),{toast:d}=vi(),h=async f=>{f.preventDefault(),a(!0);try{const{error:p}=e?await l(r,s):await c(r,s);p?d({title:"Error",description:p.message,variant:"destructive"}):e?(u("/"),d({title:"Welcome back!",description:"You've been signed in successfully."})):d({title:"Account created!",description:"Please check your email to verify your account."})}catch{d({title:"Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{a(!1)}};return m.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",style:{backgroundImage:`url(${Ahe})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[m.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-outfit-primary/20 via-transparent to-outfit-secondary/20 backdrop-blur-[2px]"}),m.jsx("div",{className:"absolute top-20 left-10 opacity-30",children:m.jsx(Ao,{className:"h-8 w-8 text-outfit-primary animate-pulse"})}),m.jsx("div",{className:"absolute top-32 right-16 opacity-20",children:m.jsx(hs,{className:"h-6 w-6 text-outfit-secondary animate-bounce"})}),m.jsx("div",{className:"absolute bottom-32 left-20 opacity-25",children:m.jsx(hs,{className:"h-4 w-4 text-outfit-accent animate-pulse"})}),m.jsxs(vr,{className:"w-full max-w-md relative z-10 border-0 shadow-glow backdrop-blur-md bg-white/90",children:[m.jsxs(Wi,{className:"text-center pb-6",children:[m.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[m.jsx(hs,{className:"h-6 w-6 text-outfit-primary"}),m.jsx(Gi,{className:"text-3xl font-bold bg-gradient-to-r from-outfit-primary to-outfit-secondary bg-clip-text text-transparent",children:"OutfitFlex"}),m.jsx(Ao,{className:"h-6 w-6 text-outfit-accent"})]}),m.jsx(pV,{className:"text-outfit-dark/70",children:e?"Welcome back, fashionista! ":"Join our stylish community "})]}),m.jsxs(Cr,{className:"space-y-6",children:[m.jsxs("form",{onSubmit:h,className:"space-y-5",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsx("div",{className:"relative",children:m.jsx(ko,{type:"email",placeholder:"Enter your email",value:r,onChange:f=>n(f.target.value),required:!0,className:"h-12 pl-4 border-outfit-primary/20 focus:border-outfit-primary bg-white/50 backdrop-blur-sm"})}),m.jsx("div",{className:"relative",children:m.jsx(ko,{type:"password",placeholder:"Enter your password",value:s,onChange:f=>i(f.target.value),required:!0,className:"h-12 pl-4 border-outfit-primary/20 focus:border-outfit-primary bg-white/50 backdrop-blur-sm"})})]}),m.jsxs(Bt,{type:"submit",className:"w-full h-12 text-base font-medium bg-gradient-to-r from-outfit-primary to-outfit-secondary hover:from-outfit-primary/90 hover:to-outfit-secondary/90 transition-all duration-300 shadow-glow",disabled:o,children:[o&&m.jsx(S3,{className:"mr-2 h-5 w-5 animate-spin"}),m.jsx(hs,{className:"mr-2 h-5 w-5"}),e?"Sign In & Style":"Join the Fashion"]})]}),m.jsx("div",{className:"text-center",children:m.jsx(Bt,{variant:"ghost",onClick:()=>t(!e),className:"text-outfit-dark/70 hover:text-outfit-primary hover:bg-outfit-primary/5",children:e?"New here? Create your style profile ":"Already have an account? Sign in "})})]})]})]})},Ihe=new GY,Ohe=()=>{const{user:e}=Do(),[t,r]=C.useState(!1),[n,s]=C.useState(!1);C.useEffect(()=>{if(e){const a=localStorage.getItem("hasSeenOnboarding"),l=localStorage.getItem("hasSeenWelcome");a?l||s(!0):r(!0)}},[e]);const i=()=>{localStorage.setItem("hasSeenOnboarding","true"),r(!1),s(!0)},o=()=>{localStorage.setItem("hasSeenWelcome","true"),s(!1)};return m.jsxs(m.Fragment,{children:[t&&m.jsx(die,{onComplete:i}),n&&m.jsx(aie,{onComplete:o}),m.jsxs(FX,{children:[m.jsx(as,{path:"/auth",element:m.jsx($he,{})}),m.jsxs(as,{path:"/",element:m.jsx(See,{children:m.jsx(Cee,{})}),children:[m.jsx(as,{index:!0,element:m.jsx(fie,{})}),m.jsx(as,{path:"wardrobe",element:m.jsx(jie,{})}),m.jsx(as,{path:"wardrobe/add",element:m.jsx(dG,{})}),m.jsx(as,{path:"wardrobe/item/:id",element:m.jsx(Rce,{})}),m.jsx(as,{path:"outfits",element:m.jsx(Nie,{})}),m.jsx(as,{path:"outfits/create",element:m.jsx(Fce,{})}),m.jsx(as,{path:"outfits/detail/:id",element:m.jsx(Lce,{})}),m.jsx(as,{path:"outfits/suggestions",element:m.jsx(Bce,{})}),m.jsx(as,{path:"weather-outfits",element:m.jsx(zce,{})}),m.jsx(as,{path:"calendar",element:m.jsx(khe,{})}),m.jsx(as,{path:"profile",element:m.jsx(Qoe,{})})]}),m.jsx(as,{path:"*",element:m.jsx(Yoe,{})})]})]})},jhe=()=>m.jsx(KY,{client:Ihe,children:m.jsx(xY,{children:m.jsxs(Eee,{children:[m.jsx(w7,{}),m.jsx(Q7,{}),m.jsx(HX,{children:m.jsx(Ohe,{})})]})})});QL(document.getElementById("root")).render(m.jsx(jhe,{}));
